\hypertarget{group__APR__Util__RMM}{}\section{Relocatable Memory Management Routines}
\label{group__APR__Util__RMM}\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
Collaboration diagram for Relocatable Memory Management Routines\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{group__APR__Util__RMM}
\end{center}
\end{figure}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structapr__rmm__t}{apr\+\_\+rmm\+\_\+t} \hyperlink{group__APR__Util__RMM_gadb4d418c417ece33c4430ba9df59070a}{apr\+\_\+rmm\+\_\+t}
\item 
typedef \hyperlink{group__apr__platform_gaaa72b2253f6f3032cefea5712a27540e}{apr\+\_\+size\+\_\+t} \hyperlink{group__APR__Util__RMM_ga70b508c81a0bc75350efdefb3410af12}{apr\+\_\+rmm\+\_\+off\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__APR__Util__RMM_gaa2645d20098f125bc72dd229db627b64}{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t}) apr\+\_\+rmm\+\_\+init(\hyperlink{structapr__rmm__t}{apr\+\_\+rmm\+\_\+t} $\ast$$\ast$rmm
\item 
\hyperlink{group__APR__Util__RMM_ga816fbaf1e2e831c43acc9990e3f8cd96}{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{group__APR__Util__RMM_ga70b508c81a0bc75350efdefb3410af12}{apr\+\_\+rmm\+\_\+off\+\_\+t}) apr\+\_\+rmm\+\_\+malloc(\hyperlink{structapr__rmm__t}{apr\+\_\+rmm\+\_\+t} $\ast$rmm
\item 
\hyperlink{group__APR__Util__RMM_gad9b913df6926ec4204252ad5540609a4}{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} $\ast$) apr\+\_\+rmm\+\_\+addr\+\_\+get(\hyperlink{structapr__rmm__t}{apr\+\_\+rmm\+\_\+t} $\ast$rmm
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structapr__anylock__t}{apr\+\_\+anylock\+\_\+t} $\ast$ \hyperlink{group__APR__Util__RMM_ga0353fe7d0bd33c38d9a7a57a73b6407e}{lock}
\item 
\hyperlink{structapr__anylock__t}{apr\+\_\+anylock\+\_\+t} \hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} $\ast$ \hyperlink{group__APR__Util__RMM_ga8cd1efca8664c2df8d8dbab3bf4b90df}{membuf}
\item 
\hyperlink{structapr__anylock__t}{apr\+\_\+anylock\+\_\+t} \hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{group__apr__platform_gaaa72b2253f6f3032cefea5712a27540e}{apr\+\_\+size\+\_\+t} \hyperlink{group__APR__Util__RMM_gacf427447e8eb4dd9a7238411a3ae120d}{memsize}
\item 
\hyperlink{structapr__anylock__t}{apr\+\_\+anylock\+\_\+t} \hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{group__apr__platform_gaaa72b2253f6f3032cefea5712a27540e}{apr\+\_\+size\+\_\+t} \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$ \hyperlink{group__APR__Util__RMM_ga787b4ea953862721fc5e2d757cd26cfc}{cont}
\item 
\hyperlink{group__apr__platform_gaaa72b2253f6f3032cefea5712a27540e}{apr\+\_\+size\+\_\+t} \hyperlink{group__APR__Util__RMM_gab0526251505fe7f4db6377b7617e16d9}{reqsize}
\item 
\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} $\ast$ \hyperlink{group__APR__Util__RMM_ga9c332e6ff04da36425a4963b3bd27dd3}{entity}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Typedef Documentation}
\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!apr\+\_\+rmm\+\_\+off\+\_\+t@{apr\+\_\+rmm\+\_\+off\+\_\+t}}
\index{apr\+\_\+rmm\+\_\+off\+\_\+t@{apr\+\_\+rmm\+\_\+off\+\_\+t}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{apr\+\_\+rmm\+\_\+off\+\_\+t}{apr_rmm_off_t}}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf apr\+\_\+size\+\_\+t} {\bf apr\+\_\+rmm\+\_\+off\+\_\+t}}\hypertarget{group__APR__Util__RMM_ga70b508c81a0bc75350efdefb3410af12}{}\label{group__APR__Util__RMM_ga70b508c81a0bc75350efdefb3410af12}
Fundamental allocation unit, within a specific \hyperlink{structapr__rmm__t}{apr\+\_\+rmm\+\_\+t} \index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!apr\+\_\+rmm\+\_\+t@{apr\+\_\+rmm\+\_\+t}}
\index{apr\+\_\+rmm\+\_\+t@{apr\+\_\+rmm\+\_\+t}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{apr\+\_\+rmm\+\_\+t}{apr_rmm_t}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf apr\+\_\+rmm\+\_\+t} {\bf apr\+\_\+rmm\+\_\+t}}\hypertarget{group__APR__Util__RMM_gadb4d418c417ece33c4430ba9df59070a}{}\label{group__APR__Util__RMM_gadb4d418c417ece33c4430ba9df59070a}
Structure to access Relocatable, Managed Memory 

\subsection{Function Documentation}
\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+R\+E(apr\+\_\+status\+\_\+t) apr\+\_\+rmm\+\_\+init(apr\+\_\+rmm\+\_\+t $\ast$$\ast$rmm}{APU_DECLARE(apr_status_t) apr_rmm_init(apr_rmm_t **rmm}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+status\+\_\+t}}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__APR__Util__RMM_gaa2645d20098f125bc72dd229db627b64}{}\label{group__APR__Util__RMM_gaa2645d20098f125bc72dd229db627b64}
Initialize a relocatable memory block to be managed by the apr\+\_\+rmm A\+PI. 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block \\
\hline
{\em lock} & An \hyperlink{structapr__anylock__t}{apr\+\_\+anylock\+\_\+t} of the appropriate type of lock, or N\+U\+LL if no locking is required. \\
\hline
{\em membuf} & The block of relocatable memory to be managed \\
\hline
{\em memsize} & The size of relocatable memory block to be managed \\
\hline
{\em cont} & The pool to use for local storage and management \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
Both 
\end{DoxyRemark}

\begin{DoxyParams}{Parameters}
{\em membuf} & and \\
\hline
{\em memsize} & must be aligned (for instance using A\+P\+R\+\_\+\+A\+L\+I\+G\+N\+\_\+\+D\+E\+F\+A\+U\+LT).\\
\hline
\end{DoxyParams}
Destroy a managed memory block. 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block to destroy\\
\hline
\end{DoxyParams}
Attach to a relocatable memory block already managed by the apr\+\_\+rmm A\+PI. 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block \\
\hline
{\em lock} & An \hyperlink{structapr__anylock__t}{apr\+\_\+anylock\+\_\+t} of the appropriate type of lock \\
\hline
{\em membuf} & The block of relocatable memory already under management \\
\hline
{\em cont} & The pool to use for local storage and management\\
\hline
\end{DoxyParams}
Detach from the managed block of memory. 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block to detach from\\
\hline
\end{DoxyParams}
Free allocation returned by apr\+\_\+rmm\+\_\+malloc or apr\+\_\+rmm\+\_\+calloc. 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block \\
\hline
{\em entity} & The memory allocation to free \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
38 \{
39     \hyperlink{structapr__bucket__brigade}{apr\_bucket\_brigade} *\hyperlink{group__APACHE__CORE__PROTO_ga7fa09c5c80a7d25b74511944f5949e31}{b} = \hyperlink{group__APACHE__CORE__LOG_gae4950db1dbfff8459a712737063b61aa}{data};
40     \hyperlink{structapr__bucket}{apr\_bucket} *\hyperlink{group__APR__Util__Bucket__Brigades_gacd90314acb2c2e5cd19681136c08efac}{e};
41 
42     \textcolor{keywordflow}{while} (!\hyperlink{group__APR__Util__Bucket__Brigades_ga836f61da6cce15074eff257ce4b6fc0f}{APR\_BRIGADE\_EMPTY}(b)) \{
43         e = \hyperlink{group__APR__Util__Bucket__Brigades_gab5826a11eb6ba90786a94282f806c230}{APR\_BRIGADE\_FIRST}(b);
44         \hyperlink{group__APR__Util__Bucket__Brigades_ga8925c02a7f95e8c1c3986294d4678797}{apr\_bucket\_delete}(e);
45     \}
46     \textcolor{comment}{/* We don't need to free(bb) because it's allocated from a pool. */}
47     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
48 \}
\end{DoxyCode}
\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+R\+E(apr\+\_\+rmm\+\_\+off\+\_\+t) apr\+\_\+rmm\+\_\+malloc(apr\+\_\+rmm\+\_\+t $\ast$rmm}{APU_DECLARE(apr_rmm_off_t) apr_rmm_malloc(apr_rmm_t *rmm}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+rmm\+\_\+off\+\_\+t}}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__APR__Util__RMM_ga816fbaf1e2e831c43acc9990e3f8cd96}{}\label{group__APR__Util__RMM_ga816fbaf1e2e831c43acc9990e3f8cd96}
Allocate memory from the block of relocatable memory. 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block \\
\hline
{\em reqsize} & How much memory to allocate\\
\hline
\end{DoxyParams}
Realloc memory from the block of relocatable memory. 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block \\
\hline
{\em entity} & The memory allocation to realloc \\
\hline
{\em reqsize} & The new size\\
\hline
\end{DoxyParams}
Allocate memory from the block of relocatable memory and initialize it to zero. 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block \\
\hline
{\em reqsize} & How much memory to allocate\\
\hline
\end{DoxyParams}
Compute the offset of a relocatable allocation of memory 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block \\
\hline
{\em entity} & The physical address to convert to an offset\\
\hline
\end{DoxyParams}
Compute the required overallocation of memory needed to fit n allocs 
\begin{DoxyParams}{Parameters}
{\em n} & The number of alloc/calloc regions desired \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
331 \{
332     \hyperlink{group__apr__platform_gaaa72b2253f6f3032cefea5712a27540e}{apr\_size\_t} \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
333     \hyperlink{group__APR__Util__RMM_ga70b508c81a0bc75350efdefb3410af12}{apr\_rmm\_off\_t} \textcolor{keyword}{this};
334         
335     size = \hyperlink{group__apr__general_gab484e98426221f3212fcb67af0467381}{APR\_ALIGN\_DEFAULT}(\hyperlink{group__apr__shm_gab0526251505fe7f4db6377b7617e16d9}{reqsize}) + \hyperlink{apr__rmm_8c_a702b3d268d954b9446c019ca86f463fa}{RMM\_BLOCK\_SIZE};
336     \textcolor{keywordflow}{if} (size < \hyperlink{group__apr__shm_gab0526251505fe7f4db6377b7617e16d9}{reqsize}) \{
337         \textcolor{keywordflow}{return} 0;
338     \}
339 
340     \hyperlink{apr__anylock_8h_ac43b130fb19a434647c34e1d7040fc49}{APR\_ANYLOCK\_LOCK}(&rmm->lock);
341 
342     \textcolor{keyword}{this} = find\_block\_of\_size(rmm, size);
343 
344     \textcolor{keywordflow}{if} (\textcolor{keyword}{this}) \{
345         move\_block(rmm, \textcolor{keyword}{this}, 0);
346         \textcolor{keyword}{this} += \hyperlink{apr__rmm_8c_a702b3d268d954b9446c019ca86f463fa}{RMM\_BLOCK\_SIZE};
347         memset((\textcolor{keywordtype}{char}*)rmm->base + \textcolor{keyword}{this}, 0, size - \hyperlink{apr__rmm_8c_a702b3d268d954b9446c019ca86f463fa}{RMM\_BLOCK\_SIZE});
348     \}
349 
350     \hyperlink{apr__anylock_8h_a367f0d4cc5239e95ee925542d4a0b3fb}{APR\_ANYLOCK\_UNLOCK}(&rmm->lock);
351     \textcolor{keywordflow}{return} \textcolor{keyword}{this};
352 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=298pt]{group__APR__Util__RMM_ga816fbaf1e2e831c43acc9990e3f8cd96_cgraph}
\end{center}
\end{figure}


\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+R\+E(void $\ast$) apr\+\_\+rmm\+\_\+addr\+\_\+get(apr\+\_\+rmm\+\_\+t $\ast$rmm}{APU_DECLARE(void *) apr_rmm_addr_get(apr_rmm_t *rmm}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+U\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__APR__Util__RMM_gad9b913df6926ec4204252ad5540609a4}{}\label{group__APR__Util__RMM_gad9b913df6926ec4204252ad5540609a4}
Retrieve the physical address of a relocatable allocation of memory 
\begin{DoxyParams}{Parameters}
{\em rmm} & The relocatable memory block \\
\hline
{\em entity} & The memory allocation to free \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
address The address, aligned with A\+P\+R\+\_\+\+A\+L\+I\+G\+N\+\_\+\+D\+E\+F\+A\+U\+LT. 
\end{DoxyReturn}


\subsection{Variable Documentation}
\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!cont@{cont}}
\index{cont@{cont}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{cont}{cont}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+anylock\+\_\+t} {\bf void} {\bf apr\+\_\+pool\+\_\+t}$\ast$ cont}\hypertarget{group__APR__Util__RMM_ga787b4ea953862721fc5e2d757cd26cfc}{}\label{group__APR__Util__RMM_ga787b4ea953862721fc5e2d757cd26cfc}
\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!entity@{entity}}
\index{entity@{entity}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{entity}{entity}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} $\ast$ entity}\hypertarget{group__APR__Util__RMM_ga9c332e6ff04da36425a4963b3bd27dd3}{}\label{group__APR__Util__RMM_ga9c332e6ff04da36425a4963b3bd27dd3}
\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!lock@{lock}}
\index{lock@{lock}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{lock}{lock}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+anylock\+\_\+t} $\ast$ lock}\hypertarget{group__APR__Util__RMM_ga0353fe7d0bd33c38d9a7a57a73b6407e}{}\label{group__APR__Util__RMM_ga0353fe7d0bd33c38d9a7a57a73b6407e}
\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!membuf@{membuf}}
\index{membuf@{membuf}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{membuf}{membuf}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+anylock\+\_\+t} {\bf void} $\ast$ membuf}\hypertarget{group__APR__Util__RMM_ga8cd1efca8664c2df8d8dbab3bf4b90df}{}\label{group__APR__Util__RMM_ga8cd1efca8664c2df8d8dbab3bf4b90df}
\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!memsize@{memsize}}
\index{memsize@{memsize}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{memsize}{memsize}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+anylock\+\_\+t} {\bf void} {\bf apr\+\_\+size\+\_\+t} memsize}\hypertarget{group__APR__Util__RMM_gacf427447e8eb4dd9a7238411a3ae120d}{}\label{group__APR__Util__RMM_gacf427447e8eb4dd9a7238411a3ae120d}
\index{Relocatable Memory Management Routines@{Relocatable Memory Management Routines}!reqsize@{reqsize}}
\index{reqsize@{reqsize}!Relocatable Memory Management Routines@{Relocatable Memory Management Routines}}
\subsubsection[{\texorpdfstring{reqsize}{reqsize}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+size\+\_\+t} reqsize}\hypertarget{group__APR__Util__RMM_gab0526251505fe7f4db6377b7617e16d9}{}\label{group__APR__Util__RMM_gab0526251505fe7f4db6377b7617e16d9}
