\hypertarget{cache__util_8c}{}\section{/usr/local/src/github/\+Codebase/httpd-\/2.4.29/modules/cache/cache\+\_\+util.c File Reference}
\label{cache__util_8c}\index{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/modules/cache/cache\+\_\+util.\+c@{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/modules/cache/cache\+\_\+util.\+c}}
{\ttfamily \#include \char`\"{}mod\+\_\+cache.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}cache\+\_\+util.\+h\char`\"{}}\\*
{\ttfamily \#include $<$ap\+\_\+provider.\+h$>$}\\*
Include dependency graph for cache\+\_\+util.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cache__util_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structcache__table__getm__t}{cache\+\_\+table\+\_\+getm\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{cache__util_8c_aa72a2cb5a9359a74d12d44c96b77c4d2}{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE} (\hyperlink{structcache}{cache})
\item 
\hyperlink{cache__util_8c_a0c188ed1fe0083803d64f9d4d958508b}{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE} (\hyperlink{group__MOD__CACHE_ga5d2f230364a78ad03f94ebbca2dd1f5c}{ap\+\_\+cache\+\_\+generate\+\_\+key})
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__Cache__util_gaea2f7fee82fd07fce89934bee0939987}{cache\+\_\+use\+\_\+early\+\_\+url} (\hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r})
\item 
\hyperlink{structcache__provider__list}{cache\+\_\+provider\+\_\+list} $\ast$ \hyperlink{group__Cache__util_ga3bb0227007e96351ef9b155cd0720abb}{cache\+\_\+get\+\_\+providers} (\hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r}, \hyperlink{structcache__server__conf}{cache\+\_\+server\+\_\+conf} $\ast$\hyperlink{group__MOD__PROXY_ga4d7edd451c4bb8ed9ce9012e5dea2b14}{conf})
\item 
\hyperlink{cache__util_8c_ga2339c792dd32ac6ce14e5ee1bb4f332b}{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{group__apr__platform_ga4b75afbf973dc6c8aea4ae75b044aa08}{apr\+\_\+int64\+\_\+t})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__Cache__util_gaffa94dfea5098ffab89d1dc91e094415}{cache\+\_\+try\+\_\+lock} (\hyperlink{structcache__server__conf}{cache\+\_\+server\+\_\+conf} $\ast$\hyperlink{group__MOD__PROXY_ga4d7edd451c4bb8ed9ce9012e5dea2b14}{conf}, \hyperlink{structcache__request__rec}{cache\+\_\+request\+\_\+rec} $\ast$\hyperlink{structcache}{cache}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__Cache__util_ga6936350ce1acc1f19e336eb95be153fb}{cache\+\_\+remove\+\_\+lock} (\hyperlink{structcache__server__conf}{cache\+\_\+server\+\_\+conf} $\ast$\hyperlink{group__MOD__PROXY_ga4d7edd451c4bb8ed9ce9012e5dea2b14}{conf}, \hyperlink{structcache__request__rec}{cache\+\_\+request\+\_\+rec} $\ast$\hyperlink{structcache}{cache}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r}, \hyperlink{structapr__bucket__brigade}{apr\+\_\+bucket\+\_\+brigade} $\ast$\hyperlink{group__MOD__PROXY_ga9313a8a2814cff280d5d780c723def3c}{bb})
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__Cache__util_ga565962a760117aaaed7e13445f79e831}{ap\+\_\+cache\+\_\+check\+\_\+no\+\_\+cache} (\hyperlink{structcache__request__rec}{cache\+\_\+request\+\_\+rec} $\ast$\hyperlink{structcache}{cache}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r})
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__Cache__util_gabddbd6cc98e9791c643ea64a26e165b0}{ap\+\_\+cache\+\_\+check\+\_\+no\+\_\+store} (\hyperlink{structcache__request__rec}{cache\+\_\+request\+\_\+rec} $\ast$\hyperlink{structcache}{cache}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r})
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__Cache__util_ga8719ff14e3ad87c32614da9fc10cb119}{cache\+\_\+check\+\_\+freshness} (\hyperlink{group__MOD__CACHE_ga6b7854a2592838a565bdee8f94343aab}{cache\+\_\+handle\+\_\+t} $\ast$\hyperlink{pcregrep_8txt_a373589baca2cb79ec87f46d6599640b9}{h}, \hyperlink{structcache__request__rec}{cache\+\_\+request\+\_\+rec} $\ast$\hyperlink{structcache}{cache}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r})
\item 
\hyperlink{cache__util_8c_adc66c9408ab730bb26ef99d39e0313f3}{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE} (const char $\ast$)
\item 
\hyperlink{cache__util_8c_a71850f9c252aac64fd4799ca724c859f}{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})
\item 
\hyperlink{cache__util_8c_a6931685a491fc9064207a161b3e14d7f}{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE} (char $\ast$)
\item 
char $\ast$ \hyperlink{group__Cache__util_gada03570414af2b2d9349449858036d90}{cache\+\_\+strqtok} (char $\ast$\hyperlink{group__APR__Util__Bucket__Brigades_ga6a62b60443be1d042194af15ce934193}{str}, const char $\ast$\hyperlink{group__apr__tables_ga37d96adf842aef6b03690e17874c9ed8}{sep}, char $\ast$$\ast$\hyperlink{group__apr__strings_ga882d08c2e3ad3004cdfc219601ebaac8}{last})
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__MOD__CACHE_ga22e3955e21c6e60450101eb1e3c6919b}{ap\+\_\+cache\+\_\+control} (\hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r}, \hyperlink{group__Cache__cache_ga974ed8fda97372a8db4010093bf933c2}{cache\+\_\+control\+\_\+t} $\ast$cc, const char $\ast$cc\+\_\+header, const char $\ast$pragma\+\_\+header, \hyperlink{structapr__table__t}{apr\+\_\+table\+\_\+t} $\ast$\hyperlink{group__APACHE__CORE__PROTO_gad27a8cead3a9e245c2e63cbf9a15f8c1}{headers})
\item 
\hyperlink{cache__util_8c_gafeaa7620641e0072e420fec575619f85}{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{structapr__table__t}{apr\+\_\+table\+\_\+t} $\ast$)
\item 
\hyperlink{structapr__table__t}{apr\+\_\+table\+\_\+t} $\ast$ \hyperlink{group__Cache__util_ga81c4df4762c014811f81be66e236f62b}{cache\+\_\+merge\+\_\+headers\+\_\+out} (\hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r})
\item 
const char $\ast$ \hyperlink{group__Cache__util_ga46b2ea303b9ec2767a61d0f121835b43}{cache\+\_\+table\+\_\+getm} (\hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, const \hyperlink{structapr__table__t}{apr\+\_\+table\+\_\+t} $\ast$\hyperlink{pcretest_8txt_a9ffb27fb8e1f90c17b13303fee2fb883}{t}, const char $\ast$\hyperlink{apr__siphash_8h_adac0b6a30345ea1d0daa8a692b0b7ad9}{key})
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{cache\+\_\+util.\+c@{cache\+\_\+util.\+c}!A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE@{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE}}
\index{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE@{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE}!cache\+\_\+util.\+c@{cache\+\_\+util.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+L\+E(cache)}{APLOG_USE_MODULE(cache)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE (
\begin{DoxyParamCaption}
\item[{{\bf cache}}]{}
\end{DoxyParamCaption}
)}\hypertarget{cache__util_8c_aa72a2cb5a9359a74d12d44c96b77c4d2}{}\label{cache__util_8c_aa72a2cb5a9359a74d12d44c96b77c4d2}
\index{cache\+\_\+util.\+c@{cache\+\_\+util.\+c}!A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE@{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE}}
\index{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE@{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE}!cache\+\_\+util.\+c@{cache\+\_\+util.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+P\+E(ap\+\_\+cache\+\_\+generate\+\_\+key)}{APR_OPTIONAL_FN_TYPE(ap_cache_generate_key)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE (
\begin{DoxyParamCaption}
\item[{{\bf ap\+\_\+cache\+\_\+generate\+\_\+key}}]{}
\end{DoxyParamCaption}
)}\hypertarget{cache__util_8c_a0c188ed1fe0083803d64f9d4d958508b}{}\label{cache__util_8c_a0c188ed1fe0083803d64f9d4d958508b}

\begin{DoxyCode}
35 \{
36     \textcolor{comment}{/* Scheme, hostname port and local part. The filter URI and the}
37 \textcolor{comment}{     * URI we test may have the following shapes:}
38 \textcolor{comment}{     *   /<path>}
39 \textcolor{comment}{     *   <scheme>[:://<hostname>[:<port>][/<path>]]}
40 \textcolor{comment}{     * That is, if there is no scheme then there must be only the path,}
41 \textcolor{comment}{     * and we check only the path; if there is a scheme, we check the}
42 \textcolor{comment}{     * scheme for equality, and then if present we match the hostname,}
43 \textcolor{comment}{     * and then if present match the port, and finally the path if any.}
44 \textcolor{comment}{     *}
45 \textcolor{comment}{     * Note that this means that "/<path>" only matches local paths,}
46 \textcolor{comment}{     * and to match proxied paths one *must* specify the scheme.}
47 \textcolor{comment}{     */}
48 
49     \textcolor{comment}{/* Is the filter is just for a local path or a proxy URI? */}
50     \textcolor{keywordflow}{if} (!filter->scheme) \{
51         \textcolor{keywordflow}{if} (\hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->scheme || \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname) \{
52             \textcolor{keywordflow}{return} 0;
53         \}
54     \}
55     \textcolor{keywordflow}{else} \{
56         \textcolor{comment}{/* The URI scheme must be present and identical except for case. */}
57         \textcolor{keywordflow}{if} (!\hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->scheme || ap\_cstr\_casecmp(filter->scheme, \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->scheme)) \{
58             \textcolor{keywordflow}{return} 0;
59         \}
60 
61         \textcolor{comment}{/* If the filter hostname is null or empty it matches any hostname,}
62 \textcolor{comment}{         * if it begins with a "*" it matches the \_end\_ of the URI hostname}
63 \textcolor{comment}{         * excluding the "*", if it begins with a "." it matches the \_end\_}
64 \textcolor{comment}{         * of the URI * hostname including the ".", otherwise it must match}
65 \textcolor{comment}{         * the URI hostname exactly. */}
66 
67         \textcolor{keywordflow}{if} (filter->hostname && filter->hostname[0]) \{
68             \textcolor{keywordflow}{if} (filter->hostname[0] == \textcolor{charliteral}{'.'}) \{
69                 \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} fhostlen = strlen(filter->hostname);
70                 \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} uhostlen = \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname ? strlen(\hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname) : 0;
71 
72                 \textcolor{keywordflow}{if} (fhostlen > uhostlen
73                     || (\hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname
74                         && \hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(filter->hostname,
75                                       \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname + uhostlen - fhostlen))) \{
76                     \textcolor{keywordflow}{return} 0;
77                 \}
78             \}
79             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (filter->hostname[0] == \textcolor{charliteral}{'*'}) \{
80                 \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} fhostlen = strlen(filter->hostname + 1);
81                 \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} uhostlen = \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname ? strlen(\hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname) : 0;
82 
83                 \textcolor{keywordflow}{if} (fhostlen > uhostlen
84                     || (\hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname
85                         && \hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(filter->hostname + 1,
86                                       \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname + uhostlen - fhostlen))) \{
87                     \textcolor{keywordflow}{return} 0;
88                 \}
89             \}
90             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname || \hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(filter->hostname, 
      \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->hostname)) \{
91                 \textcolor{keywordflow}{return} 0;
92             \}
93         \}
94 
95         \textcolor{comment}{/* If the filter port is empty it matches any URL port.}
96 \textcolor{comment}{         * If the filter or URL port are missing, or the URL port is}
97 \textcolor{comment}{         * empty, they default to the port for their scheme. */}
98 
99         \textcolor{keywordflow}{if} (!(filter->port\_str && !filter->port\_str[0])) \{
100             \textcolor{comment}{/* NOTE:  ap\_port\_of\_scheme will return 0 if given NULL input */}
101             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} fport = filter->port\_str ? filter->port
102                     : apr\_uri\_port\_of\_scheme(filter->scheme);
103             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} uport = (\hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->port\_str && \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->port\_str[0])
104                     ? \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->port : apr\_uri\_port\_of\_scheme(\hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}->scheme);
105 
106             \textcolor{keywordflow}{if} (fport != uport) \{
107                 \textcolor{keywordflow}{return} 0;
108             \}
109         \}
110     \}
111 
112     \textcolor{comment}{/* For HTTP caching purposes, an empty (NULL) path is equivalent to}
113 \textcolor{comment}{     * a single "/" path. RFCs 3986/2396}
114 \textcolor{comment}{     */}
115     \textcolor{keywordflow}{if} (!\hyperlink{group__APACHE__CORE__CONFIG_gab559cff0ba49c0f92a0dc777d5730496}{path}) \{
116         \textcolor{keywordflow}{if} (*filter->path == \textcolor{charliteral}{'/'} && pathlen == 1) \{
117             \textcolor{keywordflow}{return} 1;
118         \}
119         \textcolor{keywordflow}{else} \{
120             \textcolor{keywordflow}{return} 0;
121         \}
122     \}
123 
124     \textcolor{comment}{/* Url has met all of the filter conditions so far, determine}
125 \textcolor{comment}{     * if the paths match.}
126 \textcolor{comment}{     */}
127     \textcolor{keywordflow}{return} !strncmp(filter->path, \hyperlink{group__APACHE__CORE__CONFIG_gab559cff0ba49c0f92a0dc777d5730496}{path}, pathlen);
128 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=327pt]{cache__util_8c_a0c188ed1fe0083803d64f9d4d958508b_cgraph}
\end{center}
\end{figure}


\index{cache\+\_\+util.\+c@{cache\+\_\+util.\+c}!C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}!cache\+\_\+util.\+c@{cache\+\_\+util.\+c}}
\subsubsection[{\texorpdfstring{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+R\+E(apr\+\_\+int64\+\_\+t)}{CACHE_DECLARE(apr_int64_t)}}]{\setlength{\rightskip}{0pt plus 5cm}C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+int64\+\_\+t}}]{}
\end{DoxyParamCaption}
)}\hypertarget{cache__util_8c_ga2339c792dd32ac6ce14e5ee1bb4f332b}{}\label{cache__util_8c_ga2339c792dd32ac6ce14e5ee1bb4f332b}

\begin{DoxyCode}
235 \{
236     \hyperlink{group__apr__time_gadb4bde16055748190eae190c55aa02bb}{apr\_time\_t} apparent\_age, corrected\_received\_age, response\_delay,
237                corrected\_initial\_age, resident\_time, current\_age,
238                age\_value\_usec;
239 
240     age\_value\_usec = \hyperlink{group__apr__time_gaec56c2c03299a750006bfcc08d64ec32}{apr\_time\_from\_sec}(\hyperlink{group__MOD__CACHE_ga8732241849982352d73c94dcda0b81ed}{age\_value});
241 
242     \textcolor{comment}{/* Perform an HTTP/1.1 age calculation. (RFC2616 13.2.3) */}
243 
244     apparent\_age = \hyperlink{group__Cache__util_gafa99ec4acc4ecb2dc3c2d05da15d0e3f}{MAX}(0, \hyperlink{group__AP__EXPR_gae5e165b68fbb12afc88707b8e6eb2f08}{info}->response\_time - \hyperlink{group__AP__EXPR_gae5e165b68fbb12afc88707b8e6eb2f08}{info}->date);
245     corrected\_received\_age = \hyperlink{group__Cache__util_gafa99ec4acc4ecb2dc3c2d05da15d0e3f}{MAX}(apparent\_age, age\_value\_usec);
246     response\_delay = \hyperlink{group__AP__EXPR_gae5e165b68fbb12afc88707b8e6eb2f08}{info}->response\_time - \hyperlink{group__AP__EXPR_gae5e165b68fbb12afc88707b8e6eb2f08}{info}->request\_time;
247     corrected\_initial\_age = corrected\_received\_age + response\_delay;
248     resident\_time = \hyperlink{group__MOD__CACHE_ga33504014e188d5d7506173cc14fb5801}{now} - \hyperlink{group__AP__EXPR_gae5e165b68fbb12afc88707b8e6eb2f08}{info}->response\_time;
249     current\_age = corrected\_initial\_age + resident\_time;
250 
251     \textcolor{keywordflow}{if} (current\_age < 0) \{
252         current\_age = 0;
253     \}
254 
255     \textcolor{keywordflow}{return} \hyperlink{group__apr__time_gae0237f70a9a3206b5263c0a474219476}{apr\_time\_sec}(current\_age);
256 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{cache__util_8c_ga2339c792dd32ac6ce14e5ee1bb4f332b_icgraph}
\end{center}
\end{figure}


\index{cache\+\_\+util.\+c@{cache\+\_\+util.\+c}!C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}!cache\+\_\+util.\+c@{cache\+\_\+util.\+c}}
\subsubsection[{\texorpdfstring{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+R\+E(const char $\ast$)}{CACHE_DECLARE(const char *)}}]{\setlength{\rightskip}{0pt plus 5cm}C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{cache__util_8c_adc66c9408ab730bb26ef99d39e0313f3}{}\label{cache__util_8c_adc66c9408ab730bb26ef99d39e0313f3}

\begin{DoxyCode}
811 \{
812     \hyperlink{group__apr__platform_gaaa72b2253f6f3032cefea5712a27540e}{apr\_size\_t} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
813     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s};
814 
815     s = \hyperlink{group__APACHE__CORE__DAEMON_ga6016b58857e4c0b11e39913bdf4ff910}{ap\_strchr\_c}(\hyperlink{group__APACHE__CORE__PROTO_gaeb6b944e4524f915483b5696b7f2f424}{list}, \textcolor{charliteral}{','});
816     \textcolor{keywordflow}{if} (s != \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
817         i = s - \hyperlink{group__APACHE__CORE__PROTO_gaeb6b944e4524f915483b5696b7f2f424}{list};
818         \textcolor{keywordflow}{do}
819             s++;
820         \textcolor{keywordflow}{while} (\hyperlink{group__apr__ctype_ga23f4c7721923a0f0f444fd7fb196047a}{apr\_isspace}(*s))
821             ; \textcolor{comment}{/* noop */}
822     \}
823     \textcolor{keywordflow}{else}
824         i = strlen(list);
825 
826     \textcolor{keywordflow}{while} (i > 0 && \hyperlink{group__apr__ctype_ga23f4c7721923a0f0f444fd7fb196047a}{apr\_isspace}(list[i - 1]))
827         i--;
828 
829     *\hyperlink{group__MOD__DAV_gaab9226fe8f632e1f998e24276d478f30}{str} = \hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s};
830     \textcolor{keywordflow}{if} (i)
831         \textcolor{keywordflow}{return} apr\_pstrmemdup(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, list, i);
832     \textcolor{keywordflow}{else}
833         \textcolor{keywordflow}{return} \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
834 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{cache__util_8c_adc66c9408ab730bb26ef99d39e0313f3_cgraph}
\end{center}
\end{figure}


\index{cache\+\_\+util.\+c@{cache\+\_\+util.\+c}!C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}!cache\+\_\+util.\+c@{cache\+\_\+util.\+c}}
\subsubsection[{\texorpdfstring{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+R\+E(void)}{CACHE_DECLARE(void)}}]{\setlength{\rightskip}{0pt plus 5cm}C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{cache__util_8c_a71850f9c252aac64fd4799ca724c859f}{}\label{cache__util_8c_a71850f9c252aac64fd4799ca724c859f}

\begin{DoxyCode}
861 \{
862     \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}, ch;
863 
864     \textcolor{keywordflow}{for} (i = (\textcolor{keyword}{sizeof}(j) * 2)-1; i >= 0; i--) \{
865         ch = (\hyperlink{group__MOD__WATCHDOG_gaf0b5a943e734de7ea24142e2c81d82ef}{int})(j & 0xF);
866         j >>= 4;
867         \textcolor{keywordflow}{if} (ch >= 10)
868             \hyperlink{group__MOD__CACHE_gad4d47f76a849e2c428e3dd7f8c4eab1f}{y}[\hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}] = ch + (\textcolor{charliteral}{'A'} - 10);
869         \textcolor{keywordflow}{else}
870             \hyperlink{group__MOD__CACHE_gad4d47f76a849e2c428e3dd7f8c4eab1f}{y}[\hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}] = ch + \textcolor{charliteral}{'0'};
871     \}
872     \hyperlink{group__MOD__CACHE_gad4d47f76a849e2c428e3dd7f8c4eab1f}{y}[\textcolor{keyword}{sizeof}(j) * 2] = \textcolor{charliteral}{'\(\backslash\)0'};
873 \}
\end{DoxyCode}
\index{cache\+\_\+util.\+c@{cache\+\_\+util.\+c}!C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}!cache\+\_\+util.\+c@{cache\+\_\+util.\+c}}
\subsubsection[{\texorpdfstring{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+R\+E(char $\ast$)}{CACHE_DECLARE(char *)}}]{\setlength{\rightskip}{0pt plus 5cm}C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{cache__util_8c_a6931685a491fc9064207a161b3e14d7f}{}\label{cache__util_8c_a6931685a491fc9064207a161b3e14d7f}

\begin{DoxyCode}
919 \{
920     \textcolor{keywordtype}{char} hashfile[66];
921     cache\_hash(\hyperlink{group__APACHE__CORE__CONFIG_ga06e97fb366205b8f170da3c7562a8677}{name}, hashfile, \hyperlink{group__MOD__CACHE_gaf207be4a97a5ab15bbacf5df43aa839a}{dirlevels}, \hyperlink{group__MOD__CACHE_gabfa727ac764c820d796f407b02cd22a1}{dirlength});
922     \textcolor{keywordflow}{return} apr\_pstrdup(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, hashfile);
923 \}
\end{DoxyCode}
\index{cache\+\_\+util.\+c@{cache\+\_\+util.\+c}!C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE@{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE}!cache\+\_\+util.\+c@{cache\+\_\+util.\+c}}
\subsubsection[{\texorpdfstring{C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+R\+E(apr\+\_\+table\+\_\+t $\ast$)}{CACHE_DECLARE(apr_table_t *)}}]{\setlength{\rightskip}{0pt plus 5cm}C\+A\+C\+H\+E\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+table\+\_\+t} $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{cache__util_8c_gafeaa7620641e0072e420fec575619f85}{}\label{cache__util_8c_gafeaa7620641e0072e420fec575619f85}

\begin{DoxyCode}
1197 \{
1198     \hyperlink{structcache__server__conf}{cache\_server\_conf} *\hyperlink{group__APACHE__CORE__HTTPD_ga7be6dfd9155648f64d6e9abcd78c38cd}{conf};
1199     \textcolor{keywordtype}{char} **header;
1200     \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
1201     \hyperlink{structapr__table__t}{apr\_table\_t} *headers\_out;
1202 
1203     \textcolor{comment}{/* Short circuit the common case that there are not}
1204 \textcolor{comment}{     * (yet) any headers populated.}
1205 \textcolor{comment}{     */}
1206     \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__DAEMON_gabfa74bb4f05f3b2de1a89160025e5400}{t} == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
1207         \textcolor{keywordflow}{return} apr\_table\_make(\hyperlink{group__APACHE__CORE__MUTEX_ga8fea43b485988aa6df5dced9dddbe733}{pool}, 10);
1208     \};
1209 
1210     \textcolor{comment}{/* Make a copy of the headers, and remove from}
1211 \textcolor{comment}{     * the copy any hop-by-hop headers, as defined in Section}
1212 \textcolor{comment}{     * 13.5.1 of RFC 2616}
1213 \textcolor{comment}{     */}
1214     headers\_out = apr\_table\_copy(\hyperlink{group__APACHE__CORE__MUTEX_ga8fea43b485988aa6df5dced9dddbe733}{pool}, \hyperlink{group__APACHE__CORE__DAEMON_gabfa74bb4f05f3b2de1a89160025e5400}{t});
1215 
1216     apr\_table\_unset(headers\_out, \textcolor{stringliteral}{"Connection"});
1217     apr\_table\_unset(headers\_out, \textcolor{stringliteral}{"Keep-Alive"});
1218     apr\_table\_unset(headers\_out, \textcolor{stringliteral}{"Proxy-Authenticate"});
1219     apr\_table\_unset(headers\_out, \textcolor{stringliteral}{"Proxy-Authorization"});
1220     apr\_table\_unset(headers\_out, \textcolor{stringliteral}{"TE"});
1221     apr\_table\_unset(headers\_out, \textcolor{stringliteral}{"Trailers"});
1222     apr\_table\_unset(headers\_out, \textcolor{stringliteral}{"Transfer-Encoding"});
1223     apr\_table\_unset(headers\_out, \textcolor{stringliteral}{"Upgrade"});
1224 
1225     conf = (\hyperlink{structcache__server__conf}{cache\_server\_conf} *)\hyperlink{group__APACHE__CORE__CONFIG_ga1093a5908a384eacc929b028c79f2a02}{ap\_get\_module\_config}(
      \hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s}->\hyperlink{structserver__rec_ad18636e68c9070745578ebc966cfa430}{module\_config},
1226                                                      &\hyperlink{mod__cache_8c_a315b551bc967794e90417b5538a128f1}{cache\_module});
1227 
1228     \textcolor{comment}{/* Remove the user defined headers set with CacheIgnoreHeaders.}
1229 \textcolor{comment}{     * This may break RFC 2616 compliance on behalf of the administrator.}
1230 \textcolor{comment}{     */}
1231     header = (\textcolor{keywordtype}{char} **)conf->\hyperlink{structcache__server__conf_a4e8983b6a8e6aa3777b6c49844d75faa}{ignore\_headers}->\hyperlink{structapr__array__header__t_af8462fa2a1ddf6406c66cd3dd441a269}{elts};
1232     for (i = 0; i < conf->\hyperlink{structcache__server__conf_a4e8983b6a8e6aa3777b6c49844d75faa}{ignore\_headers}->\hyperlink{structapr__array__header__t_ab11b88220885c5a0920a06ac85680055}{nelts}; i++) \{
1233         apr\_table\_unset(headers\_out, header[i]);
1234     \}
1235     \textcolor{keywordflow}{return} headers\_out;
1236 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cache__util_8c_gafeaa7620641e0072e420fec575619f85_cgraph}
\end{center}
\end{figure}


