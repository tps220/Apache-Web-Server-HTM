\hypertarget{ssl__engine__pphrase_8c}{}\section{/usr/local/src/github/\+Codebase/httpd-\/2.4.29/modules/ssl/ssl\+\_\+engine\+\_\+pphrase.c File Reference}
\label{ssl__engine__pphrase_8c}\index{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/modules/ssl/ssl\+\_\+engine\+\_\+pphrase.\+c@{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/modules/ssl/ssl\+\_\+engine\+\_\+pphrase.\+c}}
{\ttfamily \#include \char`\"{}ssl\+\_\+private.\+h\char`\"{}}\\*
Include dependency graph for ssl\+\_\+engine\+\_\+pphrase.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ssl__engine__pphrase_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structpphrase__cb__arg__t}{pphrase\+\_\+cb\+\_\+arg\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ssl__engine__pphrase_8c_a3a07b559466a4e2916f44a28a0ae2bef}{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+B\+A\+C\+K\+O\+FF}~2
\item 
\#define \hyperlink{ssl__engine__pphrase_8c_add3d818ed8e8da505874e77640d3a751}{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+R\+E\+T\+R\+I\+ES}~5
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{ssl__engine__pphrase_8c_a385113167d9add46b16dc1000e080711}{ssl\+\_\+pphrase\+\_\+\+Handle\+\_\+\+CB} (char $\ast$, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int}, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int}, \hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} $\ast$)
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__MOD__SSL__PRIVATE_ga594145a68cd4bcdddfcee86210599d73}{ssl\+\_\+load\+\_\+encrypted\+\_\+pkey} (\hyperlink{structserver__rec}{server\+\_\+rec} $\ast$\hyperlink{pcretest_8txt_a062597889ba244b72877454b1d3adecf}{s}, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} idx, const char $\ast$pkey\+\_\+file, \hyperlink{structapr__array__header__t}{apr\+\_\+array\+\_\+header\+\_\+t} $\ast$$\ast$pphrases)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{ssl\+\_\+engine\+\_\+pphrase.\+c@{ssl\+\_\+engine\+\_\+pphrase.\+c}!B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+B\+A\+C\+K\+O\+FF@{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+B\+A\+C\+K\+O\+FF}}
\index{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+B\+A\+C\+K\+O\+FF@{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+B\+A\+C\+K\+O\+FF}!ssl\+\_\+engine\+\_\+pphrase.\+c@{ssl\+\_\+engine\+\_\+pphrase.\+c}}
\subsubsection[{\texorpdfstring{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+B\+A\+C\+K\+O\+FF}{BUILTIN_DIALOG_BACKOFF}}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+B\+A\+C\+K\+O\+FF~2}\hypertarget{ssl__engine__pphrase_8c_a3a07b559466a4e2916f44a28a0ae2bef}{}\label{ssl__engine__pphrase_8c_a3a07b559466a4e2916f44a28a0ae2bef}
\index{ssl\+\_\+engine\+\_\+pphrase.\+c@{ssl\+\_\+engine\+\_\+pphrase.\+c}!B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+R\+E\+T\+R\+I\+ES@{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+R\+E\+T\+R\+I\+ES}}
\index{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+R\+E\+T\+R\+I\+ES@{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+R\+E\+T\+R\+I\+ES}!ssl\+\_\+engine\+\_\+pphrase.\+c@{ssl\+\_\+engine\+\_\+pphrase.\+c}}
\subsubsection[{\texorpdfstring{B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+R\+E\+T\+R\+I\+ES}{BUILTIN_DIALOG_RETRIES}}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\+U\+I\+L\+T\+I\+N\+\_\+\+D\+I\+A\+L\+O\+G\+\_\+\+R\+E\+T\+R\+I\+ES~5}\hypertarget{ssl__engine__pphrase_8c_add3d818ed8e8da505874e77640d3a751}{}\label{ssl__engine__pphrase_8c_add3d818ed8e8da505874e77640d3a751}


\subsection{Function Documentation}
\index{ssl\+\_\+engine\+\_\+pphrase.\+c@{ssl\+\_\+engine\+\_\+pphrase.\+c}!ssl\+\_\+pphrase\+\_\+\+Handle\+\_\+\+CB@{ssl\+\_\+pphrase\+\_\+\+Handle\+\_\+\+CB}}
\index{ssl\+\_\+pphrase\+\_\+\+Handle\+\_\+\+CB@{ssl\+\_\+pphrase\+\_\+\+Handle\+\_\+\+CB}!ssl\+\_\+engine\+\_\+pphrase.\+c@{ssl\+\_\+engine\+\_\+pphrase.\+c}}
\subsubsection[{\texorpdfstring{ssl\+\_\+pphrase\+\_\+\+Handle\+\_\+\+C\+B(char $\ast$, int, int, void $\ast$)}{ssl_pphrase_Handle_CB(char *, int, int, void *)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} ssl\+\_\+pphrase\+\_\+\+Handle\+\_\+\+CB (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{buf, }
\item[{{\bf int}}]{bufsize, }
\item[{{\bf int}}]{verify, }
\item[{{\bf void} $\ast$}]{srv}
\end{DoxyParamCaption}
)}\hypertarget{ssl__engine__pphrase_8c_a385113167d9add46b16dc1000e080711}{}\label{ssl__engine__pphrase_8c_a385113167d9add46b16dc1000e080711}

\begin{DoxyCode}
463 \{
464     \hyperlink{structpphrase__cb__arg__t}{pphrase\_cb\_arg\_t} *ppcb\_arg = (\hyperlink{structpphrase__cb__arg__t}{pphrase\_cb\_arg\_t} *)srv;
465     \hyperlink{structSSLSrvConfigRec}{SSLSrvConfigRec} *sc = \hyperlink{group__MOD__SSL__PRIVATE_ga3ea8e2c288a4f4af189ae0fc4f1fd996}{mySrvConfig}(ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_a04abf5118944ca1717e080e3360337c7}{s});
466     \textcolor{keywordtype}{char} *cpp;
467     \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__LOG_gab5a43233d60ef05c5b5bf5cba3d74468}{len} = -1;
468 
469     ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_ad85f1529894f1b8f7d271584bb2eb84e}{nPassPhraseDialog}++;
470     ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_a451eb1ab16d0c471defcb513d5dc5bef}{nPassPhraseDialogCur}++;
471 
472     \textcolor{comment}{/*}
473 \textcolor{comment}{     * When remembered pass phrases are available use them...}
474 \textcolor{comment}{     */}
475     \textcolor{keywordflow}{if} ((cpp = pphrase\_array\_get(ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_ae08f1163b038c528152af8a490f09f27}{aPassPhrase},
476                                  ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_aef3e0a2bfde0f62c1bca633c5e388524}{nPassPhraseCur})) != 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
477         apr\_cpystrn(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf}, cpp, \hyperlink{group__APACHE__CORE__CONFIG_ga251f5b82593ed6f6b369185c5b220f82}{bufsize});
478         len = strlen(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf});
479         \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__LOG_gab5a43233d60ef05c5b5bf5cba3d74468}{len};
480     \}
481 
482     \textcolor{comment}{/*}
483 \textcolor{comment}{     * Builtin or Pipe dialog}
484 \textcolor{comment}{     */}
485     \textcolor{keywordflow}{if} (sc->\hyperlink{structSSLSrvConfigRec_a7941dbc2f9fa504b3968a4afdc4b96fc}{server}->\hyperlink{structmodssl__ctx__t_a1fe0b0fdd63583304dae0dfd85982771}{pphrase\_dialog\_type} == 
      \hyperlink{group__MOD__SSL__PRIVATE_ggad9be8a03d6bba7c92cf27a00ab9f7971a95c73eaa9cd87a96f4a968b8c1a174bd}{SSL\_PPTYPE\_BUILTIN}
486           || sc->\hyperlink{structSSLSrvConfigRec_a7941dbc2f9fa504b3968a4afdc4b96fc}{server}->\hyperlink{structmodssl__ctx__t_a1fe0b0fdd63583304dae0dfd85982771}{pphrase\_dialog\_type} == 
      \hyperlink{group__MOD__SSL__PRIVATE_ggad9be8a03d6bba7c92cf27a00ab9f7971a33ff980280a4799be36e18829885da9a}{SSL\_PPTYPE\_PIPE}) \{
487         \textcolor{keywordtype}{char} *prompt;
488         \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
489 
490         \textcolor{keywordflow}{if} (sc->\hyperlink{structSSLSrvConfigRec_a7941dbc2f9fa504b3968a4afdc4b96fc}{server}->\hyperlink{structmodssl__ctx__t_a1fe0b0fdd63583304dae0dfd85982771}{pphrase\_dialog\_type} == 
      \hyperlink{group__MOD__SSL__PRIVATE_ggad9be8a03d6bba7c92cf27a00ab9f7971a33ff980280a4799be36e18829885da9a}{SSL\_PPTYPE\_PIPE}) \{
491             \textcolor{keywordflow}{if} (!readtty) \{
492                 \hyperlink{group__APACHE__CORE__LOG_ga5e6676c87418af7a1d323a116c78ecb4}{ap\_log\_error}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga47fafbef7e478babdd92e90407f95b19}{APLOG\_INFO}, 0, ppcb\_arg->
      \hyperlink{structpphrase__cb__arg__t_a04abf5118944ca1717e080e3360337c7}{s},
493                              \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(01965)
494                              \textcolor{stringliteral}{"Init: Creating pass phrase dialog pipe child "}
495                              \textcolor{stringliteral}{"'%s'"}, sc->\hyperlink{structSSLSrvConfigRec_a7941dbc2f9fa504b3968a4afdc4b96fc}{server}->\hyperlink{structmodssl__ctx__t_aa49d72ee17088961d6e84bac67c99b47}{pphrase\_dialog\_path});
496                 \textcolor{keywordflow}{if} (ssl\_pipe\_child\_create(ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_a11be93487d30291c9efced2b8ded9101}{p},
497                                           sc->\hyperlink{structSSLSrvConfigRec_a7941dbc2f9fa504b3968a4afdc4b96fc}{server}->\hyperlink{structmodssl__ctx__t_aa49d72ee17088961d6e84bac67c99b47}{pphrase\_dialog\_path})
498                         != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
499                     \hyperlink{group__APACHE__CORE__LOG_ga5e6676c87418af7a1d323a116c78ecb4}{ap\_log\_error}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga57ad94ed8c92c4306de90479251a5d58}{APLOG\_ERR}, 0, ppcb\_arg->
      \hyperlink{structpphrase__cb__arg__t_a04abf5118944ca1717e080e3360337c7}{s},
500                                  \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(01966)
501                                  \textcolor{stringliteral}{"Init: Failed to create pass phrase pipe '%s'"},
502                                  sc->\hyperlink{structSSLSrvConfigRec_a7941dbc2f9fa504b3968a4afdc4b96fc}{server}->\hyperlink{structmodssl__ctx__t_aa49d72ee17088961d6e84bac67c99b47}{pphrase\_dialog\_path});
503                     PEMerr(PEM\_F\_PEM\_DEF\_CALLBACK,
504                            PEM\_R\_PROBLEMS\_GETTING\_PASSWORD);
505                     memset(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf}, 0, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})\hyperlink{group__APACHE__CORE__CONFIG_ga251f5b82593ed6f6b369185c5b220f82}{bufsize});
506                     \textcolor{keywordflow}{return} (-1);
507                 \}
508             \}
509             \hyperlink{group__APACHE__CORE__LOG_ga5e6676c87418af7a1d323a116c78ecb4}{ap\_log\_error}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga47fafbef7e478babdd92e90407f95b19}{APLOG\_INFO}, 0, ppcb\_arg->
      \hyperlink{structpphrase__cb__arg__t_a04abf5118944ca1717e080e3360337c7}{s}, \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(01967)
510                          \textcolor{stringliteral}{"Init: Requesting pass phrase via piped dialog"});
511         \}
512         \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* sc->server->pphrase\_dialog\_type == SSL\_PPTYPE\_BUILTIN */}
513 \textcolor{preprocessor}{#ifdef WIN32}
514             PEMerr(PEM\_F\_PEM\_DEF\_CALLBACK, PEM\_R\_PROBLEMS\_GETTING\_PASSWORD);
515             memset(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf}, 0, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})\hyperlink{group__APACHE__CORE__CONFIG_ga251f5b82593ed6f6b369185c5b220f82}{bufsize});
516             \textcolor{keywordflow}{return} (-1);
517 \textcolor{preprocessor}{#else}
518             \textcolor{comment}{/*}
519 \textcolor{comment}{             * stderr has already been redirected to the error\_log.}
520 \textcolor{comment}{             * rather than attempting to temporarily rehook it to the terminal,}
521 \textcolor{comment}{             * we print the prompt to stdout before EVP\_read\_pw\_string turns}
522 \textcolor{comment}{             * off tty echo}
523 \textcolor{comment}{             */}
524             apr\_file\_open\_stdout(&writetty, ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_a11be93487d30291c9efced2b8ded9101}{p});
525 
526             \hyperlink{group__APACHE__CORE__LOG_ga5e6676c87418af7a1d323a116c78ecb4}{ap\_log\_error}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga47fafbef7e478babdd92e90407f95b19}{APLOG\_INFO}, 0, ppcb\_arg->
      \hyperlink{structpphrase__cb__arg__t_a04abf5118944ca1717e080e3360337c7}{s}, \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(01968)
527                          \textcolor{stringliteral}{"Init: Requesting pass phrase via builtin terminal "}
528                          \textcolor{stringliteral}{"dialog"});
529 \textcolor{preprocessor}{#endif}
530         \}
531 
532         \textcolor{comment}{/*}
533 \textcolor{comment}{         * The first time display a header to inform the user about what}
534 \textcolor{comment}{         * program he actually speaks to, which module is responsible for}
535 \textcolor{comment}{         * this terminal dialog and why to the hell he has to enter}
536 \textcolor{comment}{         * something...}
537 \textcolor{comment}{         */}
538         \textcolor{keywordflow}{if} (ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_ad85f1529894f1b8f7d271584bb2eb84e}{nPassPhraseDialog} == 1) \{
539             apr\_file\_printf(writetty, \textcolor{stringliteral}{"%s mod\_ssl (Pass Phrase Dialog)\(\backslash\)n"},
540                             \hyperlink{ap__release_8h_afcbccdd5988410660e1c8cb11d269a58}{AP\_SERVER\_BASEVERSION});
541             apr\_file\_printf(writetty, \textcolor{stringliteral}{"Some of your private key files are encrypted for security reasons.\(\backslash\)n
      "});
542             apr\_file\_printf(writetty, \textcolor{stringliteral}{"In order to read them you have to provide the pass phrases.\(\backslash\)n"});
543         \}
544         \textcolor{keywordflow}{if} (ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_acbcb9e2843857d612329eb5c24b76856}{bPassPhraseDialogOnce}) \{
545             ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_acbcb9e2843857d612329eb5c24b76856}{bPassPhraseDialogOnce} = \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};
546             apr\_file\_printf(writetty, \textcolor{stringliteral}{"\(\backslash\)n"});
547             apr\_file\_printf(writetty, \textcolor{stringliteral}{"Private key %s (%s)\(\backslash\)n"},
548                             ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_abb8613c809af29aa0f3ea675efc544f0}{key\_id}, ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_afc01b5b93a45bd50c5aa697680921d65}{pkey\_file});
549         \}
550 
551         \textcolor{comment}{/*}
552 \textcolor{comment}{         * Emulate the OpenSSL internal pass phrase dialog}
553 \textcolor{comment}{         * (see crypto/pem/pem\_lib.c:def\_callback() for details)}
554 \textcolor{comment}{         */}
555         prompt = \textcolor{stringliteral}{"Enter pass phrase:"};
556 
557         \textcolor{keywordflow}{for} (;;) \{
558             apr\_file\_puts(prompt, writetty);
559             \textcolor{keywordflow}{if} (sc->\hyperlink{structSSLSrvConfigRec_a7941dbc2f9fa504b3968a4afdc4b96fc}{server}->\hyperlink{structmodssl__ctx__t_a1fe0b0fdd63583304dae0dfd85982771}{pphrase\_dialog\_type} == 
      \hyperlink{group__MOD__SSL__PRIVATE_ggad9be8a03d6bba7c92cf27a00ab9f7971a33ff980280a4799be36e18829885da9a}{SSL\_PPTYPE\_PIPE}) \{
560                 i = pipe\_get\_passwd\_cb(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf}, \hyperlink{group__APACHE__CORE__CONFIG_ga251f5b82593ed6f6b369185c5b220f82}{bufsize}, \textcolor{stringliteral}{""}, \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE});
561             \}
562             \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* sc->server->pphrase\_dialog\_type == SSL\_PPTYPE\_BUILTIN */}
563                 i = EVP\_read\_pw\_string(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf}, \hyperlink{group__APACHE__CORE__CONFIG_ga251f5b82593ed6f6b369185c5b220f82}{bufsize}, \textcolor{stringliteral}{""}, \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE});
564             \}
565             \textcolor{keywordflow}{if} (i != 0) \{
566                 PEMerr(PEM\_F\_PEM\_DEF\_CALLBACK,PEM\_R\_PROBLEMS\_GETTING\_PASSWORD);
567                 memset(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf}, 0, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})\hyperlink{group__APACHE__CORE__CONFIG_ga251f5b82593ed6f6b369185c5b220f82}{bufsize});
568                 \textcolor{keywordflow}{return} (-1);
569             \}
570             len = strlen(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf});
571             \textcolor{keywordflow}{if} (len < 1)
572                 apr\_file\_printf(writetty, \textcolor{stringliteral}{"Apache:mod\_ssl:Error: Pass phrase empty (needs to be at least 1
       character).\(\backslash\)n"});
573             \textcolor{keywordflow}{else}
574                 \textcolor{keywordflow}{break};
575         \}
576     \}
577 
578     \textcolor{comment}{/*}
579 \textcolor{comment}{     * Filter program}
580 \textcolor{comment}{     */}
581     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sc->\hyperlink{structSSLSrvConfigRec_a7941dbc2f9fa504b3968a4afdc4b96fc}{server}->\hyperlink{structmodssl__ctx__t_a1fe0b0fdd63583304dae0dfd85982771}{pphrase\_dialog\_type} == 
      \hyperlink{group__MOD__SSL__PRIVATE_ggad9be8a03d6bba7c92cf27a00ab9f7971ad52728c6f1289adcfef467800776b1d3}{SSL\_PPTYPE\_FILTER}) \{
582         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__DAEMON_ga504a7f40c3261db3e10e1d2776642dd6}{cmd} = sc->\hyperlink{structSSLSrvConfigRec_a7941dbc2f9fa504b3968a4afdc4b96fc}{server}->\hyperlink{structmodssl__ctx__t_aa49d72ee17088961d6e84bac67c99b47}{pphrase\_dialog\_path};
583         \textcolor{keyword}{const} \textcolor{keywordtype}{char} **\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv} = apr\_palloc(ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_a11be93487d30291c9efced2b8ded9101}{p}, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char} *) * 4);
584         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *idx = \hyperlink{group__APACHE__CORE__DAEMON_ga469c14311b354f1b7e3013adbde2b50b}{ap\_strrchr\_c}(ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_abb8613c809af29aa0f3ea675efc544f0}{key\_id}, \textcolor{charliteral}{':'}) + 1;
585         \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__MPM_ga9f5959dd76d5c83e775dcf44de684686}{result};
586         \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
587 
588         \hyperlink{group__APACHE__CORE__LOG_ga5e6676c87418af7a1d323a116c78ecb4}{ap\_log\_error}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga47fafbef7e478babdd92e90407f95b19}{APLOG\_INFO}, 0, ppcb\_arg->
      \hyperlink{structpphrase__cb__arg__t_a04abf5118944ca1717e080e3360337c7}{s}, \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(01969)
589                      \textcolor{stringliteral}{"Init: Requesting pass phrase from dialog filter "}
590                      \textcolor{stringliteral}{"program (%s)"}, cmd);
591 
592         argv[0] = \hyperlink{group__APACHE__CORE__DAEMON_ga504a7f40c3261db3e10e1d2776642dd6}{cmd};
593         argv[1] = apr\_pstrndup(ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_a11be93487d30291c9efced2b8ded9101}{p}, ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_abb8613c809af29aa0f3ea675efc544f0}{key\_id},
594                                idx-1 - ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_abb8613c809af29aa0f3ea675efc544f0}{key\_id});
595         \textcolor{keywordflow}{if} ((i = atoi(idx)) < \hyperlink{group__MOD__SSL__PRIVATE_gaf7c42f3ccab5cff2a01efdcd32afb4d8}{CERTKEYS\_IDX\_MAX}+1) \{
596             \textcolor{comment}{/*}
597 \textcolor{comment}{             * For compatibility with existing 2.4.x configurations, use}
598 \textcolor{comment}{             * "RSA", "DSA" and "ECC" strings for the first two/three keys}
599 \textcolor{comment}{             */}
600             argv[2] = key\_types[\hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}];
601         \} \textcolor{keywordflow}{else} \{
602             \textcolor{comment}{/* Four and above: use the integer index */}
603             argv[2] = apr\_pstrdup(ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_a11be93487d30291c9efced2b8ded9101}{p}, idx);
604         \}
605         argv[3] = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
606 
607         result = \hyperlink{group__MOD__SSL__PRIVATE_ga651f7262ac586eb3df9e357304fd7b36}{ssl\_util\_readfilter}(ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_a04abf5118944ca1717e080e3360337c7}{s}, ppcb\_arg->
      \hyperlink{structpphrase__cb__arg__t_a11be93487d30291c9efced2b8ded9101}{p}, cmd, argv);
608         apr\_cpystrn(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf}, result, \hyperlink{group__APACHE__CORE__CONFIG_ga251f5b82593ed6f6b369185c5b220f82}{bufsize});
609         len = strlen(\hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf});
610     \}
611 
612     \textcolor{comment}{/*}
613 \textcolor{comment}{     * Ok, we now have the pass phrase, so give it back}
614 \textcolor{comment}{     */}
615     ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_af6aaf85042706fa2215ce1164a2aa7eb}{cpPassPhraseCur} = apr\_pstrdup(ppcb\_arg->\hyperlink{structpphrase__cb__arg__t_a11be93487d30291c9efced2b8ded9101}{p}, \hyperlink{group__APACHE__CORE__PROTO_ga17bc47ccf1b618ed082a4ff4f2cc7f7e}{buf});
616 
617     \textcolor{comment}{/*}
618 \textcolor{comment}{     * And return its length to OpenSSL...}
619 \textcolor{comment}{     */}
620     \textcolor{keywordflow}{return} (len);
621 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ssl__engine__pphrase_8c_a385113167d9add46b16dc1000e080711_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ssl__engine__pphrase_8c_a385113167d9add46b16dc1000e080711_icgraph}
\end{center}
\end{figure}


