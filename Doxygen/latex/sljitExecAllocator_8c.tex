\hypertarget{sljitExecAllocator_8c}{}\section{/usr/local/src/github/\+Codebase/httpd-\/2.4.29/srclib/pcre/sljit/sljit\+Exec\+Allocator.c File Reference}
\label{sljitExecAllocator_8c}\index{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/srclib/pcre/sljit/sljit\+Exec\+Allocator.\+c@{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/srclib/pcre/sljit/sljit\+Exec\+Allocator.\+c}}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=250pt]{sljitExecAllocator_8c__dep__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structblock__header}{block\+\_\+header}
\item 
struct \hyperlink{structfree__block}{free\+\_\+block}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{sljitExecAllocator_8c_aea3cfda4f3a9f978ec759f206cf186fe}{C\+H\+U\+N\+K\+\_\+\+S\+I\+ZE}~0x10000
\item 
\#define \hyperlink{sljitExecAllocator_8c_a2f5d60296887c5da6718c238c922ab4b}{C\+H\+U\+N\+K\+\_\+\+M\+A\+SK}~($\sim$(\hyperlink{sljitExecAllocator_8c_aea3cfda4f3a9f978ec759f206cf186fe}{C\+H\+U\+N\+K\+\_\+\+S\+I\+ZE} -\/ 1))
\item 
\#define \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{A\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+H\+E\+A\+D\+ER}(\hyperlink{group__apr__tables_ga74964146831939c658b798439fc32f6d}{base},  \hyperlink{group__APR__Util__Bucket__Brigades_ga0feae9f93d4bc5dca392194c513e0921}{offset})~((struct \hyperlink{structblock__header}{block\+\_\+header}$\ast$)(((\hyperlink{sljitConfigInternal_8h_a571cc542f404bfc97d5499bda583c5ee}{sljit\+\_\+u8}$\ast$)\hyperlink{group__apr__tables_ga74964146831939c658b798439fc32f6d}{base}) + \hyperlink{group__APR__Util__Bucket__Brigades_ga0feae9f93d4bc5dca392194c513e0921}{offset}))
\item 
\#define \hyperlink{sljitExecAllocator_8c_aa4f4636963a1df9ab6d3ff267bc22cc4}{A\+S\+\_\+\+F\+R\+E\+E\+\_\+\+B\+L\+O\+CK}(\hyperlink{group__apr__tables_ga74964146831939c658b798439fc32f6d}{base},  \hyperlink{group__APR__Util__Bucket__Brigades_ga0feae9f93d4bc5dca392194c513e0921}{offset})~((struct \hyperlink{structfree__block}{free\+\_\+block}$\ast$)(((\hyperlink{sljitConfigInternal_8h_a571cc542f404bfc97d5499bda583c5ee}{sljit\+\_\+u8}$\ast$)\hyperlink{group__apr__tables_ga74964146831939c658b798439fc32f6d}{base}) + \hyperlink{group__APR__Util__Bucket__Brigades_ga0feae9f93d4bc5dca392194c513e0921}{offset}))
\item 
\#define \hyperlink{sljitExecAllocator_8c_ae3d1e2141179c57464e11eb25b28b1e4}{M\+E\+M\+\_\+\+S\+T\+A\+RT}(\hyperlink{group__apr__tables_ga74964146831939c658b798439fc32f6d}{base})~((\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void}$\ast$)(((\hyperlink{sljitConfigInternal_8h_a571cc542f404bfc97d5499bda583c5ee}{sljit\+\_\+u8}$\ast$)\hyperlink{group__apr__tables_ga74964146831939c658b798439fc32f6d}{base}) + sizeof(struct \hyperlink{structblock__header}{block\+\_\+header})))
\item 
\#define \hyperlink{sljitExecAllocator_8c_aebf6cc40441e3266687f4f4629471148}{A\+L\+I\+G\+N\+\_\+\+S\+I\+ZE}(\hyperlink{README_8txt_a870076999eb1486aa63d2e2cf5cdfa55}{size})~(((\hyperlink{README_8txt_a870076999eb1486aa63d2e2cf5cdfa55}{size}) + sizeof(struct \hyperlink{structblock__header}{block\+\_\+header}) + 7) \& $\sim$7)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{sljitConfigInternal_8h_a4edd1598b391cd0703fa0cbaaed1af38}{S\+L\+J\+I\+T\+\_\+\+A\+P\+I\+\_\+\+F\+U\+N\+C\+\_\+\+A\+T\+T\+R\+I\+B\+U\+TE} \hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} $\ast$ \hyperlink{sljitExecAllocator_8c_ad0fcef2b1754cc3ce3caf59a36780b76}{sljit\+\_\+malloc\+\_\+exec} (\hyperlink{sljitConfigInternal_8h_a4f2aa7461612a199a0e3fd93cd9a4d02}{sljit\+\_\+uw} \hyperlink{README_8txt_a870076999eb1486aa63d2e2cf5cdfa55}{size})
\item 
\hyperlink{sljitConfigInternal_8h_a4edd1598b391cd0703fa0cbaaed1af38}{S\+L\+J\+I\+T\+\_\+\+A\+P\+I\+\_\+\+F\+U\+N\+C\+\_\+\+A\+T\+T\+R\+I\+B\+U\+TE} \hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{sljitExecAllocator_8c_a5348493ec1e09bd6f8fa02a6864a369c}{sljit\+\_\+free\+\_\+exec} (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} $\ast$\hyperlink{group__APACHE__CORE__DAEMON_gaad7fdd8e91a6edc850f20f2fede630a9}{ptr})
\item 
\hyperlink{sljitConfigInternal_8h_a4edd1598b391cd0703fa0cbaaed1af38}{S\+L\+J\+I\+T\+\_\+\+A\+P\+I\+\_\+\+F\+U\+N\+C\+\_\+\+A\+T\+T\+R\+I\+B\+U\+TE} \hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{sljitExecAllocator_8c_aedcee52aa00cce33e3d28a6bf826a155}{sljit\+\_\+free\+\_\+unused\+\_\+memory\+\_\+exec} (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}!A\+L\+I\+G\+N\+\_\+\+S\+I\+ZE@{A\+L\+I\+G\+N\+\_\+\+S\+I\+ZE}}
\index{A\+L\+I\+G\+N\+\_\+\+S\+I\+ZE@{A\+L\+I\+G\+N\+\_\+\+S\+I\+ZE}!sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}}
\subsubsection[{\texorpdfstring{A\+L\+I\+G\+N\+\_\+\+S\+I\+ZE}{ALIGN_SIZE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+L\+I\+G\+N\+\_\+\+S\+I\+ZE(
\begin{DoxyParamCaption}
\item[{}]{{\bf size}}
\end{DoxyParamCaption}
)~((({\bf size}) + sizeof(struct {\bf block\+\_\+header}) + 7) \& $\sim$7)}\hypertarget{sljitExecAllocator_8c_aebf6cc40441e3266687f4f4629471148}{}\label{sljitExecAllocator_8c_aebf6cc40441e3266687f4f4629471148}
\index{sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}!A\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+H\+E\+A\+D\+ER@{A\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+H\+E\+A\+D\+ER}}
\index{A\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+H\+E\+A\+D\+ER@{A\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+H\+E\+A\+D\+ER}!sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}}
\subsubsection[{\texorpdfstring{A\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+H\+E\+A\+D\+ER}{AS_BLOCK_HEADER}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+H\+E\+A\+D\+ER(
\begin{DoxyParamCaption}
\item[{}]{{\bf base}, }
\item[{}]{{\bf offset}}
\end{DoxyParamCaption}
)~((struct {\bf block\+\_\+header}$\ast$)((({\bf sljit\+\_\+u8}$\ast$){\bf base}) + {\bf offset}))}\hypertarget{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{}\label{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}
\index{sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}!A\+S\+\_\+\+F\+R\+E\+E\+\_\+\+B\+L\+O\+CK@{A\+S\+\_\+\+F\+R\+E\+E\+\_\+\+B\+L\+O\+CK}}
\index{A\+S\+\_\+\+F\+R\+E\+E\+\_\+\+B\+L\+O\+CK@{A\+S\+\_\+\+F\+R\+E\+E\+\_\+\+B\+L\+O\+CK}!sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}}
\subsubsection[{\texorpdfstring{A\+S\+\_\+\+F\+R\+E\+E\+\_\+\+B\+L\+O\+CK}{AS_FREE_BLOCK}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+S\+\_\+\+F\+R\+E\+E\+\_\+\+B\+L\+O\+CK(
\begin{DoxyParamCaption}
\item[{}]{{\bf base}, }
\item[{}]{{\bf offset}}
\end{DoxyParamCaption}
)~((struct {\bf free\+\_\+block}$\ast$)((({\bf sljit\+\_\+u8}$\ast$){\bf base}) + {\bf offset}))}\hypertarget{sljitExecAllocator_8c_aa4f4636963a1df9ab6d3ff267bc22cc4}{}\label{sljitExecAllocator_8c_aa4f4636963a1df9ab6d3ff267bc22cc4}
\index{sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}!C\+H\+U\+N\+K\+\_\+\+M\+A\+SK@{C\+H\+U\+N\+K\+\_\+\+M\+A\+SK}}
\index{C\+H\+U\+N\+K\+\_\+\+M\+A\+SK@{C\+H\+U\+N\+K\+\_\+\+M\+A\+SK}!sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}}
\subsubsection[{\texorpdfstring{C\+H\+U\+N\+K\+\_\+\+M\+A\+SK}{CHUNK_MASK}}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+H\+U\+N\+K\+\_\+\+M\+A\+SK~($\sim$({\bf C\+H\+U\+N\+K\+\_\+\+S\+I\+ZE} -\/ 1))}\hypertarget{sljitExecAllocator_8c_a2f5d60296887c5da6718c238c922ab4b}{}\label{sljitExecAllocator_8c_a2f5d60296887c5da6718c238c922ab4b}
\index{sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}!C\+H\+U\+N\+K\+\_\+\+S\+I\+ZE@{C\+H\+U\+N\+K\+\_\+\+S\+I\+ZE}}
\index{C\+H\+U\+N\+K\+\_\+\+S\+I\+ZE@{C\+H\+U\+N\+K\+\_\+\+S\+I\+ZE}!sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}}
\subsubsection[{\texorpdfstring{C\+H\+U\+N\+K\+\_\+\+S\+I\+ZE}{CHUNK_SIZE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+H\+U\+N\+K\+\_\+\+S\+I\+ZE~0x10000}\hypertarget{sljitExecAllocator_8c_aea3cfda4f3a9f978ec759f206cf186fe}{}\label{sljitExecAllocator_8c_aea3cfda4f3a9f978ec759f206cf186fe}
\index{sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}!M\+E\+M\+\_\+\+S\+T\+A\+RT@{M\+E\+M\+\_\+\+S\+T\+A\+RT}}
\index{M\+E\+M\+\_\+\+S\+T\+A\+RT@{M\+E\+M\+\_\+\+S\+T\+A\+RT}!sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}}
\subsubsection[{\texorpdfstring{M\+E\+M\+\_\+\+S\+T\+A\+RT}{MEM_START}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+M\+\_\+\+S\+T\+A\+RT(
\begin{DoxyParamCaption}
\item[{}]{{\bf base}}
\end{DoxyParamCaption}
)~(({\bf void}$\ast$)((({\bf sljit\+\_\+u8}$\ast$){\bf base}) + sizeof(struct {\bf block\+\_\+header})))}\hypertarget{sljitExecAllocator_8c_ae3d1e2141179c57464e11eb25b28b1e4}{}\label{sljitExecAllocator_8c_ae3d1e2141179c57464e11eb25b28b1e4}


\subsection{Function Documentation}
\index{sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}!sljit\+\_\+free\+\_\+exec@{sljit\+\_\+free\+\_\+exec}}
\index{sljit\+\_\+free\+\_\+exec@{sljit\+\_\+free\+\_\+exec}!sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}}
\subsubsection[{\texorpdfstring{sljit\+\_\+free\+\_\+exec(void $\ast$ptr)}{sljit_free_exec(void *ptr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+L\+J\+I\+T\+\_\+\+A\+P\+I\+\_\+\+F\+U\+N\+C\+\_\+\+A\+T\+T\+R\+I\+B\+U\+TE} {\bf void} sljit\+\_\+free\+\_\+exec (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{ptr}
\end{DoxyParamCaption}
)}\hypertarget{sljitExecAllocator_8c_a5348493ec1e09bd6f8fa02a6864a369c}{}\label{sljitExecAllocator_8c_a5348493ec1e09bd6f8fa02a6864a369c}

\begin{DoxyCode}
247 \{
248     \textcolor{keyword}{struct }\hyperlink{structblock__header}{block\_header} *header;
249     \textcolor{keyword}{struct }\hyperlink{structfree__block}{free\_block}* \hyperlink{structfree__block}{free\_block};
250 
251     allocator\_grab\_lock();
252     header = \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{AS\_BLOCK\_HEADER}(\hyperlink{group__APACHE__CORE__DAEMON_gaad7fdd8e91a6edc850f20f2fede630a9}{ptr}, -(\hyperlink{sljitConfigInternal_8h_af8684c8d224c0d4e1edd560289d24e6f}{sljit\_sw})\textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} 
      \hyperlink{structblock__header}{block\_header}));
253     allocated\_size -= header->\hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size};
254 
255     \textcolor{comment}{/* Connecting free blocks together if possible. */}
256 
257     \textcolor{comment}{/* If header->prev\_size == 0, free\_block will equal to header.}
258 \textcolor{comment}{       In this case, free\_block->header.size will be > 0. */}
259     free\_block = \hyperlink{sljitExecAllocator_8c_aa4f4636963a1df9ab6d3ff267bc22cc4}{AS\_FREE\_BLOCK}(header, -(\hyperlink{sljitConfigInternal_8h_af8684c8d224c0d4e1edd560289d24e6f}{sljit\_sw})header->
      \hyperlink{structblock__header_abe1e343d7e0aef9b4db80de7aa4adb4b}{prev\_size});
260     \textcolor{keywordflow}{if} (\hyperlink{sljitConfigInternal_8h_a3e57a7da560d2aaed3299427bcd1a795}{SLJIT\_UNLIKELY}(!free\_block->\hyperlink{structfree__block_a7c325e0fbf4788e55ee69e9014c89399}{header}.\hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size})) \{
261         free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size} += header->\hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size};
262         header = \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{AS\_BLOCK\_HEADER}(free\_block, free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size});
263         header->\hyperlink{structblock__header_abe1e343d7e0aef9b4db80de7aa4adb4b}{prev\_size} = free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size};
264     \}
265     \textcolor{keywordflow}{else} \{
266         free\_block = (\textcolor{keyword}{struct }free\_block*)header;
267         sljit\_insert\_free\_block(free\_block, header->\hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size});
268     \}
269 
270     header = \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{AS\_BLOCK\_HEADER}(free\_block, free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size});
271     \textcolor{keywordflow}{if} (\hyperlink{sljitConfigInternal_8h_a3e57a7da560d2aaed3299427bcd1a795}{SLJIT\_UNLIKELY}(!header->\hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size})) \{
272         free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size} += ((\textcolor{keyword}{struct }free\_block*)header)->size;
273         sljit\_remove\_free\_block((\textcolor{keyword}{struct} free\_block*)header);
274         header = \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{AS\_BLOCK\_HEADER}(free\_block, free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size});
275         header->\hyperlink{structblock__header_abe1e343d7e0aef9b4db80de7aa4adb4b}{prev\_size} = free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size};
276     \}
277 
278     \textcolor{comment}{/* The whole chunk is free. */}
279     \textcolor{keywordflow}{if} (\hyperlink{sljitConfigInternal_8h_a3e57a7da560d2aaed3299427bcd1a795}{SLJIT\_UNLIKELY}(!free\_block->\hyperlink{structfree__block_a7c325e0fbf4788e55ee69e9014c89399}{header}.\hyperlink{structblock__header_abe1e343d7e0aef9b4db80de7aa4adb4b}{prev\_size} && header->
      \hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size} == 1)) \{
280         \textcolor{comment}{/* If this block is freed, we still have (allocated\_size / 2) free space. */}
281         \textcolor{keywordflow}{if} (total\_size - free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size} > (allocated\_size * 3 / 2)) \{
282             total\_size -= free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size};
283             sljit\_remove\_free\_block(free\_block);
284             free\_chunk(free\_block, free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size} + \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} 
      \hyperlink{structblock__header}{block\_header}));
285         \}
286     \}
287 
288     allocator\_release\_lock();
289 \}
\end{DoxyCode}
\index{sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}!sljit\+\_\+free\+\_\+unused\+\_\+memory\+\_\+exec@{sljit\+\_\+free\+\_\+unused\+\_\+memory\+\_\+exec}}
\index{sljit\+\_\+free\+\_\+unused\+\_\+memory\+\_\+exec@{sljit\+\_\+free\+\_\+unused\+\_\+memory\+\_\+exec}!sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}}
\subsubsection[{\texorpdfstring{sljit\+\_\+free\+\_\+unused\+\_\+memory\+\_\+exec(void)}{sljit_free_unused_memory_exec(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+L\+J\+I\+T\+\_\+\+A\+P\+I\+\_\+\+F\+U\+N\+C\+\_\+\+A\+T\+T\+R\+I\+B\+U\+TE} {\bf void} sljit\+\_\+free\+\_\+unused\+\_\+memory\+\_\+exec (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{sljitExecAllocator_8c_aedcee52aa00cce33e3d28a6bf826a155}{}\label{sljitExecAllocator_8c_aedcee52aa00cce33e3d28a6bf826a155}

\begin{DoxyCode}
292 \{
293     \textcolor{keyword}{struct }\hyperlink{structfree__block}{free\_block}* \hyperlink{structfree__block}{free\_block};
294     \textcolor{keyword}{struct }free\_block* next\_free\_block;
295 
296     allocator\_grab\_lock();
297 
298     free\_block = free\_blocks;
299     \textcolor{keywordflow}{while} (free\_block) \{
300         next\_free\_block = free\_block->\hyperlink{structfree__block_a9b209321b0d2d74936310fac046be7b5}{next};
301         \textcolor{keywordflow}{if} (!free\_block->\hyperlink{structfree__block_a7c325e0fbf4788e55ee69e9014c89399}{header}.\hyperlink{structblock__header_abe1e343d7e0aef9b4db80de7aa4adb4b}{prev\_size} && 
302                 \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{AS\_BLOCK\_HEADER}(free\_block, free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size})->size == 1) \{
303             total\_size -= free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size};
304             sljit\_remove\_free\_block(free\_block);
305             free\_chunk(free\_block, free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size} + \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} 
      \hyperlink{structblock__header}{block\_header}));
306         \}
307         free\_block = next\_free\_block;
308     \}
309 
310     \hyperlink{sljitConfigInternal_8h_abe7f9606761ce5dbe317c32130dc32b8}{SLJIT\_ASSERT}((total\_size && free\_blocks) || (!total\_size && !free\_blocks));
311     allocator\_release\_lock();
312 \}
\end{DoxyCode}
\index{sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}!sljit\+\_\+malloc\+\_\+exec@{sljit\+\_\+malloc\+\_\+exec}}
\index{sljit\+\_\+malloc\+\_\+exec@{sljit\+\_\+malloc\+\_\+exec}!sljit\+Exec\+Allocator.\+c@{sljit\+Exec\+Allocator.\+c}}
\subsubsection[{\texorpdfstring{sljit\+\_\+malloc\+\_\+exec(sljit\+\_\+uw size)}{sljit_malloc_exec(sljit_uw size)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf S\+L\+J\+I\+T\+\_\+\+A\+P\+I\+\_\+\+F\+U\+N\+C\+\_\+\+A\+T\+T\+R\+I\+B\+U\+TE} {\bf void}$\ast$ sljit\+\_\+malloc\+\_\+exec (
\begin{DoxyParamCaption}
\item[{{\bf sljit\+\_\+uw}}]{size}
\end{DoxyParamCaption}
)}\hypertarget{sljitExecAllocator_8c_ad0fcef2b1754cc3ce3caf59a36780b76}{}\label{sljitExecAllocator_8c_ad0fcef2b1754cc3ce3caf59a36780b76}

\begin{DoxyCode}
176 \{
177     \textcolor{keyword}{struct }\hyperlink{structblock__header}{block\_header} *header;
178     \textcolor{keyword}{struct }\hyperlink{structblock__header}{block\_header} *next\_header;
179     \textcolor{keyword}{struct }\hyperlink{structfree__block}{free\_block} *\hyperlink{structfree__block}{free\_block};
180     \hyperlink{sljitConfigInternal_8h_a4f2aa7461612a199a0e3fd93cd9a4d02}{sljit\_uw} chunk\_size;
181 
182     allocator\_grab\_lock();
183     \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size} < (64 - \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structblock__header}{block\_header})))
184         \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size} = (64 - \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct }\hyperlink{structblock__header}{block\_header}));
185     \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size} = \hyperlink{sljitExecAllocator_8c_aebf6cc40441e3266687f4f4629471148}{ALIGN\_SIZE}(\hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size});
186 
187     free\_block = free\_blocks;
188     \textcolor{keywordflow}{while} (free\_block) \{
189         \textcolor{keywordflow}{if} (free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size} >= \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size}) \{
190             chunk\_size = free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size};
191             \textcolor{keywordflow}{if} (chunk\_size > \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size} + 64) \{
192                 \textcolor{comment}{/* We just cut a block from the end of the free block. */}
193                 chunk\_size -= \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
194                 free\_block->\hyperlink{structfree__block_accf7fcad60c2eb887c41897b66281db2}{size} = chunk\_size;
195                 header = \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{AS\_BLOCK\_HEADER}(free\_block, chunk\_size);
196                 header->\hyperlink{structblock__header_abe1e343d7e0aef9b4db80de7aa4adb4b}{prev\_size} = chunk\_size;
197                 \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{AS\_BLOCK\_HEADER}(header, \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size})->prev\_size = 
      \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
198             \}
199             \textcolor{keywordflow}{else} \{
200                 sljit\_remove\_free\_block(free\_block);
201                 header = (\textcolor{keyword}{struct }\hyperlink{structblock__header}{block\_header}*)free\_block;
202                 \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size} = chunk\_size;
203             \}
204             allocated\_size += \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
205             header->\hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size} = \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
206             allocator\_release\_lock();
207             \textcolor{keywordflow}{return} \hyperlink{sljitExecAllocator_8c_ae3d1e2141179c57464e11eb25b28b1e4}{MEM\_START}(header);
208         \}
209         free\_block = free\_block->\hyperlink{structfree__block_a9b209321b0d2d74936310fac046be7b5}{next};
210     \}
211 
212     chunk\_size = (\hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size} + \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct }\hyperlink{structblock__header}{block\_header}) + 
      \hyperlink{sljitExecAllocator_8c_aea3cfda4f3a9f978ec759f206cf186fe}{CHUNK\_SIZE} - 1) & \hyperlink{sljitExecAllocator_8c_a2f5d60296887c5da6718c238c922ab4b}{CHUNK\_MASK};
213     header = (\textcolor{keyword}{struct }\hyperlink{structblock__header}{block\_header}*)alloc\_chunk(chunk\_size);
214     \textcolor{keywordflow}{if} (!header) \{
215         allocator\_release\_lock();
216         \textcolor{keywordflow}{return} \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
217     \}
218 
219     chunk\_size -= \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct }\hyperlink{structblock__header}{block\_header});
220     total\_size += chunk\_size;
221 
222     header->\hyperlink{structblock__header_abe1e343d7e0aef9b4db80de7aa4adb4b}{prev\_size} = 0;
223     \textcolor{keywordflow}{if} (chunk\_size > \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size} + 64) \{
224         \textcolor{comment}{/* Cut the allocated space into a free and a used block. */}
225         allocated\_size += \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
226         header->\hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size} = \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
227         chunk\_size -= \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
228 
229         free\_block = \hyperlink{sljitExecAllocator_8c_aa4f4636963a1df9ab6d3ff267bc22cc4}{AS\_FREE\_BLOCK}(header, \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size});
230         free\_block->\hyperlink{structfree__block_a7c325e0fbf4788e55ee69e9014c89399}{header}.\hyperlink{structblock__header_abe1e343d7e0aef9b4db80de7aa4adb4b}{prev\_size} = \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
231         sljit\_insert\_free\_block(free\_block, chunk\_size);
232         next\_header = \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{AS\_BLOCK\_HEADER}(free\_block, chunk\_size);
233     \}
234     \textcolor{keywordflow}{else} \{
235         \textcolor{comment}{/* All space belongs to this allocation. */}
236         allocated\_size += chunk\_size;
237         header->\hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size} = chunk\_size;
238         next\_header = \hyperlink{sljitExecAllocator_8c_a5e379c9f4ab20f387e99eafce4befea2}{AS\_BLOCK\_HEADER}(header, chunk\_size);
239     \}
240     next\_header->\hyperlink{structblock__header_ae6441882dc06eb9b353621fdf1edfaaf}{size} = 1;
241     next\_header->\hyperlink{structblock__header_abe1e343d7e0aef9b4db80de7aa4adb4b}{prev\_size} = chunk\_size;
242     allocator\_release\_lock();
243     \textcolor{keywordflow}{return} \hyperlink{sljitExecAllocator_8c_ae3d1e2141179c57464e11eb25b28b1e4}{MEM\_START}(header);
244 \}
\end{DoxyCode}
