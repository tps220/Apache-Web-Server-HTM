\hypertarget{group__apr__thread__mutex}{}\section{Thread Mutex Routines}
\label{group__apr__thread__mutex}\index{Thread Mutex Routines@{Thread Mutex Routines}}
Collaboration diagram for Thread Mutex Routines\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{group__apr__thread__mutex}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__apr__thread__mutex_ga579050872f9aff06e773b084264f7d06}{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+F\+A\+U\+LT}~0x0
\item 
\#define \hyperlink{group__apr__thread__mutex_gaf421e0445dbc3c739130f5f6544c2e78}{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+N\+E\+S\+T\+ED}~0x1
\item 
\#define \hyperlink{group__apr__thread__mutex_gac31107f3db115edc0c26ea48943c6a16}{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+N\+E\+S\+T\+ED}~0x2
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structapr__thread__mutex__t}{apr\+\_\+thread\+\_\+mutex\+\_\+t} \hyperlink{group__apr__thread__mutex_ga95712060ba3a192036416e1ccef1db75}{apr\+\_\+thread\+\_\+mutex\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__apr__thread__mutex_ga41aa0a42f2221afa01304558886da7f7}{A\+P\+R\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t}) apr\+\_\+thread\+\_\+mutex\+\_\+create(\hyperlink{structapr__thread__mutex__t}{apr\+\_\+thread\+\_\+mutex\+\_\+t} $\ast$$\ast$\hyperlink{group__apr__thread__cond_ga9b5d997217b2ae4c884c535811cb6e35}{mutex}
\item 
\hyperlink{group__apr__thread__mutex_gafc67e0524ebc53ae30e81b53bd719d39}{A\+P\+R\+\_\+\+P\+O\+O\+L\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+A\+C\+C\+E\+S\+S\+OR} (thread\+\_\+mutex)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
unsigned \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__apr__thread__mutex_gac92588540e8c1d014a08cd8a45462b19}{flags}
\item 
unsigned \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$ \hyperlink{group__apr__thread__mutex_gaeca91775667c01adcd0521c0be80ed3b}{pool}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Macro Definition Documentation}
\index{Thread Mutex Routines@{Thread Mutex Routines}!A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+F\+A\+U\+LT@{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+F\+A\+U\+LT}}
\index{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+F\+A\+U\+LT@{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+F\+A\+U\+LT}!Thread Mutex Routines@{Thread Mutex Routines}}
\subsubsection[{\texorpdfstring{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+F\+A\+U\+LT}{APR_THREAD_MUTEX_DEFAULT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+F\+A\+U\+LT~0x0}\hypertarget{group__apr__thread__mutex_ga579050872f9aff06e773b084264f7d06}{}\label{group__apr__thread__mutex_ga579050872f9aff06e773b084264f7d06}
platform-\/optimal lock behavior \index{Thread Mutex Routines@{Thread Mutex Routines}!A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+N\+E\+S\+T\+ED@{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+N\+E\+S\+T\+ED}}
\index{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+N\+E\+S\+T\+ED@{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+N\+E\+S\+T\+ED}!Thread Mutex Routines@{Thread Mutex Routines}}
\subsubsection[{\texorpdfstring{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+N\+E\+S\+T\+ED}{APR_THREAD_MUTEX_NESTED}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+N\+E\+S\+T\+ED~0x1}\hypertarget{group__apr__thread__mutex_gaf421e0445dbc3c739130f5f6544c2e78}{}\label{group__apr__thread__mutex_gaf421e0445dbc3c739130f5f6544c2e78}
enable nested (recursive) locks \index{Thread Mutex Routines@{Thread Mutex Routines}!A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+N\+E\+S\+T\+ED@{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+N\+E\+S\+T\+ED}}
\index{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+N\+E\+S\+T\+ED@{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+N\+E\+S\+T\+ED}!Thread Mutex Routines@{Thread Mutex Routines}}
\subsubsection[{\texorpdfstring{A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+N\+E\+S\+T\+ED}{APR_THREAD_MUTEX_UNNESTED}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+U\+N\+N\+E\+S\+T\+ED~0x2}\hypertarget{group__apr__thread__mutex_gac31107f3db115edc0c26ea48943c6a16}{}\label{group__apr__thread__mutex_gac31107f3db115edc0c26ea48943c6a16}
disable nested locks 

\subsection{Typedef Documentation}
\index{Thread Mutex Routines@{Thread Mutex Routines}!apr\+\_\+thread\+\_\+mutex\+\_\+t@{apr\+\_\+thread\+\_\+mutex\+\_\+t}}
\index{apr\+\_\+thread\+\_\+mutex\+\_\+t@{apr\+\_\+thread\+\_\+mutex\+\_\+t}!Thread Mutex Routines@{Thread Mutex Routines}}
\subsubsection[{\texorpdfstring{apr\+\_\+thread\+\_\+mutex\+\_\+t}{apr_thread_mutex_t}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf apr\+\_\+thread\+\_\+mutex\+\_\+t} {\bf apr\+\_\+thread\+\_\+mutex\+\_\+t}}\hypertarget{group__apr__thread__mutex_ga95712060ba3a192036416e1ccef1db75}{}\label{group__apr__thread__mutex_ga95712060ba3a192036416e1ccef1db75}
Opaque thread-\/local mutex structure 

\subsection{Function Documentation}
\index{Thread Mutex Routines@{Thread Mutex Routines}!A\+P\+R\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+R\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{A\+P\+R\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+R\+\_\+\+D\+E\+C\+L\+A\+RE}!Thread Mutex Routines@{Thread Mutex Routines}}
\subsubsection[{\texorpdfstring{A\+P\+R\+\_\+\+D\+E\+C\+L\+A\+R\+E(apr\+\_\+status\+\_\+t) apr\+\_\+thread\+\_\+mutex\+\_\+create(apr\+\_\+thread\+\_\+mutex\+\_\+t $\ast$$\ast$mutex}{APR_DECLARE(apr_status_t) apr_thread_mutex_create(apr_thread_mutex_t **mutex}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+R\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+status\+\_\+t}}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__apr__thread__mutex_ga41aa0a42f2221afa01304558886da7f7}{}\label{group__apr__thread__mutex_ga41aa0a42f2221afa01304558886da7f7}
Create and initialize a mutex that can be used to synchronize threads. 
\begin{DoxyParams}{Parameters}
{\em mutex} & the memory address where the newly created mutex will be stored. \\
\hline
{\em flags} & Or\textquotesingle{}ed value of\+: 
\begin{DoxyPre}
          APR\_THREAD\_MUTEX\_DEFAULT   platform-optimal lock behavior.
          APR\_THREAD\_MUTEX\_NESTED    enable nested (recursive) locks.
          APR\_THREAD\_MUTEX\_UNNESTED  disable nested locks (non-recursive).
\end{DoxyPre}
 \\
\hline
{\em pool} & the pool from which to allocate the mutex. \\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
Be cautious in using A\+P\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+M\+U\+T\+E\+X\+\_\+\+D\+E\+F\+A\+U\+LT. While this is the most optimal mutex based on a given platform\textquotesingle{}s performance characteristics, it will behave as either a nested or an unnested lock.
\end{DoxyWarning}
Acquire the lock for the given mutex. If the mutex is already locked, the current thread will be put to sleep until the lock becomes available. 
\begin{DoxyParams}{Parameters}
{\em mutex} & the mutex on which to acquire the lock.\\
\hline
\end{DoxyParams}
Attempt to acquire the lock for the given mutex. If the mutex has already been acquired, the call returns immediately with A\+P\+R\+\_\+\+E\+B\+U\+SY. Note\+: it is important that the \hyperlink{group__APR__STATUS__IS_gabb92ad7b6ef304132de70e9e5cbaa896}{A\+P\+R\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+I\+S\+\_\+\+E\+B\+U\+S\+Y(s)} macro be used to determine if the return value was A\+P\+R\+\_\+\+E\+B\+U\+SY, for portability reasons. 
\begin{DoxyParams}{Parameters}
{\em mutex} & the mutex on which to attempt the lock acquiring.\\
\hline
\end{DoxyParams}
Release the lock for the given mutex. 
\begin{DoxyParams}{Parameters}
{\em mutex} & the mutex from which to release the lock.\\
\hline
\end{DoxyParams}
Destroy the mutex and free the memory associated with the lock. 
\begin{DoxyParams}{Parameters}
{\em mutex} & the mutex to destroy. \\
\hline
\end{DoxyParams}
The problem with trying to output the entire iovec is that we cannot maintain the behaviour that a real writev would have. If we iterate over the iovec one at a time, we lose the atomic properties of \hyperlink{apr__arch__os2calls_8h_a3d0f3996136a9b5ab46431c60c746efd}{writev()}. The other option is to combine the entire iovec into one buffer that we could then send in one call to write(). This is not reasonable since we do not know how much data an iovec could contain.

The only reasonable option, that maintains the semantics of a real \hyperlink{apr__arch__os2calls_8h_a3d0f3996136a9b5ab46431c60c746efd}{writev()}, is to only write the first iovec. Callers of file\+\_\+writev() must deal with partial writes as they normally would. If you want to ensure an entire iovec is written, use apr\+\_\+file\+\_\+writev\+\_\+full().
\begin{DoxyCode}
23 \{
24     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
25 \}
\end{DoxyCode}
\index{Thread Mutex Routines@{Thread Mutex Routines}!A\+P\+R\+\_\+\+P\+O\+O\+L\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+A\+C\+C\+E\+S\+S\+OR@{A\+P\+R\+\_\+\+P\+O\+O\+L\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+A\+C\+C\+E\+S\+S\+OR}}
\index{A\+P\+R\+\_\+\+P\+O\+O\+L\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+A\+C\+C\+E\+S\+S\+OR@{A\+P\+R\+\_\+\+P\+O\+O\+L\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+A\+C\+C\+E\+S\+S\+OR}!Thread Mutex Routines@{Thread Mutex Routines}}
\subsubsection[{\texorpdfstring{A\+P\+R\+\_\+\+P\+O\+O\+L\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+A\+C\+C\+E\+S\+S\+O\+R(thread\+\_\+mutex)}{APR_POOL_DECLARE_ACCESSOR(thread_mutex)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+R\+\_\+\+P\+O\+O\+L\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+A\+C\+C\+E\+S\+S\+OR (
\begin{DoxyParamCaption}
\item[{thread\+\_\+mutex}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__apr__thread__mutex_gafc67e0524ebc53ae30e81b53bd719d39}{}\label{group__apr__thread__mutex_gafc67e0524ebc53ae30e81b53bd719d39}
Get the pool used by this thread\+\_\+mutex. \begin{DoxyReturn}{Returns}
\hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} the pool 
\end{DoxyReturn}


\subsection{Variable Documentation}
\index{Thread Mutex Routines@{Thread Mutex Routines}!flags@{flags}}
\index{flags@{flags}!Thread Mutex Routines@{Thread Mutex Routines}}
\subsubsection[{\texorpdfstring{flags}{flags}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned {\bf int} flags}\hypertarget{group__apr__thread__mutex_gac92588540e8c1d014a08cd8a45462b19}{}\label{group__apr__thread__mutex_gac92588540e8c1d014a08cd8a45462b19}
\index{Thread Mutex Routines@{Thread Mutex Routines}!pool@{pool}}
\index{pool@{pool}!Thread Mutex Routines@{Thread Mutex Routines}}
\subsubsection[{\texorpdfstring{pool}{pool}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned {\bf int} {\bf apr\+\_\+pool\+\_\+t}$\ast$ pool}\hypertarget{group__apr__thread__mutex_gaeca91775667c01adcd0521c0be80ed3b}{}\label{group__apr__thread__mutex_gaeca91775667c01adcd0521c0be80ed3b}
