\hypertarget{group__MOD__SSL__UTIL}{}\section{Utilities}
\label{group__MOD__SSL__UTIL}\index{Utilities@{Utilities}}
Collaboration diagram for Utilities\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=219pt]{group__MOD__SSL__UTIL}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__MOD__SSL__UTIL_ga69e719c4e3cc5f9d8038c18a7240482f}{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+V\+E\+R\+S\+I\+ON}~O\+P\+E\+N\+S\+S\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+N\+U\+M\+B\+ER
\item 
\#define \hyperlink{group__MOD__SSL__UTIL_ga745269f1532440b23c691b5febedb539}{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+N\+A\+ME}~\char`\"{}Open\+S\+SL\char`\"{}
\item 
\#define \hyperlink{group__MOD__SSL__UTIL_ga8483b8fd1bc5ff050b4c0154b3f1cd0f}{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+T\+E\+XT}~O\+P\+E\+N\+S\+S\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+T\+E\+XT
\item 
\#define \hyperlink{group__MOD__SSL__UTIL_ga7199e41b3460675e9b97e9582471c8e9}{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+D\+Y\+N\+T\+E\+XT}~Open\+S\+S\+L\+\_\+version(O\+P\+E\+N\+S\+S\+L\+\_\+\+V\+E\+R\+S\+I\+ON)
\item 
\#define \hyperlink{group__MOD__SSL__UTIL_ga33ff82b5abee9e2a133dbc1108e40688}{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+M\+A\+X\+\_\+\+D\+ER}~1024$\ast$10
\item 
\#define \hyperlink{group__MOD__SSL__UTIL_ga536fe93cdb182005c2482441ea973f16}{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+I\+D\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+L\+EN}~((S\+S\+L\+\_\+\+M\+A\+X\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+I\+D\+\_\+\+L\+E\+N\+G\+TH + 1) $\ast$ 2)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{group__MOD__SSL__UTIL_ga1e6f698e376d307e5826cf96eae59708}{modssl\+\_\+init\+\_\+app\+\_\+data2\+\_\+idx} (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})
\item 
\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} $\ast$ \hyperlink{group__MOD__SSL__UTIL_ga1bcee252b873bbf1f10920827802303c}{modssl\+\_\+get\+\_\+app\+\_\+data2} (\hyperlink{group__MOD__SSL_gac05889312301718b3fc106564942ad68}{S\+SL} $\ast$)
\item 
\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{group__MOD__SSL__UTIL_ga9474414be52ebb8768e3023968097bc5}{modssl\+\_\+set\+\_\+app\+\_\+data2} (\hyperlink{group__MOD__SSL_gac05889312301718b3fc106564942ad68}{S\+SL} $\ast$, \hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} $\ast$)
\item 
E\+V\+P\+\_\+\+P\+K\+EY $\ast$ \hyperlink{group__MOD__SSL__UTIL_ga82752d8eb9f5dab0b40d7b18d741e3bc}{modssl\+\_\+read\+\_\+privatekey} (const char $\ast$, E\+V\+P\+\_\+\+P\+K\+EY $\ast$$\ast$, pem\+\_\+password\+\_\+cb $\ast$, \hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} $\ast$)
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__MOD__SSL__UTIL_gac9f72fcff0b63162c3be9840dd308315}{modssl\+\_\+smart\+\_\+shutdown} (\hyperlink{group__MOD__SSL_gac05889312301718b3fc106564942ad68}{S\+SL} $\ast$\hyperlink{group__MOD__SSL_ga91d808d6c1c01029f9c9260b9b69a437}{ssl})
\item 
\hyperlink{pcre__internal_8h_a050c65e107f0c828f856a231f4b4e788}{B\+O\+OL} \hyperlink{group__MOD__SSL__UTIL_ga864fc6f3f3d496b62b5f0ba5b61f9eb3}{modssl\+\_\+\+X509\+\_\+get\+BC} (X509 $\ast$, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} $\ast$, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} $\ast$)
\item 
char $\ast$ \hyperlink{group__MOD__SSL__UTIL_ga2892cbff75bedf65cf0731d337684894}{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+R\+Y\+\_\+to\+\_\+string} (\hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+RY $\ast$xsne)
\item 
char $\ast$ \hyperlink{group__MOD__SSL__UTIL_ga51008e236441926c31150e12283c87aa}{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+to\+\_\+string} (\hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$, X509\+\_\+\+N\+A\+ME $\ast$, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int})
\item 
\hyperlink{pcre__internal_8h_a050c65e107f0c828f856a231f4b4e788}{B\+O\+OL} \hyperlink{group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595}{modssl\+\_\+\+X509\+\_\+get\+S\+AN} (\hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$, X509 $\ast$, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int}, const char $\ast$, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int}, \hyperlink{structapr__array__header__t}{apr\+\_\+array\+\_\+header\+\_\+t} $\ast$$\ast$)
\item 
\hyperlink{pcre__internal_8h_a050c65e107f0c828f856a231f4b4e788}{B\+O\+OL} \hyperlink{group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113}{modssl\+\_\+\+X509\+\_\+match\+\_\+name} (\hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$, X509 $\ast$, const char $\ast$, \hyperlink{pcre__internal_8h_a050c65e107f0c828f856a231f4b4e788}{B\+O\+OL}, \hyperlink{structserver__rec}{server\+\_\+rec} $\ast$)
\item 
char $\ast$ \hyperlink{group__MOD__SSL__UTIL_ga2363acfbf9ae3431c6ae3e7c3c346c17}{modssl\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+id2sz} (\hyperlink{group__MOD__SSL__PRIVATE_ga7b2aaacd57801ee8b4692b1699a1b1bd}{I\+D\+C\+O\+N\+ST} unsigned char $\ast$, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int}, char $\ast$, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int})
\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Macro Definition Documentation}
\index{Utilities@{Utilities}!M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+D\+Y\+N\+T\+E\+XT@{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+D\+Y\+N\+T\+E\+XT}}
\index{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+D\+Y\+N\+T\+E\+XT@{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+D\+Y\+N\+T\+E\+XT}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+D\+Y\+N\+T\+E\+XT}{MODSSL_LIBRARY_DYNTEXT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+D\+Y\+N\+T\+E\+XT~Open\+S\+S\+L\+\_\+version(O\+P\+E\+N\+S\+S\+L\+\_\+\+V\+E\+R\+S\+I\+ON)}\hypertarget{group__MOD__SSL__UTIL_ga7199e41b3460675e9b97e9582471c8e9}{}\label{group__MOD__SSL__UTIL_ga7199e41b3460675e9b97e9582471c8e9}
\index{Utilities@{Utilities}!M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+N\+A\+ME@{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+N\+A\+ME}}
\index{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+N\+A\+ME@{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+N\+A\+ME}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+N\+A\+ME}{MODSSL_LIBRARY_NAME}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+N\+A\+ME~\char`\"{}Open\+S\+SL\char`\"{}}\hypertarget{group__MOD__SSL__UTIL_ga745269f1532440b23c691b5febedb539}{}\label{group__MOD__SSL__UTIL_ga745269f1532440b23c691b5febedb539}
\index{Utilities@{Utilities}!M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+T\+E\+XT@{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+T\+E\+XT}}
\index{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+T\+E\+XT@{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+T\+E\+XT}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+T\+E\+XT}{MODSSL_LIBRARY_TEXT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+T\+E\+XT~O\+P\+E\+N\+S\+S\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+T\+E\+XT}\hypertarget{group__MOD__SSL__UTIL_ga8483b8fd1bc5ff050b4c0154b3f1cd0f}{}\label{group__MOD__SSL__UTIL_ga8483b8fd1bc5ff050b4c0154b3f1cd0f}
\index{Utilities@{Utilities}!M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+V\+E\+R\+S\+I\+ON@{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+V\+E\+R\+S\+I\+ON}}
\index{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+V\+E\+R\+S\+I\+ON@{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+V\+E\+R\+S\+I\+ON}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+V\+E\+R\+S\+I\+ON}{MODSSL_LIBRARY_VERSION}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+O\+D\+S\+S\+L\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+V\+E\+R\+S\+I\+ON~O\+P\+E\+N\+S\+S\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+N\+U\+M\+B\+ER}\hypertarget{group__MOD__SSL__UTIL_ga69e719c4e3cc5f9d8038c18a7240482f}{}\label{group__MOD__SSL__UTIL_ga69e719c4e3cc5f9d8038c18a7240482f}
S\+SL library version number \index{Utilities@{Utilities}!M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+I\+D\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+L\+EN@{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+I\+D\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+L\+EN}}
\index{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+I\+D\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+L\+EN@{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+I\+D\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+L\+EN}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+I\+D\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+L\+EN}{MODSSL_SESSION_ID_STRING_LEN}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+I\+D\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+L\+EN~((S\+S\+L\+\_\+\+M\+A\+X\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+I\+D\+\_\+\+L\+E\+N\+G\+TH + 1) $\ast$ 2)}\hypertarget{group__MOD__SSL__UTIL_ga536fe93cdb182005c2482441ea973f16}{}\label{group__MOD__SSL__UTIL_ga536fe93cdb182005c2482441ea973f16}
max length for modssl\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+id2sz \index{Utilities@{Utilities}!M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+M\+A\+X\+\_\+\+D\+ER@{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+M\+A\+X\+\_\+\+D\+ER}}
\index{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+M\+A\+X\+\_\+\+D\+ER@{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+M\+A\+X\+\_\+\+D\+ER}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+M\+A\+X\+\_\+\+D\+ER}{MODSSL_SESSION_MAX_DER}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+O\+D\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+\+M\+A\+X\+\_\+\+D\+ER~1024$\ast$10}\hypertarget{group__MOD__SSL__UTIL_ga33ff82b5abee9e2a133dbc1108e40688}{}\label{group__MOD__SSL__UTIL_ga33ff82b5abee9e2a133dbc1108e40688}
Maximum length of a D\+ER encoded session. F\+I\+X\+ME\+: There is no define in Open\+S\+SL, but Open\+S\+SL uses 1024$\ast$10, so this value should be ok. Although we have no warm feeling. 

\subsection{Function Documentation}
\index{Utilities@{Utilities}!modssl\+\_\+get\+\_\+app\+\_\+data2@{modssl\+\_\+get\+\_\+app\+\_\+data2}}
\index{modssl\+\_\+get\+\_\+app\+\_\+data2@{modssl\+\_\+get\+\_\+app\+\_\+data2}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+get\+\_\+app\+\_\+data2(\+S\+S\+L $\ast$)}{modssl_get_app_data2(SSL *)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ modssl\+\_\+get\+\_\+app\+\_\+data2 (
\begin{DoxyParamCaption}
\item[{{\bf S\+SL} $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_ga1bcee252b873bbf1f10920827802303c}{}\label{group__MOD__SSL__UTIL_ga1bcee252b873bbf1f10920827802303c}

\begin{DoxyCode}
61 \{
62     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{void} *)SSL\_get\_ex\_data(\hyperlink{group__MOD__SSL_ga91d808d6c1c01029f9c9260b9b69a437}{ssl}, app\_data2\_idx);
63 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_ga1bcee252b873bbf1f10920827802303c_icgraph}
\end{center}
\end{figure}


\index{Utilities@{Utilities}!modssl\+\_\+init\+\_\+app\+\_\+data2\+\_\+idx@{modssl\+\_\+init\+\_\+app\+\_\+data2\+\_\+idx}}
\index{modssl\+\_\+init\+\_\+app\+\_\+data2\+\_\+idx@{modssl\+\_\+init\+\_\+app\+\_\+data2\+\_\+idx}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+init\+\_\+app\+\_\+data2\+\_\+idx(void)}{modssl_init_app_data2_idx(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} modssl\+\_\+init\+\_\+app\+\_\+data2\+\_\+idx (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_ga1e6f698e376d307e5826cf96eae59708}{}\label{group__MOD__SSL__UTIL_ga1e6f698e376d307e5826cf96eae59708}
Additional Functions 
\begin{DoxyCode}
44 \{
45     \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
46 
47     \textcolor{keywordflow}{if} (app\_data2\_idx > -1) \{
48         \textcolor{keywordflow}{return};
49     \}
50 
51     \textcolor{comment}{/* we \_do\_ need to call this twice */}
52     \textcolor{keywordflow}{for} (i = 0; i <= 1; i++) \{
53         app\_data2\_idx =
54             SSL\_get\_ex\_new\_index(0,
55                                  \textcolor{stringliteral}{"Second Application Data for SSL"},
56                                  \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
57     \}
58 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_ga1e6f698e376d307e5826cf96eae59708_icgraph}
\end{center}
\end{figure}


\index{Utilities@{Utilities}!modssl\+\_\+read\+\_\+privatekey@{modssl\+\_\+read\+\_\+privatekey}}
\index{modssl\+\_\+read\+\_\+privatekey@{modssl\+\_\+read\+\_\+privatekey}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+read\+\_\+privatekey(const char $\ast$, E\+V\+P\+\_\+\+P\+K\+E\+Y $\ast$$\ast$, pem\+\_\+password\+\_\+cb $\ast$, void $\ast$)}{modssl_read_privatekey(const char *, EVP_PKEY **, pem_password_cb *, void *)}}]{\setlength{\rightskip}{0pt plus 5cm}E\+V\+P\+\_\+\+P\+K\+EY$\ast$ modssl\+\_\+read\+\_\+privatekey (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{, }
\item[{E\+V\+P\+\_\+\+P\+K\+EY $\ast$$\ast$}]{, }
\item[{pem\+\_\+password\+\_\+cb $\ast$}]{, }
\item[{{\bf void} $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_ga82752d8eb9f5dab0b40d7b18d741e3bc}{}\label{group__MOD__SSL__UTIL_ga82752d8eb9f5dab0b40d7b18d741e3bc}

\begin{DoxyCode}
78 \{
79     EVP\_PKEY *\hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
80     BIO *bioS;
81     BIO *bioF;
82 
83     \textcolor{comment}{/* 1. try PEM (= DER+Base64+headers) */}
84     \textcolor{keywordflow}{if} ((bioS=BIO\_new\_file(\hyperlink{group__APACHE__CORE__LOG_ga28849770c8bfeb04039d7dd29d4dfa35}{filename}, \textcolor{stringliteral}{"r"})) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
85         \textcolor{keywordflow}{return} \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
86     rc = PEM\_read\_bio\_PrivateKey(bioS, \hyperlink{group__MOD__CACHE_ga11d8023381192746eb96be162398fe1c}{key}, cb, \hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s});
87     BIO\_free(bioS);
88 
89     \textcolor{keywordflow}{if} (rc == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
90         \textcolor{comment}{/* 2. try DER+Base64 */}
91         \textcolor{keywordflow}{if} ((bioS = BIO\_new\_file(\hyperlink{group__APACHE__CORE__LOG_ga28849770c8bfeb04039d7dd29d4dfa35}{filename}, \textcolor{stringliteral}{"r"})) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
92             \textcolor{keywordflow}{return} \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
93 
94         \textcolor{keywordflow}{if} ((bioF = BIO\_new(BIO\_f\_base64())) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
95             BIO\_free(bioS);
96             \textcolor{keywordflow}{return} \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
97         \}
98         bioS = BIO\_push(bioF, bioS);
99         rc = d2i\_PrivateKey\_bio(bioS, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
100         BIO\_free\_all(bioS);
101 
102         \textcolor{keywordflow}{if} (rc == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
103             \textcolor{comment}{/* 3. try plain DER */}
104             \textcolor{keywordflow}{if} ((bioS = BIO\_new\_file(\hyperlink{group__APACHE__CORE__LOG_ga28849770c8bfeb04039d7dd29d4dfa35}{filename}, \textcolor{stringliteral}{"r"})) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
105                 \textcolor{keywordflow}{return} \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
106             rc = d2i\_PrivateKey\_bio(bioS, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
107             BIO\_free(bioS);
108         \}
109     \}
110     \textcolor{keywordflow}{if} (rc != \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL} && \hyperlink{group__MOD__CACHE_ga11d8023381192746eb96be162398fe1c}{key} != \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
111         \textcolor{keywordflow}{if} (*\hyperlink{group__MOD__CACHE_ga11d8023381192746eb96be162398fe1c}{key} != \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
112             EVP\_PKEY\_free(*\hyperlink{group__MOD__CACHE_ga11d8023381192746eb96be162398fe1c}{key});
113         *\hyperlink{group__MOD__CACHE_ga11d8023381192746eb96be162398fe1c}{key} = \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
114     \}
115     \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
116 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_ga82752d8eb9f5dab0b40d7b18d741e3bc_icgraph}
\end{center}
\end{figure}


\index{Utilities@{Utilities}!modssl\+\_\+set\+\_\+app\+\_\+data2@{modssl\+\_\+set\+\_\+app\+\_\+data2}}
\index{modssl\+\_\+set\+\_\+app\+\_\+data2@{modssl\+\_\+set\+\_\+app\+\_\+data2}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+set\+\_\+app\+\_\+data2(\+S\+S\+L $\ast$, void $\ast$)}{modssl_set_app_data2(SSL *, void *)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} modssl\+\_\+set\+\_\+app\+\_\+data2 (
\begin{DoxyParamCaption}
\item[{{\bf S\+SL} $\ast$}]{, }
\item[{{\bf void} $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_ga9474414be52ebb8768e3023968097bc5}{}\label{group__MOD__SSL__UTIL_ga9474414be52ebb8768e3023968097bc5}

\begin{DoxyCode}
66 \{
67     SSL\_set\_ex\_data(\hyperlink{group__MOD__SSL_ga91d808d6c1c01029f9c9260b9b69a437}{ssl}, app\_data2\_idx, (\textcolor{keywordtype}{char} *)\hyperlink{group__APACHE__CORE__LISTEN_ga71f9d4c76ff7cd8f3db5697a5cfa7b08}{arg});
68     \textcolor{keywordflow}{return};
69 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_ga9474414be52ebb8768e3023968097bc5_icgraph}
\end{center}
\end{figure}


\index{Utilities@{Utilities}!modssl\+\_\+smart\+\_\+shutdown@{modssl\+\_\+smart\+\_\+shutdown}}
\index{modssl\+\_\+smart\+\_\+shutdown@{modssl\+\_\+smart\+\_\+shutdown}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+smart\+\_\+shutdown(\+S\+S\+L $\ast$ssl)}{modssl_smart_shutdown(SSL *ssl)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} modssl\+\_\+smart\+\_\+shutdown (
\begin{DoxyParamCaption}
\item[{{\bf S\+SL} $\ast$}]{ssl}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_gac9f72fcff0b63162c3be9840dd308315}{}\label{group__MOD__SSL__UTIL_gac9f72fcff0b63162c3be9840dd308315}

\begin{DoxyCode}
125 \{
126     \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
127     \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
128     \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONNECTION_ga0e45940edc0a96a29eea9b91650341ae}{flush};
129 
130     \textcolor{comment}{/*}
131 \textcolor{comment}{     * Repeat the calls, because SSL\_shutdown internally dispatches through a}
132 \textcolor{comment}{     * little state machine. Usually only one or two interation should be}
133 \textcolor{comment}{     * needed, so we restrict the total number of restrictions in order to}
134 \textcolor{comment}{     * avoid process hangs in case the client played bad with the socket}
135 \textcolor{comment}{     * connection and OpenSSL cannot recognize it.}
136 \textcolor{comment}{     */}
137     rc = 0;
138     flush = !(SSL\_get\_shutdown(\hyperlink{group__MOD__SSL_ga91d808d6c1c01029f9c9260b9b69a437}{ssl}) & SSL\_SENT\_SHUTDOWN);
139     \textcolor{keywordflow}{for} (i = 0; i < 4 \textcolor{comment}{/* max 2x pending + 2x data = 4 */}; i++) \{
140         rc = SSL\_shutdown(\hyperlink{group__MOD__SSL_ga91d808d6c1c01029f9c9260b9b69a437}{ssl});
141         \textcolor{keywordflow}{if} (rc >= 0 && flush && (SSL\_get\_shutdown(\hyperlink{group__MOD__SSL_ga91d808d6c1c01029f9c9260b9b69a437}{ssl}) & SSL\_SENT\_SHUTDOWN)) \{
142             \textcolor{comment}{/* Once the close notity is sent through the output filters,}
143 \textcolor{comment}{             * ensure it is flushed through the socket.}
144 \textcolor{comment}{             */}
145             \textcolor{keywordflow}{if} (BIO\_flush(SSL\_get\_wbio(\hyperlink{group__MOD__SSL_ga91d808d6c1c01029f9c9260b9b69a437}{ssl})) <= 0) \{
146                 rc = -1;
147                 \textcolor{keywordflow}{break};
148             \}
149             flush = 0;
150         \}
151         \textcolor{keywordflow}{if} (rc != 0)
152             \textcolor{keywordflow}{break};
153     \}
154     \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
155 \}
\end{DoxyCode}
\index{Utilities@{Utilities}!modssl\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+id2sz@{modssl\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+id2sz}}
\index{modssl\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+id2sz@{modssl\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+id2sz}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+id2sz(\+I\+D\+C\+O\+N\+S\+T unsigned char $\ast$, int, char $\ast$, int)}{modssl_SSL_SESSION_id2sz(IDCONST unsigned char *, int, char *, int)}}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ modssl\+\_\+\+S\+S\+L\+\_\+\+S\+E\+S\+S\+I\+O\+N\+\_\+id2sz (
\begin{DoxyParamCaption}
\item[{{\bf I\+D\+C\+O\+N\+ST} unsigned char $\ast$}]{, }
\item[{{\bf int}}]{, }
\item[{char $\ast$}]{, }
\item[{{\bf int}}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_ga2363acfbf9ae3431c6ae3e7c3c346c17}{}\label{group__MOD__SSL__UTIL_ga2363acfbf9ae3431c6ae3e7c3c346c17}

\begin{DoxyCode}
493 \{
494     \textcolor{keywordflow}{if} (idlen > SSL\_MAX\_SSL\_SESSION\_ID\_LENGTH)
495         idlen = SSL\_MAX\_SSL\_SESSION\_ID\_LENGTH;
496         
497     \textcolor{comment}{/* We must ensure not to process more than what would fit in the}
498 \textcolor{comment}{     * destination buffer, including terminating NULL */}
499     \textcolor{keywordflow}{if} (idlen > (strsize-1) / 2)
500         idlen = (strsize-1) / 2;
501 
502     ap\_bin2hex(\textcolor{keywordtype}{id}, idlen, \hyperlink{group__MOD__DAV_gaab9226fe8f632e1f998e24276d478f30}{str});
503 
504     \textcolor{keywordflow}{return} \hyperlink{group__MOD__DAV_gaab9226fe8f632e1f998e24276d478f30}{str};
505 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_ga2363acfbf9ae3431c6ae3e7c3c346c17_icgraph}
\end{center}
\end{figure}


\index{Utilities@{Utilities}!modssl\+\_\+\+X509\+\_\+get\+BC@{modssl\+\_\+\+X509\+\_\+get\+BC}}
\index{modssl\+\_\+\+X509\+\_\+get\+BC@{modssl\+\_\+\+X509\+\_\+get\+BC}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+\+X509\+\_\+get\+B\+C(\+X509 $\ast$, int $\ast$, int $\ast$)}{modssl_X509_getBC(X509 *, int *, int *)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\+O\+OL} modssl\+\_\+\+X509\+\_\+get\+BC (
\begin{DoxyParamCaption}
\item[{X509 $\ast$}]{, }
\item[{{\bf int} $\ast$}]{, }
\item[{{\bf int} $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_ga864fc6f3f3d496b62b5f0ba5b61f9eb3}{}\label{group__MOD__SSL__UTIL_ga864fc6f3f3d496b62b5f0ba5b61f9eb3}

\begin{DoxyCode}
165 \{
166     BASIC\_CONSTRAINTS *bc;
167     BIGNUM *bn = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
168     \textcolor{keywordtype}{char} *cp;
169 
170     bc = X509\_get\_ext\_d2i(cert, NID\_basic\_constraints, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
171     \textcolor{keywordflow}{if} (bc == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
172         \textcolor{keywordflow}{return} \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};
173     *ca = bc->ca;
174     *pathlen = -1 \textcolor{comment}{/* unlimited */};
175     \textcolor{keywordflow}{if} (bc->pathlen != \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
176         \textcolor{keywordflow}{if} ((bn = ASN1\_INTEGER\_to\_BN(bc->pathlen, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
177             BASIC\_CONSTRAINTS\_free(bc);
178             \textcolor{keywordflow}{return} \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};
179         \}
180         \textcolor{keywordflow}{if} ((cp = BN\_bn2dec(bn)) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
181             BN\_free(bn);
182             BASIC\_CONSTRAINTS\_free(bc);
183             \textcolor{keywordflow}{return} \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};
184         \}
185         *pathlen = atoi(cp);
186         OPENSSL\_free(cp);
187         BN\_free(bn);
188     \}
189     BASIC\_CONSTRAINTS\_free(bc);
190     \textcolor{keywordflow}{return} \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
191 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_ga864fc6f3f3d496b62b5f0ba5b61f9eb3_icgraph}
\end{center}
\end{figure}


\index{Utilities@{Utilities}!modssl\+\_\+\+X509\+\_\+get\+S\+AN@{modssl\+\_\+\+X509\+\_\+get\+S\+AN}}
\index{modssl\+\_\+\+X509\+\_\+get\+S\+AN@{modssl\+\_\+\+X509\+\_\+get\+S\+AN}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+\+X509\+\_\+get\+S\+A\+N(apr\+\_\+pool\+\_\+t $\ast$, X509 $\ast$, int, const char $\ast$, int, apr\+\_\+array\+\_\+header\+\_\+t $\ast$$\ast$)}{modssl_X509_getSAN(apr_pool_t *, X509 *, int, const char *, int, apr_array_header_t **)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\+O\+OL} modssl\+\_\+\+X509\+\_\+get\+S\+AN (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{, }
\item[{X509 $\ast$}]{, }
\item[{{\bf int}}]{, }
\item[{const char $\ast$}]{, }
\item[{{\bf int}}]{, }
\item[{{\bf apr\+\_\+array\+\_\+header\+\_\+t} $\ast$$\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595}{}\label{group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595}

\begin{DoxyCode}
290 \{
291     \hyperlink{ssl__engine__init_8c_a8d3ef5dbf93a046b44c0a610b5325b45}{STACK\_OF}(GENERAL\_NAME) *\hyperlink{ap__regex_8h_aba891871049c2a2e93d20a094a56662a}{names};
292     \textcolor{keywordtype}{int} \hyperlink{ssl__engine__vars_8c_a7235ef62e89328f5155846dc59c6fc37}{nid} = onf ? OBJ\_txt2nid(onf) : NID\_undef;
293 
294     \textcolor{keywordflow}{if} (!x509 || (\hyperlink{group__APACHE__CORE__HTTPD_gaafc7089562892428c4fcae486f171f5a}{type} < GEN\_OTHERNAME) ||
295         ((\hyperlink{group__APACHE__CORE__HTTPD_gaafc7089562892428c4fcae486f171f5a}{type} == GEN\_OTHERNAME) && (nid == NID\_undef)) ||
296         (\hyperlink{group__APACHE__CORE__HTTPD_gaafc7089562892428c4fcae486f171f5a}{type} > GEN\_RID) || (idx < -1) ||
297         !(*entries = apr\_array\_make(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, 0, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char} *)))) \{
298         *entries = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
299         \textcolor{keywordflow}{return} \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};
300     \}
301 
302     \textcolor{keywordflow}{if} ((\hyperlink{ap__regex_8h_aba891871049c2a2e93d20a094a56662a}{names} = X509\_get\_ext\_d2i(x509, NID\_subject\_alt\_name, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}, 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}))) \{
303         \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}, \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n} = 0;
304         GENERAL\_NAME *\hyperlink{group__APACHE__CORE__CONFIG_ga06e97fb366205b8f170da3c7562a8677}{name};
305         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *utf8str;
306 
307         \textcolor{keywordflow}{for} (i = 0; i < sk\_GENERAL\_NAME\_num(\hyperlink{ap__regex_8h_aba891871049c2a2e93d20a094a56662a}{names}); i++) \{
308             name = sk\_GENERAL\_NAME\_value(\hyperlink{ap__regex_8h_aba891871049c2a2e93d20a094a56662a}{names}, i);
309 
310             \textcolor{keywordflow}{if} (name->type != \hyperlink{group__APACHE__CORE__HTTPD_gaafc7089562892428c4fcae486f171f5a}{type})
311                 \textcolor{keywordflow}{continue};
312 
313             \textcolor{keywordflow}{switch} (\hyperlink{group__APACHE__CORE__HTTPD_gaafc7089562892428c4fcae486f171f5a}{type}) \{
314             \textcolor{keywordflow}{case} GEN\_EMAIL:
315             \textcolor{keywordflow}{case} GEN\_DNS:
316                 \textcolor{keywordflow}{if} (((idx == -1) || (n == idx)) &&
317                     (utf8str = asn1\_string\_to\_utf8(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, name->d.ia5))) \{
318                     \hyperlink{group__apr__tables_ga1833b0f940ec03d0b95926812152e1ca}{APR\_ARRAY\_PUSH}(*entries, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *) = utf8str;
319                 \}
320                 n++;
321                 \textcolor{keywordflow}{break};
322             \textcolor{keywordflow}{case} GEN\_OTHERNAME:
323                 \textcolor{keywordflow}{if} (OBJ\_obj2nid(name->d.otherName->type\_id) == nid) \{
324                     \textcolor{keywordflow}{if} (((idx == -1) || (n == idx))) \{
325                         parse\_otherName\_value(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, name->d.otherName->value,
326                                               onf, entries);
327                     \}
328                     n++;
329                 \}
330                 \textcolor{keywordflow}{break};
331             \textcolor{keywordflow}{default}:
332                 \textcolor{comment}{/*}
333 \textcolor{comment}{                 * Not implemented right now:}
334 \textcolor{comment}{                 * GEN\_X400 (x400Address)}
335 \textcolor{comment}{                 * GEN\_DIRNAME (directoryName)}
336 \textcolor{comment}{                 * GEN\_EDIPARTY (ediPartyName)}
337 \textcolor{comment}{                 * GEN\_URI (uniformResourceIdentifier)}
338 \textcolor{comment}{                 * GEN\_IPADD (iPAddress)}
339 \textcolor{comment}{                 * GEN\_RID (registeredID)}
340 \textcolor{comment}{                 */}
341                 \textcolor{keywordflow}{break};
342             \}
343 
344             \textcolor{keywordflow}{if} ((idx != -1) && (n > idx))
345                \textcolor{keywordflow}{break};
346         \}
347 
348         sk\_GENERAL\_NAME\_pop\_free(\hyperlink{ap__regex_8h_aba891871049c2a2e93d20a094a56662a}{names}, GENERAL\_NAME\_free);
349     \}
350 
351     \textcolor{keywordflow}{return} apr\_is\_empty\_array(*entries) ? \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE} : \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
352 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_icgraph}
\end{center}
\end{figure}


\index{Utilities@{Utilities}!modssl\+\_\+\+X509\+\_\+match\+\_\+name@{modssl\+\_\+\+X509\+\_\+match\+\_\+name}}
\index{modssl\+\_\+\+X509\+\_\+match\+\_\+name@{modssl\+\_\+\+X509\+\_\+match\+\_\+name}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+\+X509\+\_\+match\+\_\+name(apr\+\_\+pool\+\_\+t $\ast$, X509 $\ast$, const char $\ast$, B\+O\+O\+L, server\+\_\+rec $\ast$)}{modssl_X509_match_name(apr_pool_t *, X509 *, const char *, BOOL, server_rec *)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf B\+O\+OL} modssl\+\_\+\+X509\+\_\+match\+\_\+name (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{, }
\item[{X509 $\ast$}]{, }
\item[{const char $\ast$}]{, }
\item[{{\bf B\+O\+OL}}]{, }
\item[{{\bf server\+\_\+rec} $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113}{}\label{group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113}

\begin{DoxyCode}
384 \{
385     \hyperlink{pcre__internal_8h_a050c65e107f0c828f856a231f4b4e788}{BOOL} \hyperlink{pcregrep_8txt_adbf62cf6c8d0bfcea6906e5ffb865b90}{matched} = \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};
386     \hyperlink{structapr__array__header__t}{apr\_array\_header\_t} *ids;
387 
388     \textcolor{comment}{/*}
389 \textcolor{comment}{     * At some day in the future, this might be replaced with X509\_check\_host()}
390 \textcolor{comment}{     * (available in OpenSSL 1.0.2 and later), but two points should be noted:}
391 \textcolor{comment}{     * 1) wildcard matching in X509\_check\_host() might yield different}
392 \textcolor{comment}{     *    results (by default, it supports a broader set of patterns, e.g.}
393 \textcolor{comment}{     *    wildcards in non-initial positions);}
394 \textcolor{comment}{     * 2) we lose the option of logging each DNS- and CN-ID (until a match}
395 \textcolor{comment}{     *    is found).}
396 \textcolor{comment}{     */}
397 
398     \textcolor{keywordflow}{if} (getIDs(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, x509, &ids)) \{
399         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *cp;
400         \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
401         \textcolor{keywordtype}{char} **\textcolor{keywordtype}{id} = (\textcolor{keywordtype}{char} **)ids->\hyperlink{structapr__array__header__t_af8462fa2a1ddf6406c66cd3dd441a269}{elts};
402         \hyperlink{pcre__internal_8h_a050c65e107f0c828f856a231f4b4e788}{BOOL} is\_wildcard;
403 
404         for (i = 0; i < ids->\hyperlink{structapr__array__header__t_ab11b88220885c5a0920a06ac85680055}{nelts}; i++) \{
405             \textcolor{keywordflow}{if} (!\textcolor{keywordtype}{id}[i])
406                 \textcolor{keywordflow}{continue};
407 
408             \textcolor{comment}{/*}
409 \textcolor{comment}{             * Determine if it is a wildcard ID - we're restrictive}
410 \textcolor{comment}{             * in the sense that we require the wildcard character to be}
411 \textcolor{comment}{             * THE left-most label (i.e., the ID must start with "*.")}
412 \textcolor{comment}{             */}
413             is\_wildcard = (*\textcolor{keywordtype}{id}[\hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}] == \textcolor{charliteral}{'*'} && *(\textcolor{keywordtype}{id}[\hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}]+1) == \textcolor{charliteral}{'.'}) ? \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} : 
      \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};
414 
415             \textcolor{comment}{/*}
416 \textcolor{comment}{             * If the ID includes a wildcard character (and the caller is}
417 \textcolor{comment}{             * allowing wildcards), check if it matches for the left-most}
418 \textcolor{comment}{             * DNS label - i.e., the wildcard character is not allowed}
419 \textcolor{comment}{             * to match a dot. Otherwise, try a simple string compare.}
420 \textcolor{comment}{             */}
421             \textcolor{keywordflow}{if} ((allow\_wildcard == \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} && is\_wildcard == \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} &&
422                  (cp = \hyperlink{group__APACHE__CORE__DAEMON_ga6016b58857e4c0b11e39913bdf4ff910}{ap\_strchr\_c}(\hyperlink{group__APACHE__CORE__CONFIG_ga06e97fb366205b8f170da3c7562a8677}{name}, \textcolor{charliteral}{'.'})) && !\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(\textcolor{keywordtype}{id}[i]+1, cp)) ||
423                 !\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(\textcolor{keywordtype}{id}[i], \hyperlink{group__APACHE__CORE__CONFIG_ga06e97fb366205b8f170da3c7562a8677}{name})) \{
424                 matched = \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
425             \}
426 
427             \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s}) \{
428                 \hyperlink{group__APACHE__CORE__LOG_ga5e6676c87418af7a1d323a116c78ecb4}{ap\_log\_error}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga5e4f134ae2203dd339774d9549d814db}{APLOG\_TRACE3}, 0, 
      \hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s},
429                              \textcolor{stringliteral}{"[%s] modssl\_X509\_match\_name: expecting name '%s', "}
430                              \textcolor{stringliteral}{"%smatched by ID '%s'"},
431                              (\hyperlink{group__MOD__SSL__PRIVATE_ga3ea8e2c288a4f4af189ae0fc4f1fd996}{mySrvConfig}(\hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s}))->vhost\_id, \hyperlink{group__APACHE__CORE__CONFIG_ga06e97fb366205b8f170da3c7562a8677}{name},
432                              matched == \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} ? \textcolor{stringliteral}{""} : \textcolor{stringliteral}{"NOT "}, \textcolor{keywordtype}{id}[i]);
433             \}
434 
435             \textcolor{keywordflow}{if} (matched == \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}) \{
436                 \textcolor{keywordflow}{break};
437             \}
438         \}
439 
440     \}
441 
442     \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s}) \{
443         \hyperlink{ssl__engine__log_8c_a5de86875132e7d957f6ff54cf3e3c002}{ssl\_log\_xerror}(\hyperlink{group__MOD__SSL__PRIVATE_ga0e50481cba5952ce59ad2c103f8128a4}{SSLLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_gadfcef90537539cf2b7d35cfbbbafeb93}{APLOG\_DEBUG}, 0, 
      \hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, \hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s}, x509,
444                        \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(02412) \textcolor{stringliteral}{"[%s] Cert %s for name '%s'"},
445                        (\hyperlink{group__MOD__SSL__PRIVATE_ga3ea8e2c288a4f4af189ae0fc4f1fd996}{mySrvConfig}(\hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s}))->vhost\_id,
446                        matched == \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} ? \textcolor{stringliteral}{"matches"} : \textcolor{stringliteral}{"does not match"},
447                        \hyperlink{group__APACHE__CORE__CONFIG_ga06e97fb366205b8f170da3c7562a8677}{name});
448     \}
449 
450     \textcolor{keywordflow}{return} \hyperlink{pcregrep_8txt_adbf62cf6c8d0bfcea6906e5ffb865b90}{matched};
451 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_icgraph}
\end{center}
\end{figure}


\index{Utilities@{Utilities}!modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+R\+Y\+\_\+to\+\_\+string@{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+R\+Y\+\_\+to\+\_\+string}}
\index{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+R\+Y\+\_\+to\+\_\+string@{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+R\+Y\+\_\+to\+\_\+string}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+R\+Y\+\_\+to\+\_\+string(apr\+\_\+pool\+\_\+t $\ast$p, X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+R\+Y $\ast$xsne)}{modssl_X509_NAME_ENTRY_to_string(apr_pool_t *p, X509_NAME_ENTRY *xsne)}}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+R\+Y\+\_\+to\+\_\+string (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{p, }
\item[{X509\+\_\+\+N\+A\+M\+E\+\_\+\+E\+N\+T\+RY $\ast$}]{xsne}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_ga2892cbff75bedf65cf0731d337684894}{}\label{group__MOD__SSL__UTIL_ga2892cbff75bedf65cf0731d337684894}

\begin{DoxyCode}
217 \{
218     \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__MPM_ga9f5959dd76d5c83e775dcf44de684686}{result} = asn1\_string\_to\_utf8(p, X509\_NAME\_ENTRY\_get\_data(xsne));
219     \hyperlink{group__APACHE__CORE__EBCDIC_gad8d6e268d45b4380e6b00371795b12c7}{ap\_xlate\_proto\_from\_ascii}(result, \hyperlink{group__APACHE__CORE__LOG_gab5a43233d60ef05c5b5bf5cba3d74468}{len});
220     \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__MPM_ga9f5959dd76d5c83e775dcf44de684686}{result};
221 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_ga2892cbff75bedf65cf0731d337684894_icgraph}
\end{center}
\end{figure}


\index{Utilities@{Utilities}!modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+to\+\_\+string@{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+to\+\_\+string}}
\index{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+to\+\_\+string@{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+to\+\_\+string}!Utilities@{Utilities}}
\subsubsection[{\texorpdfstring{modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+to\+\_\+string(apr\+\_\+pool\+\_\+t $\ast$, X509\+\_\+\+N\+A\+M\+E $\ast$, int)}{modssl_X509_NAME_to_string(apr_pool_t *, X509_NAME *, int)}}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ modssl\+\_\+\+X509\+\_\+\+N\+A\+M\+E\+\_\+to\+\_\+string (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{, }
\item[{X509\+\_\+\+N\+A\+ME $\ast$}]{, }
\item[{{\bf int}}]{}
\end{DoxyParamCaption}
)}\hypertarget{group__MOD__SSL__UTIL_ga51008e236441926c31150e12283c87aa}{}\label{group__MOD__SSL__UTIL_ga51008e236441926c31150e12283c87aa}

\begin{DoxyCode}
228 \{
229     \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__MPM_ga9f5959dd76d5c83e775dcf44de684686}{result} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
230     BIO *bio;
231     \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__LOG_gab5a43233d60ef05c5b5bf5cba3d74468}{len};
232 
233     \textcolor{keywordflow}{if} ((bio = BIO\_new(BIO\_s\_mem())) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
234         \textcolor{keywordflow}{return} \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
235     X509\_NAME\_print\_ex(bio, dn, 0, XN\_FLAG\_RFC2253);
236     len = BIO\_pending(bio);
237     \textcolor{keywordflow}{if} (len > 0) \{
238         result = apr\_palloc(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, (\hyperlink{group__APACHE__CORE__DAEMON_ga396b50964961e17784202ccbefcbf25d}{maxlen} > 0) ? \hyperlink{group__APACHE__CORE__DAEMON_ga396b50964961e17784202ccbefcbf25d}{maxlen}+1 : len+1);
239         \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__DAEMON_ga396b50964961e17784202ccbefcbf25d}{maxlen} > 0 && \hyperlink{group__APACHE__CORE__DAEMON_ga396b50964961e17784202ccbefcbf25d}{maxlen} < len) \{
240             len = BIO\_read(bio, result, \hyperlink{group__APACHE__CORE__DAEMON_ga396b50964961e17784202ccbefcbf25d}{maxlen});
241             \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__DAEMON_ga396b50964961e17784202ccbefcbf25d}{maxlen} > 2) \{
242                 \textcolor{comment}{/* insert trailing ellipsis if there's enough space */}
243                 apr\_snprintf(result + \hyperlink{group__APACHE__CORE__DAEMON_ga396b50964961e17784202ccbefcbf25d}{maxlen} - 3, 4, \textcolor{stringliteral}{"..."});
244             \}
245         \} \textcolor{keywordflow}{else} \{
246             len = BIO\_read(bio, result, len);
247         \}
248         result[\hyperlink{group__APACHE__CORE__LOG_gab5a43233d60ef05c5b5bf5cba3d74468}{len}] = \hyperlink{group__MOD__SSL__PRIVATE_gaf19d48b9f61047a668649a2f9dc317ff}{NUL};
249     \}
250     BIO\_free(bio);
251 
252     \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__MPM_ga9f5959dd76d5c83e775dcf44de684686}{result};
253 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__MOD__SSL__UTIL_ga51008e236441926c31150e12283c87aa_icgraph}
\end{center}
\end{figure}


