\hypertarget{pcretest_8c}{}\section{/usr/local/src/github/\+Codebase/httpd-\/2.4.29/srclib/pcre/pcretest.c File Reference}
\label{pcretest_8c}\index{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/srclib/pcre/pcretest.\+c@{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/srclib/pcre/pcretest.\+c}}
{\ttfamily \#include $<$ctype.\+h$>$}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$time.\+h$>$}\\*
{\ttfamily \#include $<$locale.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
{\ttfamily \#include $<$sys/time.\+h$>$}\\*
{\ttfamily \#include $<$sys/resource.\+h$>$}\\*
{\ttfamily \#include \char`\"{}pcre.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pcre\+\_\+internal.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pcre\+\_\+tables.\+c\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pcre\+\_\+ucd.\+c\char`\"{}}\\*
Include dependency graph for pcretest.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{pcretest_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{pcretest_8c_ab4803915bb240af979f73ed9d37ef7d6}{I\+N\+P\+U\+T\+\_\+\+M\+O\+DE}~\char`\"{}rb\char`\"{}
\item 
\#define \hyperlink{pcretest_8c_a64de47239f7056b19b66e6a0a4519874}{O\+U\+T\+P\+U\+T\+\_\+\+M\+O\+DE}~\char`\"{}wb\char`\"{}
\item 
\#define \hyperlink{pcretest_8c_ae497efaa9e3ed86a5dd1ffc13991e81d}{P\+R\+IV}(\hyperlink{pcre_8txt_a5a15d68aadb41c771fe50a27c400d49b}{name})~\hyperlink{pcre_8txt_a5a15d68aadb41c771fe50a27c400d49b}{name}
\item 
\#define \hyperlink{pcretest_8c_a4fcaa28936fe34ef0da78b0b18ef63de}{P\+C\+R\+E\+\_\+\+I\+N\+C\+L\+U\+D\+ED}
\item 
\#define \hyperlink{pcretest_8c_a8af07763825a8f9c88693b61e56cbee5}{P\+R\+I\+N\+T\+A\+B\+LE}(\hyperlink{pcregrep_8txt_aef720ae5f62fa015619d00171d917416}{c})~((\hyperlink{pcregrep_8txt_aef720ae5f62fa015619d00171d917416}{c}) $>$= 32 \&\& (\hyperlink{pcregrep_8txt_aef720ae5f62fa015619d00171d917416}{c}) $<$ 127)
\item 
\#define \hyperlink{pcretest_8c_aaa58bd4159f415c44f613a34254836d1}{P\+R\+I\+N\+T\+OK}(\hyperlink{pcregrep_8txt_aef720ae5f62fa015619d00171d917416}{c})~(locale\+\_\+set? (((\hyperlink{pcregrep_8txt_aef720ae5f62fa015619d00171d917416}{c}) $<$ 256) \&\& isprint(\hyperlink{pcregrep_8txt_aef720ae5f62fa015619d00171d917416}{c})) \+: \hyperlink{pcretest_8c_a8af07763825a8f9c88693b61e56cbee5}{P\+R\+I\+N\+T\+A\+B\+LE}(\hyperlink{pcregrep_8txt_aef720ae5f62fa015619d00171d917416}{c}))
\item 
\#define \hyperlink{pcretest_8c_a9d544def118762dd51f9bcc5adcab64f}{N\+O\+P\+O\+S\+IX}
\item 
\#define \hyperlink{pcretest_8c_aff47499266ff9e04ef582a66836bb373}{N\+O\+U\+TF}
\item 
\#define \hyperlink{pcretest_8c_a3d9fc3c745d0880902fe3ea3d5d5f71e}{C\+L\+O\+C\+K\+S\+\_\+\+P\+E\+R\+\_\+\+S\+EC}~100
\item 
\#define \hyperlink{pcretest_8c_a842570e8d80518cd514def8311b3041a}{D\+F\+A\+\_\+\+W\+S\+\_\+\+D\+I\+M\+E\+N\+S\+I\+ON}~1000
\item 
\#define \hyperlink{pcretest_8c_a041831962619cdf9fa8e78b8670099b3}{L\+O\+O\+P\+R\+E\+P\+E\+AT}~500000
\item 
\#define \hyperlink{pcretest_8c_a37560c659003ee72d0641168690f89ed}{P\+C\+R\+E\+\_\+\+S\+T\+U\+D\+Y\+\_\+\+A\+L\+L\+J\+IT}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{P\+C\+R\+E8\+\_\+\+M\+O\+DE}, 
\hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{P\+C\+R\+E16\+\_\+\+M\+O\+DE}, 
\hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{P\+C\+R\+E32\+\_\+\+M\+O\+DE}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
char $\ast$ \hyperlink{pcretest_8c_a5d6ffddd86bd0d0ead58247b1a80e486}{strerror} (\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{pcregrep_8txt_ab232d334efb9173a12ae2940d035f460}{n})
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{pcretest_8c_a3c04138a5bfe5d72780bb7e82a18e627}{main} (\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__apr__getopt_ga6bdebf9385dc069c90aa21989641be02}{argc}, char $\ast$$\ast$\hyperlink{group__apr__getopt_ga675a108e956f4e2ea74dae8d26e6273e}{argv})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{pcretest_8c_a560e1e3acaca1d09a7eddcdb528ed92e}{sys\+\_\+nerr}
\item 
char $\ast$ \hyperlink{pcretest_8c_a47e211ba7b51a50f6998d4f872f12d31}{sys\+\_\+errlist} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{pcretest.\+c@{pcretest.\+c}!C\+L\+O\+C\+K\+S\+\_\+\+P\+E\+R\+\_\+\+S\+EC@{C\+L\+O\+C\+K\+S\+\_\+\+P\+E\+R\+\_\+\+S\+EC}}
\index{C\+L\+O\+C\+K\+S\+\_\+\+P\+E\+R\+\_\+\+S\+EC@{C\+L\+O\+C\+K\+S\+\_\+\+P\+E\+R\+\_\+\+S\+EC}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{C\+L\+O\+C\+K\+S\+\_\+\+P\+E\+R\+\_\+\+S\+EC}{CLOCKS_PER_SEC}}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+L\+O\+C\+K\+S\+\_\+\+P\+E\+R\+\_\+\+S\+EC~100}\hypertarget{pcretest_8c_a3d9fc3c745d0880902fe3ea3d5d5f71e}{}\label{pcretest_8c_a3d9fc3c745d0880902fe3ea3d5d5f71e}
\index{pcretest.\+c@{pcretest.\+c}!D\+F\+A\+\_\+\+W\+S\+\_\+\+D\+I\+M\+E\+N\+S\+I\+ON@{D\+F\+A\+\_\+\+W\+S\+\_\+\+D\+I\+M\+E\+N\+S\+I\+ON}}
\index{D\+F\+A\+\_\+\+W\+S\+\_\+\+D\+I\+M\+E\+N\+S\+I\+ON@{D\+F\+A\+\_\+\+W\+S\+\_\+\+D\+I\+M\+E\+N\+S\+I\+ON}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{D\+F\+A\+\_\+\+W\+S\+\_\+\+D\+I\+M\+E\+N\+S\+I\+ON}{DFA_WS_DIMENSION}}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+F\+A\+\_\+\+W\+S\+\_\+\+D\+I\+M\+E\+N\+S\+I\+ON~1000}\hypertarget{pcretest_8c_a842570e8d80518cd514def8311b3041a}{}\label{pcretest_8c_a842570e8d80518cd514def8311b3041a}
\index{pcretest.\+c@{pcretest.\+c}!I\+N\+P\+U\+T\+\_\+\+M\+O\+DE@{I\+N\+P\+U\+T\+\_\+\+M\+O\+DE}}
\index{I\+N\+P\+U\+T\+\_\+\+M\+O\+DE@{I\+N\+P\+U\+T\+\_\+\+M\+O\+DE}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{I\+N\+P\+U\+T\+\_\+\+M\+O\+DE}{INPUT_MODE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+N\+P\+U\+T\+\_\+\+M\+O\+DE~\char`\"{}rb\char`\"{}}\hypertarget{pcretest_8c_ab4803915bb240af979f73ed9d37ef7d6}{}\label{pcretest_8c_ab4803915bb240af979f73ed9d37ef7d6}
\index{pcretest.\+c@{pcretest.\+c}!L\+O\+O\+P\+R\+E\+P\+E\+AT@{L\+O\+O\+P\+R\+E\+P\+E\+AT}}
\index{L\+O\+O\+P\+R\+E\+P\+E\+AT@{L\+O\+O\+P\+R\+E\+P\+E\+AT}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{L\+O\+O\+P\+R\+E\+P\+E\+AT}{LOOPREPEAT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\+O\+O\+P\+R\+E\+P\+E\+AT~500000}\hypertarget{pcretest_8c_a041831962619cdf9fa8e78b8670099b3}{}\label{pcretest_8c_a041831962619cdf9fa8e78b8670099b3}
\index{pcretest.\+c@{pcretest.\+c}!N\+O\+P\+O\+S\+IX@{N\+O\+P\+O\+S\+IX}}
\index{N\+O\+P\+O\+S\+IX@{N\+O\+P\+O\+S\+IX}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{N\+O\+P\+O\+S\+IX}{NOPOSIX}}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+O\+P\+O\+S\+IX}\hypertarget{pcretest_8c_a9d544def118762dd51f9bcc5adcab64f}{}\label{pcretest_8c_a9d544def118762dd51f9bcc5adcab64f}
\index{pcretest.\+c@{pcretest.\+c}!N\+O\+U\+TF@{N\+O\+U\+TF}}
\index{N\+O\+U\+TF@{N\+O\+U\+TF}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{N\+O\+U\+TF}{NOUTF}}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+O\+U\+TF}\hypertarget{pcretest_8c_aff47499266ff9e04ef582a66836bb373}{}\label{pcretest_8c_aff47499266ff9e04ef582a66836bb373}
\index{pcretest.\+c@{pcretest.\+c}!O\+U\+T\+P\+U\+T\+\_\+\+M\+O\+DE@{O\+U\+T\+P\+U\+T\+\_\+\+M\+O\+DE}}
\index{O\+U\+T\+P\+U\+T\+\_\+\+M\+O\+DE@{O\+U\+T\+P\+U\+T\+\_\+\+M\+O\+DE}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{O\+U\+T\+P\+U\+T\+\_\+\+M\+O\+DE}{OUTPUT_MODE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define O\+U\+T\+P\+U\+T\+\_\+\+M\+O\+DE~\char`\"{}wb\char`\"{}}\hypertarget{pcretest_8c_a64de47239f7056b19b66e6a0a4519874}{}\label{pcretest_8c_a64de47239f7056b19b66e6a0a4519874}
\index{pcretest.\+c@{pcretest.\+c}!P\+C\+R\+E\+\_\+\+I\+N\+C\+L\+U\+D\+ED@{P\+C\+R\+E\+\_\+\+I\+N\+C\+L\+U\+D\+ED}}
\index{P\+C\+R\+E\+\_\+\+I\+N\+C\+L\+U\+D\+ED@{P\+C\+R\+E\+\_\+\+I\+N\+C\+L\+U\+D\+ED}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{P\+C\+R\+E\+\_\+\+I\+N\+C\+L\+U\+D\+ED}{PCRE_INCLUDED}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+C\+R\+E\+\_\+\+I\+N\+C\+L\+U\+D\+ED}\hypertarget{pcretest_8c_a4fcaa28936fe34ef0da78b0b18ef63de}{}\label{pcretest_8c_a4fcaa28936fe34ef0da78b0b18ef63de}
\index{pcretest.\+c@{pcretest.\+c}!P\+C\+R\+E\+\_\+\+S\+T\+U\+D\+Y\+\_\+\+A\+L\+L\+J\+IT@{P\+C\+R\+E\+\_\+\+S\+T\+U\+D\+Y\+\_\+\+A\+L\+L\+J\+IT}}
\index{P\+C\+R\+E\+\_\+\+S\+T\+U\+D\+Y\+\_\+\+A\+L\+L\+J\+IT@{P\+C\+R\+E\+\_\+\+S\+T\+U\+D\+Y\+\_\+\+A\+L\+L\+J\+IT}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{P\+C\+R\+E\+\_\+\+S\+T\+U\+D\+Y\+\_\+\+A\+L\+L\+J\+IT}{PCRE_STUDY_ALLJIT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+C\+R\+E\+\_\+\+S\+T\+U\+D\+Y\+\_\+\+A\+L\+L\+J\+IT}\hypertarget{pcretest_8c_a37560c659003ee72d0641168690f89ed}{}\label{pcretest_8c_a37560c659003ee72d0641168690f89ed}
{\bfseries Value\+:}
\begin{DoxyCode}
(\hyperlink{pcre_8txt_adb2a713b53698607ab6816aa6a7c6c21}{PCRE\_STUDY\_JIT\_COMPILE} | \hyperlink{pcre_8h_ace4910cfca13bc61f959108817c51e56}{\(\backslash\)}
\hyperlink{pcre_8h_ace4910cfca13bc61f959108817c51e56}{  PCRE\_STUDY\_JIT\_PARTIAL\_SOFT\_COMPILE} | 
      \hyperlink{pcre_8h_a0ebaaf7eafe72752b02fb6203a84a23e}{PCRE\_STUDY\_JIT\_PARTIAL\_HARD\_COMPILE})
\end{DoxyCode}
\index{pcretest.\+c@{pcretest.\+c}!P\+R\+I\+N\+T\+A\+B\+LE@{P\+R\+I\+N\+T\+A\+B\+LE}}
\index{P\+R\+I\+N\+T\+A\+B\+LE@{P\+R\+I\+N\+T\+A\+B\+LE}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{P\+R\+I\+N\+T\+A\+B\+LE}{PRINTABLE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+R\+I\+N\+T\+A\+B\+LE(
\begin{DoxyParamCaption}
\item[{}]{{\bf c}}
\end{DoxyParamCaption}
)~(({\bf c}) $>$= 32 \&\& ({\bf c}) $<$ 127)}\hypertarget{pcretest_8c_a8af07763825a8f9c88693b61e56cbee5}{}\label{pcretest_8c_a8af07763825a8f9c88693b61e56cbee5}
\index{pcretest.\+c@{pcretest.\+c}!P\+R\+I\+N\+T\+OK@{P\+R\+I\+N\+T\+OK}}
\index{P\+R\+I\+N\+T\+OK@{P\+R\+I\+N\+T\+OK}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{P\+R\+I\+N\+T\+OK}{PRINTOK}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+R\+I\+N\+T\+OK(
\begin{DoxyParamCaption}
\item[{}]{{\bf c}}
\end{DoxyParamCaption}
)~(locale\+\_\+set? ((({\bf c}) $<$ 256) \&\& isprint({\bf c})) \+: {\bf P\+R\+I\+N\+T\+A\+B\+LE}({\bf c}))}\hypertarget{pcretest_8c_aaa58bd4159f415c44f613a34254836d1}{}\label{pcretest_8c_aaa58bd4159f415c44f613a34254836d1}
\index{pcretest.\+c@{pcretest.\+c}!P\+R\+IV@{P\+R\+IV}}
\index{P\+R\+IV@{P\+R\+IV}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{P\+R\+IV}{PRIV}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+R\+IV(
\begin{DoxyParamCaption}
\item[{}]{{\bf name}}
\end{DoxyParamCaption}
)~{\bf name}}\hypertarget{pcretest_8c_ae497efaa9e3ed86a5dd1ffc13991e81d}{}\label{pcretest_8c_ae497efaa9e3ed86a5dd1ffc13991e81d}


\subsection{Enumeration Type Documentation}
\subsubsection[{\texorpdfstring{anonymous enum}{anonymous enum}}]{\setlength{\rightskip}{0pt plus 5cm}anonymous enum}\hypertarget{pcretest_8c_ac9420823bfeba78fce625fc105e3b01d}{}\label{pcretest_8c_ac9420823bfeba78fce625fc105e3b01d}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{P\+C\+R\+E8\+\_\+\+M\+O\+DE@{P\+C\+R\+E8\+\_\+\+M\+O\+DE}!pcretest.\+c@{pcretest.\+c}}\index{pcretest.\+c@{pcretest.\+c}!P\+C\+R\+E8\+\_\+\+M\+O\+DE@{P\+C\+R\+E8\+\_\+\+M\+O\+DE}}\item[{\em 
P\+C\+R\+E8\+\_\+\+M\+O\+DE\hypertarget{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{}\label{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}
}]\index{P\+C\+R\+E16\+\_\+\+M\+O\+DE@{P\+C\+R\+E16\+\_\+\+M\+O\+DE}!pcretest.\+c@{pcretest.\+c}}\index{pcretest.\+c@{pcretest.\+c}!P\+C\+R\+E16\+\_\+\+M\+O\+DE@{P\+C\+R\+E16\+\_\+\+M\+O\+DE}}\item[{\em 
P\+C\+R\+E16\+\_\+\+M\+O\+DE\hypertarget{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{}\label{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}
}]\index{P\+C\+R\+E32\+\_\+\+M\+O\+DE@{P\+C\+R\+E32\+\_\+\+M\+O\+DE}!pcretest.\+c@{pcretest.\+c}}\index{pcretest.\+c@{pcretest.\+c}!P\+C\+R\+E32\+\_\+\+M\+O\+DE@{P\+C\+R\+E32\+\_\+\+M\+O\+DE}}\item[{\em 
P\+C\+R\+E32\+\_\+\+M\+O\+DE\hypertarget{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{}\label{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}
}]\end{description}
\end{Desc}

\begin{DoxyCode}
494      \{
495   \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE},
496   \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE},
497   \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE}
498 \};
\end{DoxyCode}


\subsection{Function Documentation}
\index{pcretest.\+c@{pcretest.\+c}!main@{main}}
\index{main@{main}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{main(int argc, char $\ast$$\ast$argv)}{main(int argc, char **argv)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} main (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}\hypertarget{pcretest_8c_a3c04138a5bfe5d72780bb7e82a18e627}{}\label{pcretest_8c_a3c04138a5bfe5d72780bb7e82a18e627}

\begin{DoxyCode}
2987 \{
2988 FILE *\hyperlink{group__APACHE__CORE__MD5_ga3fb008193e92b33c1bb53a980b708b75}{infile} = stdin;
2989 \textcolor{keyword}{const} \textcolor{keywordtype}{char} *version;
2990 \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__MUTEX_gaa6c9d809037676d22aceaf5517a33faf}{options} = 0;
2991 \textcolor{keywordtype}{int} study\_options = 0;
2992 \textcolor{keywordtype}{int} default\_find\_match\_limit = \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2993 pcre\_uint32 default\_options = 0;
2994 \textcolor{keywordtype}{int} op = 1;
2995 \textcolor{keywordtype}{int} timeit = 0;
2996 \textcolor{keywordtype}{int} timeitm = 0;
2997 \textcolor{keywordtype}{int} showtotaltimes = 0;
2998 \textcolor{keywordtype}{int} showinfo = 0;
2999 \textcolor{keywordtype}{int} showstore = 0;
3000 \textcolor{keywordtype}{int} force\_study = -1;
3001 \textcolor{keywordtype}{int} force\_study\_options = 0;
3002 \textcolor{keywordtype}{int} quiet = 0;
3003 \textcolor{keywordtype}{int} size\_offsets = 45;
3004 \textcolor{keywordtype}{int} size\_offsets\_max;
3005 \textcolor{keywordtype}{int} *\hyperlink{pcre_8txt_afeda8db30b411d6c918c917b867d0309}{offsets} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
3006 \textcolor{keywordtype}{int} \hyperlink{mod__macro_8c_a98d74a3e27c3b80effb0134b208bdf2a}{debug} = 0;
3007 \textcolor{keywordtype}{int} \hyperlink{README_8txt_aab36b2734b1c834ca42fc771a40b98ef}{done} = 0;
3008 \textcolor{keywordtype}{int} all\_use\_dfa = 0;
3009 \textcolor{keywordtype}{int} verify\_jit = 0;
3010 \textcolor{keywordtype}{int} yield = 0;
3011 \textcolor{keywordtype}{int} stack\_size;
3012 \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *dbuffer = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
3013 \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} lockout[24] = \{ 0 \};
3014 \textcolor{keywordtype}{size\_t} dbuffer\_size = 1\hyperlink{pcregrep_8txt_a313eed54a0385c4d4c4c3ef54236123d}{u} << 14;
3015 clock\_t total\_compile\_time = 0;
3016 clock\_t total\_study\_time = 0;
3017 clock\_t total\_match\_time = 0;
3018 
3019 \textcolor{preprocessor}{#if !defined NOPOSIX}
3020 \textcolor{keywordtype}{int} posix = 0;
3021 \textcolor{preprocessor}{#endif}
3022 \textcolor{preprocessor}{#if !defined NODFA}
3023 \textcolor{keywordtype}{int} *dfa\_workspace = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
3024 \textcolor{preprocessor}{#endif}
3025 
3026 \hyperlink{pcre_8h_a5117e25fa7999595ed9e3976244c55aa}{pcre\_jit\_stack} *jit\_stack = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
3027 
3028 \textcolor{comment}{/* These vectors store, end-to-end, a list of zero-terminated captured}
3029 \textcolor{comment}{substring names, each list itself being terminated by an empty name. Assume}
3030 \textcolor{comment}{that 1024 is plenty long enough for the few names we'll be testing. It is}
3031 \textcolor{comment}{easiest to keep separate 8-, 16- and 32-bit versions, using the 32-bit version}
3032 \textcolor{comment}{for the actual memory, to ensure alignment. */}
3033 
3034 pcre\_uint32 copynames[1024];
3035 pcre\_uint32 getnames[1024];
3036 
3037 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
3038 pcre\_uint32 *cn32ptr;
3039 pcre\_uint32 *gn32ptr;
3040 \textcolor{preprocessor}{#endif}
3041 
3042 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
3043 pcre\_uint16 *copynames16 = (pcre\_uint16 *)copynames;
3044 pcre\_uint16 *getnames16 = (pcre\_uint16 *)getnames;
3045 pcre\_uint16 *cn16ptr;
3046 pcre\_uint16 *gn16ptr;
3047 \textcolor{preprocessor}{#endif}
3048 
3049 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
3050 \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *copynames8 = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)copynames;
3051 \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *getnames8 = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)getnames;
3052 \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *cn8ptr;
3053 \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *gn8ptr;
3054 \textcolor{preprocessor}{#endif}
3055 
3056 \textcolor{comment}{/* Get buffers from malloc() so that valgrind will check their misuse when}
3057 \textcolor{comment}{debugging. They grow automatically when very long lines are read. The 16-}
3058 \textcolor{comment}{and 32-bit buffers (buffer16, buffer32) are obtained only if needed. */}
3059 
3060 \hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer} = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(buffer\_size);
3061 pbuffer = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(buffer\_size);
3062 
3063 \textcolor{comment}{/* The outfile variable is static so that new\_malloc can use it. */}
3064 
3065 outfile = \hyperlink{pcretest_8txt_a23d7bb711442e83ff18e0effa4729bdf}{stdout};
3066 
3067 \textcolor{comment}{/* The following  \_setmode() stuff is some Windows magic that tells its runtime}
3068 \textcolor{comment}{library to translate CRLF into a single LF character. At least, that's what}
3069 \textcolor{comment}{I've been told: never having used Windows I take this all on trust. Originally}
3070 \textcolor{comment}{it set 0x8000, but then I was advised that \_O\_BINARY was better. */}
3071 
3072 \textcolor{preprocessor}{#if defined(\_WIN32) || defined(WIN32)}
3073 \_setmode( \_fileno( \hyperlink{pcretest_8txt_a23d7bb711442e83ff18e0effa4729bdf}{stdout} ), \_O\_BINARY );
3074 \textcolor{preprocessor}{#endif}
3075 
3076 \textcolor{comment}{/* Get the version number: both pcre\_version() and pcre16\_version() give the}
3077 \textcolor{comment}{same answer. We just need to ensure that we call one that is available. */}
3078 
3079 \textcolor{preprocessor}{#if defined SUPPORT\_PCRE8}
3080 version = \hyperlink{pcre_8txt_a80a34330f84c195a0f7fb290ed25b72b}{pcre\_version}();
3081 \textcolor{preprocessor}{#elif defined SUPPORT\_PCRE16}
3082 version = \hyperlink{pcre_8txt_ae00776bbbc59ad781896ce1296317a6e}{pcre16\_version}();
3083 \textcolor{preprocessor}{#elif defined SUPPORT\_PCRE32}
3084 version = \hyperlink{pcre_8txt_a9cbde738eece25bf91c459a696911cf0}{pcre32\_version}();
3085 \textcolor{preprocessor}{#endif}
3086 
3087 \textcolor{comment}{/* Scan options */}
3088 
3089 \textcolor{keywordflow}{while} (\hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc} > 1 && \hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op][0] == \textcolor{charliteral}{'-'})
3090   \{
3091   \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *endptr;
3092   \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__LISTEN_ga71f9d4c76ff7cd8f3db5697a5cfa7b08}{arg} = \hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op];
3093 
3094   \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-m"}) == 0) showstore = 1;
3095   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-s"}) == 0) force\_study = 0;
3096 
3097   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strncmp(arg, \textcolor{stringliteral}{"-s+"}, 3) == 0)
3098     \{
3099     arg += 3;
3100     \textcolor{keywordflow}{if} (*arg == \textcolor{charliteral}{'+'}) \{ arg++; verify\_jit = \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}; \}
3101     force\_study = 1;
3102     \textcolor{keywordflow}{if} (*arg == 0)
3103       force\_study\_options = jit\_study\_bits[6];
3104     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*arg >= \textcolor{charliteral}{'1'} && *arg <= \textcolor{charliteral}{'7'})
3105       force\_study\_options = jit\_study\_bits[*arg - \textcolor{charliteral}{'1'}];
3106     \textcolor{keywordflow}{else} \textcolor{keywordflow}{goto} BAD\_ARG;
3107     \}
3108   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-8"}) == 0)
3109     \{
3110 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
3111     pcre\_mode = \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE};
3112 \textcolor{preprocessor}{#else}
3113     printf(\textcolor{stringliteral}{"** This version of PCRE was built without 8-bit support\(\backslash\)n"});
3114     \hyperlink{group__APACHE__OS__NETWARE_gaac7f3a566d7243651a356db3fcfef6b1}{exit}(1);
3115 \textcolor{preprocessor}{#endif}
3116     \}
3117   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-16"}) == 0)
3118     \{
3119 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
3120     pcre\_mode = \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE};
3121 \textcolor{preprocessor}{#else}
3122     printf(\textcolor{stringliteral}{"** This version of PCRE was built without 16-bit support\(\backslash\)n"});
3123     \hyperlink{group__APACHE__OS__NETWARE_gaac7f3a566d7243651a356db3fcfef6b1}{exit}(1);
3124 \textcolor{preprocessor}{#endif}
3125     \}
3126   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-32"}) == 0)
3127     \{
3128 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
3129     pcre\_mode = \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE};
3130 \textcolor{preprocessor}{#else}
3131     printf(\textcolor{stringliteral}{"** This version of PCRE was built without 32-bit support\(\backslash\)n"});
3132     \hyperlink{group__APACHE__OS__NETWARE_gaac7f3a566d7243651a356db3fcfef6b1}{exit}(1);
3133 \textcolor{preprocessor}{#endif}
3134     \}
3135   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-q"}) == 0) quiet = 1;
3136   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-b"}) == 0) debug = 1;
3137   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-i"}) == 0) showinfo = 1;
3138   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-d"}) == 0) showinfo = debug = 1;
3139   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-M"}) == 0) default\_find\_match\_limit = \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
3140   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-O"}) == 0) default\_options |= \hyperlink{pcre_8h_afa6c9234aa7d3ee12748375fe4204c56}{PCRE\_NO\_AUTO\_POSSESS};
3141 \textcolor{preprocessor}{#if !defined NODFA}
3142   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-dfa"}) == 0) all\_use\_dfa = 1;
3143 \textcolor{preprocessor}{#endif}
3144   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-o"}) == 0 && \hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc} > 2 &&
3145       ((size\_offsets = get\_value((\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op+1], &endptr)),
3146         *endptr == 0))
3147     \{
3148     op++;
3149     \hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc}--;
3150     \}
3151   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-t"}) == 0 || strcmp(arg, \textcolor{stringliteral}{"-tm"}) == 0 ||
3152            strcmp(arg, \textcolor{stringliteral}{"-T"}) == 0 || strcmp(arg, \textcolor{stringliteral}{"-TM"}) == 0)
3153     \{
3154     \textcolor{keywordtype}{int} temp;
3155     \textcolor{keywordtype}{int} both = arg[2] == 0;
3156     showtotaltimes = arg[1] == \textcolor{charliteral}{'T'};
3157     \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc} > 2 && (temp = get\_value((\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op+1], &endptr),
3158                      *endptr == 0))
3159       \{
3160       timeitm = temp;
3161       op++;
3162       \hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc}--;
3163       \}
3164     \textcolor{keywordflow}{else} timeitm = \hyperlink{pcretest_8c_a041831962619cdf9fa8e78b8670099b3}{LOOPREPEAT};
3165     \textcolor{keywordflow}{if} (both) timeit = timeitm;
3166     \}
3167   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-S"}) == 0 && \hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc} > 2 &&
3168       ((stack\_size = get\_value((\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op+1], &endptr)),
3169         *endptr == 0))
3170     \{
3171 \textcolor{preprocessor}{#if defined(\_WIN32) || defined(WIN32) || defined(\_\_minix) || defined(NATIVE\_ZOS) || defined(\_\_VMS)}
3172     printf(\textcolor{stringliteral}{"PCRE: -S not supported on this OS\(\backslash\)n"});
3173     \hyperlink{group__APACHE__OS__NETWARE_gaac7f3a566d7243651a356db3fcfef6b1}{exit}(1);
3174 \textcolor{preprocessor}{#else}
3175     \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
3176     \textcolor{keyword}{struct }rlimit rlim;
3177     getrlimit(RLIMIT\_STACK, &rlim);
3178     rlim.rlim\_cur = stack\_size * 1024 * 1024;
3179     rc = setrlimit(RLIMIT\_STACK, &rlim);
3180     \textcolor{keywordflow}{if} (rc != 0)
3181       \{
3182     printf(\textcolor{stringliteral}{"PCRE: setrlimit() failed with error %d\(\backslash\)n"}, rc);
3183     \hyperlink{group__APACHE__OS__NETWARE_gaac7f3a566d7243651a356db3fcfef6b1}{exit}(1);
3184       \}
3185     op++;
3186     \hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc}--;
3187 \textcolor{preprocessor}{#endif}
3188     \}
3189 \textcolor{preprocessor}{#if !defined NOPOSIX}
3190   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-p"}) == 0) posix = 1;
3191 \textcolor{preprocessor}{#endif}
3192   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-C"}) == 0)
3193     \{
3194     \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
3195     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} lrc;
3196 
3197     \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc} > 2)
3198       \{
3199       \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"linksize"}) == 0)
3200         \{
3201         (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a021a346383e3c6adaf16f7e67224be73}{PCRE\_CONFIG\_LINK\_SIZE}, &rc);
3202         printf(\textcolor{stringliteral}{"%d\(\backslash\)n"}, rc);
3203         yield = \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
3204 
3205 \textcolor{preprocessor}{#ifdef \_\_VMS}
3206         vms\_setsymbol(\textcolor{stringliteral}{"LINKSIZE"},0,yield );
3207 \textcolor{preprocessor}{#endif}
3208         \}
3209       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"pcre8"}) == 0)
3210         \{
3211 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
3212         printf(\textcolor{stringliteral}{"1\(\backslash\)n"});
3213         yield = 1;
3214 \textcolor{preprocessor}{#else}
3215         printf(\textcolor{stringliteral}{"0\(\backslash\)n"});
3216         yield = 0;
3217 \textcolor{preprocessor}{#endif}
3218 \textcolor{preprocessor}{#ifdef \_\_VMS}
3219         vms\_setsymbol(\textcolor{stringliteral}{"PCRE8"},0,yield );
3220 \textcolor{preprocessor}{#endif}
3221         \}
3222       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"pcre16"}) == 0)
3223         \{
3224 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
3225         printf(\textcolor{stringliteral}{"1\(\backslash\)n"});
3226         yield = 1;
3227 \textcolor{preprocessor}{#else}
3228         printf(\textcolor{stringliteral}{"0\(\backslash\)n"});
3229         yield = 0;
3230 \textcolor{preprocessor}{#endif}
3231 \textcolor{preprocessor}{#ifdef \_\_VMS}
3232         vms\_setsymbol(\textcolor{stringliteral}{"PCRE16"},0,yield );
3233 \textcolor{preprocessor}{#endif}
3234         \}
3235       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"pcre32"}) == 0)
3236         \{
3237 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
3238         printf(\textcolor{stringliteral}{"1\(\backslash\)n"});
3239         yield = 1;
3240 \textcolor{preprocessor}{#else}
3241         printf(\textcolor{stringliteral}{"0\(\backslash\)n"});
3242         yield = 0;
3243 \textcolor{preprocessor}{#endif}
3244 \textcolor{preprocessor}{#ifdef \_\_VMS}
3245         vms\_setsymbol(\textcolor{stringliteral}{"PCRE32"},0,yield );
3246 \textcolor{preprocessor}{#endif}
3247         \}
3248       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"utf"}) == 0)
3249         \{
3250 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
3251         \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE})
3252           (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})\hyperlink{pcre_8txt_a51b3560f37fc987a06062d09bbf84ef5}{pcre\_config}(\hyperlink{pcre_8h_ad18c644c262f41db8f031cb56f385489}{PCRE\_CONFIG\_UTF8}, &rc);
3253 \textcolor{preprocessor}{#endif}
3254 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
3255         \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE})
3256           (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})\hyperlink{pcre_8txt_a0175f26f9de7c8de28476c39e5fea2ce}{pcre16\_config}(\hyperlink{pcre_8h_a15e87352e992cb29558c44336e04fc68}{PCRE\_CONFIG\_UTF16}, &rc);
3257 \textcolor{preprocessor}{#endif}
3258 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
3259         \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE})
3260           (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})\hyperlink{pcre_8txt_a21871c70728d856b72c13c38b72e5cd5}{pcre32\_config}(\hyperlink{pcre_8h_a9efdf33e33c6f0dd8beeba4d043c8484}{PCRE\_CONFIG\_UTF32}, &rc);
3261 \textcolor{preprocessor}{#endif}
3262         printf(\textcolor{stringliteral}{"%d\(\backslash\)n"}, rc);
3263         yield = \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
3264 \textcolor{preprocessor}{#ifdef \_\_VMS}
3265         vms\_setsymbol(\textcolor{stringliteral}{"UTF"},0,yield );
3266 \textcolor{preprocessor}{#endif}
3267         \}
3268       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"ucp"}) == 0)
3269         \{
3270         (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a0498601a046ad7249ffd094a4f576ef7}{PCRE\_CONFIG\_UNICODE\_PROPERTIES}, &rc);
3271         printf(\textcolor{stringliteral}{"%d\(\backslash\)n"}, rc);
3272         yield = \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
3273         \}
3274       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"jit"}) == 0)
3275         \{
3276         (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a08c40099fbddb1af4eb0367ef02de04e}{PCRE\_CONFIG\_JIT}, &rc);
3277         printf(\textcolor{stringliteral}{"%d\(\backslash\)n"}, rc);
3278         yield = \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
3279         \}
3280       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"newline"}) == 0)
3281         \{
3282         (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_ac9cd3aaf1d94ff1e846082b3c69b68f0}{PCRE\_CONFIG\_NEWLINE}, &rc);
3283         print\_newline\_config(rc, \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
3284         \}
3285       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"bsr"}) == 0)
3286         \{
3287         (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_aee81a372fe78664fd6a78e04c8fd3eb1}{PCRE\_CONFIG\_BSR}, &rc);
3288         printf(\textcolor{stringliteral}{"%s\(\backslash\)n"}, rc? \textcolor{stringliteral}{"ANYCRLF"} : \textcolor{stringliteral}{"ANY"});
3289         \}
3290       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"ebcdic"}) == 0)
3291         \{
3292 \textcolor{preprocessor}{#ifdef EBCDIC}
3293         printf(\textcolor{stringliteral}{"1\(\backslash\)n"});
3294         yield = 1;
3295 \textcolor{preprocessor}{#else}
3296         printf(\textcolor{stringliteral}{"0\(\backslash\)n"});
3297 \textcolor{preprocessor}{#endif}
3298         \}
3299       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1], \textcolor{stringliteral}{"ebcdic-nl"}) == 0)
3300         \{
3301 \textcolor{preprocessor}{#ifdef EBCDIC}
3302         printf(\textcolor{stringliteral}{"0x%02x\(\backslash\)n"}, \hyperlink{pcre__internal_8h_ab278969e0bc4296056adb7b18aa43227}{CHAR\_LF});
3303 \textcolor{preprocessor}{#else}
3304         printf(\textcolor{stringliteral}{"0\(\backslash\)n"});
3305 \textcolor{preprocessor}{#endif}
3306         \}
3307       \textcolor{keywordflow}{else}
3308         \{
3309         printf(\textcolor{stringliteral}{"Unknown -C option: %s\(\backslash\)n"}, \hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op + 1]);
3310         \}
3311       \textcolor{keywordflow}{goto} EXIT;
3312       \}
3313 
3314     \textcolor{comment}{/* No argument for -C: output all configuration information. */}
3315 
3316     printf(\textcolor{stringliteral}{"PCRE version %s\(\backslash\)n"}, version);
3317     printf(\textcolor{stringliteral}{"Compiled with\(\backslash\)n"});
3318 
3319 \textcolor{preprocessor}{#ifdef EBCDIC}
3320     printf(\textcolor{stringliteral}{"  EBCDIC code support: LF is 0x%02x\(\backslash\)n"}, \hyperlink{pcre__internal_8h_ab278969e0bc4296056adb7b18aa43227}{CHAR\_LF});
3321 \textcolor{preprocessor}{#endif}
3322 
3323 \textcolor{comment}{/* At least one of SUPPORT\_PCRE8 and SUPPORT\_PCRE16 will be set. If both}
3324 \textcolor{comment}{are set, either both UTFs are supported or both are not supported. */}
3325 
3326 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
3327     printf(\textcolor{stringliteral}{"  8-bit support\(\backslash\)n"});
3328     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})\hyperlink{pcre_8txt_a51b3560f37fc987a06062d09bbf84ef5}{pcre\_config}(\hyperlink{pcre_8h_ad18c644c262f41db8f031cb56f385489}{PCRE\_CONFIG\_UTF8}, &rc);
3329       printf (\textcolor{stringliteral}{"  %sUTF-8 support\(\backslash\)n"}, rc ? \textcolor{stringliteral}{""} : \textcolor{stringliteral}{"No "});
3330 \textcolor{preprocessor}{#endif}
3331 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
3332     printf(\textcolor{stringliteral}{"  16-bit support\(\backslash\)n"});
3333     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})\hyperlink{pcre_8txt_a0175f26f9de7c8de28476c39e5fea2ce}{pcre16\_config}(\hyperlink{pcre_8h_a15e87352e992cb29558c44336e04fc68}{PCRE\_CONFIG\_UTF16}, &rc);
3334     printf (\textcolor{stringliteral}{"  %sUTF-16 support\(\backslash\)n"}, rc ? \textcolor{stringliteral}{""} : \textcolor{stringliteral}{"No "});
3335 \textcolor{preprocessor}{#endif}
3336 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
3337     printf(\textcolor{stringliteral}{"  32-bit support\(\backslash\)n"});
3338     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})\hyperlink{pcre_8txt_a21871c70728d856b72c13c38b72e5cd5}{pcre32\_config}(\hyperlink{pcre_8h_a9efdf33e33c6f0dd8beeba4d043c8484}{PCRE\_CONFIG\_UTF32}, &rc);
3339     printf (\textcolor{stringliteral}{"  %sUTF-32 support\(\backslash\)n"}, rc ? \textcolor{stringliteral}{""} : \textcolor{stringliteral}{"No "});
3340 \textcolor{preprocessor}{#endif}
3341 
3342     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a0498601a046ad7249ffd094a4f576ef7}{PCRE\_CONFIG\_UNICODE\_PROPERTIES}, &rc);
3343     printf(\textcolor{stringliteral}{"  %sUnicode properties support\(\backslash\)n"}, rc? \textcolor{stringliteral}{""} : \textcolor{stringliteral}{"No "});
3344     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a08c40099fbddb1af4eb0367ef02de04e}{PCRE\_CONFIG\_JIT}, &rc);
3345     \textcolor{keywordflow}{if} (rc)
3346       \{
3347       \textcolor{keyword}{const} \textcolor{keywordtype}{char} *arch;
3348       (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a0ec94d067429ed5e683c18fe895fa3c9}{PCRE\_CONFIG\_JITTARGET}, (\textcolor{keywordtype}{void} *)(&arch));
3349       printf(\textcolor{stringliteral}{"  Just-in-time compiler support: %s\(\backslash\)n"}, arch);
3350       \}
3351     \textcolor{keywordflow}{else}
3352       printf(\textcolor{stringliteral}{"  No just-in-time compiler support\(\backslash\)n"});
3353     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_ac9cd3aaf1d94ff1e846082b3c69b68f0}{PCRE\_CONFIG\_NEWLINE}, &rc);
3354     print\_newline\_config(rc, \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE});
3355     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_aee81a372fe78664fd6a78e04c8fd3eb1}{PCRE\_CONFIG\_BSR}, &rc);
3356     printf(\textcolor{stringliteral}{"  \(\backslash\)\(\backslash\)R matches %s\(\backslash\)n"}, rc? \textcolor{stringliteral}{"CR, LF, or CRLF only"} :
3357                                      \textcolor{stringliteral}{"all Unicode newlines"});
3358     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a021a346383e3c6adaf16f7e67224be73}{PCRE\_CONFIG\_LINK\_SIZE}, &rc);
3359     printf(\textcolor{stringliteral}{"  Internal link size = %d\(\backslash\)n"}, rc);
3360     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a92a8371791568a85cb1f4a60f1762fcd}{PCRE\_CONFIG\_POSIX\_MALLOC\_THRESHOLD}, &rc);
3361     printf(\textcolor{stringliteral}{"  POSIX malloc threshold = %d\(\backslash\)n"}, rc);
3362     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a901dcb140a6a2f43b780219e92b11727}{PCRE\_CONFIG\_PARENS\_LIMIT}, &lrc);
3363     printf(\textcolor{stringliteral}{"  Parentheses nest limit = %ld\(\backslash\)n"}, lrc);
3364     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a4b5a3d2cc8eca45f8117a90780ce2cea}{PCRE\_CONFIG\_MATCH\_LIMIT}, &lrc);
3365     printf(\textcolor{stringliteral}{"  Default match limit = %ld\(\backslash\)n"}, lrc);
3366     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_a926aa8aa1743fca147e98fbeed4c5e58}{PCRE\_CONFIG\_MATCH\_LIMIT\_RECURSION}, &lrc);
3367     printf(\textcolor{stringliteral}{"  Default recursion depth limit = %ld\(\backslash\)n"}, lrc);
3368     (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_acd39a87d50b7915ea4ff25edcf2df538}{PCRE\_CONFIG\_STACKRECURSE}, &rc);
3369     printf(\textcolor{stringliteral}{"  Match recursion uses %s"}, rc? \textcolor{stringliteral}{"stack"} : \textcolor{stringliteral}{"heap"});
3370     \textcolor{keywordflow}{if} (showstore)
3371       \{
3372       PCRE\_EXEC(stack\_size, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}, -999, -999, 0, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}, 0);
3373       printf(\textcolor{stringliteral}{": %sframe size = %d bytes"}, rc? \textcolor{stringliteral}{"approximate "} : \textcolor{stringliteral}{""}, -stack\_size);
3374       \}
3375     printf(\textcolor{stringliteral}{"\(\backslash\)n"});
3376     \textcolor{keywordflow}{goto} EXIT;
3377     \}
3378   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (strcmp(arg, \textcolor{stringliteral}{"-help"}) == 0 ||
3379            strcmp(arg, \textcolor{stringliteral}{"--help"}) == 0)
3380     \{
3381     \hyperlink{pcre_8txt_aa9cd2818d74f0439394d545925927823}{usage}();
3382     \textcolor{keywordflow}{goto} EXIT;
3383     \}
3384   \textcolor{keywordflow}{else}
3385     \{
3386     BAD\_ARG:
3387     printf(\textcolor{stringliteral}{"** Unknown or malformed option %s\(\backslash\)n"}, arg);
3388     \hyperlink{pcre_8txt_aa9cd2818d74f0439394d545925927823}{usage}();
3389     yield = 1;
3390     \textcolor{keywordflow}{goto} EXIT;
3391     \}
3392   op++;
3393   \hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc}--;
3394   \}
3395 
3396 \textcolor{comment}{/* Get the store for the offsets vector, and remember what it was */}
3397 
3398 size\_offsets\_max = size\_offsets;
3399 offsets = (\textcolor{keywordtype}{int} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(size\_offsets\_max * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
3400 \textcolor{keywordflow}{if} (offsets == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
3401   \{
3402   printf(\textcolor{stringliteral}{"** Failed to get %d bytes of memory for offsets vector\(\backslash\)n"},
3403     (\textcolor{keywordtype}{int})(size\_offsets\_max * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int})));
3404   yield = 1;
3405   \textcolor{keywordflow}{goto} EXIT;
3406   \}
3407 
3408 \textcolor{comment}{/* Sort out the input and output files */}
3409 
3410 \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc} > 1)
3411   \{
3412   infile = fopen(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op], \hyperlink{pcretest_8c_ab4803915bb240af979f73ed9d37ef7d6}{INPUT\_MODE});
3413   \textcolor{keywordflow}{if} (infile == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
3414     \{
3415     printf(\textcolor{stringliteral}{"** Failed to open %s\(\backslash\)n"}, \hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op]);
3416     yield = 1;
3417     \textcolor{keywordflow}{goto} EXIT;
3418     \}
3419   \}
3420 
3421 \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__LISTEN_ga073cc653debb351b563a84ac72c49614}{argc} > 2)
3422   \{
3423   outfile = fopen(\hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op+1], \hyperlink{pcretest_8c_a64de47239f7056b19b66e6a0a4519874}{OUTPUT\_MODE});
3424   \textcolor{keywordflow}{if} (outfile == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
3425     \{
3426     printf(\textcolor{stringliteral}{"** Failed to open %s\(\backslash\)n"}, \hyperlink{group__APACHE__CORE__LISTEN_ga7af4ef3a08f923773e59081c357d9adf}{argv}[op+1]);
3427     yield = 1;
3428     \textcolor{keywordflow}{goto} EXIT;
3429     \}
3430   \}
3431 
3432 \textcolor{comment}{/* Set alternative malloc function */}
3433 
3434 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
3435 \hyperlink{pcre_8txt_a9665af36a113024acabe99f06b795c65}{pcre\_malloc} = new\_malloc;
3436 \hyperlink{pcre_8txt_a66386e89548846d604196dafdf57b0d7}{pcre\_free} = new\_free;
3437 \hyperlink{pcre_8txt_a9925da4b01e0fe2b04af75d8ec8c72cb}{pcre\_stack\_malloc} = stack\_malloc;
3438 \hyperlink{pcre_8txt_abec62c950cd81594f347b110aa986307}{pcre\_stack\_free} = stack\_free;
3439 \textcolor{preprocessor}{#endif}
3440 
3441 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
3442 \hyperlink{pcre_8txt_a12ca028a051bd882da2cbab469d7ef15}{pcre16\_malloc} = new\_malloc;
3443 \hyperlink{pcre_8txt_a314735ae5c886a26bcbd7b79ceed4d45}{pcre16\_free} = new\_free;
3444 \hyperlink{pcre_8txt_ae3f163f89acd2172cc8e24a13e5ac5f7}{pcre16\_stack\_malloc} = stack\_malloc;
3445 \hyperlink{pcre_8txt_a7ef346e2289a58cb84754db4d3b49552}{pcre16\_stack\_free} = stack\_free;
3446 \textcolor{preprocessor}{#endif}
3447 
3448 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
3449 \hyperlink{pcre_8txt_a84d101175b95c79d0acfe920f9921c2c}{pcre32\_malloc} = new\_malloc;
3450 \hyperlink{pcre_8txt_a29f29392f2c99c6f27b4e18b053513f8}{pcre32\_free} = new\_free;
3451 \hyperlink{pcre_8txt_a7464621220fc3f776e1309ac4bcde0f3}{pcre32\_stack\_malloc} = stack\_malloc;
3452 \hyperlink{pcre_8txt_a5558519ab0fb57388f8b476b2d426266}{pcre32\_stack\_free} = stack\_free;
3453 \textcolor{preprocessor}{#endif}
3454 
3455 \textcolor{comment}{/* Heading line unless quiet */}
3456 
3457 \textcolor{keywordflow}{if} (!quiet) fprintf(outfile, \textcolor{stringliteral}{"PCRE version %s\(\backslash\)n\(\backslash\)n"}, version);
3458 
3459 \textcolor{comment}{/* Main loop */}
3460 
3461 \textcolor{keywordflow}{while} (!done)
3462   \{
3463   \hyperlink{structreal__pcre8__or__16}{pcre} *\hyperlink{pcre_8txt_abd134207f74532a8b094676c4a2ca9ed}{re} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
3464   \hyperlink{structpcre__extra}{pcre\_extra} *extra = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
3465 
3466 \textcolor{preprocessor}{#if !defined NOPOSIX  }\textcolor{comment}{/* There are still compilers that require no indent */}\textcolor{preprocessor}{}
3467   \hyperlink{structregex__t}{regex\_t} \hyperlink{ap__regex_8h_a3fe4a7e360fb5b3aa11a2e9bd00b0ed6}{preg} = \{ \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}, 0, 0\} ;
3468   \textcolor{keywordtype}{int} do\_posix = 0;
3469 \textcolor{preprocessor}{#endif}
3470 
3471   \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__PROTO_ga11614f44ef4d939bdd984953346a7572}{error};
3472   \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *markptr;
3473   \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, *pp, *ppp;
3474   \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *to\_file = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
3475   \textcolor{keyword}{const} \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *\hyperlink{pcre_8txt_a0a3ce7ba2875673af4ff52c60636a7cb}{tables} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
3476   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} get\_options;
3477   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} true\_size, true\_study\_size = 0;
3478   \textcolor{keywordtype}{size\_t} \hyperlink{group__APACHE__CORE__CONFIG_ga2bd3edb50f631a96f1b729fde236ff43}{size};
3479   \textcolor{keywordtype}{int} do\_allcaps = 0;
3480   \textcolor{keywordtype}{int} do\_mark = 0;
3481   \textcolor{keywordtype}{int} do\_study = 0;
3482   \textcolor{keywordtype}{int} no\_force\_study = 0;
3483   \textcolor{keywordtype}{int} do\_debug = \hyperlink{mod__macro_8c_a98d74a3e27c3b80effb0134b208bdf2a}{debug};
3484   \textcolor{keywordtype}{int} do\_G = 0;
3485   \textcolor{keywordtype}{int} do\_g = 0;
3486   \textcolor{keywordtype}{int} do\_showinfo = showinfo;
3487   \textcolor{keywordtype}{int} do\_showrest = 0;
3488   \textcolor{keywordtype}{int} do\_showcaprest = 0;
3489   \textcolor{keywordtype}{int} do\_flip = 0;
3490   \textcolor{keywordtype}{int} erroroffset, \hyperlink{group__APACHE__CORE__LOG_gab5a43233d60ef05c5b5bf5cba3d74468}{len}, delimiter, poffset;
3491 
3492 \textcolor{preprocessor}{#if !defined NODFA}
3493   \textcolor{keywordtype}{int} dfa\_matched = 0;
3494 \textcolor{preprocessor}{#endif}
3495 
3496   use\_utf = 0;
3497   debug\_lengths = 1;
3498   SET\_PCRE\_STACK\_GUARD(\hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
3499 
3500   \textcolor{keywordflow}{if} (extend\_inputline(infile, buffer, \textcolor{stringliteral}{"  re> "}) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \textcolor{keywordflow}{break};
3501   \textcolor{keywordflow}{if} (infile != stdin) fprintf(outfile, \textcolor{stringliteral}{"%s"}, (\textcolor{keywordtype}{char} *)buffer);
3502   fflush(outfile);
3503 
3504   p = \hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer};
3505   \textcolor{keywordflow}{while} (isspace(*p)) p++;
3506   \textcolor{keywordflow}{if} (*p == 0) \textcolor{keywordflow}{continue};
3507 
3508   \textcolor{comment}{/* Handle option lock-out setting */}
3509 
3510   \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'<'} && p[1] == \textcolor{charliteral}{' '})
3511     \{
3512     p += 2;
3513     \textcolor{keywordflow}{while} (isspace(*p)) p++;
3514     \textcolor{keywordflow}{if} (strncmp((\textcolor{keywordtype}{char} *)p, \textcolor{stringliteral}{"forbid "}, 7) == 0)
3515       \{
3516       p += 7;
3517       \textcolor{keywordflow}{while} (isspace(*p)) p++;
3518       pp = lockout;
3519       \textcolor{keywordflow}{while} (!isspace(*p) && pp < lockout + \textcolor{keyword}{sizeof}(lockout) - 1)
3520         *pp++ = *p++;
3521       *pp = 0;
3522       \}
3523     \textcolor{keywordflow}{else}
3524       \{
3525       printf(\textcolor{stringliteral}{"** Unrecognized special command '%s'\(\backslash\)n"}, p);
3526       yield = 1;
3527       \textcolor{keywordflow}{goto} EXIT;
3528       \}
3529     \textcolor{keywordflow}{continue};
3530     \}
3531 
3532   \textcolor{comment}{/* See if the pattern is to be loaded pre-compiled from a file. */}
3533 
3534   \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'<'} && strchr((\textcolor{keywordtype}{char} *)(p+1), \textcolor{charliteral}{'<'}) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
3535     \{
3536     pcre\_uint32 \hyperlink{mod__mime__magic_8c_adcacf12060e89bfe0610c798e2fdc459}{magic};
3537     \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} sbuf[8];
3538     FILE *\hyperlink{group__APACHE__CORE__DAEMON_ga588c778c1c1509e472f22dc36efb005e}{f};
3539 
3540     p++;
3541     \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'!'})
3542       \{
3543       do\_debug = \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
3544       do\_showinfo = \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
3545       p++;
3546       \}
3547 
3548     pp = p + (\hyperlink{group__MOD__WATCHDOG_gaf0b5a943e734de7ea24142e2c81d82ef}{int})strlen((\textcolor{keywordtype}{char} *)p);
3549     \hyperlink{util__expr__scan_8c_a8fdafe3be7e00ce3d4f0cb50a9a5eb39}{while} (isspace(pp[-1])) pp--;
3550     *pp = 0;
3551 
3552     f = fopen((\textcolor{keywordtype}{char} *)p, "rb");
3553     \hyperlink{util__expr__scan_8c_a33e91cd0cef6786e9e3a27ac67707207}{if} (f == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
3554       \{
3555       fprintf(outfile, \textcolor{stringliteral}{"Failed to open %s: %s\(\backslash\)n"}, p, \hyperlink{pcretest_8c_a5d6ffddd86bd0d0ead58247b1a80e486}{strerror}(errno));
3556       \textcolor{keywordflow}{continue};
3557       \}
3558     \textcolor{keywordflow}{if} (fread(sbuf, 1, 8, f) != 8) \textcolor{keywordflow}{goto} FAIL\_READ;
3559 
3560     true\_size =
3561       (sbuf[0] << 24) | (sbuf[1] << 16) | (sbuf[2] << 8) | sbuf[3];
3562     true\_study\_size =
3563       (sbuf[4] << 24) | (sbuf[5] << 16) | (sbuf[6] << 8) | sbuf[7];
3564 
3565     re = (\hyperlink{structreal__pcre8__or__16}{pcre} *)new\_malloc(true\_size);
3566     \textcolor{keywordflow}{if} (re == NULL)
3567       \{
3568       printf(\textcolor{stringliteral}{"** Failed to get %d bytes of memory for pcre object\(\backslash\)n"},
3569         (\textcolor{keywordtype}{int})true\_size);
3570       yield = 1;
3571       \textcolor{keywordflow}{goto} EXIT;
3572       \}
3573     \textcolor{keywordflow}{if} (fread(re, 1, true\_size, f) != true\_size) \textcolor{keywordflow}{goto} FAIL\_READ;
3574 
3575     magic = \hyperlink{pcre__internal_8h_a45bd9fd7ea390b22f3510077d33acf42}{REAL\_PCRE\_MAGIC}(re);
3576     \textcolor{keywordflow}{if} (magic != \hyperlink{pcre__internal_8h_a54061e5993a5517320d425f44408cc86}{MAGIC\_NUMBER})
3577       \{
3578       \textcolor{keywordflow}{if} (swap\_uint32(magic) == \hyperlink{pcre__internal_8h_a54061e5993a5517320d425f44408cc86}{MAGIC\_NUMBER})
3579         \{
3580         do\_flip = 1;
3581         \}
3582       \textcolor{keywordflow}{else}
3583         \{
3584         fprintf(outfile, \textcolor{stringliteral}{"Data in %s is not a compiled PCRE regex\(\backslash\)n"}, p);
3585         new\_free(re);
3586         fclose(f);
3587         \textcolor{keywordflow}{continue};
3588         \}
3589       \}
3590 
3591     \textcolor{comment}{/* We hide the byte-invert info for little and big endian tests. */}
3592     fprintf(outfile, \textcolor{stringliteral}{"Compiled pattern%s loaded from %s\(\backslash\)n"},
3593       do\_flip && (p[-1] == \textcolor{charliteral}{'<'}) ? \textcolor{stringliteral}{" (byte-inverted)"} : \textcolor{stringliteral}{""}, p);
3594 
3595     \textcolor{comment}{/* Now see if there is any following study data. */}
3596 
3597     \textcolor{keywordflow}{if} (true\_study\_size != 0)
3598       \{
3599       \hyperlink{structpcre__study__data}{pcre\_study\_data} *psd;
3600 
3601       extra = (\hyperlink{structpcre__extra}{pcre\_extra} *)new\_malloc(\textcolor{keyword}{sizeof}(\hyperlink{structpcre__extra}{pcre\_extra}) + true\_study\_size);
3602       extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} = \hyperlink{pcre_8h_a2349a3ef318b1472ea1e862dea0e5d5f}{PCRE\_EXTRA\_STUDY\_DATA};
3603 
3604       psd = (\hyperlink{structpcre__study__data}{pcre\_study\_data} *)(((\textcolor{keywordtype}{char} *)extra) + \textcolor{keyword}{sizeof}(
      \hyperlink{structpcre__extra}{pcre\_extra}));
3605       extra->\hyperlink{structpcre__extra_a27f29bdf9c4526d5bb3fb8ee514ee8e8}{study\_data} = psd;
3606 
3607       \textcolor{keywordflow}{if} (fread(psd, 1, true\_study\_size, f) != true\_study\_size)
3608         \{
3609         FAIL\_READ:
3610         fprintf(outfile, \textcolor{stringliteral}{"Failed to read data from %s\(\backslash\)n"}, p);
3611         \textcolor{keywordflow}{if} (extra != NULL)
3612           \{
3613           PCRE\_FREE\_STUDY(extra);
3614           \}
3615         new\_free(re);
3616         fclose(f);
3617         \textcolor{keywordflow}{continue};
3618         \}
3619       fprintf(outfile, \textcolor{stringliteral}{"Study data loaded from %s\(\backslash\)n"}, p);
3620       do\_study = 1;     \textcolor{comment}{/* To get the data output if requested */}
3621       \}
3622     \textcolor{keywordflow}{else} fprintf(outfile, \textcolor{stringliteral}{"No study data\(\backslash\)n"});
3623 
3624     \textcolor{comment}{/* Flip the necessary bytes. */}
3625     \textcolor{keywordflow}{if} (do\_flip)
3626       \{
3627       \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
3628       PCRE\_PATTERN\_TO\_HOST\_BYTE\_ORDER(rc, re, extra, NULL);
3629       \textcolor{keywordflow}{if} (rc == \hyperlink{pcre_8h_a1a3d95e2973925e87be01c3d1f9d2ebd}{PCRE\_ERROR\_BADMODE})
3630         \{
3631         pcre\_uint32 flags\_in\_host\_byte\_order;
3632         \textcolor{keywordflow}{if} (\hyperlink{pcre__internal_8h_a45bd9fd7ea390b22f3510077d33acf42}{REAL\_PCRE\_MAGIC}(re) == \hyperlink{pcre__internal_8h_a54061e5993a5517320d425f44408cc86}{MAGIC\_NUMBER})
3633           flags\_in\_host\_byte\_order = \hyperlink{pcre__internal_8h_aff96469bb3f21861d4c96281d712e1bd}{REAL\_PCRE\_FLAGS}(re);
3634         \textcolor{keywordflow}{else}
3635           flags\_in\_host\_byte\_order = swap\_uint32(\hyperlink{pcre__internal_8h_aff96469bb3f21861d4c96281d712e1bd}{REAL\_PCRE\_FLAGS}(re));
3636         \textcolor{comment}{/* Simulate the result of the function call below. */}
3637         fprintf(outfile, \textcolor{stringliteral}{"Error %d from pcre%s\_fullinfo(%d)\(\backslash\)n"}, rc,
3638           pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE} ? \textcolor{stringliteral}{"32"} : pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE} ? \textcolor{stringliteral}{"16"} : \textcolor{stringliteral}{""},
3639           \hyperlink{pcre_8h_a0e76bf1b51c1f8ab9dfd41981244e77e}{PCRE\_INFO\_OPTIONS});
3640         fprintf(outfile, \textcolor{stringliteral}{"Running in %d-bit mode but pattern was compiled in "}
3641           \textcolor{stringliteral}{"%d-bit mode\(\backslash\)n"}, 8 * CHAR\_SIZE, 8 * (flags\_in\_host\_byte\_order & 
      \hyperlink{pcre__internal_8h_aaea4e8524c01495cccd0382b560c8fea}{PCRE\_MODE\_MASK}));
3642         new\_free(re);
3643         fclose(f);
3644         \textcolor{keywordflow}{continue};
3645         \}
3646       \}
3647 
3648     \textcolor{comment}{/* Need to know if UTF-8 for printing data strings. */}
3649 
3650     \textcolor{keywordflow}{if} (new\_info(re, NULL, \hyperlink{pcre_8h_a0e76bf1b51c1f8ab9dfd41981244e77e}{PCRE\_INFO\_OPTIONS}, &get\_options) < 0)
3651       \{
3652       new\_free(re);
3653       fclose(f);
3654       \textcolor{keywordflow}{continue};
3655       \}
3656     use\_utf = (get\_options & \hyperlink{pcre_8h_a177ec66f9b06aab7b37965b77b2cf1b8}{PCRE\_UTF8}) != 0;
3657 
3658     fclose(f);
3659     \textcolor{keywordflow}{goto} SHOW\_INFO;
3660     \}
3661 
3662   \textcolor{comment}{/* In-line pattern (the usual case). Get the delimiter and seek the end of}
3663 \textcolor{comment}{  the pattern; if it isn't complete, read more. */}
3664 
3665   delimiter = *p++;
3666 
3667   \textcolor{keywordflow}{if} (\hyperlink{README_8txt_a25d7dd05239df8ce57a8921c43397d07}{isalnum}(delimiter) || delimiter == \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'})
3668     \{
3669     fprintf(outfile, \textcolor{stringliteral}{"** Delimiter must not be alphanumeric or \(\backslash\)\(\backslash\)\(\backslash\)n"});
3670     \textcolor{keywordflow}{goto} SKIP\_DATA;
3671     \}
3672 
3673   pp = \hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p};
3674   poffset = (\hyperlink{group__MOD__WATCHDOG_gaf0b5a943e734de7ea24142e2c81d82ef}{int})(p - buffer);
3675 
3676   \textcolor{keywordflow}{for}(;;)
3677     \{
3678     \textcolor{keywordflow}{while} (*pp != 0)
3679       \{
3680       \textcolor{keywordflow}{if} (*pp == \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'} && pp[1] != 0) pp++;
3681         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*pp == delimiter) \textcolor{keywordflow}{break};
3682       pp++;
3683       \}
3684     \textcolor{keywordflow}{if} (*pp != 0) \textcolor{keywordflow}{break};
3685     \textcolor{keywordflow}{if} ((pp = extend\_inputline(infile, pp, \textcolor{stringliteral}{"    > "})) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
3686       \{
3687       fprintf(outfile, \textcolor{stringliteral}{"** Unexpected EOF\(\backslash\)n"});
3688       done = 1;
3689       \textcolor{keywordflow}{goto} CONTINUE;
3690       \}
3691     \textcolor{keywordflow}{if} (infile != stdin) fprintf(outfile, \textcolor{stringliteral}{"%s"}, (\textcolor{keywordtype}{char} *)pp);
3692     \}
3693 
3694   \textcolor{comment}{/* The buffer may have moved while being extended; reset the start of data}
3695 \textcolor{comment}{  pointer to the correct relative point in the buffer. */}
3696 
3697   p = \hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer} + poffset;
3698 
3699   \textcolor{comment}{/* If the first character after the delimiter is backslash, make}
3700 \textcolor{comment}{  the pattern end with backslash. This is purely to provide a way}
3701 \textcolor{comment}{  of testing for the error message when a pattern ends with backslash. */}
3702 
3703   \textcolor{keywordflow}{if} (pp[1] == \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'}) *pp++ = \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'};
3704 
3705   \textcolor{comment}{/* Terminate the pattern at the delimiter, and save a copy of the pattern}
3706 \textcolor{comment}{  for callouts. */}
3707 
3708   *pp++ = 0;
3709   strcpy((\textcolor{keywordtype}{char} *)pbuffer, (\textcolor{keywordtype}{char} *)p);
3710 
3711   \textcolor{comment}{/* Look for modifiers and options after the final delimiter. */}
3712 
3713   options = default\_options;
3714   study\_options = force\_study\_options;
3715   log\_store = showstore;  \textcolor{comment}{/* default from command line */}
3716 
3717   \textcolor{keywordflow}{while} (*pp != 0)
3718     \{
3719     \textcolor{comment}{/* Check to see whether this modifier has been locked out for this file.}
3720 \textcolor{comment}{    This is complicated for the multi-character options that begin with '<'.}
3721 \textcolor{comment}{    If there is no '>' in the lockout string, all multi-character modifiers are}
3722 \textcolor{comment}{    locked out. */}
3723 
3724     \textcolor{keywordflow}{if} (strchr((\textcolor{keywordtype}{char} *)lockout, *pp) != NULL)
3725       \{
3726       \textcolor{keywordflow}{if} (*pp == \textcolor{charliteral}{'<'} && strchr((\textcolor{keywordtype}{char} *)lockout, \textcolor{charliteral}{'>'}) != NULL)
3727         \{
3728         \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_gaa51afdb6d96b938b938dc9439be201be}{x} = check\_mc\_option(pp+1, outfile, \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"modifier"});
3729         \textcolor{keywordflow}{if} (x == 0) \textcolor{keywordflow}{goto} SKIP\_DATA;
3730 
3731         \textcolor{keywordflow}{for} (ppp = lockout; *ppp != 0; ppp++)
3732           \{
3733           \textcolor{keywordflow}{if} (*ppp == \textcolor{charliteral}{'<'})
3734             \{
3735             \textcolor{keywordtype}{int} \hyperlink{group__MOD__CACHE_gad4d47f76a849e2c428e3dd7f8c4eab1f}{y} = check\_mc\_option(ppp+1, outfile, \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"modifier"});
3736             \textcolor{keywordflow}{if} (y == 0)
3737               \{
3738               printf(\textcolor{stringliteral}{"** Error in modifier forbid data - giving up.\(\backslash\)n"});
3739               yield = 1;
3740               \textcolor{keywordflow}{goto} EXIT;
3741               \}
3742             \textcolor{keywordflow}{if} (x == y)
3743               \{
3744               ppp = pp;
3745               \textcolor{keywordflow}{while} (*ppp != \textcolor{charliteral}{'>'}) ppp++;
3746               printf(\textcolor{stringliteral}{"** The %.*s modifier is locked out - giving up.\(\backslash\)n"},
3747                 (\textcolor{keywordtype}{int})(ppp - pp + 1), pp);
3748               yield = 1;
3749               \textcolor{keywordflow}{goto} EXIT;
3750               \}
3751             \}
3752           \}
3753         \}
3754 
3755       \textcolor{comment}{/* The single-character modifiers are straightforward. */}
3756 
3757       \textcolor{keywordflow}{else}
3758         \{
3759         printf(\textcolor{stringliteral}{"** The /%c modifier is locked out - giving up.\(\backslash\)n"}, *pp);
3760         yield = 1;
3761         \textcolor{keywordflow}{goto} EXIT;
3762         \}
3763       \}
3764 
3765     \textcolor{comment}{/* The modifier is not locked out; handle it. */}
3766 
3767     \textcolor{keywordflow}{switch} (*pp++)
3768       \{
3769       \textcolor{keywordflow}{case} \textcolor{charliteral}{'f'}: options |= \hyperlink{pcre_8h_a13e0d654eca35f3e6ef806d5f51feab1}{PCRE\_FIRSTLINE}; \textcolor{keywordflow}{break};
3770       \textcolor{keywordflow}{case} \textcolor{charliteral}{'g'}: do\_g = 1; \textcolor{keywordflow}{break};
3771       \textcolor{keywordflow}{case} \textcolor{charliteral}{'i'}: options |= \hyperlink{pcretest_8txt_afe078dbdccac820dbb524b1eb5c1a30c}{PCRE\_CASELESS}; \textcolor{keywordflow}{break};
3772       \textcolor{keywordflow}{case} \textcolor{charliteral}{'m'}: options |= \hyperlink{pcretest_8txt_a1d819abc0ef0512f286b7ce5cb2ab208}{PCRE\_MULTILINE}; \textcolor{keywordflow}{break};
3773       \textcolor{keywordflow}{case} \textcolor{charliteral}{'s'}: options |= \hyperlink{pcretest_8txt_abdfb17946dde0544aade3b2b3c333e3e}{PCRE\_DOTALL}; \textcolor{keywordflow}{break};
3774       \textcolor{keywordflow}{case} \textcolor{charliteral}{'x'}: options |= \hyperlink{pcre_8h_a24c767567bde49a4ebdc33783ae2c914}{PCRE\_EXTENDED}; \textcolor{keywordflow}{break};
3775 
3776       \textcolor{keywordflow}{case} \textcolor{charliteral}{'+'}:
3777       \textcolor{keywordflow}{if} (do\_showrest) do\_showcaprest = 1; \textcolor{keywordflow}{else} do\_showrest = 1;
3778       \textcolor{keywordflow}{break};
3779 
3780       \textcolor{keywordflow}{case} \textcolor{charliteral}{'='}: do\_allcaps = 1; \textcolor{keywordflow}{break};
3781       \textcolor{keywordflow}{case} \textcolor{charliteral}{'A'}: options |= \hyperlink{pcre_8txt_a1a82c471ce7b7648a6bd5345a8514998}{PCRE\_ANCHORED}; \textcolor{keywordflow}{break};
3782       \textcolor{keywordflow}{case} \textcolor{charliteral}{'B'}: do\_debug = 1; \textcolor{keywordflow}{break};
3783       \textcolor{keywordflow}{case} \textcolor{charliteral}{'C'}: options |= \hyperlink{pcre_8h_a35ee92b3d85086e3b978e268be40a25a}{PCRE\_AUTO\_CALLOUT}; \textcolor{keywordflow}{break};
3784       \textcolor{keywordflow}{case} \textcolor{charliteral}{'D'}: do\_debug = do\_showinfo = 1; \textcolor{keywordflow}{break};
3785       \textcolor{keywordflow}{case} \textcolor{charliteral}{'E'}: options |= \hyperlink{pcre_8h_ad65038ad88e46214044c98dc052cf77b}{PCRE\_DOLLAR\_ENDONLY}; \textcolor{keywordflow}{break};
3786       \textcolor{keywordflow}{case} \textcolor{charliteral}{'F'}: do\_flip = 1; \textcolor{keywordflow}{break};
3787       \textcolor{keywordflow}{case} \textcolor{charliteral}{'G'}: do\_G = 1; \textcolor{keywordflow}{break};
3788       \textcolor{keywordflow}{case} \textcolor{charliteral}{'I'}: do\_showinfo = 1; \textcolor{keywordflow}{break};
3789       \textcolor{keywordflow}{case} \textcolor{charliteral}{'J'}: options |= \hyperlink{pcre_8h_ac200fe10b745df0961d1f1801266ace1}{PCRE\_DUPNAMES}; \textcolor{keywordflow}{break};
3790       \textcolor{keywordflow}{case} \textcolor{charliteral}{'K'}: do\_mark = 1; \textcolor{keywordflow}{break};
3791       \textcolor{keywordflow}{case} \textcolor{charliteral}{'M'}: log\_store = 1; \textcolor{keywordflow}{break};
3792       \textcolor{keywordflow}{case} \textcolor{charliteral}{'N'}: options |= \hyperlink{pcre_8h_a89eae5b0859fda718d6924e2548c0039}{PCRE\_NO\_AUTO\_CAPTURE}; \textcolor{keywordflow}{break};
3793       \textcolor{keywordflow}{case} \textcolor{charliteral}{'O'}: options |= \hyperlink{pcre_8h_afa6c9234aa7d3ee12748375fe4204c56}{PCRE\_NO\_AUTO\_POSSESS}; \textcolor{keywordflow}{break};
3794 
3795 \textcolor{preprocessor}{#if !defined NOPOSIX}
3796       \textcolor{keywordflow}{case} \textcolor{charliteral}{'P'}: do\_posix = 1; \textcolor{keywordflow}{break};
3797 \textcolor{preprocessor}{#endif}
3798 
3799       \textcolor{keywordflow}{case} \textcolor{charliteral}{'Q'}:
3800       \textcolor{keywordflow}{switch} (*pp)
3801         \{
3802         \textcolor{keywordflow}{case} \textcolor{charliteral}{'0'}:
3803         \textcolor{keywordflow}{case} \textcolor{charliteral}{'1'}:
3804         stack\_guard\_return = *pp++ - \textcolor{charliteral}{'0'};
3805         \textcolor{keywordflow}{break};
3806 
3807         \textcolor{keywordflow}{default}:
3808         fprintf(outfile, \textcolor{stringliteral}{"** Missing 0 or 1 after /Q\(\backslash\)n"});
3809         \textcolor{keywordflow}{goto} SKIP\_DATA;
3810         \}
3811       SET\_PCRE\_STACK\_GUARD(stack\_guard);
3812       \textcolor{keywordflow}{break};
3813 
3814       \textcolor{keywordflow}{case} \textcolor{charliteral}{'S'}:
3815       do\_study = 1;
3816       \textcolor{keywordflow}{for} (;;)
3817         \{
3818         \textcolor{keywordflow}{switch} (*pp++)
3819           \{
3820           \textcolor{keywordflow}{case} \textcolor{charliteral}{'S'}:
3821           do\_study = 0;
3822           no\_force\_study = 1;
3823           \textcolor{keywordflow}{break};
3824 
3825           \textcolor{keywordflow}{case} \textcolor{charliteral}{'!'}:
3826           study\_options |= \hyperlink{pcre_8h_a0e994164f895575ba3ec61ef8af4c8e1}{PCRE\_STUDY\_EXTRA\_NEEDED};
3827           \textcolor{keywordflow}{break};
3828 
3829           \textcolor{keywordflow}{case} \textcolor{charliteral}{'+'}:
3830           \textcolor{keywordflow}{if} (*pp == \textcolor{charliteral}{'+'})
3831             \{
3832             verify\_jit = \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
3833             pp++;
3834             \}
3835           \textcolor{keywordflow}{if} (*pp >= \textcolor{charliteral}{'1'} && *pp <= \textcolor{charliteral}{'7'})
3836             study\_options |= jit\_study\_bits[*pp++ - \textcolor{charliteral}{'1'}];
3837           \textcolor{keywordflow}{else}
3838             study\_options |= jit\_study\_bits[6];
3839           \textcolor{keywordflow}{break};
3840 
3841           \textcolor{keywordflow}{case} \textcolor{charliteral}{'-'}:
3842           study\_options &= ~\hyperlink{pcretest_8c_a37560c659003ee72d0641168690f89ed}{PCRE\_STUDY\_ALLJIT};
3843           \textcolor{keywordflow}{break};
3844 
3845           \textcolor{keywordflow}{default}:
3846           pp--;
3847           \textcolor{keywordflow}{goto} ENDLOOP;
3848           \}
3849         \}
3850       ENDLOOP:
3851       \textcolor{keywordflow}{break};
3852 
3853       \textcolor{keywordflow}{case} \textcolor{charliteral}{'U'}: options |= \hyperlink{pcre_8h_afe50a7c890619904dd88d86af5621337}{PCRE\_UNGREEDY}; \textcolor{keywordflow}{break};
3854       \textcolor{keywordflow}{case} \textcolor{charliteral}{'W'}: options |= \hyperlink{pcre_8h_aa5e5c6edd5e61d07f9bc9127a6868402}{PCRE\_UCP}; \textcolor{keywordflow}{break};
3855       \textcolor{keywordflow}{case} \textcolor{charliteral}{'X'}: options |= \hyperlink{pcre_8h_ae356b5a19de6096863c0b9e39e74b92b}{PCRE\_EXTRA}; \textcolor{keywordflow}{break};
3856       \textcolor{keywordflow}{case} \textcolor{charliteral}{'Y'}: options |= \hyperlink{pcre_8h_a86ef6d7afec75d6477291e97516e753f}{PCRE\_NO\_START\_OPTIMISE}; \textcolor{keywordflow}{break};
3857       \textcolor{keywordflow}{case} \textcolor{charliteral}{'Z'}: debug\_lengths = 0; \textcolor{keywordflow}{break};
3858       \textcolor{keywordflow}{case} \textcolor{charliteral}{'8'}: options |= \hyperlink{pcre_8h_a177ec66f9b06aab7b37965b77b2cf1b8}{PCRE\_UTF8}; use\_utf = 1; \textcolor{keywordflow}{break};
3859       \textcolor{keywordflow}{case} \textcolor{charliteral}{'9'}: options |= \hyperlink{pcretest_8txt_af7acf96473f289539cac56c4c84c10f1}{PCRE\_NEVER\_UTF}; \textcolor{keywordflow}{break};
3860       \textcolor{keywordflow}{case} \textcolor{charliteral}{'?'}: options |= \hyperlink{pcre_8txt_af9448f2501d79b862273e02c0c326f7d}{PCRE\_NO\_UTF8\_CHECK}; \textcolor{keywordflow}{break};
3861 
3862       \textcolor{keywordflow}{case} \textcolor{charliteral}{'T'}:
3863       \textcolor{keywordflow}{switch} (*pp++)
3864         \{
3865         \textcolor{keywordflow}{case} \textcolor{charliteral}{'0'}: tables = tables0; \textcolor{keywordflow}{break};
3866         \textcolor{keywordflow}{case} \textcolor{charliteral}{'1'}: tables = tables1; \textcolor{keywordflow}{break};
3867 
3868         \textcolor{keywordflow}{case} \textcolor{charliteral}{'\(\backslash\)r'}:
3869         \textcolor{keywordflow}{case} \textcolor{charliteral}{'\(\backslash\)n'}:
3870         \textcolor{keywordflow}{case} \textcolor{charliteral}{' '}:
3871         \textcolor{keywordflow}{case} 0:
3872         fprintf(outfile, \textcolor{stringliteral}{"** Missing table number after /T\(\backslash\)n"});
3873         \textcolor{keywordflow}{goto} SKIP\_DATA;
3874 
3875         \textcolor{keywordflow}{default}:
3876         fprintf(outfile, \textcolor{stringliteral}{"** Bad table number \(\backslash\)"%c\(\backslash\)" after /T\(\backslash\)n"}, pp[-1]);
3877         \textcolor{keywordflow}{goto} SKIP\_DATA;
3878         \}
3879       \textcolor{keywordflow}{break};
3880 
3881       \textcolor{keywordflow}{case} \textcolor{charliteral}{'L'}:
3882       ppp = pp;
3883       \textcolor{comment}{/* The '\(\backslash\)r' test here is so that it works on Windows. */}
3884       \textcolor{comment}{/* The '0' test is just in case this is an unterminated line. */}
3885       \textcolor{keywordflow}{while} (*ppp != 0 && *ppp != \textcolor{charliteral}{'\(\backslash\)n'} && *ppp != \textcolor{charliteral}{'\(\backslash\)r'} && *ppp != \textcolor{charliteral}{' '}) ppp++;
3886       *ppp = 0;
3887       \textcolor{keywordflow}{if} (setlocale(LC\_CTYPE, (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *)pp) == NULL)
3888         \{
3889         fprintf(outfile, \textcolor{stringliteral}{"** Failed to set locale \(\backslash\)"%s\(\backslash\)"\(\backslash\)n"}, pp);
3890         \textcolor{keywordflow}{goto} SKIP\_DATA;
3891         \}
3892       locale\_set = 1;
3893       tables = PCRE\_MAKETABLES;
3894       pp = ppp;
3895       \textcolor{keywordflow}{break};
3896 
3897       \textcolor{keywordflow}{case} \textcolor{charliteral}{'>'}:
3898       to\_file = pp;
3899       \textcolor{keywordflow}{while} (*pp != 0) pp++;
3900       \textcolor{keywordflow}{while} (isspace(pp[-1])) pp--;
3901       *pp = 0;
3902       \textcolor{keywordflow}{break};
3903 
3904       \textcolor{keywordflow}{case} \textcolor{charliteral}{'<'}:
3905         \{
3906         \textcolor{keywordtype}{int} x = check\_mc\_option(pp, outfile, \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE}, \textcolor{stringliteral}{"modifier"});
3907         \textcolor{keywordflow}{if} (x == 0) \textcolor{keywordflow}{goto} SKIP\_DATA;
3908         options |= \hyperlink{group__MOD__PROXY_gaa51afdb6d96b938b938dc9439be201be}{x};
3909         \textcolor{keywordflow}{while} (*pp++ != \textcolor{charliteral}{'>'});
3910         \}
3911       \textcolor{keywordflow}{break};
3912 
3913       \textcolor{keywordflow}{case} \textcolor{charliteral}{'\(\backslash\)r'}:                      \textcolor{comment}{/* So that it works in Windows */}
3914       \textcolor{keywordflow}{case} \textcolor{charliteral}{'\(\backslash\)n'}:
3915       \textcolor{keywordflow}{case} \textcolor{charliteral}{' '}:
3916       \textcolor{keywordflow}{break};
3917 
3918       \textcolor{keywordflow}{default}:
3919       fprintf(outfile, \textcolor{stringliteral}{"** Unknown modifier '%c'\(\backslash\)n"}, pp[-1]);
3920       \textcolor{keywordflow}{goto} SKIP\_DATA;
3921       \}
3922     \}
3923 
3924   \textcolor{comment}{/* Handle compiling via the POSIX interface, which doesn't support the}
3925 \textcolor{comment}{  timing, showing, or debugging options, nor the ability to pass over}
3926 \textcolor{comment}{  local character tables. Neither does it have 16-bit support. */}
3927 
3928 \textcolor{preprocessor}{#if !defined NOPOSIX}
3929   \textcolor{keywordflow}{if} (posix || do\_posix)
3930     \{
3931     \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
3932     \textcolor{keywordtype}{int} \hyperlink{ap__regex_8h_a3defcfc322adaa47f01e20261c7483ff}{cflags} = 0;
3933 
3934     \textcolor{keywordflow}{if} ((options & \hyperlink{pcretest_8txt_afe078dbdccac820dbb524b1eb5c1a30c}{PCRE\_CASELESS}) != 0) cflags |= \hyperlink{pcreposix_8h_a0c3e7b1d5bc9c2d278a544fe9b61b67a}{REG\_ICASE};
3935     \textcolor{keywordflow}{if} ((options & \hyperlink{pcretest_8txt_a1d819abc0ef0512f286b7ce5cb2ab208}{PCRE\_MULTILINE}) != 0) cflags |= \hyperlink{pcreposix_8h_ab678ef3b27bf7de2fb82c79cb2cd9d8a}{REG\_NEWLINE};
3936     \textcolor{keywordflow}{if} ((options & \hyperlink{pcretest_8txt_abdfb17946dde0544aade3b2b3c333e3e}{PCRE\_DOTALL}) != 0) cflags |= \hyperlink{pcreposix_8h_afaf44d80c708ae3deffaeeda14ff5637}{REG\_DOTALL};
3937     \textcolor{keywordflow}{if} ((options & \hyperlink{pcre_8h_a89eae5b0859fda718d6924e2548c0039}{PCRE\_NO\_AUTO\_CAPTURE}) != 0) cflags |= 
      \hyperlink{pcreposix_8h_abb835c7fe6f1673fc0efeff0064510ab}{REG\_NOSUB};
3938     \textcolor{keywordflow}{if} ((options & \hyperlink{pcre_8h_a177ec66f9b06aab7b37965b77b2cf1b8}{PCRE\_UTF8}) != 0) cflags |= \hyperlink{pcreposix_8h_a8c1205d34d63255d71ad98d297867cf8}{REG\_UTF8};
3939     \textcolor{keywordflow}{if} ((options & \hyperlink{pcre_8h_aa5e5c6edd5e61d07f9bc9127a6868402}{PCRE\_UCP}) != 0) cflags |= \hyperlink{pcreposix_8h_af6bee5ae43d2bd3da47bb73453a4c7e6}{REG\_UCP};
3940     \textcolor{keywordflow}{if} ((options & \hyperlink{pcre_8h_afe50a7c890619904dd88d86af5621337}{PCRE\_UNGREEDY}) != 0) cflags |= \hyperlink{pcreposix_8h_ae38b15387ce5f73d486ddecc66af02dc}{REG\_UNGREEDY};
3941 
3942     rc = \hyperlink{pcreposix_8c_a3ba85b868e843e308c46ae0627793b14}{regcomp}(&preg, (\textcolor{keywordtype}{char} *)p, cflags);
3943 
3944     \textcolor{comment}{/* Compilation failed; go back for another re, skipping to blank line}
3945 \textcolor{comment}{    if non-interactive. */}
3946 
3947     \textcolor{keywordflow}{if} (rc != 0)
3948       \{
3949       (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})\hyperlink{pcreposix_8c_a70dcfd4affaf92e8fc8ec9b89e054e49}{regerror}(rc, &preg, (\textcolor{keywordtype}{char} *)\hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer}, buffer\_size);
3950       fprintf(outfile, \textcolor{stringliteral}{"Failed: POSIX code %d: %s\(\backslash\)n"}, rc, buffer);
3951       \textcolor{keywordflow}{goto} SKIP\_DATA;
3952       \}
3953     \}
3954 
3955   \textcolor{comment}{/* Handle compiling via the native interface */}
3956 
3957   \textcolor{keywordflow}{else}
3958 \textcolor{preprocessor}{#endif  }\textcolor{comment}{/* !defined NOPOSIX */}\textcolor{preprocessor}{}
3959 
3960     \{
3961     \textcolor{comment}{/* In 16- or 32-bit mode, convert the input. */}
3962 
3963 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
3964     \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE})
3965       \{
3966       \textcolor{keywordflow}{switch}(to16(\hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE}, p, options & PCRE\_UTF8, (\textcolor{keywordtype}{int})strlen((\textcolor{keywordtype}{char} *)p)))
3967         \{
3968         \textcolor{keywordflow}{case} -1:
3969         fprintf(outfile, \textcolor{stringliteral}{"**Failed: invalid UTF-8 string cannot be "}
3970           \textcolor{stringliteral}{"converted to UTF-16\(\backslash\)n"});
3971         \textcolor{keywordflow}{goto} SKIP\_DATA;
3972 
3973         \textcolor{keywordflow}{case} -2:
3974         fprintf(outfile, \textcolor{stringliteral}{"**Failed: character value greater than 0x10ffff "}
3975           \textcolor{stringliteral}{"cannot be converted to UTF-16\(\backslash\)n"});
3976         \textcolor{keywordflow}{goto} SKIP\_DATA;
3977 
3978         \textcolor{keywordflow}{case} -3: \textcolor{comment}{/* "Impossible error" when to16 is called arg1 FALSE */}
3979         fprintf(outfile, \textcolor{stringliteral}{"**Failed: character value greater than 0xffff "}
3980           \textcolor{stringliteral}{"cannot be converted to 16-bit in non-UTF mode\(\backslash\)n"});
3981         \textcolor{keywordflow}{goto} SKIP\_DATA;
3982 
3983         \textcolor{keywordflow}{default}:
3984         \textcolor{keywordflow}{break};
3985         \}
3986       p = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)buffer16;
3987       \}
3988 \textcolor{preprocessor}{#endif}
3989 
3990 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
3991     \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE})
3992       \{
3993       \textcolor{keywordflow}{switch}(to32(\hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE}, p, options & \hyperlink{pcre_8h_a1e21d4d3b39559da9313ca1d4908001b}{PCRE\_UTF32}, (\textcolor{keywordtype}{int})strlen((\textcolor{keywordtype}{char} *)p)))
3994         \{
3995         \textcolor{keywordflow}{case} -1:
3996         fprintf(outfile, \textcolor{stringliteral}{"**Failed: invalid UTF-8 string cannot be "}
3997           \textcolor{stringliteral}{"converted to UTF-32\(\backslash\)n"});
3998         \textcolor{keywordflow}{goto} SKIP\_DATA;
3999 
4000         \textcolor{keywordflow}{case} -2:
4001         fprintf(outfile, \textcolor{stringliteral}{"**Failed: character value greater than 0x10ffff "}
4002           \textcolor{stringliteral}{"cannot be converted to UTF-32\(\backslash\)n"});
4003         \textcolor{keywordflow}{goto} SKIP\_DATA;
4004 
4005         \textcolor{keywordflow}{case} -3:
4006         fprintf(outfile, \textcolor{stringliteral}{"**Failed: character value is ill-formed UTF-32\(\backslash\)n"});
4007         \textcolor{keywordflow}{goto} SKIP\_DATA;
4008 
4009         \textcolor{keywordflow}{default}:
4010         \textcolor{keywordflow}{break};
4011         \}
4012       p = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)buffer32;
4013       \}
4014 \textcolor{preprocessor}{#endif}
4015 
4016     \textcolor{comment}{/* Compile many times when timing */}
4017 
4018     \textcolor{keywordflow}{if} (timeit > 0)
4019       \{
4020       \textcolor{keyword}{register} \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
4021       clock\_t time\_taken;
4022       clock\_t start\_time = clock();
4023       \textcolor{keywordflow}{for} (i = 0; i < timeit; i++)
4024         \{
4025         PCRE\_COMPILE(re, p, options, &error, &erroroffset, tables);
4026         \textcolor{keywordflow}{if} (re != NULL) \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(re);
4027         \}
4028       total\_compile\_time += (time\_taken = clock() - start\_time);
4029       fprintf(outfile, \textcolor{stringliteral}{"Compile time %.4f milliseconds\(\backslash\)n"},
4030         (((\textcolor{keywordtype}{double})time\_taken * 1000.0) / (\textcolor{keywordtype}{double})timeit) /
4031           (\textcolor{keywordtype}{double})\hyperlink{pcretest_8c_a3d9fc3c745d0880902fe3ea3d5d5f71e}{CLOCKS\_PER\_SEC});
4032       \}
4033 
4034     PCRE\_COMPILE(re, p, options, &error, &erroroffset, tables);
4035 
4036     \textcolor{comment}{/* Compilation failed; go back for another re, skipping to blank line}
4037 \textcolor{comment}{    if non-interactive. */}
4038 
4039     \textcolor{keywordflow}{if} (re == NULL)
4040       \{
4041       fprintf(outfile, \textcolor{stringliteral}{"Failed: %s at offset %d\(\backslash\)n"}, error, erroroffset);
4042       SKIP\_DATA:
4043       \textcolor{keywordflow}{if} (infile != stdin)
4044         \{
4045         \textcolor{keywordflow}{for} (;;)
4046           \{
4047           \textcolor{keywordflow}{if} (extend\_inputline(infile, buffer, NULL) == NULL)
4048             \{
4049             done = 1;
4050             \textcolor{keywordflow}{goto} CONTINUE;
4051             \}
4052           len = (\hyperlink{group__MOD__WATCHDOG_gaf0b5a943e734de7ea24142e2c81d82ef}{int})strlen((\textcolor{keywordtype}{char} *)\hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer});
4053           \textcolor{keywordflow}{while} (len > 0 && isspace(buffer[len-1])) len--;
4054           \textcolor{keywordflow}{if} (len == 0) \textcolor{keywordflow}{break};
4055           \}
4056         fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
4057         \}
4058       \textcolor{keywordflow}{goto} CONTINUE;
4059       \}
4060 
4061     \textcolor{comment}{/* Compilation succeeded. It is now possible to set the UTF-8 option from}
4062 \textcolor{comment}{    within the regex; check for this so that we know how to process the data}
4063 \textcolor{comment}{    lines. */}
4064 
4065     \textcolor{keywordflow}{if} (new\_info(re, NULL, \hyperlink{pcre_8h_a0e76bf1b51c1f8ab9dfd41981244e77e}{PCRE\_INFO\_OPTIONS}, &get\_options) < 0)
4066       \textcolor{keywordflow}{goto} SKIP\_DATA;
4067     \textcolor{keywordflow}{if} ((get\_options & PCRE\_UTF8) != 0) use\_utf = 1;
4068 
4069     \textcolor{comment}{/* Extract the size for possible writing before possibly flipping it,}
4070 \textcolor{comment}{    and remember the store that was got. */}
4071 
4072     true\_size = \hyperlink{pcre__internal_8h_ad08140f9c9551d638b67e798dd95046e}{REAL\_PCRE\_SIZE}(re);
4073 
4074     \textcolor{comment}{/* Output code size information if requested */}
4075 
4076     \textcolor{keywordflow}{if} (log\_store)
4077       \{
4078       \textcolor{keywordtype}{int} name\_count, name\_entry\_size, real\_pcre\_size;
4079 
4080       new\_info(re, NULL, \hyperlink{pcre_8h_a65a1bccd2d8ae9390f58fbbd204604b4}{PCRE\_INFO\_NAMECOUNT}, &name\_count);
4081       new\_info(re, NULL, \hyperlink{pcre_8h_a0592f8d9db4d1d559ce7619b26dfe5f7}{PCRE\_INFO\_NAMEENTRYSIZE}, &name\_entry\_size);
4082       real\_pcre\_size = 0;
4083 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
4084       \textcolor{keywordflow}{if} (\hyperlink{pcre__internal_8h_aff96469bb3f21861d4c96281d712e1bd}{REAL\_PCRE\_FLAGS}(re) & \hyperlink{pcre__internal_8h_a1e99f8d31a9ba524c582f881640a5b44}{PCRE\_MODE8})
4085         real\_pcre\_size = \textcolor{keyword}{sizeof}(\hyperlink{pcre__internal_8h_a8d1f933a14e5dfe9167d84824fd46e09}{real\_pcre});
4086 \textcolor{preprocessor}{#endif}
4087 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
4088       \textcolor{keywordflow}{if} (\hyperlink{pcre__internal_8h_aff96469bb3f21861d4c96281d712e1bd}{REAL\_PCRE\_FLAGS}(re) & \hyperlink{pcre__internal_8h_aa686efd59814ef5380bb4c30753c3ea4}{PCRE\_MODE16})
4089         real\_pcre\_size = \textcolor{keyword}{sizeof}(\hyperlink{structreal__pcre8__or__16}{real\_pcre16});
4090 \textcolor{preprocessor}{#endif}
4091 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
4092       \textcolor{keywordflow}{if} (\hyperlink{pcre__internal_8h_aff96469bb3f21861d4c96281d712e1bd}{REAL\_PCRE\_FLAGS}(re) & \hyperlink{pcre__internal_8h_adf5c6e5ab69dcc5df19d59cdaabd8e16}{PCRE\_MODE32})
4093         real\_pcre\_size = \textcolor{keyword}{sizeof}(\hyperlink{structreal__pcre32}{real\_pcre32});
4094 \textcolor{preprocessor}{#endif}
4095       new\_info(re, NULL, \hyperlink{pcre_8h_a157c504f78f237c14e1c46c762fc44c7}{PCRE\_INFO\_SIZE}, &size);
4096       fprintf(outfile, \textcolor{stringliteral}{"Memory allocation (code space): %d\(\backslash\)n"},
4097         (\textcolor{keywordtype}{int})(size - real\_pcre\_size - name\_count * name\_entry\_size));
4098       \}
4099 
4100     \textcolor{comment}{/* If -s or /S was present, study the regex to generate additional info to}
4101 \textcolor{comment}{    help with the matching, unless the pattern has the SS option, which}
4102 \textcolor{comment}{    suppresses the effect of /S (used for a few test patterns where studying is}
4103 \textcolor{comment}{    never sensible). */}
4104 
4105     \textcolor{keywordflow}{if} (do\_study || (force\_study >= 0 && !no\_force\_study))
4106       \{
4107       \textcolor{keywordflow}{if} (timeit > 0)
4108         \{
4109         \textcolor{keyword}{register} \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
4110         clock\_t time\_taken;
4111         clock\_t start\_time = clock();
4112         \textcolor{keywordflow}{for} (i = 0; i < timeit; i++)
4113           \{
4114           PCRE\_STUDY(extra, re, study\_options, &error);
4115           \}
4116         total\_study\_time = (time\_taken = clock() - start\_time);
4117         \textcolor{keywordflow}{if} (extra != NULL)
4118           \{
4119           PCRE\_FREE\_STUDY(extra);
4120           \}
4121         fprintf(outfile, \textcolor{stringliteral}{"  Study time %.4f milliseconds\(\backslash\)n"},
4122           (((\textcolor{keywordtype}{double})time\_taken * 1000.0) / (\textcolor{keywordtype}{double})timeit) /
4123             (\textcolor{keywordtype}{double})\hyperlink{pcretest_8c_a3d9fc3c745d0880902fe3ea3d5d5f71e}{CLOCKS\_PER\_SEC});
4124         \}
4125       PCRE\_STUDY(extra, re, study\_options, &error);
4126       \textcolor{keywordflow}{if} (error != NULL)
4127         fprintf(outfile, \textcolor{stringliteral}{"Failed to study: %s\(\backslash\)n"}, error);
4128       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (extra != NULL)
4129         \{
4130         true\_study\_size = ((\hyperlink{structpcre__study__data}{pcre\_study\_data} *)(extra->\hyperlink{structpcre__extra_a27f29bdf9c4526d5bb3fb8ee514ee8e8}{study\_data}))->size;
4131         \textcolor{keywordflow}{if} (log\_store)
4132           \{
4133           \textcolor{keywordtype}{size\_t} jitsize;
4134           \textcolor{keywordflow}{if} (new\_info(re, extra, \hyperlink{pcre_8h_a33b5388887780a3388ab2f0aa0eb06e8}{PCRE\_INFO\_JITSIZE}, &jitsize) == 0 &&
4135               jitsize != 0)
4136             fprintf(outfile, \textcolor{stringliteral}{"Memory allocation (JIT code): %d\(\backslash\)n"}, (\textcolor{keywordtype}{int})jitsize);
4137           \}
4138         \}
4139       \}
4140 
4141     \textcolor{comment}{/* If /K was present, we set up for handling MARK data. */}
4142 
4143     \textcolor{keywordflow}{if} (do\_mark)
4144       \{
4145       \textcolor{keywordflow}{if} (extra == NULL)
4146         \{
4147         extra = (\hyperlink{structpcre__extra}{pcre\_extra} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(\textcolor{keyword}{sizeof}(\hyperlink{structpcre__extra}{pcre\_extra}));
4148         extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} = 0;
4149         \}
4150       extra->\hyperlink{structpcre__extra_abdc3759ca999d874712eedfa0fa57f21}{mark} = &markptr;
4151       extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} |= \hyperlink{pcre_8h_aaa0700c4e5ae62a2b7945d6aff00d7a3}{PCRE\_EXTRA\_MARK};
4152       \}
4153 
4154     \textcolor{comment}{/* Extract and display information from the compiled data if required. */}
4155 
4156     SHOW\_INFO:
4157 
4158     \textcolor{keywordflow}{if} (do\_debug)
4159       \{
4160       fprintf(outfile, \textcolor{stringliteral}{"------------------------------------------------------------------\(\backslash\)n"});
4161       PCRE\_PRINTINT(re, outfile, debug\_lengths);
4162       \}
4163 
4164     \textcolor{comment}{/* We already have the options in get\_options (see above) */}
4165 
4166     \textcolor{keywordflow}{if} (do\_showinfo)
4167       \{
4168       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} all\_options;
4169       pcre\_uint32 first\_char, need\_char;
4170       pcre\_uint32 match\_limit, recursion\_limit;
4171       \textcolor{keywordtype}{int} \hyperlink{group__APR__MD5_ga16ff2d8e15ade4948398b0aeb80124a8}{count}, backrefmax, first\_char\_set, need\_char\_set, okpartial, jchanged,
4172         hascrorlf, maxlookbehind, match\_empty;
4173       \textcolor{keywordtype}{int} nameentrysize, namecount;
4174       \textcolor{keyword}{const} \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *nametable;
4175 
4176       \textcolor{keywordflow}{if} (new\_info(re, NULL, \hyperlink{pcre_8h_a1e67f3dc26bcad0195ef42f9d5126d78}{PCRE\_INFO\_CAPTURECOUNT}, &count) +
4177           new\_info(re, NULL, \hyperlink{pcre_8h_a41f8636ef1964c07030820d46dfd8d0a}{PCRE\_INFO\_BACKREFMAX}, &backrefmax) +
4178           new\_info(re, NULL, \hyperlink{pcre_8h_a78484ed22121a02be14a3e117620b086}{PCRE\_INFO\_FIRSTCHARACTER}, &first\_char) +
4179           new\_info(re, NULL, \hyperlink{pcre_8h_a0e0c4a31d7729eed2365ab36bb553474}{PCRE\_INFO\_FIRSTCHARACTERFLAGS}, &first\_char\_set) +
4180           new\_info(re, NULL, \hyperlink{pcre_8h_a6e7e846311c75235ef5cd0654fca5f10}{PCRE\_INFO\_REQUIREDCHAR}, &need\_char) +
4181           new\_info(re, NULL, \hyperlink{pcre_8h_a8f16ed6d143a739e8ffbd2416c2942d2}{PCRE\_INFO\_REQUIREDCHARFLAGS}, &need\_char\_set) +
4182           new\_info(re, NULL, \hyperlink{pcre_8h_a0592f8d9db4d1d559ce7619b26dfe5f7}{PCRE\_INFO\_NAMEENTRYSIZE}, &nameentrysize) +
4183           new\_info(re, NULL, \hyperlink{pcre_8h_a65a1bccd2d8ae9390f58fbbd204604b4}{PCRE\_INFO\_NAMECOUNT}, &namecount) +
4184           new\_info(re, NULL, \hyperlink{pcre_8h_a0268bee19c3c4f925dd10c320ad84dd2}{PCRE\_INFO\_NAMETABLE}, (\textcolor{keywordtype}{void} *)&nametable) +
4185           new\_info(re, NULL, \hyperlink{pcre_8h_ac2d31bd0f762c33882914adbd2fb7bd5}{PCRE\_INFO\_OKPARTIAL}, &okpartial) +
4186           new\_info(re, NULL, \hyperlink{pcre_8h_abcce93127f116fa34938a0dcbff153f1}{PCRE\_INFO\_JCHANGED}, &jchanged) +
4187           new\_info(re, NULL, \hyperlink{pcre_8h_a4fe48f70c96771135e0f25eeadaabea6}{PCRE\_INFO\_HASCRORLF}, &hascrorlf) +
4188           new\_info(re, NULL, \hyperlink{pcre_8h_aa83023edd345484bb5fc8b128026b7a2}{PCRE\_INFO\_MATCH\_EMPTY}, &match\_empty) +
4189           new\_info(re, NULL, \hyperlink{pcre_8h_a02e72edc3f1cc7b9f25dbed9453b4a9e}{PCRE\_INFO\_MAXLOOKBEHIND}, &maxlookbehind)
4190           != 0)
4191         \textcolor{keywordflow}{goto} SKIP\_DATA;
4192 
4193       fprintf(outfile, \textcolor{stringliteral}{"Capturing subpattern count = %d\(\backslash\)n"}, count);
4194 
4195       \textcolor{keywordflow}{if} (backrefmax > 0)
4196         fprintf(outfile, \textcolor{stringliteral}{"Max back reference = %d\(\backslash\)n"}, backrefmax);
4197 
4198       \textcolor{keywordflow}{if} (maxlookbehind > 0)
4199         fprintf(outfile, \textcolor{stringliteral}{"Max lookbehind = %d\(\backslash\)n"}, maxlookbehind);
4200 
4201       \textcolor{keywordflow}{if} (new\_info(re, NULL, \hyperlink{pcre_8h_a956ee10f13db550da1cc9939ed002eed}{PCRE\_INFO\_MATCHLIMIT}, &match\_limit) == 0)
4202         fprintf(outfile, \textcolor{stringliteral}{"Match limit = %u\(\backslash\)n"}, match\_limit);
4203 
4204       \textcolor{keywordflow}{if} (new\_info(re, NULL, \hyperlink{pcre_8h_af88fb87dc0ac85b873b7a5fbe576a2c3}{PCRE\_INFO\_RECURSIONLIMIT}, &recursion\_limit) == 0)
4205         fprintf(outfile, \textcolor{stringliteral}{"Recursion limit = %u\(\backslash\)n"}, recursion\_limit);
4206 
4207       \textcolor{keywordflow}{if} (namecount > 0)
4208         \{
4209         fprintf(outfile, \textcolor{stringliteral}{"Named capturing subpatterns:\(\backslash\)n"});
4210         \textcolor{keywordflow}{while} (namecount-- > 0)
4211           \{
4212           \textcolor{keywordtype}{int} imm2\_size = pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE} ? 2 : 1;
4213           \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__PROTO_gae8609cee12b4a979fa07fe431b3ee0fb}{length} = (\hyperlink{group__MOD__WATCHDOG_gaf0b5a943e734de7ea24142e2c81d82ef}{int})\hyperlink{testsock_8h_a278cf415676752815cfb411cb0b32802}{STRLEN}(nametable + imm2\_size);
4214           fprintf(outfile, \textcolor{stringliteral}{"  "});
4215           PCHARSV(nametable, imm2\_size, length, outfile);
4216           \textcolor{keywordflow}{while} (length++ < nameentrysize - imm2\_size) putc(\textcolor{charliteral}{' '}, outfile);
4217 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
4218           \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE})
4219             fprintf(outfile, \textcolor{stringliteral}{"%3d\(\backslash\)n"}, (\textcolor{keywordtype}{int})(((\hyperlink{pcre_8h_a02d41f00c750930076db31dd9e787315}{PCRE\_SPTR32})nametable)[0]));
4220 \textcolor{preprocessor}{#endif}
4221 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
4222           \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE})
4223             fprintf(outfile, \textcolor{stringliteral}{"%3d\(\backslash\)n"}, (\textcolor{keywordtype}{int})(((\hyperlink{pcre_8h_a2f6580994f85f07d9db79999541d4141}{PCRE\_SPTR16})nametable)[0]));
4224 \textcolor{preprocessor}{#endif}
4225 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
4226           \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE})
4227             fprintf(outfile, \textcolor{stringliteral}{"%3d\(\backslash\)n"}, ((\textcolor{keywordtype}{int})nametable[0] << 8) | (\textcolor{keywordtype}{int})nametable[1]);
4228 \textcolor{preprocessor}{#endif}
4229           nametable += nameentrysize * CHAR\_SIZE;
4230           \}
4231         \}
4232 
4233       \textcolor{keywordflow}{if} (!okpartial)  fprintf(outfile, \textcolor{stringliteral}{"Partial matching not supported\(\backslash\)n"});
4234       \textcolor{keywordflow}{if} (hascrorlf)   fprintf(outfile, \textcolor{stringliteral}{"Contains explicit CR or LF match\(\backslash\)n"});
4235       \textcolor{keywordflow}{if} (match\_empty) fprintf(outfile, \textcolor{stringliteral}{"May match empty string\(\backslash\)n"});
4236 
4237       all\_options = \hyperlink{pcre__internal_8h_a93f324f7b60edf6c37c3e26bb5cbee34}{REAL\_PCRE\_OPTIONS}(re);
4238       \textcolor{keywordflow}{if} (do\_flip) all\_options = swap\_uint32(all\_options);
4239 
4240       \textcolor{keywordflow}{if} (get\_options == 0) fprintf(outfile, \textcolor{stringliteral}{"No options\(\backslash\)n"});
4241         \textcolor{keywordflow}{else} fprintf(outfile, \textcolor{stringliteral}{"Options:%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s\(\backslash\)n"},
4242           ((get\_options & \hyperlink{pcre_8txt_a1a82c471ce7b7648a6bd5345a8514998}{PCRE\_ANCHORED}) != 0)? \textcolor{stringliteral}{" anchored"} : \textcolor{stringliteral}{""},
4243           ((get\_options & PCRE\_CASELESS) != 0)? \textcolor{stringliteral}{" caseless"} : \textcolor{stringliteral}{""},
4244           ((get\_options & \hyperlink{pcre_8h_a24c767567bde49a4ebdc33783ae2c914}{PCRE\_EXTENDED}) != 0)? \textcolor{stringliteral}{" extended"} : \textcolor{stringliteral}{""},
4245           ((get\_options & PCRE\_MULTILINE) != 0)? \textcolor{stringliteral}{" multiline"} : \textcolor{stringliteral}{""},
4246           ((get\_options & \hyperlink{pcre_8h_a13e0d654eca35f3e6ef806d5f51feab1}{PCRE\_FIRSTLINE}) != 0)? \textcolor{stringliteral}{" firstline"} : \textcolor{stringliteral}{""},
4247           ((get\_options & PCRE\_DOTALL) != 0)? \textcolor{stringliteral}{" dotall"} : \textcolor{stringliteral}{""},
4248           ((get\_options & \hyperlink{pcre_8h_ac4743871720886cdb063a9102f18bf0a}{PCRE\_BSR\_ANYCRLF}) != 0)? \textcolor{stringliteral}{" bsr\_anycrlf"} : \textcolor{stringliteral}{""},
4249           ((get\_options & \hyperlink{pcre_8h_ac26454ae13931ee0bb369dff27b7c1e2}{PCRE\_BSR\_UNICODE}) != 0)? \textcolor{stringliteral}{" bsr\_unicode"} : \textcolor{stringliteral}{""},
4250           ((get\_options & \hyperlink{pcre_8h_ad65038ad88e46214044c98dc052cf77b}{PCRE\_DOLLAR\_ENDONLY}) != 0)? \textcolor{stringliteral}{" dollar\_endonly"} : \textcolor{stringliteral}{""},
4251           ((get\_options & \hyperlink{pcre_8h_ae356b5a19de6096863c0b9e39e74b92b}{PCRE\_EXTRA}) != 0)? \textcolor{stringliteral}{" extra"} : \textcolor{stringliteral}{""},
4252           ((get\_options & PCRE\_UNGREEDY) != 0)? \textcolor{stringliteral}{" ungreedy"} : \textcolor{stringliteral}{""},
4253           ((get\_options & PCRE\_NO\_AUTO\_CAPTURE) != 0)? \textcolor{stringliteral}{" no\_auto\_capture"} : \textcolor{stringliteral}{""},
4254           ((get\_options & \hyperlink{pcre_8h_afa6c9234aa7d3ee12748375fe4204c56}{PCRE\_NO\_AUTO\_POSSESS}) != 0)? \textcolor{stringliteral}{" no\_auto\_possessify"} : \textcolor{stringliteral}{""},
4255           ((get\_options & PCRE\_UTF8) != 0)? \textcolor{stringliteral}{" utf"} : \textcolor{stringliteral}{""},
4256           ((get\_options & PCRE\_UCP) != 0)? \textcolor{stringliteral}{" ucp"} : \textcolor{stringliteral}{""},
4257           ((get\_options & \hyperlink{pcre_8txt_af9448f2501d79b862273e02c0c326f7d}{PCRE\_NO\_UTF8\_CHECK}) != 0)? \textcolor{stringliteral}{" no\_utf\_check"} : \textcolor{stringliteral}{""},
4258           ((get\_options & \hyperlink{pcre_8h_ab07c8c2c3a7fc070d2da0ec9bdf8a873}{PCRE\_NO\_START\_OPTIMIZE}) != 0)? \textcolor{stringliteral}{" no\_start\_optimize"} : \textcolor{stringliteral}{""},
4259           ((get\_options & \hyperlink{pcre_8h_ac200fe10b745df0961d1f1801266ace1}{PCRE\_DUPNAMES}) != 0)? \textcolor{stringliteral}{" dupnames"} : \textcolor{stringliteral}{""},
4260           ((get\_options & \hyperlink{pcretest_8txt_af7acf96473f289539cac56c4c84c10f1}{PCRE\_NEVER\_UTF}) != 0)? \textcolor{stringliteral}{" never\_utf"} : \textcolor{stringliteral}{""});
4261 
4262       \textcolor{keywordflow}{if} (jchanged) fprintf(outfile, \textcolor{stringliteral}{"Duplicate name status changes\(\backslash\)n"});
4263 
4264       \textcolor{keywordflow}{switch} (get\_options & \hyperlink{pcre__internal_8h_a3ee8247993b3ece18a68631e54007555}{PCRE\_NEWLINE\_BITS})
4265         \{
4266         \textcolor{keywordflow}{case} \hyperlink{pcre_8h_ab55198e91574a143392a8dced9d5cf85}{PCRE\_NEWLINE\_CR}:
4267         fprintf(outfile, \textcolor{stringliteral}{"Forced newline sequence: CR\(\backslash\)n"});
4268         \textcolor{keywordflow}{break};
4269 
4270         \textcolor{keywordflow}{case} \hyperlink{pcre_8h_a9d3e03ae881322fe05e72e7ad111bf4f}{PCRE\_NEWLINE\_LF}:
4271         fprintf(outfile, \textcolor{stringliteral}{"Forced newline sequence: LF\(\backslash\)n"});
4272         \textcolor{keywordflow}{break};
4273 
4274         \textcolor{keywordflow}{case} \hyperlink{pcre_8h_a6d5da3bae2692b4bc458f5638dcafd57}{PCRE\_NEWLINE\_CRLF}:
4275         fprintf(outfile, \textcolor{stringliteral}{"Forced newline sequence: CRLF\(\backslash\)n"});
4276         \textcolor{keywordflow}{break};
4277 
4278         \textcolor{keywordflow}{case} \hyperlink{pcre_8h_af25f19586bec4187ca77e617ddc9b98b}{PCRE\_NEWLINE\_ANYCRLF}:
4279         fprintf(outfile, \textcolor{stringliteral}{"Forced newline sequence: ANYCRLF\(\backslash\)n"});
4280         \textcolor{keywordflow}{break};
4281 
4282         \textcolor{keywordflow}{case} \hyperlink{pcre_8h_a1c379cd4b51ea037dce7e8c79f9ee57d}{PCRE\_NEWLINE\_ANY}:
4283         fprintf(outfile, \textcolor{stringliteral}{"Forced newline sequence: ANY\(\backslash\)n"});
4284         \textcolor{keywordflow}{break};
4285 
4286         \textcolor{keywordflow}{default}:
4287         \textcolor{keywordflow}{break};
4288         \}
4289 
4290       \textcolor{keywordflow}{if} (first\_char\_set == 2)
4291         \{
4292         fprintf(outfile, \textcolor{stringliteral}{"First char at start or follows newline\(\backslash\)n"});
4293         \}
4294       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (first\_char\_set == 1)
4295         \{
4296         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *caseless =
4297           ((\hyperlink{pcre__internal_8h_aff96469bb3f21861d4c96281d712e1bd}{REAL\_PCRE\_FLAGS}(re) & \hyperlink{pcre__internal_8h_a91834d023916ad826da8eb6bbb316863}{PCRE\_FCH\_CASELESS}) == 0)?
4298           \textcolor{stringliteral}{""} : \textcolor{stringliteral}{" (caseless)"};
4299 
4300         \textcolor{keywordflow}{if} (\hyperlink{pcretest_8c_aaa58bd4159f415c44f613a34254836d1}{PRINTOK}(first\_char))
4301           fprintf(outfile, \textcolor{stringliteral}{"First char = \(\backslash\)'%c\(\backslash\)'%s\(\backslash\)n"}, first\_char, caseless);
4302         \textcolor{keywordflow}{else}
4303           \{
4304           fprintf(outfile, \textcolor{stringliteral}{"First char = "});
4305           pchar(first\_char, outfile);
4306           fprintf(outfile, \textcolor{stringliteral}{"%s\(\backslash\)n"}, caseless);
4307           \}
4308         \}
4309       \textcolor{keywordflow}{else}
4310         \{
4311         fprintf(outfile, \textcolor{stringliteral}{"No first char\(\backslash\)n"});
4312         \}
4313 
4314       \textcolor{keywordflow}{if} (need\_char\_set == 0)
4315         \{
4316         fprintf(outfile, \textcolor{stringliteral}{"No need char\(\backslash\)n"});
4317         \}
4318       \textcolor{keywordflow}{else}
4319         \{
4320         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *caseless =
4321           ((\hyperlink{pcre__internal_8h_aff96469bb3f21861d4c96281d712e1bd}{REAL\_PCRE\_FLAGS}(re) & \hyperlink{pcre__internal_8h_aabd065c48c6bc64165e21d664e17f27f}{PCRE\_RCH\_CASELESS}) == 0)?
4322           \textcolor{stringliteral}{""} : \textcolor{stringliteral}{" (caseless)"};
4323 
4324         \textcolor{keywordflow}{if} (\hyperlink{pcretest_8c_aaa58bd4159f415c44f613a34254836d1}{PRINTOK}(need\_char))
4325           fprintf(outfile, \textcolor{stringliteral}{"Need char = \(\backslash\)'%c\(\backslash\)'%s\(\backslash\)n"}, need\_char, caseless);
4326         \textcolor{keywordflow}{else}
4327           \{
4328           fprintf(outfile, \textcolor{stringliteral}{"Need char = "});
4329           pchar(need\_char, outfile);
4330           fprintf(outfile, \textcolor{stringliteral}{"%s\(\backslash\)n"}, caseless);
4331           \}
4332         \}
4333 
4334       \textcolor{comment}{/* Don't output study size; at present it is in any case a fixed}
4335 \textcolor{comment}{      value, but it varies, depending on the computer architecture, and}
4336 \textcolor{comment}{      so messes up the test suite. (And with the /F option, it might be}
4337 \textcolor{comment}{      flipped.) If study was forced by an external -s, don't show this}
4338 \textcolor{comment}{      information unless -i or -d was also present. This means that, except}
4339 \textcolor{comment}{      when auto-callouts are involved, the output from runs with and without}
4340 \textcolor{comment}{      -s should be identical. */}
4341 
4342       \textcolor{keywordflow}{if} (do\_study || (force\_study >= 0 && showinfo && !no\_force\_study))
4343         \{
4344         \textcolor{keywordflow}{if} (extra == NULL)
4345           fprintf(outfile, \textcolor{stringliteral}{"Study returned NULL\(\backslash\)n"});
4346         \textcolor{keywordflow}{else}
4347           \{
4348           \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *start\_bits = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
4349           \textcolor{keywordtype}{int} minlength;
4350 
4351           \textcolor{keywordflow}{if} (new\_info(re, extra, \hyperlink{pcre_8h_a95507ec5fc6e2de160b21bcd81766670}{PCRE\_INFO\_MINLENGTH}, &minlength) == 0)
4352             fprintf(outfile, \textcolor{stringliteral}{"Subject length lower bound = %d\(\backslash\)n"}, minlength);
4353 
4354           \textcolor{keywordflow}{if} (new\_info(re, extra, \hyperlink{pcre_8h_a6967220a12ed19c6b461d28342825afb}{PCRE\_INFO\_FIRSTTABLE}, &start\_bits) == 0)
4355             \{
4356             \textcolor{keywordflow}{if} (start\_bits == NULL)
4357               fprintf(outfile, \textcolor{stringliteral}{"No starting char list\(\backslash\)n"});
4358             \textcolor{keywordflow}{else}
4359               \{
4360               \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
4361               \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__HTTPD_ga7cce37ef8558e46f408cb4d0f555605b}{c} = 24;
4362               fprintf(outfile, \textcolor{stringliteral}{"Starting chars: "});
4363               \textcolor{keywordflow}{for} (i = 0; i < 256; i++)
4364                 \{
4365                 \textcolor{keywordflow}{if} ((start\_bits[i/8] & (1<<(i&7))) != 0)
4366                   \{
4367                   \textcolor{keywordflow}{if} (c > 75)
4368                     \{
4369                     fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n  "});
4370                     c = 2;
4371                     \}
4372                   \textcolor{keywordflow}{if} (\hyperlink{pcretest_8c_aaa58bd4159f415c44f613a34254836d1}{PRINTOK}(i) && i != \textcolor{charliteral}{' '})
4373                     \{
4374                     fprintf(outfile, \textcolor{stringliteral}{"%c "}, i);
4375                     c += 2;
4376                     \}
4377                   \textcolor{keywordflow}{else}
4378                     \{
4379                     fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)\(\backslash\)x%02x "}, i);
4380                     c += 5;
4381                     \}
4382                   \}
4383                 \}
4384               fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
4385               \}
4386             \}
4387           \}
4388 
4389         \textcolor{comment}{/* Show this only if the JIT was set by /S, not by -s. */}
4390 
4391         \textcolor{keywordflow}{if} ((study\_options & \hyperlink{pcretest_8c_a37560c659003ee72d0641168690f89ed}{PCRE\_STUDY\_ALLJIT}) != 0 &&
4392             (force\_study\_options & PCRE\_STUDY\_ALLJIT) == 0)
4393           \{
4394           \textcolor{keywordtype}{int} jit;
4395           \textcolor{keywordflow}{if} (new\_info(re, extra, \hyperlink{pcre_8h_a981b889f7bcdcd18cbf28e6b10341e5a}{PCRE\_INFO\_JIT}, &jit) == 0)
4396             \{
4397             \textcolor{keywordflow}{if} (jit)
4398               fprintf(outfile, \textcolor{stringliteral}{"JIT study was successful\(\backslash\)n"});
4399             \textcolor{keywordflow}{else}
4400 \textcolor{preprocessor}{#ifdef SUPPORT\_JIT}
4401               fprintf(outfile, \textcolor{stringliteral}{"JIT study was not successful\(\backslash\)n"});
4402 \textcolor{preprocessor}{#else}
4403               fprintf(outfile, \textcolor{stringliteral}{"JIT support is not available in this version of PCRE\(\backslash\)n"});
4404 \textcolor{preprocessor}{#endif}
4405             \}
4406           \}
4407         \}
4408       \}
4409 
4410     \textcolor{comment}{/* If the '>' option was present, we write out the regex to a file, and}
4411 \textcolor{comment}{    that is all. The first 8 bytes of the file are the regex length and then}
4412 \textcolor{comment}{    the study length, in big-endian order. */}
4413 
4414     \textcolor{keywordflow}{if} (to\_file != NULL)
4415       \{
4416       FILE *f = fopen((\textcolor{keywordtype}{char} *)to\_file, \textcolor{stringliteral}{"wb"});
4417       \textcolor{keywordflow}{if} (f == NULL)
4418         \{
4419         fprintf(outfile, \textcolor{stringliteral}{"Unable to open %s: %s\(\backslash\)n"}, to\_file, \hyperlink{pcretest_8c_a5d6ffddd86bd0d0ead58247b1a80e486}{strerror}(errno));
4420         \}
4421       \textcolor{keywordflow}{else}
4422         \{
4423         \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} sbuf[8];
4424 
4425         \textcolor{keywordflow}{if} (do\_flip) regexflip(re, extra);
4426         sbuf[0] = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8})((true\_size >> 24) & 255);
4427         sbuf[1] = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8})((true\_size >> 16) & 255);
4428         sbuf[2] = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8})((true\_size >>  8) & 255);
4429         sbuf[3] = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8})((true\_size) & 255);
4430         sbuf[4] = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8})((true\_study\_size >> 24) & 255);
4431         sbuf[5] = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8})((true\_study\_size >> 16) & 255);
4432         sbuf[6] = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8})((true\_study\_size >>  8) & 255);
4433         sbuf[7] = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8})((true\_study\_size) & 255);
4434 
4435         \textcolor{keywordflow}{if} (fwrite(sbuf, 1, 8, f) < 8 ||
4436             fwrite(re, 1, true\_size, f) < true\_size)
4437           \{
4438           fprintf(outfile, \textcolor{stringliteral}{"Write error on %s: %s\(\backslash\)n"}, to\_file, \hyperlink{pcretest_8c_a5d6ffddd86bd0d0ead58247b1a80e486}{strerror}(errno));
4439           \}
4440         \textcolor{keywordflow}{else}
4441           \{
4442           fprintf(outfile, \textcolor{stringliteral}{"Compiled pattern written to %s\(\backslash\)n"}, to\_file);
4443 
4444           \textcolor{comment}{/* If there is study data, write it. */}
4445 
4446           \textcolor{keywordflow}{if} (extra != NULL)
4447             \{
4448             \textcolor{keywordflow}{if} (fwrite(extra->\hyperlink{structpcre__extra_a27f29bdf9c4526d5bb3fb8ee514ee8e8}{study\_data}, 1, true\_study\_size, f) <
4449                 true\_study\_size)
4450               \{
4451               fprintf(outfile, \textcolor{stringliteral}{"Write error on %s: %s\(\backslash\)n"}, to\_file,
4452                 \hyperlink{pcretest_8c_a5d6ffddd86bd0d0ead58247b1a80e486}{strerror}(errno));
4453               \}
4454             \textcolor{keywordflow}{else} fprintf(outfile, \textcolor{stringliteral}{"Study data written to %s\(\backslash\)n"}, to\_file);
4455             \}
4456           \}
4457         fclose(f);
4458         \}
4459 
4460       new\_free(re);
4461       \textcolor{keywordflow}{if} (extra != NULL)
4462         \{
4463         PCRE\_FREE\_STUDY(extra);
4464         \}
4465       \textcolor{keywordflow}{if} (locale\_set)
4466         \{
4467         new\_free((\textcolor{keywordtype}{void} *)tables);
4468         setlocale(LC\_CTYPE, \textcolor{stringliteral}{"C"});
4469         locale\_set = 0;
4470         \}
4471       \textcolor{keywordflow}{continue};  \textcolor{comment}{/* With next regex */}
4472       \}
4473     \}        \textcolor{comment}{/* End of non-POSIX compile */}
4474 
4475   \textcolor{comment}{/* Read data lines and test them */}
4476 
4477   \textcolor{keywordflow}{for} (;;)
4478     \{
4479 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
4480     \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *q8;
4481 \textcolor{preprocessor}{#endif}
4482 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
4483     pcre\_uint16 *q16;
4484 \textcolor{preprocessor}{#endif}
4485 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
4486     pcre\_uint32 *q32;
4487 \textcolor{preprocessor}{#endif}
4488     \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *bptr;
4489     \textcolor{keywordtype}{int} *use\_offsets = \hyperlink{pcre_8txt_afeda8db30b411d6c918c917b867d0309}{offsets};
4490     \textcolor{keywordtype}{int} use\_size\_offsets = size\_offsets;
4491     \textcolor{keywordtype}{int} callout\_data = 0;
4492     \textcolor{keywordtype}{int} callout\_data\_set = 0;
4493     \textcolor{keywordtype}{int} \hyperlink{group__APR__MD5_ga16ff2d8e15ade4948398b0aeb80124a8}{count};
4494     pcre\_uint32 \hyperlink{group__APACHE__CORE__HTTPD_ga7cce37ef8558e46f408cb4d0f555605b}{c};
4495     \textcolor{keywordtype}{int} copystrings = 0;
4496     \textcolor{keywordtype}{int} find\_match\_limit = default\_find\_match\_limit;
4497     \textcolor{keywordtype}{int} getstrings = 0;
4498     \textcolor{keywordtype}{int} getlist = 0;
4499     \textcolor{keywordtype}{int} gmatched = 0;
4500     \textcolor{keywordtype}{int} start\_offset = 0;
4501     \textcolor{keywordtype}{int} start\_offset\_sign = 1;
4502     \textcolor{keywordtype}{int} g\_notempty = 0;
4503     \textcolor{keywordtype}{int} use\_dfa = 0;
4504 
4505     *copynames = 0;
4506     *getnames = 0;
4507 
4508 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
4509     cn32ptr = copynames;
4510     gn32ptr = getnames;
4511 \textcolor{preprocessor}{#endif}
4512 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
4513     cn16ptr = copynames16;
4514     gn16ptr = getnames16;
4515 \textcolor{preprocessor}{#endif}
4516 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
4517     cn8ptr = copynames8;
4518     gn8ptr = getnames8;
4519 \textcolor{preprocessor}{#endif}
4520 
4521     SET\_PCRE\_CALLOUT(callout);
4522     first\_callout = 1;
4523     last\_callout\_mark = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
4524     callout\_extra = 0;
4525     callout\_count = 0;
4526     callout\_fail\_count = 999999;
4527     callout\_fail\_id = -1;
4528     show\_malloc = 0;
4529     options = 0;
4530 
4531     \textcolor{keywordflow}{if} (extra != NULL) extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} &=
4532       ~(\hyperlink{pcre_8h_a445166c422ee5e35dc97b5b6e2255afc}{PCRE\_EXTRA\_MATCH\_LIMIT}|
      \hyperlink{pcre_8h_ace793f02af463ede612983bfff275674}{PCRE\_EXTRA\_MATCH\_LIMIT\_RECURSION});
4533 
4534     len = 0;
4535     \textcolor{keywordflow}{for} (;;)
4536       \{
4537       \textcolor{keywordflow}{if} (extend\_inputline(infile, buffer + len, \textcolor{stringliteral}{"data> "}) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL})
4538         \{
4539         \textcolor{keywordflow}{if} (len > 0)    \textcolor{comment}{/* Reached EOF without hitting a newline */}
4540           \{
4541           fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
4542           \textcolor{keywordflow}{break};
4543           \}
4544         done = 1;
4545         \textcolor{keywordflow}{goto} CONTINUE;
4546         \}
4547       \textcolor{keywordflow}{if} (infile != stdin) fprintf(outfile, \textcolor{stringliteral}{"%s"}, (\textcolor{keywordtype}{char} *)buffer);
4548       len = (\hyperlink{group__MOD__WATCHDOG_gaf0b5a943e734de7ea24142e2c81d82ef}{int})strlen((\textcolor{keywordtype}{char} *)\hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer});
4549       \textcolor{keywordflow}{if} (buffer[len-1] == \textcolor{charliteral}{'\(\backslash\)n'}) \textcolor{keywordflow}{break};
4550       \}
4551 
4552     \textcolor{keywordflow}{while} (len > 0 && isspace(buffer[len-1])) len--;
4553     \hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer}[\hyperlink{group__APACHE__CORE__LOG_gab5a43233d60ef05c5b5bf5cba3d74468}{len}] = 0;
4554     \textcolor{keywordflow}{if} (len == 0) \textcolor{keywordflow}{break};
4555 
4556     p = \hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer};
4557     \textcolor{keywordflow}{while} (isspace(*p)) p++;
4558 
4559 \textcolor{preprocessor}{#ifndef NOUTF}
4560     \textcolor{comment}{/* Check that the data is well-formed UTF-8 if we're in UTF mode. To create}
4561 \textcolor{comment}{    invalid input to pcre\_exec, you must use \(\backslash\)x?? or \(\backslash\)x\{\} sequences. */}
4562 
4563     \textcolor{keywordflow}{if} (use\_utf)
4564       \{
4565       \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *q;
4566       pcre\_uint32 cc;
4567       \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n} = 1;
4568 
4569       \textcolor{keywordflow}{for} (q = p; n > 0 && *q; q += \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n}) n = utf82ord(q, &cc);
4570       \textcolor{keywordflow}{if} (n <= 0)
4571         \{
4572         fprintf(outfile, \textcolor{stringliteral}{"**Failed: invalid UTF-8 string cannot be used as input in UTF mode\(\backslash\)n"});
4573         \textcolor{keywordflow}{goto} NEXT\_DATA;
4574         \}
4575       \}
4576 \textcolor{preprocessor}{#endif}
4577 
4578 \textcolor{preprocessor}{#ifdef SUPPORT\_VALGRIND}
4579     \textcolor{comment}{/* Mark the dbuffer as addressable but undefined again. */}
4580 
4581     \textcolor{keywordflow}{if} (dbuffer != NULL)
4582       \{
4583       VALGRIND\_MAKE\_MEM\_UNDEFINED(dbuffer, dbuffer\_size * CHAR\_SIZE);
4584       \}
4585 \textcolor{preprocessor}{#endif}
4586 
4587     \textcolor{comment}{/* Allocate a buffer to hold the data line; len+1 is an upper bound on}
4588 \textcolor{comment}{    the number of pcre\_uchar units that will be needed. */}
4589 
4590     \textcolor{keywordflow}{while} (dbuffer == NULL || (\textcolor{keywordtype}{size\_t})len >= dbuffer\_size)
4591       \{
4592       dbuffer\_size *= 2;
4593       dbuffer = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)realloc(dbuffer, dbuffer\_size * CHAR\_SIZE);
4594       \textcolor{keywordflow}{if} (dbuffer == NULL)
4595         \{
4596         fprintf(stderr, \textcolor{stringliteral}{"pcretest: realloc(%d) failed\(\backslash\)n"}, (\textcolor{keywordtype}{int})dbuffer\_size);
4597         \hyperlink{group__APACHE__OS__NETWARE_gaac7f3a566d7243651a356db3fcfef6b1}{exit}(1);
4598         \}
4599       \}
4600 
4601 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
4602     q8 = (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *) dbuffer;
4603 \textcolor{preprocessor}{#endif}
4604 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
4605     q16 = (pcre\_uint16 *) dbuffer;
4606 \textcolor{preprocessor}{#endif}
4607 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
4608     q32 = (pcre\_uint32 *) dbuffer;
4609 \textcolor{preprocessor}{#endif}
4610 
4611     \textcolor{keywordflow}{while} ((c = *p++) != 0)
4612       \{
4613       \textcolor{keywordtype}{int} i = 0;
4614       \textcolor{keywordtype}{int} n = 0;
4615 
4616       \textcolor{comment}{/* In UTF mode, input can be UTF-8, so just copy all non-backslash bytes.}
4617 \textcolor{comment}{      In non-UTF mode, allow the value of the byte to fall through to later,}
4618 \textcolor{comment}{      where values greater than 127 are turned into UTF-8 when running in}
4619 \textcolor{comment}{      16-bit or 32-bit mode. */}
4620 
4621       \textcolor{keywordflow}{if} (c != \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'})
4622         \{
4623 \textcolor{preprocessor}{#ifndef NOUTF}
4624         \textcolor{keywordflow}{if} (use\_utf && HASUTF8EXTRALEN(c)) \{ GETUTF8INC(c, p); \}
4625 \textcolor{preprocessor}{#endif}
4626         \}
4627 
4628       \textcolor{comment}{/* Handle backslash escapes */}
4629 
4630       \textcolor{keywordflow}{else} \textcolor{keywordflow}{switch} ((c = *p++))
4631         \{
4632         \textcolor{keywordflow}{case} \textcolor{charliteral}{'a'}: c =  \hyperlink{pcre__internal_8h_ac20230c3cd9427707cbb6a998a58f713}{CHAR\_BEL}; \textcolor{keywordflow}{break};
4633         \textcolor{keywordflow}{case} \textcolor{charliteral}{'b'}: c = \textcolor{charliteral}{'\(\backslash\)b'}; \textcolor{keywordflow}{break};
4634         \textcolor{keywordflow}{case} \textcolor{charliteral}{'e'}: c =  \hyperlink{pcre__internal_8h_ac763d1de8ee96951064bd7dbb649dfc5}{CHAR\_ESC}; \textcolor{keywordflow}{break};
4635         \textcolor{keywordflow}{case} \textcolor{charliteral}{'f'}: c = \textcolor{charliteral}{'\(\backslash\)f'}; \textcolor{keywordflow}{break};
4636         \textcolor{keywordflow}{case} \textcolor{charliteral}{'n'}: c = \textcolor{charliteral}{'\(\backslash\)n'}; \textcolor{keywordflow}{break};
4637         \textcolor{keywordflow}{case} \textcolor{charliteral}{'r'}: c = \textcolor{charliteral}{'\(\backslash\)r'}; \textcolor{keywordflow}{break};
4638         \textcolor{keywordflow}{case} \textcolor{charliteral}{'t'}: c = \textcolor{charliteral}{'\(\backslash\)t'}; \textcolor{keywordflow}{break};
4639         \textcolor{keywordflow}{case} \textcolor{charliteral}{'v'}: c = \textcolor{charliteral}{'\(\backslash\)v'}; \textcolor{keywordflow}{break};
4640 
4641         \textcolor{keywordflow}{case} \textcolor{charliteral}{'0'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'1'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'2'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'3'}:
4642         \textcolor{keywordflow}{case} \textcolor{charliteral}{'4'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'5'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'6'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'7'}:
4643         c -= \textcolor{charliteral}{'0'};
4644         \textcolor{keywordflow}{while} (i++ < 2 && isdigit(*p) && *p != \textcolor{charliteral}{'8'} && *p != \textcolor{charliteral}{'9'})
4645           c = c * 8 + *p++ - \textcolor{charliteral}{'0'};
4646         \textcolor{keywordflow}{break};
4647 
4648         \textcolor{keywordflow}{case} \textcolor{charliteral}{'o'}:
4649         \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'\{'})
4650           \{
4651           \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *pt = \hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p};
4652           c = 0;
4653           \textcolor{keywordflow}{for} (pt++; isdigit(*pt) && *pt != \textcolor{charliteral}{'8'} && *pt != \textcolor{charliteral}{'9'}; pt++)
4654             \{
4655             \textcolor{keywordflow}{if} (++i == 12)
4656               fprintf(outfile, \textcolor{stringliteral}{"** Too many octal digits in \(\backslash\)\(\backslash\)o\{...\} item; "}
4657                                \textcolor{stringliteral}{"using only the first twelve.\(\backslash\)n"});
4658             \textcolor{keywordflow}{else} c = c * 8 + *pt - \textcolor{charliteral}{'0'};
4659             \}
4660           \textcolor{keywordflow}{if} (*pt == \textcolor{charliteral}{'\}'}) p = pt + 1;
4661             \textcolor{keywordflow}{else} fprintf(outfile, \textcolor{stringliteral}{"** Missing \} after \(\backslash\)\(\backslash\)o\{ (assumed)\(\backslash\)n"});
4662           \}
4663         \textcolor{keywordflow}{break};
4664 
4665         \textcolor{keywordflow}{case} \textcolor{charliteral}{'x'}:
4666         \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'\{'})
4667           \{
4668           \hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *pt = \hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p};
4669           c = 0;
4670 
4671           \textcolor{comment}{/* We used to have "while (isxdigit(*(++pt)))" here, but it fails}
4672 \textcolor{comment}{          when isxdigit() is a macro that refers to its argument more than}
4673 \textcolor{comment}{          once. This is banned by the C Standard, but apparently happens in at}
4674 \textcolor{comment}{          least one MacOS environment. */}
4675 
4676           \textcolor{keywordflow}{for} (pt++; isxdigit(*pt); pt++)
4677             \{
4678             \textcolor{keywordflow}{if} (++i == 9)
4679               fprintf(outfile, \textcolor{stringliteral}{"** Too many hex digits in \(\backslash\)\(\backslash\)x\{...\} item; "}
4680                                \textcolor{stringliteral}{"using only the first eight.\(\backslash\)n"});
4681             \textcolor{keywordflow}{else} c = c * 16 + tolower(*pt) - ((isdigit(*pt))? \textcolor{charliteral}{'0'} : \textcolor{charliteral}{'a'} - 10);
4682             \}
4683           \textcolor{keywordflow}{if} (*pt == \textcolor{charliteral}{'\}'})
4684             \{
4685             p = pt + 1;
4686             \textcolor{keywordflow}{break};
4687             \}
4688           \textcolor{comment}{/* Not correct form for \(\backslash\)x\{...\}; fall through */}
4689           \}
4690 
4691         \textcolor{comment}{/* \(\backslash\)x without \{\} always defines just one byte in 8-bit mode. This}
4692 \textcolor{comment}{        allows UTF-8 characters to be constructed byte by byte, and also allows}
4693 \textcolor{comment}{        invalid UTF-8 sequences to be made. Just copy the byte in UTF mode.}
4694 \textcolor{comment}{        Otherwise, pass it down to later code so that it can be turned into}
4695 \textcolor{comment}{        UTF-8 when running in 16/32-bit mode. */}
4696 
4697         c = 0;
4698         \textcolor{keywordflow}{while} (i++ < 2 && isxdigit(*p))
4699           \{
4700           c = c * 16 + tolower(*p) - ((isdigit(*p))? \textcolor{charliteral}{'0'} : \textcolor{charliteral}{'a'} - 10);
4701           p++;
4702           \}
4703 \textcolor{preprocessor}{#if !defined NOUTF && defined SUPPORT\_PCRE8}
4704         \textcolor{keywordflow}{if} (use\_utf && (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE}))
4705           \{
4706           *q8++ = \hyperlink{group__APACHE__CORE__HTTPD_ga7cce37ef8558e46f408cb4d0f555605b}{c};
4707           \textcolor{keywordflow}{continue};
4708           \}
4709 \textcolor{preprocessor}{#endif}
4710         \textcolor{keywordflow}{break};
4711 
4712         \textcolor{keywordflow}{case} 0:   \textcolor{comment}{/* \(\backslash\) followed by EOF allows for an empty line */}
4713         p--;
4714         \textcolor{keywordflow}{continue};
4715 
4716         \textcolor{keywordflow}{case} \textcolor{charliteral}{'>'}:
4717         \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'-'})
4718           \{
4719           start\_offset\_sign = -1;
4720           p++;
4721           \}
4722         \textcolor{keywordflow}{while}(isdigit(*p)) start\_offset = start\_offset * 10 + *p++ - \textcolor{charliteral}{'0'};
4723         start\_offset *= start\_offset\_sign;
4724         \textcolor{keywordflow}{continue};
4725 
4726         \textcolor{keywordflow}{case} \textcolor{charliteral}{'A'}:  \textcolor{comment}{/* Option setting */}
4727         options |= \hyperlink{pcre_8txt_a1a82c471ce7b7648a6bd5345a8514998}{PCRE\_ANCHORED};
4728         \textcolor{keywordflow}{continue};
4729 
4730         \textcolor{keywordflow}{case} \textcolor{charliteral}{'B'}:
4731         options |= \hyperlink{pcre_8h_a16056d7051a946b4045356e828bbb0b6}{PCRE\_NOTBOL};
4732         \textcolor{keywordflow}{continue};
4733 
4734         \textcolor{keywordflow}{case} \textcolor{charliteral}{'C'}:
4735         \textcolor{keywordflow}{if} (isdigit(*p))    \textcolor{comment}{/* Set copy string */}
4736           \{
4737           \textcolor{keywordflow}{while}(isdigit(*p)) n = n * 10 + *p++ - \textcolor{charliteral}{'0'};
4738           copystrings |= 1 << \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n};
4739           \}
4740         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{README_8txt_a25d7dd05239df8ce57a8921c43397d07}{isalnum}(*p))
4741           \{
4742           READ\_CAPTURE\_NAME(p, &cn8ptr, &cn16ptr, &cn32ptr, re);
4743           \}
4744         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'+'})
4745           \{
4746           callout\_extra = 1;
4747           p++;
4748           \}
4749         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'-'})
4750           \{
4751           SET\_PCRE\_CALLOUT(NULL);
4752           p++;
4753           \}
4754         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'!'})
4755           \{
4756           callout\_fail\_id = 0;
4757           p++;
4758           \textcolor{keywordflow}{while}(isdigit(*p))
4759             callout\_fail\_id = callout\_fail\_id * 10 + *p++ - \textcolor{charliteral}{'0'};
4760           callout\_fail\_count = 0;
4761           \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'!'})
4762             \{
4763             p++;
4764             \textcolor{keywordflow}{while}(isdigit(*p))
4765               callout\_fail\_count = callout\_fail\_count * 10 + *p++ - \textcolor{charliteral}{'0'};
4766             \}
4767           \}
4768         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*p == \textcolor{charliteral}{'*'})
4769           \{
4770           \textcolor{keywordtype}{int} sign = 1;
4771           callout\_data = 0;
4772           \textcolor{keywordflow}{if} (*(++p) == \textcolor{charliteral}{'-'}) \{ sign = -1; p++; \}
4773           \textcolor{keywordflow}{while}(isdigit(*p))
4774             callout\_data = callout\_data * 10 + *p++ - \textcolor{charliteral}{'0'};
4775           callout\_data *= sign;
4776           callout\_data\_set = 1;
4777           \}
4778         \textcolor{keywordflow}{continue};
4779 
4780 \textcolor{preprocessor}{#if !defined NODFA}
4781         \textcolor{keywordflow}{case} \textcolor{charliteral}{'D'}:
4782 \textcolor{preprocessor}{#if !defined NOPOSIX}
4783         \textcolor{keywordflow}{if} (posix || do\_posix)
4784           printf(\textcolor{stringliteral}{"** Can't use dfa matching in POSIX mode: \(\backslash\)\(\backslash\)D ignored\(\backslash\)n"});
4785         \textcolor{keywordflow}{else}
4786 \textcolor{preprocessor}{#endif}
4787           use\_dfa = 1;
4788         \textcolor{keywordflow}{continue};
4789 \textcolor{preprocessor}{#endif}
4790 
4791 \textcolor{preprocessor}{#if !defined NODFA}
4792         \textcolor{keywordflow}{case} \textcolor{charliteral}{'F'}:
4793         options |= \hyperlink{pcre_8h_a4c96d4b8191b1853c88186ac5ee39e37}{PCRE\_DFA\_SHORTEST};
4794         \textcolor{keywordflow}{continue};
4795 \textcolor{preprocessor}{#endif}
4796 
4797         \textcolor{keywordflow}{case} \textcolor{charliteral}{'G'}:
4798         \textcolor{keywordflow}{if} (isdigit(*p))
4799           \{
4800           \textcolor{keywordflow}{while}(isdigit(*p)) n = n * 10 + *p++ - \textcolor{charliteral}{'0'};
4801           getstrings |= 1 << \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n};
4802           \}
4803         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{README_8txt_a25d7dd05239df8ce57a8921c43397d07}{isalnum}(*p))
4804           \{
4805           READ\_CAPTURE\_NAME(p, &gn8ptr, &gn16ptr, &gn32ptr, re);
4806           \}
4807         \textcolor{keywordflow}{continue};
4808 
4809         \textcolor{keywordflow}{case} \textcolor{charliteral}{'J'}:
4810         \textcolor{keywordflow}{while}(isdigit(*p)) n = n * 10 + *p++ - \textcolor{charliteral}{'0'};
4811         \textcolor{keywordflow}{if} (extra != NULL
4812             && (extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} & \hyperlink{pcre_8h_ab4d31aea438fe7d60400e90770688d40}{PCRE\_EXTRA\_EXECUTABLE\_JIT}) != 0
4813             && extra->\hyperlink{structpcre__extra_a48da1bd01315b326e626657bdb46da78}{executable\_jit} != NULL)
4814           \{
4815           \textcolor{keywordflow}{if} (jit\_stack != NULL) \{ PCRE\_JIT\_STACK\_FREE(jit\_stack); \}
4816           jit\_stack = PCRE\_JIT\_STACK\_ALLOC(1, n * 1024);
4817           PCRE\_ASSIGN\_JIT\_STACK(extra, jit\_callback, jit\_stack);
4818           \}
4819         \textcolor{keywordflow}{continue};
4820 
4821         \textcolor{keywordflow}{case} \textcolor{charliteral}{'L'}:
4822         getlist = 1;
4823         \textcolor{keywordflow}{continue};
4824 
4825         \textcolor{keywordflow}{case} \textcolor{charliteral}{'M'}:
4826         find\_match\_limit = 1;
4827         \textcolor{keywordflow}{continue};
4828 
4829         \textcolor{keywordflow}{case} \textcolor{charliteral}{'N'}:
4830         \textcolor{keywordflow}{if} ((options & \hyperlink{pcre_8h_a99d5e98371fe4cc99a91496fec260a22}{PCRE\_NOTEMPTY}) != 0)
4831           options = (options & ~PCRE\_NOTEMPTY) | \hyperlink{pcre_8h_afa0f634260adacc0902bf7db3d12c755}{PCRE\_NOTEMPTY\_ATSTART};
4832         \textcolor{keywordflow}{else}
4833           options |= \hyperlink{pcre_8h_a99d5e98371fe4cc99a91496fec260a22}{PCRE\_NOTEMPTY};
4834         \textcolor{keywordflow}{continue};
4835 
4836         \textcolor{keywordflow}{case} \textcolor{charliteral}{'O'}:
4837         \textcolor{keywordflow}{while}(isdigit(*p))
4838           \{
4839           \textcolor{keywordflow}{if} (n > (INT\_MAX-10)/10)   \textcolor{comment}{/* Hack to stop fuzzers */}
4840             \{
4841             printf(\textcolor{stringliteral}{"** \(\backslash\)\(\backslash\)O argument is too big\(\backslash\)n"});
4842             yield = 1;
4843             \textcolor{keywordflow}{goto} EXIT;
4844             \}
4845           n = n * 10 + *p++ - \textcolor{charliteral}{'0'};
4846           \}
4847         \textcolor{keywordflow}{if} (n > size\_offsets\_max)
4848           \{
4849           size\_offsets\_max = \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n};
4850           \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(offsets);
4851           use\_offsets = offsets = (\textcolor{keywordtype}{int} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(size\_offsets\_max * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
4852           \textcolor{keywordflow}{if} (offsets == NULL)
4853             \{
4854             printf(\textcolor{stringliteral}{"** Failed to get %d bytes of memory for offsets vector\(\backslash\)n"},
4855               (\textcolor{keywordtype}{int})(size\_offsets\_max * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int})));
4856             yield = 1;
4857             \textcolor{keywordflow}{goto} EXIT;
4858             \}
4859           \}
4860         use\_size\_offsets = \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n};
4861         \textcolor{keywordflow}{if} (n == 0) use\_offsets = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};   \textcolor{comment}{/* Ensures it can't write to it */}
4862           \textcolor{keywordflow}{else} use\_offsets = offsets + size\_offsets\_max - \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n};  \textcolor{comment}{/* To catch overruns */}
4863         \textcolor{keywordflow}{continue};
4864 
4865         \textcolor{keywordflow}{case} \textcolor{charliteral}{'P'}:
4866         options |= ((options & \hyperlink{pcre_8h_a8cc01527b04e25f2249da15788874e0a}{PCRE\_PARTIAL\_SOFT}) == 0)?
4867           \hyperlink{pcre_8h_a8cc01527b04e25f2249da15788874e0a}{PCRE\_PARTIAL\_SOFT} : \hyperlink{pcre_8h_ad6a3d6c982008334fb1351443c7d794d}{PCRE\_PARTIAL\_HARD};
4868         \textcolor{keywordflow}{continue};
4869 
4870         \textcolor{keywordflow}{case} \textcolor{charliteral}{'Q'}:
4871         \textcolor{keywordflow}{while}(isdigit(*p)) n = n * 10 + *p++ - \textcolor{charliteral}{'0'};
4872         \textcolor{keywordflow}{if} (extra == NULL)
4873           \{
4874           extra = (\hyperlink{structpcre__extra}{pcre\_extra} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(\textcolor{keyword}{sizeof}(\hyperlink{structpcre__extra}{pcre\_extra}));
4875           extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} = 0;
4876           \}
4877         extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} |= \hyperlink{pcre_8h_ace793f02af463ede612983bfff275674}{PCRE\_EXTRA\_MATCH\_LIMIT\_RECURSION};
4878         extra->\hyperlink{structpcre__extra_ac62a2bd02946b6b1e59615f15c903b37}{match\_limit\_recursion} = \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n};
4879         \textcolor{keywordflow}{continue};
4880 
4881         \textcolor{keywordflow}{case} \textcolor{charliteral}{'q'}:
4882         \textcolor{keywordflow}{while}(isdigit(*p)) n = n * 10 + *p++ - \textcolor{charliteral}{'0'};
4883         \textcolor{keywordflow}{if} (extra == NULL)
4884           \{
4885           extra = (\hyperlink{structpcre__extra}{pcre\_extra} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(\textcolor{keyword}{sizeof}(\hyperlink{structpcre__extra}{pcre\_extra}));
4886           extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} = 0;
4887           \}
4888         extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} |= \hyperlink{pcre_8h_a445166c422ee5e35dc97b5b6e2255afc}{PCRE\_EXTRA\_MATCH\_LIMIT};
4889         extra->\hyperlink{structpcre__extra_aa1a16c13f086255baba34f5e8a180186}{match\_limit} = \hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n};
4890         \textcolor{keywordflow}{continue};
4891 
4892 \textcolor{preprocessor}{#if !defined NODFA}
4893         \textcolor{keywordflow}{case} \textcolor{charliteral}{'R'}:
4894         options |= \hyperlink{pcre_8h_aaca8969d1f3de87ccecceda165c16af7}{PCRE\_DFA\_RESTART};
4895         \textcolor{keywordflow}{continue};
4896 \textcolor{preprocessor}{#endif}
4897 
4898         \textcolor{keywordflow}{case} \textcolor{charliteral}{'S'}:
4899         show\_malloc = 1;
4900         \textcolor{keywordflow}{continue};
4901 
4902         \textcolor{keywordflow}{case} \textcolor{charliteral}{'Y'}:
4903         options |= \hyperlink{pcre_8h_ab07c8c2c3a7fc070d2da0ec9bdf8a873}{PCRE\_NO\_START\_OPTIMIZE};
4904         \textcolor{keywordflow}{continue};
4905 
4906         \textcolor{keywordflow}{case} \textcolor{charliteral}{'Z'}:
4907         options |= \hyperlink{pcre_8h_a5a49583d34fb5cf425ab4ff7687ff290}{PCRE\_NOTEOL};
4908         \textcolor{keywordflow}{continue};
4909 
4910         \textcolor{keywordflow}{case} \textcolor{charliteral}{'?'}:
4911         options |= \hyperlink{pcre_8txt_af9448f2501d79b862273e02c0c326f7d}{PCRE\_NO\_UTF8\_CHECK};
4912         \textcolor{keywordflow}{continue};
4913 
4914         \textcolor{keywordflow}{case} \textcolor{charliteral}{'<'}:
4915           \{
4916           \textcolor{keywordtype}{int} x = check\_mc\_option(p, outfile, \hyperlink{group__MOD__SSL__PRIVATE_gaa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \textcolor{stringliteral}{"escape sequence"});
4917           \textcolor{keywordflow}{if} (x == 0) \textcolor{keywordflow}{goto} NEXT\_DATA;
4918           options |= \hyperlink{group__MOD__PROXY_gaa51afdb6d96b938b938dc9439be201be}{x};
4919           \textcolor{keywordflow}{while} (*p++ != \textcolor{charliteral}{'>'});
4920           \}
4921         \textcolor{keywordflow}{continue};
4922         \}
4923 
4924       \textcolor{comment}{/* We now have a character value in c that may be greater than 255.}
4925 \textcolor{comment}{      In 8-bit mode we convert to UTF-8 if we are in UTF mode. Values greater}
4926 \textcolor{comment}{      than 127 in UTF mode must have come from \(\backslash\)x\{...\} or octal constructs}
4927 \textcolor{comment}{      because values from \(\backslash\)x.. get this far only in non-UTF mode. */}
4928 
4929 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
4930       \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE})
4931         \{
4932 \textcolor{preprocessor}{#ifndef NOUTF}
4933         \textcolor{keywordflow}{if} (use\_utf)
4934           \{
4935           \textcolor{keywordflow}{if} (c > 0x7fffffff)
4936             \{
4937             fprintf(outfile, \textcolor{stringliteral}{"** Character \(\backslash\)\(\backslash\)x\{%x\} is greater than 0x7fffffff "}
4938               \textcolor{stringliteral}{"and so cannot be converted to UTF-8\(\backslash\)n"}, c);
4939             \textcolor{keywordflow}{goto} NEXT\_DATA;
4940             \}
4941           q8 += ord2utf8(c, q8);
4942           \}
4943         \textcolor{keywordflow}{else}
4944 \textcolor{preprocessor}{#endif}
4945           \{
4946           \textcolor{keywordflow}{if} (c > 0xffu)
4947             \{
4948             fprintf(outfile, \textcolor{stringliteral}{"** Character \(\backslash\)\(\backslash\)x\{%x\} is greater than 255 "}
4949               \textcolor{stringliteral}{"and UTF-8 mode is not enabled.\(\backslash\)n"}, c);
4950             fprintf(outfile, \textcolor{stringliteral}{"** Truncation will probably give the wrong "}
4951               \textcolor{stringliteral}{"result.\(\backslash\)n"});
4952             \}
4953           *q8++ = \hyperlink{group__APACHE__CORE__HTTPD_ga7cce37ef8558e46f408cb4d0f555605b}{c};
4954           \}
4955         \}
4956 \textcolor{preprocessor}{#endif}
4957 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
4958       \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE})
4959         \{
4960 \textcolor{preprocessor}{#ifndef NOUTF}
4961         \textcolor{keywordflow}{if} (use\_utf)
4962           \{
4963           \textcolor{keywordflow}{if} (c > 0x10ffffu)
4964             \{
4965             fprintf(outfile, \textcolor{stringliteral}{"** Failed: character \(\backslash\)\(\backslash\)x\{%x\} is greater than "}
4966               \textcolor{stringliteral}{"0x10ffff and so cannot be converted to UTF-16\(\backslash\)n"}, c);
4967             \textcolor{keywordflow}{goto} NEXT\_DATA;
4968             \}
4969           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (c >= 0x10000u)
4970             \{
4971             c-= 0x10000\hyperlink{pcregrep_8txt_a313eed54a0385c4d4c4c3ef54236123d}{u};
4972             *q16++ = 0xD800 | (c >> 10);
4973             *q16++ = 0xDC00 | (c & 0x3ff);
4974             \}
4975           \textcolor{keywordflow}{else}
4976             *q16++ = \hyperlink{group__APACHE__CORE__HTTPD_ga7cce37ef8558e46f408cb4d0f555605b}{c};
4977           \}
4978         \textcolor{keywordflow}{else}
4979 \textcolor{preprocessor}{#endif}
4980           \{
4981           \textcolor{keywordflow}{if} (c > 0xffffu)
4982             \{
4983             fprintf(outfile, \textcolor{stringliteral}{"** Character \(\backslash\)\(\backslash\)x\{%x\} is greater than 0xffff "}
4984               \textcolor{stringliteral}{"and UTF-16 mode is not enabled.\(\backslash\)n"}, c);
4985             fprintf(outfile, \textcolor{stringliteral}{"** Truncation will probably give the wrong "}
4986               \textcolor{stringliteral}{"result.\(\backslash\)n"});
4987             \}
4988 
4989           *q16++ = \hyperlink{group__APACHE__CORE__HTTPD_ga7cce37ef8558e46f408cb4d0f555605b}{c};
4990           \}
4991         \}
4992 \textcolor{preprocessor}{#endif}
4993 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
4994       \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE})
4995         \{
4996         *q32++ = \hyperlink{group__APACHE__CORE__HTTPD_ga7cce37ef8558e46f408cb4d0f555605b}{c};
4997         \}
4998 \textcolor{preprocessor}{#endif}
4999 
5000       \}
5001 
5002     \textcolor{comment}{/* Reached end of subject string */}
5003 
5004 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
5005     \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE})
5006     \{
5007       *q8 = 0;
5008       len = (\hyperlink{group__MOD__WATCHDOG_gaf0b5a943e734de7ea24142e2c81d82ef}{int})(q8 - (\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)dbuffer);
5009     \}
5010 \textcolor{preprocessor}{#endif}
5011 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
5012     \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE})
5013     \{
5014       *q16 = 0;
5015       len = (\hyperlink{group__MOD__WATCHDOG_gaf0b5a943e734de7ea24142e2c81d82ef}{int})(q16 - (pcre\_uint16 *)dbuffer);
5016     \}
5017 \textcolor{preprocessor}{#endif}
5018 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
5019     \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE})
5020     \{
5021       *q32 = 0;
5022       len = (\hyperlink{group__MOD__WATCHDOG_gaf0b5a943e734de7ea24142e2c81d82ef}{int})(q32 - (pcre\_uint32 *)dbuffer);
5023     \}
5024 \textcolor{preprocessor}{#endif}
5025 
5026     \textcolor{comment}{/* If we're compiling with explicit valgrind support, Mark the data from after}
5027 \textcolor{comment}{    its end to the end of the buffer as unaddressable, so that a read over the end}
5028 \textcolor{comment}{    of the buffer will be seen by valgrind, even if it doesn't cause a crash.}
5029 \textcolor{comment}{    If we're not building with valgrind support, at least move the data to the end}
5030 \textcolor{comment}{    of the buffer so that it might at least cause a crash.}
5031 \textcolor{comment}{    If we are using the POSIX interface, we must include the terminating zero. */}
5032 
5033     bptr = dbuffer;
5034 
5035 \textcolor{preprocessor}{#if !defined NOPOSIX}
5036     \textcolor{keywordflow}{if} (posix || do\_posix)
5037       \{
5038 \textcolor{preprocessor}{#ifdef SUPPORT\_VALGRIND}
5039       VALGRIND\_MAKE\_MEM\_NOACCESS(dbuffer + len + 1, dbuffer\_size - (len + 1));
5040 \textcolor{preprocessor}{#else}
5041       \hyperlink{pcre__internal_8h_ad12df83f1d3a090b658adc645555ca79}{memmove}(bptr + dbuffer\_size - len - 1, bptr, len + 1);
5042       bptr += dbuffer\_size - len - 1;
5043 \textcolor{preprocessor}{#endif}
5044       \}
5045     \textcolor{keywordflow}{else}
5046 \textcolor{preprocessor}{#endif}
5047       \{
5048 \textcolor{preprocessor}{#ifdef SUPPORT\_VALGRIND}
5049       VALGRIND\_MAKE\_MEM\_NOACCESS(dbuffer + len * CHAR\_SIZE, (dbuffer\_size - len) * CHAR\_SIZE);
5050 \textcolor{preprocessor}{#else}
5051       bptr = \hyperlink{pcre__internal_8h_ad12df83f1d3a090b658adc645555ca79}{memmove}(bptr + (dbuffer\_size - len) * CHAR\_SIZE, bptr, len * CHAR\_SIZE);
5052 \textcolor{preprocessor}{#endif}
5053       \}
5054 
5055     \textcolor{keywordflow}{if} ((all\_use\_dfa || use\_dfa) && find\_match\_limit)
5056       \{
5057       printf(\textcolor{stringliteral}{"** Match limit not relevant for DFA matching: ignored\(\backslash\)n"});
5058       find\_match\_limit = 0;
5059       \}
5060 
5061     \textcolor{comment}{/* Handle matching via the POSIX interface, which does not}
5062 \textcolor{comment}{    support timing or playing with the match limit or callout data. */}
5063 
5064 \textcolor{preprocessor}{#if !defined NOPOSIX}
5065     \textcolor{keywordflow}{if} (posix || do\_posix)
5066       \{
5067       \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
5068       \textcolor{keywordtype}{int} \hyperlink{ap__regex_8h_a9f68b18f48e4c69747ab1bc133e396f5}{eflags} = 0;
5069       \hyperlink{structregmatch__t}{regmatch\_t} *\hyperlink{group__AP__EXPR_ga144e8a242b3028b194fd8f301b15078b}{pmatch} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
5070       \textcolor{keywordflow}{if} (use\_size\_offsets > 0)
5071         pmatch = (\hyperlink{structregmatch__t}{regmatch\_t} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(\textcolor{keyword}{sizeof}(\hyperlink{structregmatch__t}{regmatch\_t}) * use\_size\_offsets);
5072       \textcolor{keywordflow}{if} ((options & \hyperlink{pcre_8h_a16056d7051a946b4045356e828bbb0b6}{PCRE\_NOTBOL}) != 0) eflags |= \hyperlink{pcreposix_8h_aa0ca15a79530976f6d4ef90326c46858}{REG\_NOTBOL};
5073       \textcolor{keywordflow}{if} ((options & \hyperlink{pcre_8h_a5a49583d34fb5cf425ab4ff7687ff290}{PCRE\_NOTEOL}) != 0) eflags |= \hyperlink{pcreposix_8h_a9d97d85ef86123060a845723d28a92cb}{REG\_NOTEOL};
5074       \textcolor{keywordflow}{if} ((options & PCRE\_NOTEMPTY) != 0) eflags |= \hyperlink{pcreposix_8h_ae880a6d5c6df1c0b286efa8cfa0811c8}{REG\_NOTEMPTY};
5075 
5076       rc = \hyperlink{pcreposix_8c_a7bae01b6d58da41c644b5e07db9b9511}{regexec}(&preg, (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *)bptr, use\_size\_offsets, pmatch, eflags);
5077 
5078       \textcolor{keywordflow}{if} (rc != 0)
5079         \{
5080         (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})\hyperlink{pcreposix_8c_a70dcfd4affaf92e8fc8ec9b89e054e49}{regerror}(rc, &preg, (\textcolor{keywordtype}{char} *)\hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer}, buffer\_size);
5081         fprintf(outfile, \textcolor{stringliteral}{"No match: POSIX code %d: %s\(\backslash\)n"}, rc, buffer);
5082         \}
5083       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\hyperlink{pcre__internal_8h_a93f324f7b60edf6c37c3e26bb5cbee34}{REAL\_PCRE\_OPTIONS}(preg.\hyperlink{structregex__t_ab3694f54105f125bc239be955f54143e}{re\_pcre}) & PCRE\_NO\_AUTO\_CAPTURE) != 0)
5084         \{
5085         fprintf(outfile, \textcolor{stringliteral}{"Matched with REG\_NOSUB\(\backslash\)n"});
5086         \}
5087       \textcolor{keywordflow}{else}
5088         \{
5089         \textcolor{keywordtype}{size\_t} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
5090         \textcolor{keywordflow}{for} (i = 0; i < (size\_t)use\_size\_offsets; i++)
5091           \{
5092           \textcolor{keywordflow}{if} (pmatch[i].rm\_so >= 0)
5093             \{
5094             fprintf(outfile, \textcolor{stringliteral}{"%2d: "}, (\textcolor{keywordtype}{int})i);
5095             PCHARSV(dbuffer, pmatch[i].rm\_so,
5096               pmatch[i].rm\_eo - pmatch[i].rm\_so, outfile);
5097             fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
5098             \textcolor{keywordflow}{if} (do\_showcaprest || (i == 0 && do\_showrest))
5099               \{
5100               fprintf(outfile, \textcolor{stringliteral}{"%2d+ "}, (\textcolor{keywordtype}{int})i);
5101               PCHARSV(dbuffer, pmatch[i].rm\_eo, len - pmatch[i].rm\_eo,
5102                 outfile);
5103               fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
5104               \}
5105             \}
5106           \}
5107         \}
5108       \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(pmatch);
5109       \textcolor{keywordflow}{goto} NEXT\_DATA;
5110       \}
5111 
5112 \textcolor{preprocessor}{#endif  }\textcolor{comment}{/* !defined NOPOSIX */}\textcolor{preprocessor}{}
5113 
5114     \textcolor{comment}{/* Handle matching via the native interface - repeats for /g and /G */}
5115 
5116     \textcolor{comment}{/* Ensure that there is a JIT callback if we want to verify that JIT was}
5117 \textcolor{comment}{    actually used. If jit\_stack == NULL, no stack has yet been assigned. */}
5118 
5119     \textcolor{keywordflow}{if} (verify\_jit && jit\_stack == NULL && extra != NULL)
5120        \{ PCRE\_ASSIGN\_JIT\_STACK(extra, jit\_callback, jit\_stack); \}
5121 
5122     \textcolor{keywordflow}{for} (;; gmatched++)    \textcolor{comment}{/* Loop for /g or /G */}
5123       \{
5124       markptr = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
5125       jit\_was\_used = \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};
5126 
5127       \textcolor{keywordflow}{if} (timeitm > 0)
5128         \{
5129         \textcolor{keyword}{register} \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
5130         clock\_t time\_taken;
5131         clock\_t start\_time = clock();
5132 
5133 \textcolor{preprocessor}{#if !defined NODFA}
5134         \textcolor{keywordflow}{if} (all\_use\_dfa || use\_dfa)
5135           \{
5136           \textcolor{keywordflow}{if} ((options & \hyperlink{pcre_8h_aaca8969d1f3de87ccecceda165c16af7}{PCRE\_DFA\_RESTART}) != 0)
5137             \{
5138             fprintf(outfile, \textcolor{stringliteral}{"Timing DFA restarts is not supported\(\backslash\)n"});
5139             \textcolor{keywordflow}{break};
5140             \}
5141           \textcolor{keywordflow}{if} (dfa\_workspace == NULL)
5142             dfa\_workspace = (\textcolor{keywordtype}{int} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(\hyperlink{pcretest_8c_a842570e8d80518cd514def8311b3041a}{DFA\_WS\_DIMENSION}*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
5143           \textcolor{keywordflow}{for} (i = 0; i < timeitm; i++)
5144             \{
5145             PCRE\_DFA\_EXEC(count, re, extra, bptr, len, start\_offset,
5146               (options | g\_notempty), use\_offsets, use\_size\_offsets,
5147               dfa\_workspace, \hyperlink{pcretest_8c_a842570e8d80518cd514def8311b3041a}{DFA\_WS\_DIMENSION});
5148             \}
5149           \}
5150         \textcolor{keywordflow}{else}
5151 \textcolor{preprocessor}{#endif}
5152 
5153         \textcolor{keywordflow}{for} (i = 0; i < timeitm; i++)
5154           \{
5155           PCRE\_EXEC(count, re, extra, bptr, len, start\_offset,
5156             (options | g\_notempty), use\_offsets, use\_size\_offsets);
5157           \}
5158         total\_match\_time += (time\_taken = clock() - start\_time);
5159         fprintf(outfile, \textcolor{stringliteral}{"Execute time %.4f milliseconds\(\backslash\)n"},
5160           (((\textcolor{keywordtype}{double})time\_taken * 1000.0) / (\textcolor{keywordtype}{double})timeitm) /
5161             (\textcolor{keywordtype}{double})\hyperlink{pcretest_8c_a3d9fc3c745d0880902fe3ea3d5d5f71e}{CLOCKS\_PER\_SEC});
5162         \}
5163 
5164       \textcolor{comment}{/* If find\_match\_limit is set, we want to do repeated matches with}
5165 \textcolor{comment}{      varying limits in order to find the minimum value for the match limit and}
5166 \textcolor{comment}{      for the recursion limit. The match limits are relevant only to the normal}
5167 \textcolor{comment}{      running of pcre\_exec(), so disable the JIT optimization. This makes it}
5168 \textcolor{comment}{      possible to run the same set of tests with and without JIT externally}
5169 \textcolor{comment}{      requested. */}
5170 
5171       \textcolor{keywordflow}{if} (find\_match\_limit)
5172         \{
5173         \textcolor{keywordflow}{if} (extra != NULL) \{ PCRE\_FREE\_STUDY(extra); \}
5174         extra = (\hyperlink{structpcre__extra}{pcre\_extra} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(\textcolor{keyword}{sizeof}(\hyperlink{structpcre__extra}{pcre\_extra}));
5175         extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} = 0;
5176 
5177         (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})check\_match\_limit(re, extra, bptr, len, start\_offset,
5178           options|g\_notempty, use\_offsets, use\_size\_offsets,
5179           \hyperlink{pcre_8h_a445166c422ee5e35dc97b5b6e2255afc}{PCRE\_EXTRA\_MATCH\_LIMIT}, &(extra->\hyperlink{structpcre__extra_aa1a16c13f086255baba34f5e8a180186}{match\_limit}),
5180           \hyperlink{pcre_8h_abe4a2c56f074df78c108ceda543ffae6}{PCRE\_ERROR\_MATCHLIMIT}, \textcolor{stringliteral}{"match()"});
5181 
5182         count = check\_match\_limit(re, extra, bptr, len, start\_offset,
5183           options|g\_notempty, use\_offsets, use\_size\_offsets,
5184           \hyperlink{pcre_8h_ace793f02af463ede612983bfff275674}{PCRE\_EXTRA\_MATCH\_LIMIT\_RECURSION}, &(extra->
      \hyperlink{structpcre__extra_ac62a2bd02946b6b1e59615f15c903b37}{match\_limit\_recursion}),
5185           \hyperlink{pcre_8h_a8ac929eecc597f78ce9ba03fac738b78}{PCRE\_ERROR\_RECURSIONLIMIT}, \textcolor{stringliteral}{"match() recursion"});
5186         \}
5187 
5188       \textcolor{comment}{/* If callout\_data is set, use the interface with additional data */}
5189 
5190       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (callout\_data\_set)
5191         \{
5192         \textcolor{keywordflow}{if} (extra == NULL)
5193           \{
5194           extra = (\hyperlink{structpcre__extra}{pcre\_extra} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(\textcolor{keyword}{sizeof}(\hyperlink{structpcre__extra}{pcre\_extra}));
5195           extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} = 0;
5196           \}
5197         extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} |= \hyperlink{pcre_8h_a197fb3eb123c7d79aa25d9cb810bd4d3}{PCRE\_EXTRA\_CALLOUT\_DATA};
5198         extra->\hyperlink{structpcre__extra_aef88fa059796850ca7f00842f5d88e8c}{callout\_data} = &callout\_data;
5199         PCRE\_EXEC(count, re, extra, bptr, len, start\_offset,
5200           options | g\_notempty, use\_offsets, use\_size\_offsets);
5201         extra->\hyperlink{structpcre__extra_a2a7957f7f9d15b3b69f8652b2f50ecb3}{flags} &= ~\hyperlink{pcre_8h_a197fb3eb123c7d79aa25d9cb810bd4d3}{PCRE\_EXTRA\_CALLOUT\_DATA};
5202         \}
5203 
5204       \textcolor{comment}{/* The normal case is just to do the match once, with the default}
5205 \textcolor{comment}{      value of match\_limit. */}
5206 
5207 \textcolor{preprocessor}{#if !defined NODFA}
5208       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (all\_use\_dfa || use\_dfa)
5209         \{
5210         \textcolor{keywordflow}{if} (dfa\_workspace == NULL)
5211           dfa\_workspace = (\textcolor{keywordtype}{int} *)\hyperlink{util__expr__parse_8c_a5faf6a2d99f50a4655dd390199a8db7b}{malloc}(\hyperlink{pcretest_8c_a842570e8d80518cd514def8311b3041a}{DFA\_WS\_DIMENSION}*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
5212         \textcolor{keywordflow}{if} (dfa\_matched++ == 0)
5213           dfa\_workspace[0] = -1;  \textcolor{comment}{/* To catch bad restart */}
5214         PCRE\_DFA\_EXEC(count, re, extra, bptr, len, start\_offset,
5215           (options | g\_notempty), use\_offsets, use\_size\_offsets, dfa\_workspace,
5216           \hyperlink{pcretest_8c_a842570e8d80518cd514def8311b3041a}{DFA\_WS\_DIMENSION});
5217         \textcolor{keywordflow}{if} (count == 0)
5218           \{
5219           fprintf(outfile, \textcolor{stringliteral}{"Matched, but offsets vector is too small to show all matches\(\backslash\)n"});
5220           count = use\_size\_offsets/2;
5221           \}
5222         \}
5223 \textcolor{preprocessor}{#endif}
5224 
5225       \textcolor{keywordflow}{else}
5226         \{
5227         PCRE\_EXEC(count, re, extra, bptr, len, start\_offset,
5228           options | g\_notempty, use\_offsets, use\_size\_offsets);
5229         \textcolor{keywordflow}{if} (count == 0)
5230           \{
5231           fprintf(outfile, \textcolor{stringliteral}{"Matched, but too many substrings\(\backslash\)n"});
5232           \textcolor{comment}{/* 2 is a special case; match can be returned */}
5233           count = (use\_size\_offsets == 2)? 1 : use\_size\_offsets/3;
5234           \}
5235         \}
5236 
5237       \textcolor{comment}{/* Matched */}
5238 
5239       \textcolor{keywordflow}{if} (count >= 0)
5240         \{
5241         \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}, maxcount;
5242         \textcolor{keywordtype}{void} *cnptr, *gnptr;
5243 
5244 \textcolor{preprocessor}{#if !defined NODFA}
5245         \textcolor{keywordflow}{if} (all\_use\_dfa || use\_dfa) maxcount = use\_size\_offsets/2; \textcolor{keywordflow}{else}
5246 \textcolor{preprocessor}{#endif}
5247           \textcolor{comment}{/* 2 is a special case; match can be returned */}
5248           maxcount = (use\_size\_offsets == 2)? 1 : use\_size\_offsets/3;
5249 
5250         \textcolor{comment}{/* This is a check against a lunatic return value. */}
5251 
5252         \textcolor{keywordflow}{if} (count > maxcount)
5253           \{
5254           fprintf(outfile,
5255             \textcolor{stringliteral}{"** PCRE error: returned count %d is too big for offset size %d\(\backslash\)n"},
5256             count, use\_size\_offsets);
5257           count = use\_size\_offsets/3;
5258           \textcolor{keywordflow}{if} (do\_g || do\_G)
5259             \{
5260             fprintf(outfile, \textcolor{stringliteral}{"** /%c loop abandoned\(\backslash\)n"}, do\_g? \textcolor{charliteral}{'g'} : \textcolor{charliteral}{'G'});
5261             do\_g = do\_G = \hyperlink{group__MOD__SSL__PRIVATE_gaa93f0eb578d23995850d61f7d61c55c1}{FALSE};        \textcolor{comment}{/* Break g/G loop */}
5262             \}
5263           \}
5264 
5265         \textcolor{comment}{/* do\_allcaps requests showing of all captures in the pattern, to check}
5266 \textcolor{comment}{        unset ones at the end. */}
5267 
5268         \textcolor{keywordflow}{if} (do\_allcaps)
5269           \{
5270           \textcolor{keywordflow}{if} (all\_use\_dfa || use\_dfa)
5271             \{
5272             fprintf(outfile, \textcolor{stringliteral}{"** Show all captures ignored after DFA matching\(\backslash\)n"});
5273             \}
5274           \textcolor{keywordflow}{else}
5275            \{
5276             \textcolor{keywordflow}{if} (new\_info(re, NULL, \hyperlink{pcre_8h_a1e67f3dc26bcad0195ef42f9d5126d78}{PCRE\_INFO\_CAPTURECOUNT}, &count) < 0)
5277               \textcolor{keywordflow}{goto} SKIP\_DATA;
5278             count++;   \textcolor{comment}{/* Allow for full match */}
5279             \textcolor{keywordflow}{if} (count * 2 > use\_size\_offsets) count = use\_size\_offsets/2;
5280             \}
5281           \}
5282 
5283         \textcolor{comment}{/* Output the captured substrings. Note that, for the matched string,}
5284 \textcolor{comment}{        the use of \(\backslash\)K in an assertion can make the start later than the end. */}
5285 
5286         \textcolor{keywordflow}{for} (i = 0; i < count * 2; i += 2)
5287           \{
5288           \textcolor{keywordflow}{if} (use\_offsets[i] < 0)
5289             \{
5290             \textcolor{keywordflow}{if} (use\_offsets[i] != -1)
5291               fprintf(outfile, \textcolor{stringliteral}{"ERROR: bad negative value %d for offset %d\(\backslash\)n"},
5292                 use\_offsets[i], i);
5293             \textcolor{keywordflow}{if} (use\_offsets[i+1] != -1)
5294               fprintf(outfile, \textcolor{stringliteral}{"ERROR: bad negative value %d for offset %d\(\backslash\)n"},
5295                 use\_offsets[i+1], i+1);
5296             fprintf(outfile, \textcolor{stringliteral}{"%2d: <unset>\(\backslash\)n"}, i/2);
5297             \}
5298           \textcolor{keywordflow}{else}
5299             \{
5300             \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__DAEMON_ga6d3a995932cd00f6b3473898aa90d596}{start} = use\_offsets[\hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}];
5301             \textcolor{keywordtype}{int} \hyperlink{group__apr__strings_ga87c7e3f3f70b6e7de10e3f56e3f4d7a4}{end} = use\_offsets[i+1];
5302 
5303             \textcolor{keywordflow}{if} (start > end)
5304               \{
5305               start = use\_offsets[i+1];
5306               end = use\_offsets[\hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}];
5307               fprintf(outfile, \textcolor{stringliteral}{"Start of matched string is beyond its end - "}
5308                 \textcolor{stringliteral}{"displaying from end to start.\(\backslash\)n"});
5309               \}
5310 
5311             fprintf(outfile, \textcolor{stringliteral}{"%2d: "}, i/2);
5312             PCHARSV(bptr, start, end - start, outfile);
5313             \textcolor{keywordflow}{if} (verify\_jit && jit\_was\_used) fprintf(outfile, \textcolor{stringliteral}{" (JIT)"});
5314             fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
5315 
5316             \textcolor{comment}{/* Note: don't use the start/end variables here because we want to}
5317 \textcolor{comment}{            show the text from what is reported as the end. */}
5318 
5319             \textcolor{keywordflow}{if} (do\_showcaprest || (i == 0 && do\_showrest))
5320               \{
5321               fprintf(outfile, \textcolor{stringliteral}{"%2d+ "}, i/2);
5322               PCHARSV(bptr, use\_offsets[i+1], len - use\_offsets[i+1],
5323                 outfile);
5324               fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
5325               \}
5326             \}
5327           \}
5328 
5329         \textcolor{keywordflow}{if} (markptr != NULL)
5330           \{
5331           fprintf(outfile, \textcolor{stringliteral}{"MK: "});
5332           PCHARSV(markptr, 0, -1, outfile);
5333           fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
5334           \}
5335 
5336         \textcolor{keywordflow}{for} (i = 0; i < 32; i++)
5337           \{
5338           \textcolor{keywordflow}{if} ((copystrings & (1 << i)) != 0)
5339             \{
5340             \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
5341             \textcolor{keywordtype}{char} copybuffer[256];
5342             PCRE\_COPY\_SUBSTRING(rc, bptr, use\_offsets, count, i,
5343               copybuffer, \textcolor{keyword}{sizeof}(copybuffer));
5344             \textcolor{keywordflow}{if} (rc < 0)
5345               fprintf(outfile, \textcolor{stringliteral}{"copy substring %d failed %d\(\backslash\)n"}, i, rc);
5346             \textcolor{keywordflow}{else}
5347               \{
5348               fprintf(outfile, \textcolor{stringliteral}{"%2dC "}, i);
5349               PCHARSV(copybuffer, 0, rc, outfile);
5350               fprintf(outfile, \textcolor{stringliteral}{" (%d)\(\backslash\)n"}, rc);
5351               \}
5352             \}
5353           \}
5354 
5355         cnptr = copynames;
5356         \textcolor{keywordflow}{for} (;;)
5357           \{
5358           \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
5359           \textcolor{keywordtype}{char} copybuffer[256];
5360 
5361 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
5362           \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE})
5363             \{
5364             \textcolor{keywordflow}{if} (*(pcre\_uint32 *)cnptr == 0) \textcolor{keywordflow}{break};
5365             \}
5366 \textcolor{preprocessor}{#endif}
5367 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
5368           \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE})
5369             \{
5370             \textcolor{keywordflow}{if} (*(pcre\_uint16 *)cnptr == 0) \textcolor{keywordflow}{break};
5371             \}
5372 \textcolor{preprocessor}{#endif}
5373 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
5374           \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE})
5375             \{
5376             \textcolor{keywordflow}{if} (*(\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)cnptr == 0) \textcolor{keywordflow}{break};
5377             \}
5378 \textcolor{preprocessor}{#endif}
5379 
5380           PCRE\_COPY\_NAMED\_SUBSTRING(rc, re, bptr, use\_offsets, count,
5381             cnptr, copybuffer, \textcolor{keyword}{sizeof}(copybuffer));
5382 
5383           \textcolor{keywordflow}{if} (rc < 0)
5384             \{
5385             fprintf(outfile, \textcolor{stringliteral}{"copy substring "});
5386             PCHARSV(cnptr, 0, -1, outfile);
5387             fprintf(outfile, \textcolor{stringliteral}{" failed %d\(\backslash\)n"}, rc);
5388             \}
5389           \textcolor{keywordflow}{else}
5390             \{
5391             fprintf(outfile, \textcolor{stringliteral}{"  C "});
5392             PCHARSV(copybuffer, 0, rc, outfile);
5393             fprintf(outfile, \textcolor{stringliteral}{" (%d) "}, rc);
5394             PCHARSV(cnptr, 0, -1, outfile);
5395             putc(\textcolor{charliteral}{'\(\backslash\)n'}, outfile);
5396             \}
5397 
5398           cnptr = (\textcolor{keywordtype}{char} *)cnptr + (\hyperlink{testsock_8h_a278cf415676752815cfb411cb0b32802}{STRLEN}(cnptr) + 1) * CHAR\_SIZE;
5399           \}
5400 
5401         \textcolor{keywordflow}{for} (i = 0; i < 32; i++)
5402           \{
5403           \textcolor{keywordflow}{if} ((getstrings & (1 << i)) != 0)
5404             \{
5405             \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
5406             \textcolor{keyword}{const} \textcolor{keywordtype}{char} *substring;
5407             PCRE\_GET\_SUBSTRING(rc, bptr, use\_offsets, count, i, &substring);
5408             \textcolor{keywordflow}{if} (rc < 0)
5409               fprintf(outfile, \textcolor{stringliteral}{"get substring %d failed %d\(\backslash\)n"}, i, rc);
5410             \textcolor{keywordflow}{else}
5411               \{
5412               fprintf(outfile, \textcolor{stringliteral}{"%2dG "}, i);
5413               PCHARSV(substring, 0, rc, outfile);
5414               fprintf(outfile, \textcolor{stringliteral}{" (%d)\(\backslash\)n"}, rc);
5415               PCRE\_FREE\_SUBSTRING(substring);
5416               \}
5417             \}
5418           \}
5419 
5420         gnptr = getnames;
5421         \textcolor{keywordflow}{for} (;;)
5422           \{
5423           \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
5424           \textcolor{keyword}{const} \textcolor{keywordtype}{char} *substring;
5425 
5426 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
5427           \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE})
5428             \{
5429             \textcolor{keywordflow}{if} (*(pcre\_uint32 *)gnptr == 0) \textcolor{keywordflow}{break};
5430             \}
5431 \textcolor{preprocessor}{#endif}
5432 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
5433           \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE})
5434             \{
5435             \textcolor{keywordflow}{if} (*(pcre\_uint16 *)gnptr == 0) \textcolor{keywordflow}{break};
5436             \}
5437 \textcolor{preprocessor}{#endif}
5438 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE8}
5439           \textcolor{keywordflow}{if} (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE})
5440             \{
5441             \textcolor{keywordflow}{if} (*(\hyperlink{pcre__internal_8h_a6e9105ffeed09883190f9bf30d93e210}{pcre\_uint8} *)gnptr == 0) \textcolor{keywordflow}{break};
5442             \}
5443 \textcolor{preprocessor}{#endif}
5444 
5445           PCRE\_GET\_NAMED\_SUBSTRING(rc, re, bptr, use\_offsets, count,
5446             gnptr, &substring);
5447           \textcolor{keywordflow}{if} (rc < 0)
5448             \{
5449             fprintf(outfile, \textcolor{stringliteral}{"get substring "});
5450             PCHARSV(gnptr, 0, -1, outfile);
5451             fprintf(outfile, \textcolor{stringliteral}{" failed %d\(\backslash\)n"}, rc);
5452             \}
5453           \textcolor{keywordflow}{else}
5454             \{
5455             fprintf(outfile, \textcolor{stringliteral}{"  G "});
5456             PCHARSV(substring, 0, rc, outfile);
5457             fprintf(outfile, \textcolor{stringliteral}{" (%d) "}, rc);
5458             PCHARSV(gnptr, 0, -1, outfile);
5459             PCRE\_FREE\_SUBSTRING(substring);
5460             putc(\textcolor{charliteral}{'\(\backslash\)n'}, outfile);
5461             \}
5462 
5463           gnptr = (\textcolor{keywordtype}{char} *)gnptr + (\hyperlink{testsock_8h_a278cf415676752815cfb411cb0b32802}{STRLEN}(gnptr) + 1) * CHAR\_SIZE;
5464           \}
5465 
5466         \textcolor{keywordflow}{if} (getlist)
5467           \{
5468           \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__CONFIG_ga2e051c0ce9ee165170cd7973f2464512}{rc};
5469           \textcolor{keyword}{const} \textcolor{keywordtype}{char} **stringlist;
5470           PCRE\_GET\_SUBSTRING\_LIST(rc, bptr, use\_offsets, count, &stringlist);
5471           \textcolor{keywordflow}{if} (rc < 0)
5472             fprintf(outfile, \textcolor{stringliteral}{"get substring list failed %d\(\backslash\)n"}, rc);
5473           \textcolor{keywordflow}{else}
5474             \{
5475             \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{group__APR__MD5_ga16ff2d8e15ade4948398b0aeb80124a8}{count}; i++)
5476               \{
5477               fprintf(outfile, \textcolor{stringliteral}{"%2dL "}, i);
5478               PCHARSV(stringlist[i], 0, -1, outfile);
5479               putc(\textcolor{charliteral}{'\(\backslash\)n'}, outfile);
5480               \}
5481             \textcolor{keywordflow}{if} (stringlist[i] != NULL)
5482               fprintf(outfile, \textcolor{stringliteral}{"string list not terminated by NULL\(\backslash\)n"});
5483             PCRE\_FREE\_SUBSTRING\_LIST(stringlist);
5484             \}
5485           \}
5486         \}
5487 
5488       \textcolor{comment}{/* There was a partial match. If the bumpalong point is not the same as}
5489 \textcolor{comment}{      the first inspected character, show the offset explicitly. */}
5490 
5491       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (count == \hyperlink{pcre_8h_a15e18e8cc2d40840786a650ee750d49a}{PCRE\_ERROR\_PARTIAL})
5492         \{
5493         fprintf(outfile, \textcolor{stringliteral}{"Partial match"});
5494         \textcolor{keywordflow}{if} (use\_size\_offsets > 2 && use\_offsets[0] != use\_offsets[2])
5495           fprintf(outfile, \textcolor{stringliteral}{" at offset %d"}, use\_offsets[2]);
5496         \textcolor{keywordflow}{if} (markptr != NULL)
5497           \{
5498           fprintf(outfile, \textcolor{stringliteral}{", mark="});
5499           PCHARSV(markptr, 0, -1, outfile);
5500           \}
5501         \textcolor{keywordflow}{if} (use\_size\_offsets > 1)
5502           \{
5503           fprintf(outfile, \textcolor{stringliteral}{": "});
5504           PCHARSV(bptr, use\_offsets[0], use\_offsets[1] - use\_offsets[0],
5505             outfile);
5506           \}
5507         \textcolor{keywordflow}{if} (verify\_jit && jit\_was\_used) fprintf(outfile, \textcolor{stringliteral}{" (JIT)"});
5508         fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
5509         \textcolor{keywordflow}{break};  \textcolor{comment}{/* Out of the /g loop */}
5510         \}
5511 
5512       \textcolor{comment}{/* Failed to match. If this is a /g or /G loop and we previously set}
5513 \textcolor{comment}{      g\_notempty after a null match, this is not necessarily the end. We want}
5514 \textcolor{comment}{      to advance the start offset, and continue. We won't be at the end of the}
5515 \textcolor{comment}{      string - that was checked before setting g\_notempty.}
5516 \textcolor{comment}{}
5517 \textcolor{comment}{      Complication arises in the case when the newline convention is "any",}
5518 \textcolor{comment}{      "crlf", or "anycrlf". If the previous match was at the end of a line}
5519 \textcolor{comment}{      terminated by CRLF, an advance of one character just passes the \(\backslash\)r,}
5520 \textcolor{comment}{      whereas we should prefer the longer newline sequence, as does the code in}
5521 \textcolor{comment}{      pcre\_exec(). Fudge the offset value to achieve this. We check for a}
5522 \textcolor{comment}{      newline setting in the pattern; if none was set, use PCRE\_CONFIG() to}
5523 \textcolor{comment}{      find the default.}
5524 \textcolor{comment}{}
5525 \textcolor{comment}{      Otherwise, in the case of UTF-8 matching, the advance must be one}
5526 \textcolor{comment}{      character, not one byte. */}
5527 
5528       \textcolor{keywordflow}{else}
5529         \{
5530         \textcolor{keywordflow}{if} (g\_notempty != 0)
5531           \{
5532           \textcolor{keywordtype}{int} onechar = 1;
5533           \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} obits = \hyperlink{pcre__internal_8h_a93f324f7b60edf6c37c3e26bb5cbee34}{REAL\_PCRE\_OPTIONS}(re);
5534           use\_offsets[0] = start\_offset;
5535           \textcolor{keywordflow}{if} ((obits & PCRE\_NEWLINE\_BITS) == 0)
5536             \{
5537             \textcolor{keywordtype}{int} \hyperlink{apr__siphash_8h_a105cb8ad09be3a7d9d15497ce529ccce}{d};
5538             (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})PCRE\_CONFIG(\hyperlink{pcre_8h_ac9cd3aaf1d94ff1e846082b3c69b68f0}{PCRE\_CONFIG\_NEWLINE}, &d);
5539             \textcolor{comment}{/* Note that these values are always the ASCII ones, even in}
5540 \textcolor{comment}{            EBCDIC environments. CR = 13, NL = 10. */}
5541             obits = (d == 13)? \hyperlink{pcre_8h_ab55198e91574a143392a8dced9d5cf85}{PCRE\_NEWLINE\_CR} :
5542                     (d == 10)? \hyperlink{pcre_8h_a9d3e03ae881322fe05e72e7ad111bf4f}{PCRE\_NEWLINE\_LF} :
5543                     (d == (13<<8 | 10))? \hyperlink{pcre_8h_a6d5da3bae2692b4bc458f5638dcafd57}{PCRE\_NEWLINE\_CRLF} :
5544                     (d == -2)? \hyperlink{pcre_8h_af25f19586bec4187ca77e617ddc9b98b}{PCRE\_NEWLINE\_ANYCRLF} :
5545                     (d == -1)? \hyperlink{pcre_8h_a1c379cd4b51ea037dce7e8c79f9ee57d}{PCRE\_NEWLINE\_ANY} : 0;
5546             \}
5547           \textcolor{keywordflow}{if} (((obits & PCRE\_NEWLINE\_BITS) == \hyperlink{pcre_8h_a1c379cd4b51ea037dce7e8c79f9ee57d}{PCRE\_NEWLINE\_ANY} ||
5548                (obits & \hyperlink{pcre__internal_8h_a3ee8247993b3ece18a68631e54007555}{PCRE\_NEWLINE\_BITS}) == \hyperlink{pcre_8h_a6d5da3bae2692b4bc458f5638dcafd57}{PCRE\_NEWLINE\_CRLF} ||
5549                (obits & PCRE\_NEWLINE\_BITS) == \hyperlink{pcre_8h_af25f19586bec4187ca77e617ddc9b98b}{PCRE\_NEWLINE\_ANYCRLF})
5550               &&
5551               start\_offset < len - 1 && (
5552 #ifdef \hyperlink{config_8h_a0e09d861a3b3ebd12565f778c41cd6c8}{SUPPORT\_PCRE8}
5553               (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01dabf54035556ef74d92a1c1707ce4e241a}{PCRE8\_MODE} &&
5554                bptr[start\_offset] == \textcolor{charliteral}{'\(\backslash\)r'} &&
5555                bptr[start\_offset + 1] == \textcolor{charliteral}{'\(\backslash\)n'}) ||
5556 \textcolor{preprocessor}{#endif}
5557 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
5558               (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da0a188ab637bcba2af63838b294cef398}{PCRE16\_MODE} &&
5559                ((\hyperlink{pcre_8h_a2f6580994f85f07d9db79999541d4141}{PCRE\_SPTR16})bptr)[start\_offset] == \textcolor{charliteral}{'\(\backslash\)r'} &&
5560                ((\hyperlink{pcre_8h_a2f6580994f85f07d9db79999541d4141}{PCRE\_SPTR16})bptr)[start\_offset + 1] == \textcolor{charliteral}{'\(\backslash\)n'}) ||
5561 #endif
5562 #ifdef \hyperlink{config_8h_a88aaacfd30fc8a3bb1cd3c668759dd4c}{SUPPORT\_PCRE32}
5563               (pcre\_mode == \hyperlink{pcretest_8c_ac9420823bfeba78fce625fc105e3b01da5b660459a43698e0139757fe6614eae1}{PCRE32\_MODE} &&
5564                ((\hyperlink{pcre_8h_a02d41f00c750930076db31dd9e787315}{PCRE\_SPTR32})bptr)[start\_offset] == \textcolor{charliteral}{'\(\backslash\)r'} &&
5565                ((\hyperlink{pcre_8h_a02d41f00c750930076db31dd9e787315}{PCRE\_SPTR32})bptr)[start\_offset + 1] == \textcolor{charliteral}{'\(\backslash\)n'}) ||
5566 \textcolor{preprocessor}{#endif}
5567               0))
5568             onechar++;
5569           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_utf)
5570             \{
5571             \textcolor{keywordflow}{while} (start\_offset + onechar < len)
5572               \{
5573               \textcolor{keywordflow}{if} ((bptr[start\_offset+onechar] & 0xc0) != 0x80) \textcolor{keywordflow}{break};
5574               onechar++;
5575               \}
5576             \}
5577           use\_offsets[1] = start\_offset + onechar;
5578           \}
5579         \textcolor{keywordflow}{else}
5580           \{
5581           \textcolor{keywordflow}{switch}(count)
5582             \{
5583             \textcolor{keywordflow}{case} \hyperlink{pcre_8h_ad39129723af6a7f9584c1c1cba089509}{PCRE\_ERROR\_NOMATCH}:
5584             \textcolor{keywordflow}{if} (gmatched == 0)
5585               \{
5586               \textcolor{keywordflow}{if} (markptr == NULL)
5587                 \{
5588                 fprintf(outfile, \textcolor{stringliteral}{"No match"});
5589                 \}
5590               \textcolor{keywordflow}{else}
5591                 \{
5592                 fprintf(outfile, \textcolor{stringliteral}{"No match, mark = "});
5593                 PCHARSV(markptr, 0, -1, outfile);
5594                 \}
5595               \textcolor{keywordflow}{if} (verify\_jit && jit\_was\_used) fprintf(outfile, \textcolor{stringliteral}{" (JIT)"});
5596               putc(\textcolor{charliteral}{'\(\backslash\)n'}, outfile);
5597               \}
5598             \textcolor{keywordflow}{break};
5599 
5600             \textcolor{keywordflow}{case} \hyperlink{pcre_8h_af3d0d74db5955e377ad5a7d91d57f2ea}{PCRE\_ERROR\_BADUTF8}:
5601             \textcolor{keywordflow}{case} \hyperlink{pcre_8h_a4304330d39cd7fb1607243ba17e333b2}{PCRE\_ERROR\_SHORTUTF8}:
5602             fprintf(outfile, \textcolor{stringliteral}{"Error %d (%s UTF-%d string)"}, count,
5603               (count == \hyperlink{pcre_8h_af3d0d74db5955e377ad5a7d91d57f2ea}{PCRE\_ERROR\_BADUTF8})? \textcolor{stringliteral}{"bad"} : \textcolor{stringliteral}{"short"},
5604               8 * CHAR\_SIZE);
5605             \textcolor{keywordflow}{if} (use\_size\_offsets >= 2)
5606               fprintf(outfile, \textcolor{stringliteral}{" offset=%d reason=%d"}, use\_offsets[0],
5607                 use\_offsets[1]);
5608             fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
5609             \textcolor{keywordflow}{break};
5610 
5611             \textcolor{keywordflow}{case} \hyperlink{pcre_8h_a09e2716e3bb1ecd82e7bc19fb0b72d51}{PCRE\_ERROR\_BADUTF8\_OFFSET}:
5612             fprintf(outfile, \textcolor{stringliteral}{"Error %d (bad UTF-%d offset)\(\backslash\)n"}, count,
5613               8 * CHAR\_SIZE);
5614             \textcolor{keywordflow}{break};
5615 
5616             \textcolor{keywordflow}{default}:
5617             \textcolor{keywordflow}{if} (count < 0 &&
5618                 (-count) < (\textcolor{keywordtype}{int})(\textcolor{keyword}{sizeof}(errtexts)/\textcolor{keyword}{sizeof}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *)))
5619               fprintf(outfile, \textcolor{stringliteral}{"Error %d (%s)\(\backslash\)n"}, count, errtexts[-count]);
5620             \textcolor{keywordflow}{else}
5621               fprintf(outfile, \textcolor{stringliteral}{"Error %d (Unexpected value)\(\backslash\)n"}, count);
5622             \textcolor{keywordflow}{break};
5623             \}
5624 
5625           \textcolor{keywordflow}{break};  \textcolor{comment}{/* Out of the /g loop */}
5626           \}
5627         \}
5628 
5629       \textcolor{comment}{/* If not /g or /G we are done */}
5630 
5631       \textcolor{keywordflow}{if} (!do\_g && !do\_G) \textcolor{keywordflow}{break};
5632 
5633       \textcolor{keywordflow}{if} (use\_offsets == NULL)
5634         \{
5635         fprintf(outfile, \textcolor{stringliteral}{"Cannot do global matching without an ovector\(\backslash\)n"});
5636         \textcolor{keywordflow}{break};
5637         \}
5638 
5639       \textcolor{keywordflow}{if} (use\_size\_offsets < 2)
5640         \{
5641         fprintf(outfile, \textcolor{stringliteral}{"Cannot do global matching with an ovector size < 2\(\backslash\)n"});
5642         \textcolor{keywordflow}{break};
5643         \}
5644 
5645       \textcolor{comment}{/* If we have matched an empty string, first check to see if we are at}
5646 \textcolor{comment}{      the end of the subject. If so, the /g loop is over. Otherwise, mimic what}
5647 \textcolor{comment}{      Perl's /g options does. This turns out to be rather cunning. First we set}
5648 \textcolor{comment}{      PCRE\_NOTEMPTY\_ATSTART and PCRE\_ANCHORED and try the match again at the}
5649 \textcolor{comment}{      same point. If this fails (picked up above) we advance to the next}
5650 \textcolor{comment}{      character. */}
5651 
5652       g\_notempty = 0;
5653 
5654       \textcolor{keywordflow}{if} (use\_offsets[0] == use\_offsets[1])
5655         \{
5656         \textcolor{keywordflow}{if} (use\_offsets[0] == len) \textcolor{keywordflow}{break};
5657         g\_notempty = \hyperlink{pcre_8h_afa0f634260adacc0902bf7db3d12c755}{PCRE\_NOTEMPTY\_ATSTART} | \hyperlink{pcre_8txt_a1a82c471ce7b7648a6bd5345a8514998}{PCRE\_ANCHORED};
5658         \}
5659 
5660       \textcolor{comment}{/* For /g, update the start offset, leaving the rest alone. There is a}
5661 \textcolor{comment}{      tricky case when \(\backslash\)K is used in a positive lookbehind assertion. This can}
5662 \textcolor{comment}{      cause the end of the match to be less than or equal to the start offset.}
5663 \textcolor{comment}{      In this case we restart at one past the start offset. This may return the}
5664 \textcolor{comment}{      same match if the original start offset was bumped along during the}
5665 \textcolor{comment}{      match, but eventually the new start offset will hit the actual start}
5666 \textcolor{comment}{      offset. (In PCRE2 the true start offset is available, and this can be}
5667 \textcolor{comment}{      done better. It is not worth doing more than making sure we do not loop}
5668 \textcolor{comment}{      at this stage in the life of PCRE1.) */}
5669 
5670       \textcolor{keywordflow}{if} (do\_g)
5671         \{
5672         \textcolor{keywordflow}{if} (g\_notempty == 0 && use\_offsets[1] <= start\_offset)
5673           \{
5674           \textcolor{keywordflow}{if} (start\_offset >= len) \textcolor{keywordflow}{break};  \textcolor{comment}{/* End of subject */}
5675           start\_offset++;
5676           \textcolor{keywordflow}{if} (use\_utf)
5677             \{
5678             \textcolor{keywordflow}{while} (start\_offset < len)
5679               \{
5680               \textcolor{keywordflow}{if} ((bptr[start\_offset] & 0xc0) != 0x80) \textcolor{keywordflow}{break};
5681               start\_offset++;
5682               \}
5683             \}
5684           \}
5685         \textcolor{keywordflow}{else} start\_offset = use\_offsets[1];
5686         \}
5687 
5688       \textcolor{comment}{/* For /G, update the pointer and length */}
5689 
5690       \textcolor{keywordflow}{else}
5691         \{
5692         bptr += use\_offsets[1] * CHAR\_SIZE;
5693         len -= use\_offsets[1];
5694         \}
5695       \}  \textcolor{comment}{/* End of loop for /g and /G */}
5696 
5697     NEXT\_DATA: \textcolor{keywordflow}{continue};
5698     \}    \textcolor{comment}{/* End of loop for data lines */}
5699 
5700   CONTINUE:
5701 
5702 \textcolor{preprocessor}{#if !defined NOPOSIX}
5703   \textcolor{keywordflow}{if} ((posix || do\_posix) && preg.\hyperlink{structregex__t_ab3694f54105f125bc239be955f54143e}{re\_pcre} != 0) \hyperlink{pcreposix_8c_a4250992b948e440b66d7467a8ddeee87}{regfree}(&preg);
5704 \textcolor{preprocessor}{#endif}
5705 
5706   \textcolor{keywordflow}{if} (re != NULL) new\_free(re);
5707   \textcolor{keywordflow}{if} (extra != NULL)
5708     \{
5709     PCRE\_FREE\_STUDY(extra);
5710     \}
5711   \textcolor{keywordflow}{if} (locale\_set)
5712     \{
5713     new\_free((\textcolor{keywordtype}{void} *)tables);
5714     setlocale(LC\_CTYPE, \textcolor{stringliteral}{"C"});
5715     locale\_set = 0;
5716     \}
5717   \textcolor{keywordflow}{if} (jit\_stack != NULL)
5718     \{
5719     PCRE\_JIT\_STACK\_FREE(jit\_stack);
5720     jit\_stack = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
5721     \}
5722   \}
5723 
5724 \textcolor{keywordflow}{if} (infile == stdin) fprintf(outfile, \textcolor{stringliteral}{"\(\backslash\)n"});
5725 
5726 \textcolor{keywordflow}{if} (showtotaltimes)
5727   \{
5728   fprintf(outfile, \textcolor{stringliteral}{"--------------------------------------\(\backslash\)n"});
5729   \textcolor{keywordflow}{if} (timeit > 0)
5730     \{
5731     fprintf(outfile, \textcolor{stringliteral}{"Total compile time %.4f milliseconds\(\backslash\)n"},
5732       (((\textcolor{keywordtype}{double})total\_compile\_time * 1000.0) / (\textcolor{keywordtype}{double})timeit) /
5733         (\textcolor{keywordtype}{double})\hyperlink{pcretest_8c_a3d9fc3c745d0880902fe3ea3d5d5f71e}{CLOCKS\_PER\_SEC});
5734     fprintf(outfile, \textcolor{stringliteral}{"Total study time   %.4f milliseconds\(\backslash\)n"},
5735       (((\textcolor{keywordtype}{double})total\_study\_time * 1000.0) / (\textcolor{keywordtype}{double})timeit) /
5736         (\textcolor{keywordtype}{double})\hyperlink{pcretest_8c_a3d9fc3c745d0880902fe3ea3d5d5f71e}{CLOCKS\_PER\_SEC});
5737     \}
5738   fprintf(outfile, \textcolor{stringliteral}{"Total execute time %.4f milliseconds\(\backslash\)n"},
5739     (((\textcolor{keywordtype}{double})total\_match\_time * 1000.0) / (\textcolor{keywordtype}{double})timeitm) /
5740       (\textcolor{keywordtype}{double})\hyperlink{pcretest_8c_a3d9fc3c745d0880902fe3ea3d5d5f71e}{CLOCKS\_PER\_SEC});
5741   \}
5742 
5743 EXIT:
5744 
5745 \textcolor{keywordflow}{if} (infile != NULL && infile != stdin) fclose(infile);
5746 \textcolor{keywordflow}{if} (outfile != NULL && outfile != \hyperlink{pcretest_8txt_a23d7bb711442e83ff18e0effa4729bdf}{stdout}) fclose(outfile);
5747 
5748 \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(buffer);
5749 \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(dbuffer);
5750 \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(pbuffer);
5751 \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(offsets);
5752 
5753 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE16}
5754 \textcolor{keywordflow}{if} (buffer16 != NULL) \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(buffer16);
5755 \textcolor{preprocessor}{#endif}
5756 \textcolor{preprocessor}{#ifdef SUPPORT\_PCRE32}
5757 \textcolor{keywordflow}{if} (buffer32 != NULL) \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(buffer32);
5758 \textcolor{preprocessor}{#endif}
5759 
5760 \textcolor{preprocessor}{#if !defined NODFA}
5761 \textcolor{keywordflow}{if} (dfa\_workspace != NULL)
5762   \hyperlink{util__expr__parse_8c_af07d89f5ceaea0c7c8252cc41fd75f37}{free}(dfa\_workspace);
5763 \textcolor{preprocessor}{#endif}
5764 
5765 \textcolor{preprocessor}{#if defined(\_\_VMS)}
5766   yield = SS$\_NORMAL;  \textcolor{comment}{/* Return values via DCL symbols */}
5767 \textcolor{preprocessor}{#endif}
5768 
5769 \textcolor{keywordflow}{return} yield;
5770 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{pcretest_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph}
\end{center}
\end{figure}


\index{pcretest.\+c@{pcretest.\+c}!strerror@{strerror}}
\index{strerror@{strerror}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{strerror(int n)}{strerror(int n)}}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ strerror (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{n}
\end{DoxyParamCaption}
)}\hypertarget{pcretest_8c_a5d6ffddd86bd0d0ead58247b1a80e486}{}\label{pcretest_8c_a5d6ffddd86bd0d0ead58247b1a80e486}

\begin{DoxyCode}
1510 \{
1511 \textcolor{keywordflow}{if} (n < 0 || n >= \hyperlink{pcretest_8c_a560e1e3acaca1d09a7eddcdb528ed92e}{sys\_nerr}) \textcolor{keywordflow}{return} \textcolor{stringliteral}{"unknown error number"};
1512 \textcolor{keywordflow}{return} \hyperlink{pcretest_8c_a47e211ba7b51a50f6998d4f872f12d31}{sys\_errlist}[\hyperlink{group__APACHE__CORE__PROTO_gad484edfd58b9127caa8f0f59b4004d09}{n}];
1513 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=289pt]{pcretest_8c_a5d6ffddd86bd0d0ead58247b1a80e486_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=201pt]{pcretest_8c_a5d6ffddd86bd0d0ead58247b1a80e486_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{pcretest.\+c@{pcretest.\+c}!sys\+\_\+errlist@{sys\+\_\+errlist}}
\index{sys\+\_\+errlist@{sys\+\_\+errlist}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{sys\+\_\+errlist}{sys_errlist}}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ sys\+\_\+errlist\mbox{[}$\,$\mbox{]}}\hypertarget{pcretest_8c_a47e211ba7b51a50f6998d4f872f12d31}{}\label{pcretest_8c_a47e211ba7b51a50f6998d4f872f12d31}
\index{pcretest.\+c@{pcretest.\+c}!sys\+\_\+nerr@{sys\+\_\+nerr}}
\index{sys\+\_\+nerr@{sys\+\_\+nerr}!pcretest.\+c@{pcretest.\+c}}
\subsubsection[{\texorpdfstring{sys\+\_\+nerr}{sys_nerr}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} sys\+\_\+nerr}\hypertarget{pcretest_8c_a560e1e3acaca1d09a7eddcdb528ed92e}{}\label{pcretest_8c_a560e1e3acaca1d09a7eddcdb528ed92e}
