\hypertarget{unix_2dir_8c}{}\section{/usr/local/src/github/\+Codebase/httpd-\/2.4.29/srclib/apr/file\+\_\+io/unix/dir.c File Reference}
\label{unix_2dir_8c}\index{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/srclib/apr/file\+\_\+io/unix/dir.\+c@{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/srclib/apr/file\+\_\+io/unix/dir.\+c}}
{\ttfamily \#include \char`\"{}apr\+\_\+arch\+\_\+file\+\_\+io.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+strings.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+portable.\+h\char`\"{}}\\*
Include dependency graph for dir.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{unix_2dir_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{unix_2dir_8c_a256a5721249aa3309437212cc21a9fe4}{P\+A\+T\+H\+\_\+\+S\+E\+P\+A\+R\+A\+T\+OR}~\textquotesingle{}/\textquotesingle{}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{unix_2dir_8c_a6116289feec09ec86c564e926a5f4cd2}{apr\+\_\+dir\+\_\+open} (\hyperlink{structapr__dir__t}{apr\+\_\+dir\+\_\+t} $\ast$$\ast$new, const char $\ast$\hyperlink{group__apr__dir_gab8a2fd169b20f0b9d33959f7b17d35aa}{dirname}, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APR__XLATE_gabb3cd978f04c73d0b763c391e9bfde73}{pool})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{unix_2dir_8c_a57fef00ccea03e9244f6fa21da4d3359}{apr\+\_\+dir\+\_\+close} (\hyperlink{structapr__dir__t}{apr\+\_\+dir\+\_\+t} $\ast$\hyperlink{group__apr__portabile_ga615037f19c897e8cf0feb5f2888fb819}{thedir})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{unix_2dir_8c_a3e4ee253e0c712160bee10bfb9c8e4a8}{apr\+\_\+dir\+\_\+read} (\hyperlink{structapr__finfo__t}{apr\+\_\+finfo\+\_\+t} $\ast$finfo, \hyperlink{group__apr__platform_ga21ef1e35fd3ff9be386f3cb20164ff02}{apr\+\_\+int32\+\_\+t} \hyperlink{group__apr__file__io_ga48805d2a6845252444835c7809c73ade}{wanted}, \hyperlink{structapr__dir__t}{apr\+\_\+dir\+\_\+t} $\ast$\hyperlink{group__apr__portabile_ga615037f19c897e8cf0feb5f2888fb819}{thedir})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{unix_2dir_8c_ab9b9f23e76128144d3fb953cabea6290}{apr\+\_\+dir\+\_\+rewind} (\hyperlink{structapr__dir__t}{apr\+\_\+dir\+\_\+t} $\ast$\hyperlink{group__apr__portabile_ga615037f19c897e8cf0feb5f2888fb819}{thedir})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{unix_2dir_8c_a51e0b4703c7561f72587982808985d29}{apr\+\_\+dir\+\_\+make} (const char $\ast$\hyperlink{ab_8c_a3b02c6de5c049804444a246f7fdf46b4}{path}, \hyperlink{group__apr__file__info_ga3af19c4c47007169064a70f9351bc7d8}{apr\+\_\+fileperms\+\_\+t} \hyperlink{group__APR__Util__DBM_gaa8065a83f4f6501dc243d0c894030278}{perm}, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APR__XLATE_gabb3cd978f04c73d0b763c391e9bfde73}{pool})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{unix_2dir_8c_a6a3b2602f57ff148cd64096da02adbd2}{apr\+\_\+dir\+\_\+make\+\_\+recursive} (const char $\ast$\hyperlink{ab_8c_a3b02c6de5c049804444a246f7fdf46b4}{path}, \hyperlink{group__apr__file__info_ga3af19c4c47007169064a70f9351bc7d8}{apr\+\_\+fileperms\+\_\+t} \hyperlink{group__APR__Util__DBM_gaa8065a83f4f6501dc243d0c894030278}{perm}, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APR__XLATE_gabb3cd978f04c73d0b763c391e9bfde73}{pool})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{unix_2dir_8c_a5487d02a62fba9444747ccb5838150ba}{apr\+\_\+dir\+\_\+remove} (const char $\ast$\hyperlink{ab_8c_a3b02c6de5c049804444a246f7fdf46b4}{path}, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APR__XLATE_gabb3cd978f04c73d0b763c391e9bfde73}{pool})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{unix_2dir_8c_a99225bfab137069b9d5c5a72f863c577}{apr\+\_\+os\+\_\+dir\+\_\+get} (\hyperlink{group__apr__portabile_gacb790646cfc3da1b43a5f7c4bfaa3937}{apr\+\_\+os\+\_\+dir\+\_\+t} $\ast$$\ast$\hyperlink{group__apr__portabile_ga615037f19c897e8cf0feb5f2888fb819}{thedir}, \hyperlink{structapr__dir__t}{apr\+\_\+dir\+\_\+t} $\ast$\hyperlink{pcregrep_8txt_a6d902c83b02c43071b972ed0416729bc}{dir})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{unix_2dir_8c_ad30a2b690b79e632d55aab4ce4e6ca82}{apr\+\_\+os\+\_\+dir\+\_\+put} (\hyperlink{structapr__dir__t}{apr\+\_\+dir\+\_\+t} $\ast$$\ast$\hyperlink{pcregrep_8txt_a6d902c83b02c43071b972ed0416729bc}{dir}, \hyperlink{group__apr__portabile_gacb790646cfc3da1b43a5f7c4bfaa3937}{apr\+\_\+os\+\_\+dir\+\_\+t} $\ast$\hyperlink{group__apr__portabile_ga615037f19c897e8cf0feb5f2888fb819}{thedir}, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APR__XLATE_gabb3cd978f04c73d0b763c391e9bfde73}{pool})
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{unix/dir.\+c@{unix/dir.\+c}!P\+A\+T\+H\+\_\+\+S\+E\+P\+A\+R\+A\+T\+OR@{P\+A\+T\+H\+\_\+\+S\+E\+P\+A\+R\+A\+T\+OR}}
\index{P\+A\+T\+H\+\_\+\+S\+E\+P\+A\+R\+A\+T\+OR@{P\+A\+T\+H\+\_\+\+S\+E\+P\+A\+R\+A\+T\+OR}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{P\+A\+T\+H\+\_\+\+S\+E\+P\+A\+R\+A\+T\+OR}{PATH_SEPARATOR}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+T\+H\+\_\+\+S\+E\+P\+A\+R\+A\+T\+OR~\textquotesingle{}/\textquotesingle{}}\hypertarget{unix_2dir_8c_a256a5721249aa3309437212cc21a9fe4}{}\label{unix_2dir_8c_a256a5721249aa3309437212cc21a9fe4}


\subsection{Function Documentation}
\index{unix/dir.\+c@{unix/dir.\+c}!apr\+\_\+dir\+\_\+close@{apr\+\_\+dir\+\_\+close}}
\index{apr\+\_\+dir\+\_\+close@{apr\+\_\+dir\+\_\+close}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{apr\+\_\+dir\+\_\+close(apr\+\_\+dir\+\_\+t $\ast$thedir)}{apr_dir_close(apr_dir_t *thedir)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} apr\+\_\+dir\+\_\+close (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+dir\+\_\+t} $\ast$}]{thedir}
\end{DoxyParamCaption}
)}\hypertarget{unix_2dir_8c_a57fef00ccea03e9244f6fa21da4d3359}{}\label{unix_2dir_8c_a57fef00ccea03e9244f6fa21da4d3359}

\begin{DoxyCode}
101 \{
102     \textcolor{keywordflow}{return} apr\_pool\_cleanup\_run(thedir->\hyperlink{structapr__dir__t_a3cb1521d8e75d392e708934f9c6fd178}{pool}, thedir, dir\_cleanup);
103 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{unix_2dir_8c_a57fef00ccea03e9244f6fa21da4d3359_icgraph}
\end{center}
\end{figure}


\index{unix/dir.\+c@{unix/dir.\+c}!apr\+\_\+dir\+\_\+make@{apr\+\_\+dir\+\_\+make}}
\index{apr\+\_\+dir\+\_\+make@{apr\+\_\+dir\+\_\+make}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{apr\+\_\+dir\+\_\+make(const char $\ast$path, apr\+\_\+fileperms\+\_\+t perm, apr\+\_\+pool\+\_\+t $\ast$pool)}{apr_dir_make(const char *path, apr_fileperms_t perm, apr_pool_t *pool)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} apr\+\_\+dir\+\_\+make (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{path, }
\item[{{\bf apr\+\_\+fileperms\+\_\+t}}]{perm, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{pool}
\end{DoxyParamCaption}
)}\hypertarget{unix_2dir_8c_a51e0b4703c7561f72587982808985d29}{}\label{unix_2dir_8c_a51e0b4703c7561f72587982808985d29}

\begin{DoxyCode}
290 \{
291     \hyperlink{aplibtool_8c_a18c6d44ab22b2cd0d38a2dd0ef13ed1c}{mode\_t} \hyperlink{group__APACHE__CORE__FILTER_gad194431669b7d1f96d2dacfb7be21261}{mode} = \hyperlink{unix_2fileacc_8c_a6ff1e968d4350cb1184ec6ed57ac3902}{apr\_unix\_perms2mode}(\hyperlink{group__apr__file__io_gaa8065a83f4f6501dc243d0c894030278}{perm});
292 
293     \textcolor{keywordflow}{if} (mkdir(\hyperlink{group__APACHE__CORE__CONFIG_gab559cff0ba49c0f92a0dc777d5730496}{path}, mode) == 0) \{
294         \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
295     \}
296     \textcolor{keywordflow}{else} \{
297         \textcolor{keywordflow}{return} errno;
298     \}
299 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=306pt]{unix_2dir_8c_a51e0b4703c7561f72587982808985d29_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{unix_2dir_8c_a51e0b4703c7561f72587982808985d29_icgraph}
\end{center}
\end{figure}


\index{unix/dir.\+c@{unix/dir.\+c}!apr\+\_\+dir\+\_\+make\+\_\+recursive@{apr\+\_\+dir\+\_\+make\+\_\+recursive}}
\index{apr\+\_\+dir\+\_\+make\+\_\+recursive@{apr\+\_\+dir\+\_\+make\+\_\+recursive}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{apr\+\_\+dir\+\_\+make\+\_\+recursive(const char $\ast$path, apr\+\_\+fileperms\+\_\+t perm, apr\+\_\+pool\+\_\+t $\ast$pool)}{apr_dir_make_recursive(const char *path, apr_fileperms_t perm, apr_pool_t *pool)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} apr\+\_\+dir\+\_\+make\+\_\+recursive (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{path, }
\item[{{\bf apr\+\_\+fileperms\+\_\+t}}]{perm, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{pool}
\end{DoxyParamCaption}
)}\hypertarget{unix_2dir_8c_a6a3b2602f57ff148cd64096da02adbd2}{}\label{unix_2dir_8c_a6a3b2602f57ff148cd64096da02adbd2}

\begin{DoxyCode}
303 \{
304     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} apr\_err = 0;
305     
306     apr\_err = \hyperlink{unix_2dir_8c_a51e0b4703c7561f72587982808985d29}{apr\_dir\_make} (\hyperlink{group__APACHE__CORE__CONFIG_gab559cff0ba49c0f92a0dc777d5730496}{path}, \hyperlink{group__apr__file__io_gaa8065a83f4f6501dc243d0c894030278}{perm}, pool); \textcolor{comment}{/* Try to make PATH right out */}
307     
308     \textcolor{keywordflow}{if} (apr\_err == ENOENT) \{ \textcolor{comment}{/* Missing an intermediate dir */}
309         \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__DAEMON_ga6d902c83b02c43071b972ed0416729bc}{dir};
310         
311         dir = path\_remove\_last\_component(\hyperlink{group__APACHE__CORE__CONFIG_gab559cff0ba49c0f92a0dc777d5730496}{path}, pool);
312         \textcolor{comment}{/* If there is no path left, give up. */}
313         \textcolor{keywordflow}{if} (dir[0] == \textcolor{charliteral}{'\(\backslash\)0'}) \{
314             \textcolor{keywordflow}{return} apr\_err;
315         \}
316 
317         apr\_err = \hyperlink{unix_2dir_8c_a6a3b2602f57ff148cd64096da02adbd2}{apr\_dir\_make\_recursive}(dir, \hyperlink{group__apr__file__io_gaa8065a83f4f6501dc243d0c894030278}{perm}, pool);
318         
319         \textcolor{keywordflow}{if} (!apr\_err) 
320             apr\_err = \hyperlink{unix_2dir_8c_a51e0b4703c7561f72587982808985d29}{apr\_dir\_make} (\hyperlink{group__APACHE__CORE__CONFIG_gab559cff0ba49c0f92a0dc777d5730496}{path}, \hyperlink{group__apr__file__io_gaa8065a83f4f6501dc243d0c894030278}{perm}, pool);
321     \}
322 
323     \textcolor{comment}{/*}
324 \textcolor{comment}{     * It's OK if PATH exists. Timing issues can lead to the second}
325 \textcolor{comment}{     * apr\_dir\_make being called on existing dir, therefore this check}
326 \textcolor{comment}{     * has to come last.}
327 \textcolor{comment}{     */}
328     \textcolor{keywordflow}{if} (\hyperlink{group__APR__STATUS__IS_ga37707a0f41b084f1ce1a13575f4f21db}{APR\_STATUS\_IS\_EEXIST}(apr\_err))
329         \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
330 
331     \textcolor{keywordflow}{return} apr\_err;
332 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{unix_2dir_8c_a6a3b2602f57ff148cd64096da02adbd2_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=327pt]{unix_2dir_8c_a6a3b2602f57ff148cd64096da02adbd2_icgraph}
\end{center}
\end{figure}


\index{unix/dir.\+c@{unix/dir.\+c}!apr\+\_\+dir\+\_\+open@{apr\+\_\+dir\+\_\+open}}
\index{apr\+\_\+dir\+\_\+open@{apr\+\_\+dir\+\_\+open}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{apr\+\_\+dir\+\_\+open(apr\+\_\+dir\+\_\+t $\ast$$\ast$new, const char $\ast$dirname, apr\+\_\+pool\+\_\+t $\ast$pool)}{apr_dir_open(apr_dir_t **new, const char *dirname, apr_pool_t *pool)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} apr\+\_\+dir\+\_\+open (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+dir\+\_\+t} $\ast$$\ast$}]{new, }
\item[{const char $\ast$}]{dirname, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{pool}
\end{DoxyParamCaption}
)}\hypertarget{unix_2dir_8c_a6116289feec09ec86c564e926a5f4cd2}{}\label{unix_2dir_8c_a6116289feec09ec86c564e926a5f4cd2}

\begin{DoxyCode}
73 \{
74     \textcolor{comment}{/* On some platforms (e.g., Linux+GNU libc), d\_name[] in struct }
75 \textcolor{comment}{     * dirent is declared with enough storage for the name.  On other}
76 \textcolor{comment}{     * platforms (e.g., Solaris 8 for Intel), d\_name is declared as a}
77 \textcolor{comment}{     * one-byte array.  Note: gcc evaluates this at compile time.}
78 \textcolor{comment}{     */}
79     \hyperlink{group__apr__platform_gaaa72b2253f6f3032cefea5712a27540e}{apr\_size\_t} dirent\_size = 
80         \textcolor{keyword}{sizeof}(*(*new)->entry) +
81         (\textcolor{keyword}{sizeof}((*new)->entry->d\_name) > 1 ? 0 : 255);
82     DIR *\hyperlink{group__APACHE__CORE__DAEMON_ga6d902c83b02c43071b972ed0416729bc}{dir} = opendir(\hyperlink{group__apr__dir_gab8a2fd169b20f0b9d33959f7b17d35aa}{dirname});
83 
84     \textcolor{keywordflow}{if} (!dir) \{
85         \textcolor{keywordflow}{return} errno;
86     \}
87 
88     (*new) = (\hyperlink{structapr__dir__t}{apr\_dir\_t} *)apr\_palloc(pool, \textcolor{keyword}{sizeof}(\hyperlink{structapr__dir__t}{apr\_dir\_t}));
89 
90     (*new)->pool = \hyperlink{group__APACHE__CORE__MUTEX_ga8fea43b485988aa6df5dced9dddbe733}{pool};
91     (*new)->dirname = apr\_pstrdup(pool, \hyperlink{group__apr__dir_gab8a2fd169b20f0b9d33959f7b17d35aa}{dirname});
92     (*new)->dirstruct = \hyperlink{group__APACHE__CORE__DAEMON_ga6d902c83b02c43071b972ed0416729bc}{dir};
93     (*new)->entry = \hyperlink{group__apr__pools_gad214fc0160de3c22b6435e29ea20fce8}{apr\_pcalloc}(pool, dirent\_size);
94 
95     apr\_pool\_cleanup\_register((*new)->pool, *\textcolor{keyword}{new}, dir\_cleanup,
96                               apr\_pool\_cleanup\_null);
97     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
98 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{unix_2dir_8c_a6116289feec09ec86c564e926a5f4cd2_icgraph}
\end{center}
\end{figure}


\index{unix/dir.\+c@{unix/dir.\+c}!apr\+\_\+dir\+\_\+read@{apr\+\_\+dir\+\_\+read}}
\index{apr\+\_\+dir\+\_\+read@{apr\+\_\+dir\+\_\+read}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{apr\+\_\+dir\+\_\+read(apr\+\_\+finfo\+\_\+t $\ast$finfo, apr\+\_\+int32\+\_\+t wanted, apr\+\_\+dir\+\_\+t $\ast$thedir)}{apr_dir_read(apr_finfo_t *finfo, apr_int32_t wanted, apr_dir_t *thedir)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} apr\+\_\+dir\+\_\+read (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+finfo\+\_\+t} $\ast$}]{finfo, }
\item[{{\bf apr\+\_\+int32\+\_\+t}}]{wanted, }
\item[{{\bf apr\+\_\+dir\+\_\+t} $\ast$}]{thedir}
\end{DoxyParamCaption}
)}\hypertarget{unix_2dir_8c_a3e4ee253e0c712160bee10bfb9c8e4a8}{}\label{unix_2dir_8c_a3e4ee253e0c712160bee10bfb9c8e4a8}

\begin{DoxyCode}
135 \{
136     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} \hyperlink{group__APACHE__MPM_ga794c48ec324a4d85a40f38fe264d2a41}{ret} = 0;
137 \textcolor{preprocessor}{#ifdef DIRENT\_TYPE}
138     \hyperlink{group__apr__file__info_gae3f0ce3014337a52b39852f8bf81ca7c}{apr\_filetype\_e} \hyperlink{group__APACHE__CORE__HTTPD_gaafc7089562892428c4fcae486f171f5a}{type};
139 \textcolor{preprocessor}{#endif}
140 \textcolor{preprocessor}{#if APR\_HAS\_THREADS && defined(\_POSIX\_THREAD\_SAFE\_FUNCTIONS) \(\backslash\)}
141 \textcolor{preprocessor}{                    && !defined(READDIR\_IS\_THREAD\_SAFE)}
142 \textcolor{preprocessor}{#ifdef APR\_USE\_READDIR64\_R}
143     \textcolor{keyword}{struct }dirent64 *retent;
144 
145     \textcolor{comment}{/* If LFS is enabled and readdir64\_r is available, readdir64\_r is}
146 \textcolor{comment}{     * used in preference to readdir\_r.  This allows directories to be}
147 \textcolor{comment}{     * read which contain a (64-bit) inode number which doesn't fit}
148 \textcolor{comment}{     * into the 32-bit apr\_ino\_t, iff the caller doesn't actually care}
149 \textcolor{comment}{     * about the inode number (i.e. wanted & APR\_FINFO\_INODE == 0).}
150 \textcolor{comment}{     * (such inodes may be seen in some wonky NFS environments)}
151 \textcolor{comment}{     *}
152 \textcolor{comment}{     * Similarly, if the d\_off field cannot be reprented in a 32-bit}
153 \textcolor{comment}{     * offset, the libc readdir\_r() would barf; using readdir64\_r}
154 \textcolor{comment}{     * bypasses that case entirely since APR does not care about}
155 \textcolor{comment}{     * d\_off. */}
156 
157     ret = readdir64\_r(thedir->\hyperlink{structapr__dir__t_ab9a95626319c43bf881fef29494d4210}{dirstruct}, thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}, &retent);
158 \textcolor{preprocessor}{#else}
159 
160     \textcolor{keyword}{struct }dirent *retent;
161 
162     ret = readdir\_r(thedir->\hyperlink{structapr__dir__t_ab9a95626319c43bf881fef29494d4210}{dirstruct}, thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}, &retent);
163 \textcolor{preprocessor}{#endif}
164 
165     \textcolor{comment}{/* POSIX treats "end of directory" as a non-error case, so ret}
166 \textcolor{comment}{     * will be zero and retent will be set to NULL in that case. */}
167     \textcolor{keywordflow}{if} (!ret && retent == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
168         ret = \hyperlink{group__APR__Error_gacc26a4afe01b6cc141f839be71fddf1c}{APR\_ENOENT};
169     \}
170 
171     \textcolor{comment}{/* Solaris is a bit strange, if there are no more entries in the}
172 \textcolor{comment}{     * directory, it returns EINVAL.  Since this is against POSIX, we}
173 \textcolor{comment}{     * hack around the problem here.  EINVAL is possible from other}
174 \textcolor{comment}{     * readdir implementations, but only if the result buffer is too small.}
175 \textcolor{comment}{     * since we control the size of that buffer, we should never have}
176 \textcolor{comment}{     * that problem.}
177 \textcolor{comment}{     */}
178     \textcolor{keywordflow}{if} (ret == EINVAL) \{
179         ret = \hyperlink{group__APR__Error_gacc26a4afe01b6cc141f839be71fddf1c}{APR\_ENOENT};
180     \}
181 \textcolor{preprocessor}{#else}
182     \textcolor{comment}{/* We're about to call a non-thread-safe readdir() that may}
183 \textcolor{comment}{       possibly set `errno', and the logic below actually cares about}
184 \textcolor{comment}{       errno after the call.  Therefore we need to clear errno first. */}
185     errno = 0;
186     thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry} = readdir(thedir->\hyperlink{structapr__dir__t_ab9a95626319c43bf881fef29494d4210}{dirstruct});
187     \textcolor{keywordflow}{if} (thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry} == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
188         \textcolor{comment}{/* If NULL was returned, this can NEVER be a success. Can it?! */}
189         \textcolor{keywordflow}{if} (errno == \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
190             ret = \hyperlink{group__APR__Error_gacc26a4afe01b6cc141f839be71fddf1c}{APR\_ENOENT};
191         \}
192         \textcolor{keywordflow}{else}
193             ret = errno;
194     \}
195 \textcolor{preprocessor}{#endif}
196 
197     \textcolor{comment}{/* No valid bit flag to test here - do we want one? */}
198     finfo->\hyperlink{structapr__finfo__t_acfed83ab2943ee7a58a215aa1cfd9e47}{fname} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
199 
200     \textcolor{keywordflow}{if} (ret) \{
201         finfo->\hyperlink{structapr__finfo__t_aff0cdf06637edec63c4701e582792019}{valid} = 0;
202         \textcolor{keywordflow}{return} \hyperlink{group__APACHE__MPM_ga794c48ec324a4d85a40f38fe264d2a41}{ret};
203     \}
204 
205 \textcolor{preprocessor}{#ifdef DIRENT\_TYPE}
206     type = filetype\_from\_dirent\_type(thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}->DIRENT\_TYPE);
207     \textcolor{keywordflow}{if} (type != \hyperlink{group__apr__file__info_ggae3f0ce3014337a52b39852f8bf81ca7ca3347d2110d62ce464ddf1ae38759e6b0}{APR\_UNKFILE}) \{
208         \hyperlink{group__apr__file__stat_ga48805d2a6845252444835c7809c73ade}{wanted} &= ~\hyperlink{group__apr__file__stat_gad5d25f25527ee77c08bb20aae141306c}{APR\_FINFO\_TYPE};
209     \}
210 \textcolor{preprocessor}{#endif}
211 \textcolor{preprocessor}{#ifdef DIRENT\_INODE}
212     \textcolor{keywordflow}{if} (thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}->DIRENT\_INODE && thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}->DIRENT\_INODE != -1) \{
213 \textcolor{preprocessor}{#ifdef APR\_USE\_READDIR64\_R}
214         \textcolor{comment}{/* If readdir64\_r is used, check for the overflow case of trying}
215 \textcolor{comment}{         * to fit a 64-bit integer into a 32-bit integer. */}
216         \textcolor{keywordflow}{if} (\textcolor{keyword}{sizeof}(\hyperlink{group__apr__platform_ga0a5ae63884288a9f69f4e384a23bad68}{apr\_ino\_t}) >= \textcolor{keyword}{sizeof}(retent->DIRENT\_INODE)
217             || (\hyperlink{group__apr__platform_ga0a5ae63884288a9f69f4e384a23bad68}{apr\_ino\_t})retent->DIRENT\_INODE == retent->DIRENT\_INODE) \{
218             \hyperlink{group__apr__file__stat_ga48805d2a6845252444835c7809c73ade}{wanted} &= ~\hyperlink{group__apr__file__stat_ga4fee7341395912db501b40de81dbba26}{APR\_FINFO\_INODE};
219         \} \textcolor{keywordflow}{else} \{
220             \textcolor{comment}{/* Prevent the fallback code below from filling in the}
221 \textcolor{comment}{             * inode if the stat call fails. */}
222             retent->DIRENT\_INODE = 0;
223         \}
224 \textcolor{preprocessor}{#else}
225         \hyperlink{group__apr__file__stat_ga48805d2a6845252444835c7809c73ade}{wanted} &= ~\hyperlink{group__apr__file__stat_ga4fee7341395912db501b40de81dbba26}{APR\_FINFO\_INODE};
226 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* APR\_USE\_READDIR64\_R */}\textcolor{preprocessor}{}
227     \}
228 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* DIRENT\_INODE */}\textcolor{preprocessor}{}
229 
230     \hyperlink{group__apr__file__stat_ga48805d2a6845252444835c7809c73ade}{wanted} &= ~\hyperlink{group__apr__file__stat_ga7fa4caf84808c11a1ec33c5c8d613e4b}{APR\_FINFO\_NAME};
231 
232     \textcolor{keywordflow}{if} (\hyperlink{group__apr__file__stat_ga48805d2a6845252444835c7809c73ade}{wanted})
233     \{
234         \textcolor{keywordtype}{char} fspec[APR\_PATH\_MAX];
235         \textcolor{keywordtype}{char} *\hyperlink{group__apr__strings_ga87c7e3f3f70b6e7de10e3f56e3f4d7a4}{end};
236 
237         end = apr\_cpystrn(fspec, thedir->\hyperlink{structapr__dir__t_a18ca7f45c18219d94b1e500c70301cbb}{dirname}, \textcolor{keyword}{sizeof} fspec);
238 
239         \textcolor{keywordflow}{if} (end > fspec && end[-1] != \textcolor{charliteral}{'/'} && (end < fspec + APR\_PATH\_MAX))
240             *end++ = \textcolor{charliteral}{'/'};
241 
242         apr\_cpystrn(end, thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}->d\_name, 
243                     \textcolor{keyword}{sizeof} fspec - (end - fspec));
244 
245         ret = apr\_stat(finfo, fspec, \hyperlink{group__apr__file__stat_ga9b0c1d02401b845f928f836fdd3c6712}{APR\_FINFO\_LINK} | \hyperlink{group__apr__file__stat_ga48805d2a6845252444835c7809c73ade}{wanted}, thedir->
      \hyperlink{structapr__dir__t_a3cb1521d8e75d392e708934f9c6fd178}{pool});
246         \textcolor{comment}{/* We passed a stack name that will disappear */}
247         finfo->\hyperlink{structapr__finfo__t_acfed83ab2943ee7a58a215aa1cfd9e47}{fname} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
248     \}
249 
250     \textcolor{keywordflow}{if} (\hyperlink{group__apr__file__stat_ga48805d2a6845252444835c7809c73ade}{wanted} && (ret == \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS} || ret == \hyperlink{group__APR__Error_ga64dff43b83bcefd3f3c751be6b864ca1}{APR\_INCOMPLETE})) \{
251         \hyperlink{group__apr__file__stat_ga48805d2a6845252444835c7809c73ade}{wanted} &= ~finfo->\hyperlink{structapr__finfo__t_aff0cdf06637edec63c4701e582792019}{valid};
252     \}
253     \textcolor{keywordflow}{else} \{
254         \textcolor{comment}{/* We don't bail because we fail to stat, when we are only -required-}
255 \textcolor{comment}{         * to readdir... but the result will be APR\_INCOMPLETE}
256 \textcolor{comment}{         */}
257         finfo->\hyperlink{structapr__finfo__t_a71496f86b5489c87e58e9c03fe468fb8}{pool} = thedir->\hyperlink{structapr__dir__t_a3cb1521d8e75d392e708934f9c6fd178}{pool};
258         finfo->\hyperlink{structapr__finfo__t_aff0cdf06637edec63c4701e582792019}{valid} = 0;
259 \textcolor{preprocessor}{#ifdef DIRENT\_TYPE}
260         \textcolor{keywordflow}{if} (type != \hyperlink{group__apr__file__info_ggae3f0ce3014337a52b39852f8bf81ca7ca3347d2110d62ce464ddf1ae38759e6b0}{APR\_UNKFILE}) \{
261             finfo->\hyperlink{structapr__finfo__t_a274ae0dd60b59182c2e0134bc9a09a20}{filetype} = \hyperlink{group__APACHE__CORE__HTTPD_gaafc7089562892428c4fcae486f171f5a}{type};
262             finfo->\hyperlink{structapr__finfo__t_aff0cdf06637edec63c4701e582792019}{valid} |= \hyperlink{group__apr__file__stat_gad5d25f25527ee77c08bb20aae141306c}{APR\_FINFO\_TYPE};
263         \}
264 \textcolor{preprocessor}{#endif}
265 \textcolor{preprocessor}{#ifdef DIRENT\_INODE}
266         \textcolor{keywordflow}{if} (thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}->DIRENT\_INODE && thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}->DIRENT\_INODE != -1) \{
267             finfo->\hyperlink{structapr__finfo__t_a73aebb666ddc391d53a871802c27eed6}{inode} = thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}->DIRENT\_INODE;
268             finfo->\hyperlink{structapr__finfo__t_aff0cdf06637edec63c4701e582792019}{valid} |= \hyperlink{group__apr__file__stat_ga4fee7341395912db501b40de81dbba26}{APR\_FINFO\_INODE};
269         \}
270 \textcolor{preprocessor}{#endif}
271     \}
272 
273     finfo->\hyperlink{structapr__finfo__t_a2915f9141ea76ae3672ccf9eb0fa77bb}{name} = apr\_pstrdup(thedir->\hyperlink{structapr__dir__t_a3cb1521d8e75d392e708934f9c6fd178}{pool}, thedir->\hyperlink{structapr__dir__t_a3ca708a80f894cffc347ee35a5055d8c}{entry}->d\_name);
274     finfo->\hyperlink{structapr__finfo__t_aff0cdf06637edec63c4701e582792019}{valid} |= \hyperlink{group__apr__file__stat_ga7fa4caf84808c11a1ec33c5c8d613e4b}{APR\_FINFO\_NAME};
275 
276     \textcolor{keywordflow}{if} (\hyperlink{group__apr__file__stat_ga48805d2a6845252444835c7809c73ade}{wanted})
277         \textcolor{keywordflow}{return} \hyperlink{group__APR__Error_ga64dff43b83bcefd3f3c751be6b864ca1}{APR\_INCOMPLETE};
278 
279     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
280 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{unix_2dir_8c_a3e4ee253e0c712160bee10bfb9c8e4a8_icgraph}
\end{center}
\end{figure}


\index{unix/dir.\+c@{unix/dir.\+c}!apr\+\_\+dir\+\_\+remove@{apr\+\_\+dir\+\_\+remove}}
\index{apr\+\_\+dir\+\_\+remove@{apr\+\_\+dir\+\_\+remove}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{apr\+\_\+dir\+\_\+remove(const char $\ast$path, apr\+\_\+pool\+\_\+t $\ast$pool)}{apr_dir_remove(const char *path, apr_pool_t *pool)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} apr\+\_\+dir\+\_\+remove (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{path, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{pool}
\end{DoxyParamCaption}
)}\hypertarget{unix_2dir_8c_a5487d02a62fba9444747ccb5838150ba}{}\label{unix_2dir_8c_a5487d02a62fba9444747ccb5838150ba}

\begin{DoxyCode}
335 \{
336     \textcolor{keywordflow}{if} (rmdir(\hyperlink{group__APACHE__CORE__CONFIG_gab559cff0ba49c0f92a0dc777d5730496}{path}) == 0) \{
337         \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
338     \}
339     \textcolor{keywordflow}{else} \{
340         \textcolor{keywordflow}{return} errno;
341     \}
342 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{unix_2dir_8c_a5487d02a62fba9444747ccb5838150ba_icgraph}
\end{center}
\end{figure}


\index{unix/dir.\+c@{unix/dir.\+c}!apr\+\_\+dir\+\_\+rewind@{apr\+\_\+dir\+\_\+rewind}}
\index{apr\+\_\+dir\+\_\+rewind@{apr\+\_\+dir\+\_\+rewind}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{apr\+\_\+dir\+\_\+rewind(apr\+\_\+dir\+\_\+t $\ast$thedir)}{apr_dir_rewind(apr_dir_t *thedir)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} apr\+\_\+dir\+\_\+rewind (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+dir\+\_\+t} $\ast$}]{thedir}
\end{DoxyParamCaption}
)}\hypertarget{unix_2dir_8c_ab9b9f23e76128144d3fb953cabea6290}{}\label{unix_2dir_8c_ab9b9f23e76128144d3fb953cabea6290}

\begin{DoxyCode}
283 \{
284     rewinddir(thedir->\hyperlink{structapr__dir__t_ab9a95626319c43bf881fef29494d4210}{dirstruct});
285     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
286 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=287pt]{unix_2dir_8c_ab9b9f23e76128144d3fb953cabea6290_icgraph}
\end{center}
\end{figure}


\index{unix/dir.\+c@{unix/dir.\+c}!apr\+\_\+os\+\_\+dir\+\_\+get@{apr\+\_\+os\+\_\+dir\+\_\+get}}
\index{apr\+\_\+os\+\_\+dir\+\_\+get@{apr\+\_\+os\+\_\+dir\+\_\+get}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{apr\+\_\+os\+\_\+dir\+\_\+get(apr\+\_\+os\+\_\+dir\+\_\+t $\ast$$\ast$thedir, apr\+\_\+dir\+\_\+t $\ast$dir)}{apr_os_dir_get(apr_os_dir_t **thedir, apr_dir_t *dir)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} apr\+\_\+os\+\_\+dir\+\_\+get (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+os\+\_\+dir\+\_\+t} $\ast$$\ast$}]{thedir, }
\item[{{\bf apr\+\_\+dir\+\_\+t} $\ast$}]{dir}
\end{DoxyParamCaption}
)}\hypertarget{unix_2dir_8c_a99225bfab137069b9d5c5a72f863c577}{}\label{unix_2dir_8c_a99225bfab137069b9d5c5a72f863c577}

\begin{DoxyCode}
345 \{
346     \textcolor{keywordflow}{if} (dir == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
347         \textcolor{keywordflow}{return} \hyperlink{group__APR__Error_ga9a8077e85b6241c1e91b69548395fc09}{APR\_ENODIR};
348     \}
349     *\hyperlink{group__apr__dir_gad52296d31a5d2f8307f60eed6a103209}{thedir} = dir->\hyperlink{structapr__dir__t_ab9a95626319c43bf881fef29494d4210}{dirstruct};
350     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
351 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=287pt]{unix_2dir_8c_a99225bfab137069b9d5c5a72f863c577_icgraph}
\end{center}
\end{figure}


\index{unix/dir.\+c@{unix/dir.\+c}!apr\+\_\+os\+\_\+dir\+\_\+put@{apr\+\_\+os\+\_\+dir\+\_\+put}}
\index{apr\+\_\+os\+\_\+dir\+\_\+put@{apr\+\_\+os\+\_\+dir\+\_\+put}!unix/dir.\+c@{unix/dir.\+c}}
\subsubsection[{\texorpdfstring{apr\+\_\+os\+\_\+dir\+\_\+put(apr\+\_\+dir\+\_\+t $\ast$$\ast$dir, apr\+\_\+os\+\_\+dir\+\_\+t $\ast$thedir, apr\+\_\+pool\+\_\+t $\ast$pool)}{apr_os_dir_put(apr_dir_t **dir, apr_os_dir_t *thedir, apr_pool_t *pool)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} apr\+\_\+os\+\_\+dir\+\_\+put (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+dir\+\_\+t} $\ast$$\ast$}]{dir, }
\item[{{\bf apr\+\_\+os\+\_\+dir\+\_\+t} $\ast$}]{thedir, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{pool}
\end{DoxyParamCaption}
)}\hypertarget{unix_2dir_8c_ad30a2b690b79e632d55aab4ce4e6ca82}{}\label{unix_2dir_8c_ad30a2b690b79e632d55aab4ce4e6ca82}

\begin{DoxyCode}
355 \{
356     \textcolor{keywordflow}{if} ((*dir) == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
357         (*dir) = (\hyperlink{structapr__dir__t}{apr\_dir\_t} *)\hyperlink{group__apr__pools_gad214fc0160de3c22b6435e29ea20fce8}{apr\_pcalloc}(pool, \textcolor{keyword}{sizeof}(
      \hyperlink{structapr__dir__t}{apr\_dir\_t}));
358         (*dir)->pool = \hyperlink{group__APACHE__CORE__MUTEX_ga8fea43b485988aa6df5dced9dddbe733}{pool};
359     \}
360     (*dir)->dirstruct = \hyperlink{group__apr__dir_gad52296d31a5d2f8307f60eed6a103209}{thedir};
361     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
362 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=287pt]{unix_2dir_8c_ad30a2b690b79e632d55aab4ce4e6ca82_icgraph}
\end{center}
\end{figure}


