\hypertarget{cache__storage_8c}{}\section{/usr/local/src/github/\+Codebase/httpd-\/2.4.29/modules/cache/cache\+\_\+storage.c File Reference}
\label{cache__storage_8c}\index{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/modules/cache/cache\+\_\+storage.\+c@{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/modules/cache/cache\+\_\+storage.\+c}}
{\ttfamily \#include \char`\"{}mod\+\_\+cache.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}time.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}cache\+\_\+storage.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}cache\+\_\+util.\+h\char`\"{}}\\*
Include dependency graph for cache\+\_\+storage.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cache__storage_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{cache__storage_8c_aa72a2cb5a9359a74d12d44c96b77c4d2}{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE} (\hyperlink{structcache}{cache})
\item 
\hyperlink{cache__storage_8c_a0c188ed1fe0083803d64f9d4d958508b}{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE} (\hyperlink{group__MOD__CACHE_ga5d2f230364a78ad03f94ebbca2dd1f5c}{ap\+\_\+cache\+\_\+generate\+\_\+key})
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__Cache__storage_gaa8317a8938235881e7f1368031b33bb9}{cache\+\_\+create\+\_\+entity} (\hyperlink{structcache__request__rec}{cache\+\_\+request\+\_\+rec} $\ast$\hyperlink{structcache}{cache}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r}, \hyperlink{group__apr__platform_ga6938af9075cec15c88299109381aa984}{apr\+\_\+off\+\_\+t} \hyperlink{README_8txt_a870076999eb1486aa63d2e2cf5cdfa55}{size}, \hyperlink{structapr__bucket__brigade}{apr\+\_\+bucket\+\_\+brigade} $\ast$\hyperlink{group__apr__thread__proc_ga2e46fea00cc2238744ebca5061c62bcc}{in})
\item 
\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{group__Cache__storage_ga0b273ea1fdda33adc7ecf2e47e4a57a7}{cache\+\_\+accept\+\_\+headers} (\hyperlink{group__MOD__CACHE_ga6b7854a2592838a565bdee8f94343aab}{cache\+\_\+handle\+\_\+t} $\ast$\hyperlink{pcregrep_8txt_a373589baca2cb79ec87f46d6599640b9}{h}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r}, \hyperlink{structapr__table__t}{apr\+\_\+table\+\_\+t} $\ast$top, \hyperlink{structapr__table__t}{apr\+\_\+table\+\_\+t} $\ast$bottom, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} revalidation)
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__Cache__storage_gaffb29f2e1276bc7d81bac540a1cf3e06}{cache\+\_\+select} (\hyperlink{structcache__request__rec}{cache\+\_\+request\+\_\+rec} $\ast$\hyperlink{structcache}{cache}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__Cache__storage_ga9b9cd90883d10b4e8f021c0cc371a823}{cache\+\_\+generate\+\_\+key\+\_\+default} (\hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r}, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, const char $\ast$$\ast$\hyperlink{apr__siphash_8h_adac0b6a30345ea1d0daa8a692b0b7ad9}{key})
\item 
\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} \hyperlink{group__Cache__storage_ga8579a258895a1e158ebe9e61deb15d9a}{cache\+\_\+invalidate} (\hyperlink{structcache__request__rec}{cache\+\_\+request\+\_\+rec} $\ast$\hyperlink{structcache}{cache}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r})
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{cache\+\_\+storage.\+c@{cache\+\_\+storage.\+c}!A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE@{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE}}
\index{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE@{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE}!cache\+\_\+storage.\+c@{cache\+\_\+storage.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+L\+E(cache)}{APLOG_USE_MODULE(cache)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE (
\begin{DoxyParamCaption}
\item[{{\bf cache}}]{}
\end{DoxyParamCaption}
)}\hypertarget{cache__storage_8c_aa72a2cb5a9359a74d12d44c96b77c4d2}{}\label{cache__storage_8c_aa72a2cb5a9359a74d12d44c96b77c4d2}
\index{cache\+\_\+storage.\+c@{cache\+\_\+storage.\+c}!A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE@{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE}}
\index{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE@{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE}!cache\+\_\+storage.\+c@{cache\+\_\+storage.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+P\+E(ap\+\_\+cache\+\_\+generate\+\_\+key)}{APR_OPTIONAL_FN_TYPE(ap_cache_generate_key)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+R\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+F\+N\+\_\+\+T\+Y\+PE (
\begin{DoxyParamCaption}
\item[{{\bf ap\+\_\+cache\+\_\+generate\+\_\+key}}]{}
\end{DoxyParamCaption}
)}\hypertarget{cache__storage_8c_a0c188ed1fe0083803d64f9d4d958508b}{}\label{cache__storage_8c_a0c188ed1fe0083803d64f9d4d958508b}

\begin{DoxyCode}
35 \{
36     \hyperlink{structcache__provider__list}{cache\_provider\_list} *\hyperlink{group__APACHE__CORE__PROTO_gaeb6b944e4524f915483b5696b7f2f424}{list};
37     \hyperlink{structcache__handle}{cache\_handle\_t} *\hyperlink{group__apr__hash_ga0d6dcb41ca5e794b318df5f6fd273ee2}{h};
38 
39     list = \hyperlink{structcache}{cache}->providers;
40 
41     \textcolor{comment}{/* Remove the stale cache entry if present. If not, we're}
42 \textcolor{comment}{     * being called from outside of a request; remove the}
43 \textcolor{comment}{     * non-stale handle.}
44 \textcolor{comment}{     */}
45     h = \hyperlink{structcache}{cache}->stale\_handle ? \hyperlink{structcache}{cache}->stale\_handle : \hyperlink{structcache}{cache}->handle;
46     \textcolor{keywordflow}{if} (!h) \{
47        \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__DAEMON_gaba51915c87d64af47fb1cc59348961c9}{OK};
48     \}
49     \hyperlink{group__APACHE__CORE__LOG_ga4c112558ccffd6b363da102b2052d2a6}{ap\_log\_rerror}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_gadfcef90537539cf2b7d35cfbbbafeb93}{APLOG\_DEBUG}, 0, 
      \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}, \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(00691)
50                  \textcolor{stringliteral}{"cache: Removing url %s from the cache"}, h->\hyperlink{structcache__handle_aea71e9fd166a32e0fe46a12668a1f3bd}{cache\_obj}->
      \hyperlink{structcache__object_a6dfc38a2cd449d6ede42716a80e11f92}{key});
51 
52     \textcolor{comment}{/* for each specified cache type, delete the URL */}
53     \textcolor{keyword}{struct }timespec \hyperlink{group__APACHE__CORE__DAEMON_ga6d3a995932cd00f6b3473898aa90d596}{start}, finish;
54     \textcolor{keywordtype}{double} elapsed = 0;
55     \textcolor{keywordtype}{int} \hyperlink{group__APR__MD5_ga16ff2d8e15ade4948398b0aeb80124a8}{count} = 0;
56     \textcolor{keywordflow}{while} (list) \{
57     clock\_gettime(CLOCK\_MONOTONIC, &\hyperlink{group__APACHE__CORE__DAEMON_ga6d3a995932cd00f6b3473898aa90d596}{start});
58         list->\hyperlink{structcache__provider__list_a1e1caa5b70698f255962728326dc1be3}{provider}->\hyperlink{structcache__provider_a82d8c41dcf037abc2cfbe6eb3706463a}{remove\_url}(h, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r});
59     clock\_gettime(CLOCK\_MONOTONIC, &finish);
60     elapsed += (finish.tv\_nsec - \hyperlink{group__APACHE__CORE__DAEMON_ga6d3a995932cd00f6b3473898aa90d596}{start}.tv\_nsec) / 500000000.0;
61     count++;
62         list = list->\hyperlink{structcache__provider__list_a87c07afc8bb63fe7fd2e9274e60341a9}{next};
63     \}
64     \textcolor{keywordflow}{if} (count != 0) \{
65     elapsed /= \hyperlink{group__APR__MD5_ga16ff2d8e15ade4948398b0aeb80124a8}{count};
66     \hyperlink{group__APACHE__CORE__LOG_ga5e6676c87418af7a1d323a116c78ecb4}{ap\_log\_error}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga9f0686ea770c44e205d1c12be74fc21f}{APLOG\_CRIT}, 0, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r} -> 
      \hyperlink{group__APACHE__CORE__MUTEX_ga32727ee32089d3426d1d6a7280d28228}{server}, \textcolor{stringliteral}{"%lf REMOVE URL"}, elapsed);   
67     \}
68     \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__DAEMON_gaba51915c87d64af47fb1cc59348961c9}{OK};
69 \}
\end{DoxyCode}
