\hypertarget{util__mutex_8c}{}\section{/usr/local/src/github/\+Codebase/httpd-\/2.4.29/server/util\+\_\+mutex.c File Reference}
\label{util__mutex_8c}\index{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/server/util\+\_\+mutex.\+c@{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/server/util\+\_\+mutex.\+c}}
{\ttfamily \#include \char`\"{}apr.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+hash.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+strings.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+lib.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+want.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ap\+\_\+config.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}httpd.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+main.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+config.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+core.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+log.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}util\+\_\+mutex.\+h\char`\"{}}\\*
Include dependency graph for util\+\_\+mutex.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__mutex_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structmutex__cfg__t}{mutex\+\_\+cfg\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{util__mutex_8c_a88a4bf7f483aad3f3945773f3383e713}{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}
\item 
\#define \hyperlink{util__mutex_8c_ae75325996d1b2cf6120dded4cb153a22}{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}~\hyperlink{group__APACHE__CORE__HTTPD_gaf1cdaac5f4562d9d20bae417471ad422}{A\+P\+\_\+\+C\+O\+R\+E\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{util__mutex_8c_ad4e49a371518f348d13b2d4e83b79b9e}{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t})
\item 
\hyperlink{group__APACHE__CORE__LISTEN_ga41a09cbeeecb4898dbae176a6e720c68}{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+N\+O\+N\+S\+TD} (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})
\item 
\hyperlink{util__mutex_8c_a3c3d35fe71135329f5cf444e02610da7}{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+N\+O\+N\+S\+TD} (const char $\ast$)
\item 
\hyperlink{group__MOD__CORE_ga67c82c46d8e12b9b3ccf7c96c288f207}{A\+P\+\_\+\+C\+O\+R\+E\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{util\+\_\+mutex.\+c@{util\+\_\+mutex.\+c}!A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX@{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}}
\index{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX@{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}!util\+\_\+mutex.\+c@{util\+\_\+mutex.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}{APLOG_MODULE_INDEX}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX~{\bf A\+P\+\_\+\+C\+O\+R\+E\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}}\hypertarget{util__mutex_8c_ae75325996d1b2cf6120dded4cb153a22}{}\label{util__mutex_8c_ae75325996d1b2cf6120dded4cb153a22}
\index{util\+\_\+mutex.\+c@{util\+\_\+mutex.\+c}!A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC@{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}}
\index{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC@{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}!util\+\_\+mutex.\+c@{util\+\_\+mutex.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}{APR_WANT_STRFUNC}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}\hypertarget{util__mutex_8c_a88a4bf7f483aad3f3945773f3383e713}{}\label{util__mutex_8c_a88a4bf7f483aad3f3945773f3383e713}


\subsection{Function Documentation}
\index{util\+\_\+mutex.\+c@{util\+\_\+mutex.\+c}!A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}!util\+\_\+mutex.\+c@{util\+\_\+mutex.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E(apr\+\_\+status\+\_\+t)}{AP_DECLARE(apr_status_t)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{{\bf apr\+\_\+status\+\_\+t}}]{}
\end{DoxyParamCaption}
)}\hypertarget{util__mutex_8c_ad4e49a371518f348d13b2d4e83b79b9e}{}\label{util__mutex_8c_ad4e49a371518f348d13b2d4e83b79b9e}

\begin{DoxyCode}
52 \{
53     \textcolor{comment}{/* Split arg into meth and file */}
54     \textcolor{keywordtype}{char} *meth = apr\_pstrdup(\hyperlink{group__APACHE__CORE__MUTEX_ga8fea43b485988aa6df5dced9dddbe733}{pool}, \hyperlink{group__APACHE__CORE__LISTEN_ga71f9d4c76ff7cd8f3db5697a5cfa7b08}{arg});
55     \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__LOG_ga52f984475a42d9227fcbfd159db35676}{file} = strchr(meth, \textcolor{charliteral}{':'});
56     \textcolor{keywordflow}{if} (file) \{
57         *(file++) = \textcolor{charliteral}{'\(\backslash\)0'};
58         \textcolor{keywordflow}{if} (!*file) \{
59             file = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
60         \}
61     \}
62 
63     \textcolor{comment}{/* APR determines temporary filename unless overridden below,}
64 \textcolor{comment}{     * we presume file indicates an mutexfile is a file path}
65 \textcolor{comment}{     * unless the method sets mutexfile=file and NULLs file}
66 \textcolor{comment}{     */}
67     *\hyperlink{group__APACHE__CORE__MUTEX_gaa4b7af5163be82f815eb2e47c2b4480e}{mutexfile} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
68 
69     \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"none"}) || !\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"no"})) \{
70         \textcolor{keywordflow}{return} \hyperlink{group__APR__Error_ga9c411624c42f7562a5c6c3461bdcb0ec}{APR\_ENOLOCK};
71     \}
72 
73     \textcolor{comment}{/* NOTE: previously, 'yes' implied 'sem' */}
74     \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"default"}) || !\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"yes"})) \{
75         *\hyperlink{group__APACHE__CORE__MUTEX_ga2b93d746dbd53f3815877a7b19f89be1}{mutexmech} = \hyperlink{group__apr__proc__mutex_gga75dd95a48a1e855a87b509b522746ed4ae91fb435c45216bcf84f506db99d0f19}{APR\_LOCK\_DEFAULT};
76     \}
77 \textcolor{preprocessor}{#if APR\_HAS\_FCNTL\_SERIALIZE}
78     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"fcntl"}) || !\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"file"})) \{
79         *\hyperlink{group__APACHE__CORE__MUTEX_ga2b93d746dbd53f3815877a7b19f89be1}{mutexmech} = \hyperlink{group__apr__proc__mutex_gga75dd95a48a1e855a87b509b522746ed4ad9dad69d83d1e112054ad21a7e4e16b3}{APR\_LOCK\_FCNTL};
80     \}
81 \textcolor{preprocessor}{#endif}
82 \textcolor{preprocessor}{#if APR\_HAS\_FLOCK\_SERIALIZE}
83     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"flock"}) || !\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"file"})) \{
84         *\hyperlink{group__APACHE__CORE__MUTEX_ga2b93d746dbd53f3815877a7b19f89be1}{mutexmech} = \hyperlink{group__apr__proc__mutex_gga75dd95a48a1e855a87b509b522746ed4a1d06f73a37dae31233299401c9594b41}{APR\_LOCK\_FLOCK};
85     \}
86 \textcolor{preprocessor}{#endif}
87 \textcolor{preprocessor}{#if APR\_HAS\_POSIXSEM\_SERIALIZE}
88     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"posixsem"}) || !\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"sem"})) \{
89         *\hyperlink{group__APACHE__CORE__MUTEX_ga2b93d746dbd53f3815877a7b19f89be1}{mutexmech} = \hyperlink{group__apr__proc__mutex_gga75dd95a48a1e855a87b509b522746ed4a6d65d9d745e13d8759bd8f1057f27041}{APR\_LOCK\_POSIXSEM};
90         \textcolor{comment}{/* Posix/SysV semaphores aren't file based, use the literal name}
91 \textcolor{comment}{         * if provided and fall back on APR's default if not.  Today, APR}
92 \textcolor{comment}{         * will ignore it, but once supported it has an absurdly short limit.}
93 \textcolor{comment}{         */}
94         \textcolor{keywordflow}{if} (file) \{
95             *\hyperlink{group__APACHE__CORE__MUTEX_gaa4b7af5163be82f815eb2e47c2b4480e}{mutexfile} = apr\_pstrdup(\hyperlink{group__APACHE__CORE__MUTEX_ga8fea43b485988aa6df5dced9dddbe733}{pool}, file);
96 
97             file = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
98         \}
99     \}
100 \textcolor{preprocessor}{#endif}
101 \textcolor{preprocessor}{#if APR\_HAS\_SYSVSEM\_SERIALIZE}
102     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"sysvsem"}) || !\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"sem"})) \{
103         *\hyperlink{group__APACHE__CORE__MUTEX_ga2b93d746dbd53f3815877a7b19f89be1}{mutexmech} = \hyperlink{group__apr__proc__mutex_gga75dd95a48a1e855a87b509b522746ed4a642536695bd4c233761a15d48b1d6487}{APR\_LOCK\_SYSVSEM};
104     \}
105 \textcolor{preprocessor}{#endif}
106 \textcolor{preprocessor}{#if APR\_HAS\_PROC\_PTHREAD\_SERIALIZE}
107     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(meth, \textcolor{stringliteral}{"pthread"})) \{
108         *\hyperlink{group__APACHE__CORE__MUTEX_ga2b93d746dbd53f3815877a7b19f89be1}{mutexmech} = \hyperlink{group__apr__proc__mutex_gga75dd95a48a1e855a87b509b522746ed4abd5e7cca2c9f6023b541131f3841057a}{APR\_LOCK\_PROC\_PTHREAD};
109     \}
110 \textcolor{preprocessor}{#endif}
111     \textcolor{keywordflow}{else} \{
112         \textcolor{keywordflow}{return} \hyperlink{group__APR__Error_ga939ddb834a30bc9a5a0a329b13000161}{APR\_ENOTIMPL};
113     \}
114 
115     \textcolor{comment}{/* Unless the method above assumed responsibility for setting up}
116 \textcolor{comment}{     * mutexfile and NULLing out file, presume it is a file we}
117 \textcolor{comment}{     * are looking to use}
118 \textcolor{comment}{     */}
119     \textcolor{keywordflow}{if} (file) \{
120         *\hyperlink{group__APACHE__CORE__MUTEX_gaa4b7af5163be82f815eb2e47c2b4480e}{mutexfile} = ap\_server\_root\_relative(\hyperlink{group__APACHE__CORE__MUTEX_ga8fea43b485988aa6df5dced9dddbe733}{pool}, file);
121         \textcolor{keywordflow}{if} (!*\hyperlink{group__APACHE__CORE__MUTEX_gaa4b7af5163be82f815eb2e47c2b4480e}{mutexfile}) \{
122             \textcolor{keywordflow}{return} \hyperlink{group__APR__Error_ga771bf48ab38d93355be8530f6efe4ae9}{APR\_BADARG};
123         \}
124     \}
125 
126     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
127 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=267pt]{util__mutex_8c_ad4e49a371518f348d13b2d4e83b79b9e_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{util__mutex_8c_ad4e49a371518f348d13b2d4e83b79b9e_icgraph}
\end{center}
\end{figure}


\index{util\+\_\+mutex.\+c@{util\+\_\+mutex.\+c}!A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+N\+O\+N\+S\+TD@{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+N\+O\+N\+S\+TD}}
\index{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+N\+O\+N\+S\+TD@{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+N\+O\+N\+S\+TD}!util\+\_\+mutex.\+c@{util\+\_\+mutex.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+N\+O\+N\+S\+T\+D(const char $\ast$)}{AP_DECLARE_NONSTD(const char *)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+N\+O\+N\+S\+TD (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{util__mutex_8c_a3c3d35fe71135329f5cf444e02610da7}{}\label{util__mutex_8c_a3c3d35fe71135329f5cf444e02610da7}

\begin{DoxyCode}
166 \{
167     \hyperlink{structapr__pool__t}{apr\_pool\_t} *\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p} = \hyperlink{group__APACHE__CORE__DAEMON_ga504a7f40c3261db3e10e1d2776642dd6}{cmd}->pool;
168     \hyperlink{structapr__pool__t}{apr\_pool\_t} *\hyperlink{group__AP__EXPR_gaab85d20515306c350c88fbc8f58673b7}{ptemp} = \hyperlink{group__APACHE__CORE__DAEMON_ga504a7f40c3261db3e10e1d2776642dd6}{cmd}->temp\_pool;
169     \textcolor{keyword}{const} \textcolor{keywordtype}{char} **elt;
170     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *mechdir;
171     \textcolor{keywordtype}{int} no\_mutex = 0, omit\_pid = 0;
172     \hyperlink{structapr__array__header__t}{apr\_array\_header\_t} *type\_list;
173     \hyperlink{group__apr__proc__mutex_ga75dd95a48a1e855a87b509b522746ed4}{apr\_lockmech\_e} \hyperlink{group__APR__GlobalMutex_ga1e2bd4bf5e9584b52b5fc7d60cc52cb3}{mech};
174     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv;
175     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *mutexdir;
176     \hyperlink{structmutex__cfg__t}{mutex\_cfg\_t} *mxcfg;
177     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{group__AP__EXPR_gaccebe6c638c552d2845014cf8bdea8d8}{err} = ap\_check\_cmd\_context(\hyperlink{group__APACHE__CORE__DAEMON_ga504a7f40c3261db3e10e1d2776642dd6}{cmd}, \hyperlink{group__ap__check__cmd__context_ga8f2f401b1d57a151c5ba871088ba097e}{GLOBAL\_ONLY});
178 
179     \textcolor{keywordflow}{if} (err != \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
180         \textcolor{keywordflow}{return} \hyperlink{group__AP__EXPR_gaccebe6c638c552d2845014cf8bdea8d8}{err};
181     \}
182 
183     mechdir = ap\_getword\_conf(\hyperlink{group__APACHE__CORE__DAEMON_ga504a7f40c3261db3e10e1d2776642dd6}{cmd}->pool, &\hyperlink{group__APACHE__CORE__LISTEN_ga71f9d4c76ff7cd8f3db5697a5cfa7b08}{arg});
184     \textcolor{keywordflow}{if} (*mechdir == \textcolor{charliteral}{'\(\backslash\)0'}) \{
185         \textcolor{keywordflow}{return} \textcolor{stringliteral}{"Mutex requires at least a mechanism argument ("}
186                \hyperlink{group__APACHE__CORE__MUTEX_ga9305553b8e0ad2f6b404cbfdfc9223ed}{AP\_ALL\_AVAILABLE\_MUTEXES\_STRING} \textcolor{stringliteral}{")"};
187     \}
188 
189     rv = ap\_parse\_mutex(mechdir, p, &mech, &mutexdir);
190     \textcolor{keywordflow}{if} (rv == \hyperlink{group__APR__Error_ga939ddb834a30bc9a5a0a329b13000161}{APR\_ENOTIMPL}) \{
191         \textcolor{keywordflow}{return} apr\_pstrcat(p, \textcolor{stringliteral}{"Invalid Mutex argument "}, mechdir,
192                            \textcolor{stringliteral}{" ("} \hyperlink{group__APACHE__CORE__MUTEX_ga9305553b8e0ad2f6b404cbfdfc9223ed}{AP\_ALL\_AVAILABLE\_MUTEXES\_STRING} \textcolor{stringliteral}{")"}, 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
193     \}
194     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rv == \hyperlink{group__APR__Error_ga771bf48ab38d93355be8530f6efe4ae9}{APR\_BADARG}
195              || (mutexdir && !ap\_is\_directory(ptemp, mutexdir))) \{
196         \textcolor{keywordflow}{return} apr\_pstrcat(p, \textcolor{stringliteral}{"Invalid Mutex directory in argument "},
197                            mechdir, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
198     \}
199     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rv == \hyperlink{group__APR__Error_ga9c411624c42f7562a5c6c3461bdcb0ec}{APR\_ENOLOCK}) \{ \textcolor{comment}{/* "none" */}
200         no\_mutex = 1;
201     \}
202 
203     \textcolor{comment}{/* "OmitPID" can appear at the end of the list, so build a list of}
204 \textcolor{comment}{     * mutex type names while looking for "OmitPID" (anywhere) or the end}
205 \textcolor{comment}{     */}
206     type\_list = apr\_array\_make(\hyperlink{group__APACHE__CORE__DAEMON_ga504a7f40c3261db3e10e1d2776642dd6}{cmd}->pool, 4, \textcolor{keyword}{sizeof}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *));
207     \textcolor{keywordflow}{while} (*\hyperlink{group__APACHE__CORE__LISTEN_ga71f9d4c76ff7cd8f3db5697a5cfa7b08}{arg}) \{
208         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s} = ap\_getword\_conf(\hyperlink{group__APACHE__CORE__DAEMON_ga504a7f40c3261db3e10e1d2776642dd6}{cmd}->pool, &\hyperlink{group__APACHE__CORE__LISTEN_ga71f9d4c76ff7cd8f3db5697a5cfa7b08}{arg});
209 
210         \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(s, \textcolor{stringliteral}{"omitpid"})) \{
211             omit\_pid = 1;
212         \}
213         \textcolor{keywordflow}{else} \{
214             \textcolor{keyword}{const} \textcolor{keywordtype}{char} **new\_type = (\textcolor{keyword}{const} \textcolor{keywordtype}{char} **)apr\_array\_push(type\_list);
215             *new\_type = \hyperlink{group__APACHE__CORE__LISTEN_ga9359ed159c8b295541e3770172d34550}{s};
216         \}
217     \}
218 
219     \textcolor{keywordflow}{if} (apr\_is\_empty\_array(type\_list)) \{ \textcolor{comment}{/* no mutex type?  assume "default" */}
220         \textcolor{keyword}{const} \textcolor{keywordtype}{char} **new\_type = (\textcolor{keyword}{const} \textcolor{keywordtype}{char} **)apr\_array\_push(type\_list);
221         *new\_type = \textcolor{stringliteral}{"default"};
222     \}
223 
224     \textcolor{keywordflow}{while} ((elt = (\textcolor{keyword}{const} \textcolor{keywordtype}{char} **)apr\_array\_pop(type\_list)) != \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
225         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\hyperlink{group__APACHE__CORE__HTTPD_gaafc7089562892428c4fcae486f171f5a}{type} = *elt;
226         mxcfg = apr\_hash\_get(mxcfg\_by\_type, type, \hyperlink{group__apr__hash_ga3ba32541f2717b394000f87f38c7e12d}{APR\_HASH\_KEY\_STRING});
227         \textcolor{keywordflow}{if} (!mxcfg) \{
228             \textcolor{keywordflow}{return} apr\_psprintf(p, \textcolor{stringliteral}{"Mutex type %s is not valid"}, type);
229         \}
230 
231         mxcfg->\hyperlink{structmutex__cfg__t_af931fe78e12119415a63c6eec9f0421c}{none} = 0; \textcolor{comment}{/* in case that was the default */}
232         mxcfg->\hyperlink{structmutex__cfg__t_a102a90b0a3cd83a21f206ac0fcf73baf}{omit\_pid} = omit\_pid;
233 
234         mxcfg->\hyperlink{structmutex__cfg__t_ab52c4e56323fd1de3afa6969477e5ef6}{set} = 1;
235         \textcolor{keywordflow}{if} (no\_mutex) \{
236             \textcolor{keywordflow}{if} (!(mxcfg->\hyperlink{structmutex__cfg__t_aba69bfd427c5b37eb76c7f3c7fe5f4e7}{options} & \hyperlink{group__APACHE__CORE__MUTEX_ga8d0b1fe7b3697aec18c41ec8cf9f6d98}{AP\_MUTEX\_ALLOW\_NONE})) \{
237                 \textcolor{keywordflow}{return} apr\_psprintf(p,
238                                     \textcolor{stringliteral}{"None is not allowed for mutex type %s"},
239                                     type);
240             \}
241             mxcfg->\hyperlink{structmutex__cfg__t_af931fe78e12119415a63c6eec9f0421c}{none} = 1;
242         \}
243         \textcolor{keywordflow}{else} \{
244             mxcfg->\hyperlink{structmutex__cfg__t_a63215de650d3150915cbfb08b80731fd}{mech} = \hyperlink{group__APR__GlobalMutex_ga1e2bd4bf5e9584b52b5fc7d60cc52cb3}{mech};
245             \textcolor{keywordflow}{if} (mutexdir) \{ \textcolor{comment}{/* retain mutex default if not configured */}
246                 mxcfg->\hyperlink{structmutex__cfg__t_a096ef6675379ee7f817f6143267b809b}{dir} = mutexdir;
247             \}
248         \}
249     \}
250 
251     \textcolor{keywordflow}{return} \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
252 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__mutex_8c_a3c3d35fe71135329f5cf444e02610da7_cgraph}
\end{center}
\end{figure}


