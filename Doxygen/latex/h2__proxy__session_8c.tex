\hypertarget{h2__proxy__session_8c}{}\section{/usr/local/src/github/\+Codebase/httpd-\/2.4.29/modules/http2/h2\+\_\+proxy\+\_\+session.c File Reference}
\label{h2__proxy__session_8c}\index{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/modules/http2/h2\+\_\+proxy\+\_\+session.\+c@{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/modules/http2/h2\+\_\+proxy\+\_\+session.\+c}}
{\ttfamily \#include $<$stddef.\+h$>$}\\*
{\ttfamily \#include $<$apr\+\_\+strings.\+h$>$}\\*
{\ttfamily \#include $<$nghttp2/nghttp2.\+h$>$}\\*
{\ttfamily \#include $<$mpm\+\_\+common.\+h$>$}\\*
{\ttfamily \#include $<$httpd.\+h$>$}\\*
{\ttfamily \#include $<$mod\+\_\+proxy.\+h$>$}\\*
{\ttfamily \#include \char`\"{}mod\+\_\+http2.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}h2.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}h2\+\_\+proxy\+\_\+util.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}h2\+\_\+proxy\+\_\+session.\+h\char`\"{}}\\*
Include dependency graph for h2\+\_\+proxy\+\_\+session.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{h2__proxy__session_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structh2__proxy__stream}{h2\+\_\+proxy\+\_\+stream}
\item 
struct \hyperlink{structcleanup__iter__ctx}{cleanup\+\_\+iter\+\_\+ctx}
\item 
struct \hyperlink{structwin__update__ctx}{win\+\_\+update\+\_\+ctx}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structh2__proxy__stream}{h2\+\_\+proxy\+\_\+stream} \hyperlink{h2__proxy__session_8c_acfb79a816d2aab01a724b4c514929e59}{h2\+\_\+proxy\+\_\+stream}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{h2__proxy__session_8c_aa2ff352ff249b8799e39cd5c18f8ba79}{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE} (proxy\+\_\+http2)
\item 
\hyperlink{structh2__proxy__session}{h2\+\_\+proxy\+\_\+session} $\ast$ \hyperlink{h2__proxy__session_8c_a4db236b858a8c74981b48ed3981928f8}{h2\+\_\+proxy\+\_\+session\+\_\+setup} (const char $\ast$id, \hyperlink{structproxy__conn__rec}{proxy\+\_\+conn\+\_\+rec} $\ast$\hyperlink{group__MOD__PROXY_ga9751c38cba4756a499d065b1f8a0c0b0}{p\+\_\+conn}, \hyperlink{structproxy__server__conf}{proxy\+\_\+server\+\_\+conf} $\ast$\hyperlink{group__MOD__PROXY_ga4d7edd451c4bb8ed9ce9012e5dea2b14}{conf}, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} h2\+\_\+front, unsigned char window\+\_\+bits\+\_\+connection, unsigned char window\+\_\+bits\+\_\+stream, \hyperlink{h2__proxy__session_8h_ab03f2c17fec6ec68916d7cf8a91efd54}{h2\+\_\+proxy\+\_\+request\+\_\+done} $\ast$\hyperlink{ab_8c_a5992b274cfdcacdbc1fa8347fd01ebde}{done})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{h2__proxy__session_8c_a3ea321f20620afaaad862ea81c47a2e0}{h2\+\_\+proxy\+\_\+session\+\_\+submit} (\hyperlink{structh2__proxy__session}{h2\+\_\+proxy\+\_\+session} $\ast$session, const char $\ast$\hyperlink{group__APR__Util__Escaping_gaec657bef26e5ff27b9442563a591d9ec}{url}, \hyperlink{structrequest__rec}{request\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_a2e9e9438b26c0bb4425367a7e4f75eb3}{r}, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} standalone)
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{h2__proxy__session_8c_aa6962e70689bf57f09f95a274eeef149}{h2\+\_\+proxy\+\_\+session\+\_\+process} (\hyperlink{structh2__proxy__session}{h2\+\_\+proxy\+\_\+session} $\ast$session)
\item 
\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{h2__proxy__session_8c_ab8bc0b9a8f22bc3f748225554018778e}{h2\+\_\+proxy\+\_\+session\+\_\+cancel\+\_\+all} (\hyperlink{structh2__proxy__session}{h2\+\_\+proxy\+\_\+session} $\ast$session)
\item 
\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{h2__proxy__session_8c_af8ec3935eea644fa308c054b111f5749}{h2\+\_\+proxy\+\_\+session\+\_\+cleanup} (\hyperlink{structh2__proxy__session}{h2\+\_\+proxy\+\_\+session} $\ast$session, \hyperlink{h2__proxy__session_8h_ab03f2c17fec6ec68916d7cf8a91efd54}{h2\+\_\+proxy\+\_\+request\+\_\+done} $\ast$\hyperlink{ab_8c_a5992b274cfdcacdbc1fa8347fd01ebde}{done})
\item 
\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void} \hyperlink{h2__proxy__session_8c_a2f3cd8e8886775c3c5a9d8ff72a27765}{h2\+\_\+proxy\+\_\+session\+\_\+update\+\_\+window} (\hyperlink{structh2__proxy__session}{h2\+\_\+proxy\+\_\+session} $\ast$session, \hyperlink{structconn__rec}{conn\+\_\+rec} $\ast$\hyperlink{pcregrep_8txt_aef720ae5f62fa015619d00171d917416}{c}, \hyperlink{group__apr__platform_ga6938af9075cec15c88299109381aa984}{apr\+\_\+off\+\_\+t} \hyperlink{group__apr__random_ga393b167dab644f408202cbbcad070e6d}{bytes})
\end{DoxyCompactItemize}


\subsection{Typedef Documentation}
\index{h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}!h2\+\_\+proxy\+\_\+stream@{h2\+\_\+proxy\+\_\+stream}}
\index{h2\+\_\+proxy\+\_\+stream@{h2\+\_\+proxy\+\_\+stream}!h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}}
\subsubsection[{\texorpdfstring{h2\+\_\+proxy\+\_\+stream}{h2_proxy_stream}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf h2\+\_\+proxy\+\_\+stream}  {\bf h2\+\_\+proxy\+\_\+stream}}\hypertarget{h2__proxy__session_8c_acfb79a816d2aab01a724b4c514929e59}{}\label{h2__proxy__session_8c_acfb79a816d2aab01a724b4c514929e59}


\subsection{Function Documentation}
\index{h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}!A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE@{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE}}
\index{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE@{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE}!h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+L\+E(proxy\+\_\+http2)}{APLOG_USE_MODULE(proxy_http2)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+L\+O\+G\+\_\+\+U\+S\+E\+\_\+\+M\+O\+D\+U\+LE (
\begin{DoxyParamCaption}
\item[{proxy\+\_\+http2}]{}
\end{DoxyParamCaption}
)}\hypertarget{h2__proxy__session_8c_aa2ff352ff249b8799e39cd5c18f8ba79}{}\label{h2__proxy__session_8c_aa2ff352ff249b8799e39cd5c18f8ba79}
\index{h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}!h2\+\_\+proxy\+\_\+session\+\_\+cancel\+\_\+all@{h2\+\_\+proxy\+\_\+session\+\_\+cancel\+\_\+all}}
\index{h2\+\_\+proxy\+\_\+session\+\_\+cancel\+\_\+all@{h2\+\_\+proxy\+\_\+session\+\_\+cancel\+\_\+all}!h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}}
\subsubsection[{\texorpdfstring{h2\+\_\+proxy\+\_\+session\+\_\+cancel\+\_\+all(h2\+\_\+proxy\+\_\+session $\ast$session)}{h2_proxy_session_cancel_all(h2_proxy_session *session)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} h2\+\_\+proxy\+\_\+session\+\_\+cancel\+\_\+all (
\begin{DoxyParamCaption}
\item[{{\bf h2\+\_\+proxy\+\_\+session} $\ast$}]{session}
\end{DoxyParamCaption}
)}\hypertarget{h2__proxy__session_8c_ab8bc0b9a8f22bc3f748225554018778e}{}\label{h2__proxy__session_8c_ab8bc0b9a8f22bc3f748225554018778e}

\begin{DoxyCode}
1480 \{
1481     \textcolor{keywordflow}{if} (!\hyperlink{h2__proxy__util_8c_ae89c7b87a94fedb669f713e6a1947224}{h2\_proxy\_ihash\_empty}(session->\hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams})) \{
1482         \hyperlink{structcleanup__iter__ctx}{cleanup\_iter\_ctx} \hyperlink{group__APACHE__CORE__FILTER_ga94af791485570bea922969fef12d6259}{ctx};
1483         ctx.\hyperlink{structcleanup__iter__ctx_a415be96abc49c1129d0f200e529302b9}{session} = session;
1484         ctx.\hyperlink{structcleanup__iter__ctx_a682d37e24a1c99450d93ee0d09329ffd}{done} = session->\hyperlink{structh2__proxy__session_a4dd756bee1ad8bab34e7ab2c5232309d}{done};
1485         \hyperlink{group__APACHE__CORE__LOG_ga60ef6919b8e1b691b0c1ac4d67c9449f}{ap\_log\_cerror}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_gadfcef90537539cf2b7d35cfbbbafeb93}{APLOG\_DEBUG}, 0, session->
      \hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c}, \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(03366)
1486                       \textcolor{stringliteral}{"h2\_proxy\_session(%s): cancel  %d streams"},
1487                       session->\hyperlink{structh2__proxy__session_ae67274346c5ae772de78d93a5707a5f6}{id}, (\textcolor{keywordtype}{int})\hyperlink{h2__proxy__util_8c_ac61da9fb5ca4bae452430e6c39a8c07c}{h2\_proxy\_ihash\_count}(session->
      \hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams}));
1488         \hyperlink{h2__proxy__util_8c_a0d373da0cd3773260727b120d2278d95}{h2\_proxy\_ihash\_iter}(session->\hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams}, cancel\_iter, &ctx);
1489         session\_shutdown(session, 0, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
1490     \}
1491 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{h2__proxy__session_8c_ab8bc0b9a8f22bc3f748225554018778e_cgraph}
\end{center}
\end{figure}


\index{h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}!h2\+\_\+proxy\+\_\+session\+\_\+cleanup@{h2\+\_\+proxy\+\_\+session\+\_\+cleanup}}
\index{h2\+\_\+proxy\+\_\+session\+\_\+cleanup@{h2\+\_\+proxy\+\_\+session\+\_\+cleanup}!h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}}
\subsubsection[{\texorpdfstring{h2\+\_\+proxy\+\_\+session\+\_\+cleanup(h2\+\_\+proxy\+\_\+session $\ast$session, h2\+\_\+proxy\+\_\+request\+\_\+done $\ast$done)}{h2_proxy_session_cleanup(h2_proxy_session *session, h2_proxy_request_done *done)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} h2\+\_\+proxy\+\_\+session\+\_\+cleanup (
\begin{DoxyParamCaption}
\item[{{\bf h2\+\_\+proxy\+\_\+session} $\ast$}]{session, }
\item[{{\bf h2\+\_\+proxy\+\_\+request\+\_\+done} $\ast$}]{done}
\end{DoxyParamCaption}
)}\hypertarget{h2__proxy__session_8c_af8ec3935eea644fa308c054b111f5749}{}\label{h2__proxy__session_8c_af8ec3935eea644fa308c054b111f5749}

\begin{DoxyCode}
1505 \{
1506     \textcolor{keywordflow}{if} (!\hyperlink{h2__proxy__util_8c_ae89c7b87a94fedb669f713e6a1947224}{h2\_proxy\_ihash\_empty}(session->\hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams})) \{
1507         \hyperlink{structcleanup__iter__ctx}{cleanup\_iter\_ctx} \hyperlink{group__APACHE__CORE__FILTER_ga94af791485570bea922969fef12d6259}{ctx};
1508         ctx.\hyperlink{structcleanup__iter__ctx_a415be96abc49c1129d0f200e529302b9}{session} = session;
1509         ctx.\hyperlink{structcleanup__iter__ctx_a682d37e24a1c99450d93ee0d09329ffd}{done} = \hyperlink{README_8txt_aab36b2734b1c834ca42fc771a40b98ef}{done};
1510         \hyperlink{group__APACHE__CORE__LOG_ga60ef6919b8e1b691b0c1ac4d67c9449f}{ap\_log\_cerror}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_gadfcef90537539cf2b7d35cfbbbafeb93}{APLOG\_DEBUG}, 0, session->
      \hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c}, \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(03519)
1511                       \textcolor{stringliteral}{"h2\_proxy\_session(%s): terminated, %d streams unfinished"},
1512                       session->\hyperlink{structh2__proxy__session_ae67274346c5ae772de78d93a5707a5f6}{id}, (\textcolor{keywordtype}{int})\hyperlink{h2__proxy__util_8c_ac61da9fb5ca4bae452430e6c39a8c07c}{h2\_proxy\_ihash\_count}(session->
      \hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams}));
1513         \hyperlink{h2__proxy__util_8c_a0d373da0cd3773260727b120d2278d95}{h2\_proxy\_ihash\_iter}(session->\hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams}, done\_iter, &ctx);
1514         \hyperlink{h2__proxy__util_8c_abb7d9cc11ed91118f93b6a593b429f76}{h2\_proxy\_ihash\_clear}(session->\hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams});
1515     \}
1516 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{h2__proxy__session_8c_af8ec3935eea644fa308c054b111f5749_cgraph}
\end{center}
\end{figure}


\index{h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}!h2\+\_\+proxy\+\_\+session\+\_\+process@{h2\+\_\+proxy\+\_\+session\+\_\+process}}
\index{h2\+\_\+proxy\+\_\+session\+\_\+process@{h2\+\_\+proxy\+\_\+session\+\_\+process}!h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}}
\subsubsection[{\texorpdfstring{h2\+\_\+proxy\+\_\+session\+\_\+process(h2\+\_\+proxy\+\_\+session $\ast$session)}{h2_proxy_session_process(h2_proxy_session *session)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} h2\+\_\+proxy\+\_\+session\+\_\+process (
\begin{DoxyParamCaption}
\item[{{\bf h2\+\_\+proxy\+\_\+session} $\ast$}]{s}
\end{DoxyParamCaption}
)}\hypertarget{h2__proxy__session_8c_aa6962e70689bf57f09f95a274eeef149}{}\label{h2__proxy__session_8c_aa6962e70689bf57f09f95a274eeef149}
Perform a step in processing the proxy session. Will return aftert one read/write cycle and indicate session status by status code. 
\begin{DoxyParams}{Parameters}
{\em s} & the session to process \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A\+P\+R\+\_\+\+E\+A\+G\+A\+IN when processing needs to be invoked again A\+P\+R\+\_\+\+S\+U\+C\+C\+E\+SS when all streams have been processed, session still live A\+P\+R\+\_\+\+E\+OF when the session has been terminated 
\end{DoxyReturn}

\begin{DoxyCode}
1370 \{
1371     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} \hyperlink{group__APACHE__CORE__HTTPD_ga6e27f49150e9a14580fb313cc2777e00}{status};
1372     \textcolor{keywordtype}{int} have\_written = 0, have\_read = 0;
1373 
1374     \hyperlink{group__APACHE__CORE__LOG_ga60ef6919b8e1b691b0c1ac4d67c9449f}{ap\_log\_cerror}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_gaaa69603638ba4a5d83b8727a1ca5b76a}{APLOG\_TRACE2}, 0, session->
      \hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c}, 
1375                   \textcolor{stringliteral}{"h2\_proxy\_session(%s): process"}, session->\hyperlink{structh2__proxy__session_ae67274346c5ae772de78d93a5707a5f6}{id});
1376            
1377 run\_loop:
1378     \textcolor{keywordflow}{switch} (session->\hyperlink{structh2__proxy__session_aeb8d7358e8c8bbe5b92a6f9c6e6ab3c7}{state}) \{
1379         \textcolor{keywordflow}{case} \hyperlink{h2__proxy__session_8h_a59363bb01a8dd39f0ce73c35d6e6ee2aae28818b87630089056b70a2945c7592a}{H2\_PROXYS\_ST\_INIT}:
1380             status = session\_start(session);
1381             \textcolor{keywordflow}{if} (status == \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
1382                 dispatch\_event(session, \hyperlink{h2__proxy__session_8h_a807adaee1fc3fcfb63e6d812e5c09f71ae6a6951b64c1e78874f3641c05d9982e}{H2\_PROXYS\_EV\_INIT}, 0, 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
1383                 \textcolor{keywordflow}{goto} run\_loop;
1384             \}
1385             \textcolor{keywordflow}{else} \{
1386                 dispatch\_event(session, \hyperlink{h2__proxy__session_8h_a807adaee1fc3fcfb63e6d812e5c09f71abd9a9ced9da6258c0e709a849d0ed21f}{H2\_PROXYS\_EV\_CONN\_ERROR}, status, 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
1387             \}
1388             \textcolor{keywordflow}{break};
1389             
1390         \textcolor{keywordflow}{case} \hyperlink{h2__proxy__session_8h_a59363bb01a8dd39f0ce73c35d6e6ee2aa4e4822f6ca4013c4eed38a5749cf3196}{H2\_PROXYS\_ST\_BUSY}:
1391         \textcolor{keywordflow}{case} \hyperlink{h2__proxy__session_8h_a59363bb01a8dd39f0ce73c35d6e6ee2aa0c93d2f687a02eae644795b11d42c48d}{H2\_PROXYS\_ST\_LOCAL\_SHUTDOWN}:
1392         \textcolor{keywordflow}{case} \hyperlink{h2__proxy__session_8h_a59363bb01a8dd39f0ce73c35d6e6ee2aa84db51cc7de30ce49be667d2b24daf1a}{H2\_PROXYS\_ST\_REMOTE\_SHUTDOWN}:
1393             have\_written = send\_loop(session);
1394             
1395             \textcolor{keywordflow}{if} (nghttp2\_session\_want\_read(session->\hyperlink{structh2__proxy__session_ae5281df3b5d25fe3628d8b1efcfa1b70}{ngh2})) \{
1396                 status = h2\_proxy\_session\_read(session, 0, 0);
1397                 \textcolor{keywordflow}{if} (status == \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
1398                     have\_read = 1;
1399                 \}
1400             \}
1401             
1402             \textcolor{keywordflow}{if} (!have\_written && !have\_read 
1403                 && !nghttp2\_session\_want\_write(session->\hyperlink{structh2__proxy__session_ae5281df3b5d25fe3628d8b1efcfa1b70}{ngh2})) \{
1404                 dispatch\_event(session, \hyperlink{h2__proxy__session_8h_a807adaee1fc3fcfb63e6d812e5c09f71a253bc881fcfecfa78b13d484a58ae360}{H2\_PROXYS\_EV\_NO\_IO}, 0, 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
1405                 \textcolor{keywordflow}{goto} run\_loop;
1406             \}
1407             \textcolor{keywordflow}{break};
1408             
1409         \textcolor{keywordflow}{case} \hyperlink{h2__proxy__session_8h_a59363bb01a8dd39f0ce73c35d6e6ee2aa6689e6bc2ff91a736f4588c48ddeccb3}{H2\_PROXYS\_ST\_WAIT}:
1410             \textcolor{keywordflow}{if} (check\_suspended(session) == \hyperlink{group__APR__Error_ga0b2a5ebb819de5ce93d326939b586578}{APR\_EAGAIN}) \{
1411                 \textcolor{comment}{/* no stream has become resumed. Do a blocking read with}
1412 \textcolor{comment}{                 * ever increasing timeouts... */}
1413                 \textcolor{keywordflow}{if} (session->\hyperlink{structh2__proxy__session_a6845156d89a261445999670ec49288fc}{wait\_timeout} < 25) \{
1414                     session->\hyperlink{structh2__proxy__session_a6845156d89a261445999670ec49288fc}{wait\_timeout} = 25;
1415                 \}
1416                 \textcolor{keywordflow}{else} \{
1417                     session->\hyperlink{structh2__proxy__session_a6845156d89a261445999670ec49288fc}{wait\_timeout} = \hyperlink{h2_8h_acd3215da569b00c8a029a4810bd48f50}{H2MIN}(
      \hyperlink{event_8c_a05ce6646c8ba980c843903fc77e9f8a0}{apr\_time\_from\_msec}(100), 
1418                                                   2*session->\hyperlink{structh2__proxy__session_a6845156d89a261445999670ec49288fc}{wait\_timeout});
1419                 \}
1420                 
1421                 status = h2\_proxy\_session\_read(session, 1, session->\hyperlink{structh2__proxy__session_a6845156d89a261445999670ec49288fc}{wait\_timeout});
1422                 \hyperlink{group__APACHE__CORE__LOG_ga60ef6919b8e1b691b0c1ac4d67c9449f}{ap\_log\_cerror}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga5e4f134ae2203dd339774d9549d814db}{APLOG\_TRACE3}, status, session
      ->\hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c}, 
1423                               \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(03365)
1424                               \textcolor{stringliteral}{"h2\_proxy\_session(%s): WAIT read, timeout=%fms"}, 
1425                               session->\hyperlink{structh2__proxy__session_ae67274346c5ae772de78d93a5707a5f6}{id}, (\textcolor{keywordtype}{float})session->\hyperlink{structh2__proxy__session_a6845156d89a261445999670ec49288fc}{wait\_timeout}/1000.0);
1426                 \textcolor{keywordflow}{if} (status == \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
1427                     have\_read = 1;
1428                     dispatch\_event(session, \hyperlink{h2__proxy__session_8h_a807adaee1fc3fcfb63e6d812e5c09f71aa5a16d99da2f7b237fd4a3c7bd1223d6}{H2\_PROXYS\_EV\_DATA\_READ}, 0, 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
1429                 \}
1430                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{group__APR__STATUS__IS_ga864b207719c86ac4deeba696943262d0}{APR\_STATUS\_IS\_TIMEUP}(status)
1431                     || \hyperlink{group__APR__STATUS__IS_ga9dd578bfcd76a2d997395608ae5b3a4e}{APR\_STATUS\_IS\_EAGAIN}(status)) \{
1432                     \textcolor{comment}{/* go back to checking all inputs again */}
1433                     transit(session, \textcolor{stringliteral}{"wait cycle"}, \hyperlink{h2__proxy__session_8h_a59363bb01a8dd39f0ce73c35d6e6ee2aa4e4822f6ca4013c4eed38a5749cf3196}{H2\_PROXYS\_ST\_BUSY});
1434                 \}
1435             \}
1436             \textcolor{keywordflow}{break};
1437             
1438         \textcolor{keywordflow}{case} \hyperlink{h2__proxy__session_8h_a59363bb01a8dd39f0ce73c35d6e6ee2aa705a5c2d960b5bbd6982fccbfbae11eb}{H2\_PROXYS\_ST\_IDLE}:
1439             \textcolor{keywordflow}{break};
1440 
1441         \textcolor{keywordflow}{case} \hyperlink{h2__proxy__session_8h_a59363bb01a8dd39f0ce73c35d6e6ee2aa2025855f66da1720345cd22cd08a4821}{H2\_PROXYS\_ST\_DONE}: \textcolor{comment}{/* done, session terminated */}
1442             \textcolor{keywordflow}{return} \hyperlink{group__APR__Error_ga35d9dca2514c522a2840aca0f3e2ebd3}{APR\_EOF};
1443             
1444         \textcolor{keywordflow}{default}:
1445             \hyperlink{group__APACHE__CORE__LOG_ga60ef6919b8e1b691b0c1ac4d67c9449f}{ap\_log\_cerror}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga57ad94ed8c92c4306de90479251a5d58}{APLOG\_ERR}, 
      \hyperlink{group__APR__Error_ga18f5678bea0c2c704a2b6a186c9e158b}{APR\_EGENERAL}, session->\hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c},
1446                           \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(03346)\textcolor{stringliteral}{"h2\_proxy\_session(%s): unknown state %d"}, 
1447                           session->\hyperlink{structh2__proxy__session_ae67274346c5ae772de78d93a5707a5f6}{id}, session->\hyperlink{structh2__proxy__session_aeb8d7358e8c8bbe5b92a6f9c6e6ab3c7}{state});
1448             dispatch\_event(session, \hyperlink{h2__proxy__session_8h_a807adaee1fc3fcfb63e6d812e5c09f71a37b1aff986e081f5ec3f81c998299dcb}{H2\_PROXYS\_EV\_PROTO\_ERROR}, 0, 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
1449             \textcolor{keywordflow}{break};
1450     \}
1451 
1452 
1453     \textcolor{keywordflow}{if} (have\_read || have\_written) \{
1454         session->\hyperlink{structh2__proxy__session_a6845156d89a261445999670ec49288fc}{wait\_timeout} = 0;
1455     \}
1456     
1457     \textcolor{keywordflow}{if} (!nghttp2\_session\_want\_read(session->\hyperlink{structh2__proxy__session_ae5281df3b5d25fe3628d8b1efcfa1b70}{ngh2})
1458         && !nghttp2\_session\_want\_write(session->\hyperlink{structh2__proxy__session_ae5281df3b5d25fe3628d8b1efcfa1b70}{ngh2})) \{
1459         dispatch\_event(session, \hyperlink{h2__proxy__session_8h_a807adaee1fc3fcfb63e6d812e5c09f71aae1609f89dea1068a8bb1a984b9abccd}{H2\_PROXYS\_EV\_NGH2\_DONE}, 0, 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
1460     \}
1461     
1462     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}; \textcolor{comment}{/* needs to be called again */}
1463 \}
\end{DoxyCode}
\index{h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}!h2\+\_\+proxy\+\_\+session\+\_\+setup@{h2\+\_\+proxy\+\_\+session\+\_\+setup}}
\index{h2\+\_\+proxy\+\_\+session\+\_\+setup@{h2\+\_\+proxy\+\_\+session\+\_\+setup}!h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}}
\subsubsection[{\texorpdfstring{h2\+\_\+proxy\+\_\+session\+\_\+setup(const char $\ast$id, proxy\+\_\+conn\+\_\+rec $\ast$p\+\_\+conn, proxy\+\_\+server\+\_\+conf $\ast$conf, int h2\+\_\+front, unsigned char window\+\_\+bits\+\_\+connection, unsigned char window\+\_\+bits\+\_\+stream, h2\+\_\+proxy\+\_\+request\+\_\+done $\ast$done)}{h2_proxy_session_setup(const char *id, proxy_conn_rec *p_conn, proxy_server_conf *conf, int h2_front, unsigned char window_bits_connection, unsigned char window_bits_stream, h2_proxy_request_done *done)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf h2\+\_\+proxy\+\_\+session}$\ast$ h2\+\_\+proxy\+\_\+session\+\_\+setup (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{id, }
\item[{{\bf proxy\+\_\+conn\+\_\+rec} $\ast$}]{p\+\_\+conn, }
\item[{{\bf proxy\+\_\+server\+\_\+conf} $\ast$}]{conf, }
\item[{{\bf int}}]{h2\+\_\+front, }
\item[{unsigned char}]{window\+\_\+bits\+\_\+connection, }
\item[{unsigned char}]{window\+\_\+bits\+\_\+stream, }
\item[{{\bf h2\+\_\+proxy\+\_\+request\+\_\+done} $\ast$}]{done}
\end{DoxyParamCaption}
)}\hypertarget{h2__proxy__session_8c_a4db236b858a8c74981b48ed3981928f8}{}\label{h2__proxy__session_8c_a4db236b858a8c74981b48ed3981928f8}

\begin{DoxyCode}
603 \{
604     \textcolor{keywordflow}{if} (!p\_conn->\hyperlink{structproxy__conn__rec_a09448822ce878869f63f7b00421ec2b8}{data}) \{
605         \hyperlink{structapr__pool__t}{apr\_pool\_t} *\hyperlink{group__APACHE__CORE__MUTEX_ga8fea43b485988aa6df5dced9dddbe733}{pool} = p\_conn->\hyperlink{structproxy__conn__rec_a572f7275ff328d6181a01389b95a7761}{scpool};
606         \hyperlink{structh2__proxy__session}{h2\_proxy\_session} *session;
607         nghttp2\_session\_callbacks *cbs;
608         nghttp2\_option *\hyperlink{group__APACHE__CORE__TIME_ga737bdf2e23a8aca3ce89e79e9df35b3e}{option};
609 
610         session = \hyperlink{group__apr__pools_gad214fc0160de3c22b6435e29ea20fce8}{apr\_pcalloc}(pool, \textcolor{keyword}{sizeof}(*session));
611         apr\_pool\_pre\_cleanup\_register(pool, p\_conn, proxy\_session\_pre\_close);
612         p\_conn->\hyperlink{structproxy__conn__rec_a09448822ce878869f63f7b00421ec2b8}{data} = session;
613         
614         session->\hyperlink{structh2__proxy__session_ae67274346c5ae772de78d93a5707a5f6}{id} = apr\_pstrdup(p\_conn->\hyperlink{structproxy__conn__rec_a572f7275ff328d6181a01389b95a7761}{scpool}, \textcolor{keywordtype}{id});
615         session->\hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c} = p\_conn->\hyperlink{structproxy__conn__rec_aee2e053d5ca025ba7a8d7235061e035c}{connection};
616         session->\hyperlink{structh2__proxy__session_a51b4f90ddb1f230094059fba5f44d7b5}{p\_conn} = \hyperlink{group__MOD__PROXY_ga9751c38cba4756a499d065b1f8a0c0b0}{p\_conn};
617         session->\hyperlink{structh2__proxy__session_ac1a68e13ab0ddbfb4ff664cf285281b9}{conf} = \hyperlink{group__APACHE__CORE__HTTPD_ga7be6dfd9155648f64d6e9abcd78c38cd}{conf};
618         session->\hyperlink{structh2__proxy__session_afc51ecbd2b58959c21fc7e31d17878ea}{pool} = p\_conn->\hyperlink{structproxy__conn__rec_a572f7275ff328d6181a01389b95a7761}{scpool};
619         session->\hyperlink{structh2__proxy__session_aeb8d7358e8c8bbe5b92a6f9c6e6ab3c7}{state} = \hyperlink{h2__proxy__session_8h_a59363bb01a8dd39f0ce73c35d6e6ee2aae28818b87630089056b70a2945c7592a}{H2\_PROXYS\_ST\_INIT};
620         session->\hyperlink{structh2__proxy__session_a41cb62e1cf2d92ecac35850fcfb4ecde}{h2\_front} = h2\_front;
621         session->\hyperlink{structh2__proxy__session_a883566eeb6fdb2f49d9731da9a9e367c}{window\_bits\_stream} = window\_bits\_stream;
622         session->\hyperlink{structh2__proxy__session_ad3a2795431b54a9437c79fad5b40fb45}{window\_bits\_connection} = window\_bits\_connection;
623         session->\hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams} = \hyperlink{h2__proxy__util_8c_aab02303e00cc22c8006e7a37221da4f6}{h2\_proxy\_ihash\_create}(pool, offsetof(
      \hyperlink{structh2__proxy__stream}{h2\_proxy\_stream}, \textcolor{keywordtype}{id}));
624         session->\hyperlink{structh2__proxy__session_aec53df8c646b56d86866514f197b3b6f}{suspended} = \hyperlink{h2__proxy__util_8c_ae3db5926ce33d3797f45a1545045810c}{h2\_proxy\_iq\_create}(pool, 5);
625         session->\hyperlink{structh2__proxy__session_a4dd756bee1ad8bab34e7ab2c5232309d}{done} = \hyperlink{README_8txt_aab36b2734b1c834ca42fc771a40b98ef}{done};
626     
627         session->\hyperlink{structh2__proxy__session_a7bf5242c9ebc2c7d2ffc50bde4eb0994}{input} = apr\_brigade\_create(session->\hyperlink{structh2__proxy__session_afc51ecbd2b58959c21fc7e31d17878ea}{pool}, session->\hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c}->
      \hyperlink{structconn__rec_a5a9ee4911c5a655131f76a04036fb4c0}{bucket\_alloc});
628         session->\hyperlink{structh2__proxy__session_a6be91565be6fbd77848656f49a5f0c53}{output} = apr\_brigade\_create(session->\hyperlink{structh2__proxy__session_afc51ecbd2b58959c21fc7e31d17878ea}{pool}, session->\hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c}->
      \hyperlink{structconn__rec_a5a9ee4911c5a655131f76a04036fb4c0}{bucket\_alloc});
629     
630         nghttp2\_session\_callbacks\_new(&cbs);
631         nghttp2\_session\_callbacks\_set\_on\_frame\_recv\_callback(cbs, on\_frame\_recv);
632         nghttp2\_session\_callbacks\_set\_on\_data\_chunk\_recv\_callback(cbs, stream\_response\_data);
633         nghttp2\_session\_callbacks\_set\_on\_stream\_close\_callback(cbs, on\_stream\_close);
634         nghttp2\_session\_callbacks\_set\_on\_header\_callback(cbs, on\_header);
635         nghttp2\_session\_callbacks\_set\_before\_frame\_send\_callback(cbs, before\_frame\_send);
636         nghttp2\_session\_callbacks\_set\_send\_callback(cbs, raw\_send);
637 \textcolor{preprocessor}{#ifdef H2\_NG2\_INVALID\_HEADER\_CB}
638         nghttp2\_session\_callbacks\_set\_on\_invalid\_header\_callback(cbs, on\_invalid\_header\_cb);
639 \textcolor{preprocessor}{#endif}
640         
641         nghttp2\_option\_new(&option);
642         nghttp2\_option\_set\_peer\_max\_concurrent\_streams(option, 100);
643         nghttp2\_option\_set\_no\_auto\_window\_update(option, 1);
644         
645         nghttp2\_session\_client\_new2(&session->\hyperlink{structh2__proxy__session_ae5281df3b5d25fe3628d8b1efcfa1b70}{ngh2}, cbs, session, option);
646         
647         nghttp2\_option\_del(option);
648         nghttp2\_session\_callbacks\_del(cbs);
649 
650         \hyperlink{group__APACHE__CORE__LOG_ga60ef6919b8e1b691b0c1ac4d67c9449f}{ap\_log\_cerror}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_gadfcef90537539cf2b7d35cfbbbafeb93}{APLOG\_DEBUG}, 0, session->
      \hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c}, \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(03362)
651                       \textcolor{stringliteral}{"setup session for %s"}, p\_conn->\hyperlink{structproxy__conn__rec_a1ab19f0a00dd603547746818640ce583}{hostname});
652     \}
653     \textcolor{keywordflow}{else} \{
654         \hyperlink{structh2__proxy__session}{h2\_proxy\_session} *session = p\_conn->\hyperlink{structproxy__conn__rec_a09448822ce878869f63f7b00421ec2b8}{data};
655         \hyperlink{group__apr__time_gaae2129185a395cc393f76fabf4f43e47}{apr\_interval\_time\_t} age = apr\_time\_now() - session->
      \hyperlink{structh2__proxy__session_ab067d7ae6b8d2221f6ea6ed2f582daad}{last\_frame\_received};
656         \textcolor{keywordflow}{if} (age > \hyperlink{group__apr__time_gaec56c2c03299a750006bfcc08d64ec32}{apr\_time\_from\_sec}(1)) \{
657             session->\hyperlink{structh2__proxy__session_aab9d08ed258a6d49ed18a3d4335aeee6}{check\_ping} = 1;
658             nghttp2\_submit\_ping(session->\hyperlink{structh2__proxy__session_ae5281df3b5d25fe3628d8b1efcfa1b70}{ngh2}, 0, (\textcolor{keyword}{const} uint8\_t *)\textcolor{stringliteral}{"nevergonnagiveyouup"});
659         \}
660     \}
661     \textcolor{keywordflow}{return} p\_conn->\hyperlink{structproxy__conn__rec_a09448822ce878869f63f7b00421ec2b8}{data};
662 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{h2__proxy__session_8c_a4db236b858a8c74981b48ed3981928f8_cgraph}
\end{center}
\end{figure}


\index{h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}!h2\+\_\+proxy\+\_\+session\+\_\+submit@{h2\+\_\+proxy\+\_\+session\+\_\+submit}}
\index{h2\+\_\+proxy\+\_\+session\+\_\+submit@{h2\+\_\+proxy\+\_\+session\+\_\+submit}!h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}}
\subsubsection[{\texorpdfstring{h2\+\_\+proxy\+\_\+session\+\_\+submit(h2\+\_\+proxy\+\_\+session $\ast$session, const char $\ast$url, request\+\_\+rec $\ast$r, int standalone)}{h2_proxy_session_submit(h2_proxy_session *session, const char *url, request_rec *r, int standalone)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} h2\+\_\+proxy\+\_\+session\+\_\+submit (
\begin{DoxyParamCaption}
\item[{{\bf h2\+\_\+proxy\+\_\+session} $\ast$}]{session, }
\item[{const char $\ast$}]{url, }
\item[{{\bf request\+\_\+rec} $\ast$}]{r, }
\item[{{\bf int}}]{standalone}
\end{DoxyParamCaption}
)}\hypertarget{h2__proxy__session_8c_a3ea321f20620afaaad862ea81c47a2e0}{}\label{h2__proxy__session_8c_a3ea321f20620afaaad862ea81c47a2e0}

\begin{DoxyCode}
928 \{
929     \hyperlink{structh2__proxy__stream}{h2\_proxy\_stream} *stream;
930     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} \hyperlink{group__APACHE__CORE__HTTPD_ga6e27f49150e9a14580fb313cc2777e00}{status};
931     
932     status = open\_stream(session, \hyperlink{group__MOD__PROXY_ga05d2db9f2dd75d18170f192bd1cc9b4e}{url}, r, standalone, &stream);
933     \textcolor{keywordflow}{if} (status == \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
934         \hyperlink{group__APACHE__CORE__LOG_ga4c112558ccffd6b363da102b2052d2a6}{ap\_log\_rerror}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_gadfcef90537539cf2b7d35cfbbbafeb93}{APLOG\_DEBUG}, 0, r, 
      \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(03381)
935                       \textcolor{stringliteral}{"process stream(%d): %s %s%s, original: %s"}, 
936                       stream->\hyperlink{structh2__proxy__stream_af604b9138112d7ffaebd621833d0bf79}{id}, stream->\hyperlink{structh2__proxy__stream_a78b0ecb98be9f725ddd970561f4eecd5}{req}->\hyperlink{structh2__proxy__request_add377aa05871d58a5c4d2a839c297db4}{method}, 
937                       stream->\hyperlink{structh2__proxy__stream_a78b0ecb98be9f725ddd970561f4eecd5}{req}->\hyperlink{structh2__proxy__request_a215085650d4e8e3ee2ca98ca87dc1e34}{authority}, stream->\hyperlink{structh2__proxy__stream_a78b0ecb98be9f725ddd970561f4eecd5}{req}->\hyperlink{structh2__proxy__request_a7e29bb6643f5156b4a4b6b914a6d17df}{path}, 
938                       r->\hyperlink{structrequest__rec_a57abc62ddc18e3837b7ec4638713259d}{the\_request});
939         status = submit\_stream(session, stream);
940     \}
941     \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__HTTPD_ga6e27f49150e9a14580fb313cc2777e00}{status};
942 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{h2__proxy__session_8c_a3ea321f20620afaaad862ea81c47a2e0_cgraph}
\end{center}
\end{figure}


\index{h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}!h2\+\_\+proxy\+\_\+session\+\_\+update\+\_\+window@{h2\+\_\+proxy\+\_\+session\+\_\+update\+\_\+window}}
\index{h2\+\_\+proxy\+\_\+session\+\_\+update\+\_\+window@{h2\+\_\+proxy\+\_\+session\+\_\+update\+\_\+window}!h2\+\_\+proxy\+\_\+session.\+c@{h2\+\_\+proxy\+\_\+session.\+c}}
\subsubsection[{\texorpdfstring{h2\+\_\+proxy\+\_\+session\+\_\+update\+\_\+window(h2\+\_\+proxy\+\_\+session $\ast$session, conn\+\_\+rec $\ast$c, apr\+\_\+off\+\_\+t bytes)}{h2_proxy_session_update_window(h2_proxy_session *session, conn_rec *c, apr_off_t bytes)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} h2\+\_\+proxy\+\_\+session\+\_\+update\+\_\+window (
\begin{DoxyParamCaption}
\item[{{\bf h2\+\_\+proxy\+\_\+session} $\ast$}]{session, }
\item[{{\bf conn\+\_\+rec} $\ast$}]{c, }
\item[{{\bf apr\+\_\+off\+\_\+t}}]{bytes}
\end{DoxyParamCaption}
)}\hypertarget{h2__proxy__session_8c_a2f3cd8e8886775c3c5a9d8ff72a27765}{}\label{h2__proxy__session_8c_a2f3cd8e8886775c3c5a9d8ff72a27765}

\begin{DoxyCode}
1564 \{
1565     \textcolor{keywordflow}{if} (!\hyperlink{h2__proxy__util_8c_ae89c7b87a94fedb669f713e6a1947224}{h2\_proxy\_ihash\_empty}(session->\hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams})) \{
1566         \hyperlink{structwin__update__ctx}{win\_update\_ctx} \hyperlink{group__APACHE__CORE__FILTER_ga94af791485570bea922969fef12d6259}{ctx};
1567         ctx.\hyperlink{structwin__update__ctx_ae5bfe28fc96917de0833f68cdef78bbc}{session} = session;
1568         ctx.\hyperlink{structwin__update__ctx_a93823ecffa2e0f63b3d4f07fb62ca406}{c} = \hyperlink{group__APACHE__CORE__HTTPD_ga7cce37ef8558e46f408cb4d0f555605b}{c};
1569         ctx.\hyperlink{structwin__update__ctx_afa6a82a253225a8e1df7e9de2e55ea28}{bytes} = \hyperlink{group__APACHE__CORE__HTTPD_ga393b167dab644f408202cbbcad070e6d}{bytes};
1570         ctx.\hyperlink{structwin__update__ctx_a5f243df3ee2861c4948343595391bede}{updated} = 0;
1571         \hyperlink{h2__proxy__util_8c_a0d373da0cd3773260727b120d2278d95}{h2\_proxy\_ihash\_iter}(session->\hyperlink{structh2__proxy__session_aba423e4b2d9494c8452f485e91ae8c3d}{streams}, win\_update\_iter, &ctx);
1572         
1573         \textcolor{keywordflow}{if} (!ctx.\hyperlink{structwin__update__ctx_a5f243df3ee2861c4948343595391bede}{updated}) \{
1574             \textcolor{comment}{/* could not find the stream any more, possibly closed, update}
1575 \textcolor{comment}{             * the connection window at least */}
1576             \hyperlink{group__APACHE__CORE__LOG_ga60ef6919b8e1b691b0c1ac4d67c9449f}{ap\_log\_cerror}(\hyperlink{group__APACHE__CORE__LOG_ga655e126996849bcb82e4e5a14c616f4a}{APLOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_gaaa69603638ba4a5d83b8727a1ca5b76a}{APLOG\_TRACE2}, 0, session->
      \hyperlink{structh2__proxy__session_ac79a04ae92b3cf7a34b4c251bbb9a551}{c}, 
1577                           \textcolor{stringliteral}{"h2\_proxy\_session(%s): win\_update conn %ld bytes"},
1578                           session->\hyperlink{structh2__proxy__session_ae67274346c5ae772de78d93a5707a5f6}{id}, (\textcolor{keywordtype}{long})\hyperlink{group__APACHE__CORE__HTTPD_ga393b167dab644f408202cbbcad070e6d}{bytes});
1579             nghttp2\_session\_consume\_connection(session->\hyperlink{structh2__proxy__session_ae5281df3b5d25fe3628d8b1efcfa1b70}{ngh2}, (\textcolor{keywordtype}{size\_t})\hyperlink{group__APACHE__CORE__HTTPD_ga393b167dab644f408202cbbcad070e6d}{bytes});
1580         \}
1581     \}
1582 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{h2__proxy__session_8c_a2f3cd8e8886775c3c5a9d8ff72a27765_cgraph}
\end{center}
\end{figure}


