\hypertarget{group__APACHE__MPM__WORKER}{}\section{Worker M\+PM}
\label{group__APACHE__MPM__WORKER}\index{Worker M\+PM@{Worker M\+PM}}
Collaboration diagram for Worker M\+PM\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__APACHE__MPM__WORKER}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structfd__queue__elem__t}{fd\+\_\+queue\+\_\+elem\+\_\+t}
\item 
struct \hyperlink{structfd__queue__t}{fd\+\_\+queue\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__APACHE__MPM__WORKER_gac3950e57f9e8a7cfe6ff3fa67237e604}{D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+T\+A\+R\+T\+\_\+\+D\+A\+E\+M\+ON}~3
\item 
\#define \hyperlink{group__APACHE__MPM__WORKER_ga77abf0320697e196e2d1d282cca9ad44}{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+A\+X\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON}~10
\item 
\#define \hyperlink{group__APACHE__MPM__WORKER_gabfe5932653591d3339a6620cbd0d40be}{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+I\+N\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON}~3
\item 
\#define \hyperlink{group__APACHE__MPM__WORKER_gaf3e2d0fe4c45aac538a61bf99d69a378}{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+H\+R\+E\+A\+D\+S\+\_\+\+P\+E\+R\+\_\+\+C\+H\+I\+LD}~25
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structfd__queue__info__t}{fd\+\_\+queue\+\_\+info\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_gae60bd20f632fdf018c59af8943651458}{fd\+\_\+queue\+\_\+info\+\_\+t}
\item 
typedef struct \hyperlink{structfd__queue__elem__t}{fd\+\_\+queue\+\_\+elem\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_ga05898396eb6f09bf84cdf03f6c4bea00}{fd\+\_\+queue\+\_\+elem\+\_\+t}
\item 
typedef struct \hyperlink{structfd__queue__t}{fd\+\_\+queue\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_gaecd41846d40f5570725f5cd670a3181b}{fd\+\_\+queue\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_ga0454170ba8018a7ce2db3ecd14135657}{ap\+\_\+queue\+\_\+info\+\_\+create} (\hyperlink{structfd__queue__info__t}{fd\+\_\+queue\+\_\+info\+\_\+t} $\ast$$\ast$queue\+\_\+info, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APR__XLATE_gabb3cd978f04c73d0b763c391e9bfde73}{pool}, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} max\+\_\+idlers)
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_ga7673a5c9eda89916d6df264fdfdba2b5}{ap\+\_\+queue\+\_\+info\+\_\+set\+\_\+idle} (\hyperlink{structfd__queue__info__t}{fd\+\_\+queue\+\_\+info\+\_\+t} $\ast$queue\+\_\+info, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$pool\+\_\+to\+\_\+recycle)
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_ga7e0fa1c1b5681b774ad15366f909e55b}{ap\+\_\+queue\+\_\+info\+\_\+wait\+\_\+for\+\_\+idler} (\hyperlink{structfd__queue__info__t}{fd\+\_\+queue\+\_\+info\+\_\+t} $\ast$queue\+\_\+info, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$$\ast$\hyperlink{structrecycled__pool}{recycled\+\_\+pool})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_gaae8ca4deac4b25a12d826ba68569f608}{ap\+\_\+queue\+\_\+info\+\_\+term} (\hyperlink{structfd__queue__info__t}{fd\+\_\+queue\+\_\+info\+\_\+t} $\ast$queue\+\_\+info)
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_ga3c7e0f17e79985d68cf97adbe01966a4}{ap\+\_\+queue\+\_\+init} (\hyperlink{structfd__queue__t}{fd\+\_\+queue\+\_\+t} $\ast$queue, \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int} queue\+\_\+capacity, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{pcre_8txt_a841271aab70f5cda9412a19c7753f02c}{a})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_gacd3fbdf78efce43a6fa7ca4e8e254707}{ap\+\_\+queue\+\_\+push} (\hyperlink{structfd__queue__t}{fd\+\_\+queue\+\_\+t} $\ast$queue, \hyperlink{structapr__socket__t}{apr\+\_\+socket\+\_\+t} $\ast$sd, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_gaa0a7d0fbf57c588d863174ae5dbb1899}{ap\+\_\+queue\+\_\+pop} (\hyperlink{structfd__queue__t}{fd\+\_\+queue\+\_\+t} $\ast$queue, \hyperlink{structapr__socket__t}{apr\+\_\+socket\+\_\+t} $\ast$$\ast$sd, \hyperlink{structapr__pool__t}{apr\+\_\+pool\+\_\+t} $\ast$$\ast$\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p})
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_ga6a9df0d76a287d52f8ea78b6ebce9c27}{ap\+\_\+queue\+\_\+interrupt\+\_\+all} (\hyperlink{structfd__queue__t}{fd\+\_\+queue\+\_\+t} $\ast$queue)
\item 
\hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\+\_\+status\+\_\+t} \hyperlink{group__APACHE__MPM__WORKER_gabd40aa9d9c5f2cd9a23d912200158c5f}{ap\+\_\+queue\+\_\+term} (\hyperlink{structfd__queue__t}{fd\+\_\+queue\+\_\+t} $\ast$queue)
\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Macro Definition Documentation}
\index{Worker M\+PM@{Worker M\+PM}!D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+A\+X\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON@{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+A\+X\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON}}
\index{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+A\+X\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON@{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+A\+X\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+A\+X\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON}{DEFAULT_MAX_FREE_DAEMON}}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+A\+X\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON~10}\hypertarget{group__APACHE__MPM__WORKER_ga77abf0320697e196e2d1d282cca9ad44}{}\label{group__APACHE__MPM__WORKER_ga77abf0320697e196e2d1d282cca9ad44}
\index{Worker M\+PM@{Worker M\+PM}!D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+I\+N\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON@{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+I\+N\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON}}
\index{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+I\+N\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON@{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+I\+N\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+I\+N\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON}{DEFAULT_MIN_FREE_DAEMON}}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+F\+A\+U\+L\+T\+\_\+\+M\+I\+N\+\_\+\+F\+R\+E\+E\+\_\+\+D\+A\+E\+M\+ON~3}\hypertarget{group__APACHE__MPM__WORKER_gabfe5932653591d3339a6620cbd0d40be}{}\label{group__APACHE__MPM__WORKER_gabfe5932653591d3339a6620cbd0d40be}
\index{Worker M\+PM@{Worker M\+PM}!D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+T\+A\+R\+T\+\_\+\+D\+A\+E\+M\+ON@{D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+T\+A\+R\+T\+\_\+\+D\+A\+E\+M\+ON}}
\index{D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+T\+A\+R\+T\+\_\+\+D\+A\+E\+M\+ON@{D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+T\+A\+R\+T\+\_\+\+D\+A\+E\+M\+ON}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+T\+A\+R\+T\+\_\+\+D\+A\+E\+M\+ON}{DEFAULT_START_DAEMON}}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+T\+A\+R\+T\+\_\+\+D\+A\+E\+M\+ON~3}\hypertarget{group__APACHE__MPM__WORKER_gac3950e57f9e8a7cfe6ff3fa67237e604}{}\label{group__APACHE__MPM__WORKER_gac3950e57f9e8a7cfe6ff3fa67237e604}
\index{Worker M\+PM@{Worker M\+PM}!D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+H\+R\+E\+A\+D\+S\+\_\+\+P\+E\+R\+\_\+\+C\+H\+I\+LD@{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+H\+R\+E\+A\+D\+S\+\_\+\+P\+E\+R\+\_\+\+C\+H\+I\+LD}}
\index{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+H\+R\+E\+A\+D\+S\+\_\+\+P\+E\+R\+\_\+\+C\+H\+I\+LD@{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+H\+R\+E\+A\+D\+S\+\_\+\+P\+E\+R\+\_\+\+C\+H\+I\+LD}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+H\+R\+E\+A\+D\+S\+\_\+\+P\+E\+R\+\_\+\+C\+H\+I\+LD}{DEFAULT_THREADS_PER_CHILD}}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+H\+R\+E\+A\+D\+S\+\_\+\+P\+E\+R\+\_\+\+C\+H\+I\+LD~25}\hypertarget{group__APACHE__MPM__WORKER_gaf3e2d0fe4c45aac538a61bf99d69a378}{}\label{group__APACHE__MPM__WORKER_gaf3e2d0fe4c45aac538a61bf99d69a378}


\subsection{Typedef Documentation}
\index{Worker M\+PM@{Worker M\+PM}!fd\+\_\+queue\+\_\+elem\+\_\+t@{fd\+\_\+queue\+\_\+elem\+\_\+t}}
\index{fd\+\_\+queue\+\_\+elem\+\_\+t@{fd\+\_\+queue\+\_\+elem\+\_\+t}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{fd\+\_\+queue\+\_\+elem\+\_\+t}{fd_queue_elem_t}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf fd\+\_\+queue\+\_\+elem\+\_\+t} {\bf fd\+\_\+queue\+\_\+elem\+\_\+t}}\hypertarget{group__APACHE__MPM__WORKER_ga05898396eb6f09bf84cdf03f6c4bea00}{}\label{group__APACHE__MPM__WORKER_ga05898396eb6f09bf84cdf03f6c4bea00}
\index{Worker M\+PM@{Worker M\+PM}!fd\+\_\+queue\+\_\+info\+\_\+t@{fd\+\_\+queue\+\_\+info\+\_\+t}}
\index{fd\+\_\+queue\+\_\+info\+\_\+t@{fd\+\_\+queue\+\_\+info\+\_\+t}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{fd\+\_\+queue\+\_\+info\+\_\+t}{fd_queue_info_t}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf fd\+\_\+queue\+\_\+info\+\_\+t} {\bf fd\+\_\+queue\+\_\+info\+\_\+t}}\hypertarget{group__APACHE__MPM__WORKER_gae60bd20f632fdf018c59af8943651458}{}\label{group__APACHE__MPM__WORKER_gae60bd20f632fdf018c59af8943651458}
\index{Worker M\+PM@{Worker M\+PM}!fd\+\_\+queue\+\_\+t@{fd\+\_\+queue\+\_\+t}}
\index{fd\+\_\+queue\+\_\+t@{fd\+\_\+queue\+\_\+t}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{fd\+\_\+queue\+\_\+t}{fd_queue_t}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf fd\+\_\+queue\+\_\+t} {\bf fd\+\_\+queue\+\_\+t}}\hypertarget{group__APACHE__MPM__WORKER_gaecd41846d40f5570725f5cd670a3181b}{}\label{group__APACHE__MPM__WORKER_gaecd41846d40f5570725f5cd670a3181b}


\subsection{Function Documentation}
\index{Worker M\+PM@{Worker M\+PM}!ap\+\_\+queue\+\_\+info\+\_\+create@{ap\+\_\+queue\+\_\+info\+\_\+create}}
\index{ap\+\_\+queue\+\_\+info\+\_\+create@{ap\+\_\+queue\+\_\+info\+\_\+create}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{ap\+\_\+queue\+\_\+info\+\_\+create(fd\+\_\+queue\+\_\+info\+\_\+t $\ast$$\ast$queue\+\_\+info, apr\+\_\+pool\+\_\+t $\ast$pool, int max\+\_\+idlers)}{ap_queue_info_create(fd_queue_info_t **queue_info, apr_pool_t *pool, int max_idlers)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} ap\+\_\+queue\+\_\+info\+\_\+create (
\begin{DoxyParamCaption}
\item[{{\bf fd\+\_\+queue\+\_\+info\+\_\+t} $\ast$$\ast$}]{queue\+\_\+info, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{pool, }
\item[{{\bf int}}]{max\+\_\+idlers}
\end{DoxyParamCaption}
)}\hypertarget{group__APACHE__MPM__WORKER_ga0454170ba8018a7ce2db3ecd14135657}{}\label{group__APACHE__MPM__WORKER_ga0454170ba8018a7ce2db3ecd14135657}

\begin{DoxyCode}
57 \{
58     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv;
59     \hyperlink{structfd__queue__info__t}{fd\_queue\_info\_t} *qi;
60 
61     qi = \hyperlink{group__apr__pools_gad214fc0160de3c22b6435e29ea20fce8}{apr\_pcalloc}(pool, \textcolor{keyword}{sizeof}(*qi));
62 
63     rv = apr\_thread\_mutex\_create(&qi->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex}, 
      \hyperlink{group__apr__thread__mutex_ga579050872f9aff06e773b084264f7d06}{APR\_THREAD\_MUTEX\_DEFAULT},
64                                  pool);
65     \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
66         \textcolor{keywordflow}{return} rv;
67     \}
68     rv = apr\_thread\_cond\_create(&qi->\hyperlink{structfd__queue__info__t_ab55cf55999e66ef49df240ec7ac1b750}{wait\_for\_idler}, pool);
69     \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
70         \textcolor{keywordflow}{return} rv;
71     \}
72     qi->\hyperlink{structfd__queue__info__t_ac4e7511417ba04c774bf0576cba54dc2}{recycled\_pools} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
73     qi->\hyperlink{structfd__queue__info__t_a288e8b082895e4560c6414d9b77b773d}{max\_idlers} = max\_idlers;
74     apr\_pool\_cleanup\_register(pool, qi, queue\_info\_cleanup,
75                               apr\_pool\_cleanup\_null);
76 
77     *queue\_info = qi;
78 
79     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
80 \}
\end{DoxyCode}
\index{Worker M\+PM@{Worker M\+PM}!ap\+\_\+queue\+\_\+info\+\_\+set\+\_\+idle@{ap\+\_\+queue\+\_\+info\+\_\+set\+\_\+idle}}
\index{ap\+\_\+queue\+\_\+info\+\_\+set\+\_\+idle@{ap\+\_\+queue\+\_\+info\+\_\+set\+\_\+idle}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{ap\+\_\+queue\+\_\+info\+\_\+set\+\_\+idle(fd\+\_\+queue\+\_\+info\+\_\+t $\ast$queue\+\_\+info, apr\+\_\+pool\+\_\+t $\ast$pool\+\_\+to\+\_\+recycle)}{ap_queue_info_set_idle(fd_queue_info_t *queue_info, apr_pool_t *pool_to_recycle)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} ap\+\_\+queue\+\_\+info\+\_\+set\+\_\+idle (
\begin{DoxyParamCaption}
\item[{{\bf fd\+\_\+queue\+\_\+info\+\_\+t} $\ast$}]{queue\+\_\+info, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{pool\+\_\+to\+\_\+recycle}
\end{DoxyParamCaption}
)}\hypertarget{group__APACHE__MPM__WORKER_ga7673a5c9eda89916d6df264fdfdba2b5}{}\label{group__APACHE__MPM__WORKER_ga7673a5c9eda89916d6df264fdfdba2b5}

\begin{DoxyCode}
98 \{
99     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv;
100     \hyperlink{group__apr__platform_ga21ef1e35fd3ff9be386f3cb20164ff02}{apr\_int32\_t} prev\_idlers;
101 
102     \hyperlink{group__APACHE__MPM__EVENT_ga725f2a86b43ff2ade34db77aec45e471}{ap\_push\_pool}(queue\_info, pool\_to\_recycle);
103 
104     \textcolor{comment}{/* Atomically increment the count of idle workers */}
105     prev\_idlers = \hyperlink{atomic_8c_a4af33da5aa6493ec321af14bedfc47a9}{apr\_atomic\_inc32}(&(queue\_info->\hyperlink{structfd__queue__info__t_a34f88b2125fb629dd4200cf75568bb1d}{idlers})) - zero\_pt;
106 
107     \textcolor{comment}{/* If other threads are waiting on a worker, wake one up */}
108     \textcolor{keywordflow}{if} (prev\_idlers < 0) \{
109         rv = apr\_thread\_mutex\_lock(queue\_info->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex});
110         \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
111             \hyperlink{group__APACHE__CORE__DAEMON_ga85dbc1e4d9600422461f815193f8ace8}{AP\_DEBUG\_ASSERT}(0);
112             \textcolor{keywordflow}{return} rv;
113         \}
114         rv = apr\_thread\_cond\_signal(queue\_info->\hyperlink{structfd__queue__info__t_ab55cf55999e66ef49df240ec7ac1b750}{wait\_for\_idler});
115         \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
116             apr\_thread\_mutex\_unlock(queue\_info->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex});
117             \textcolor{keywordflow}{return} rv;
118         \}
119         rv = apr\_thread\_mutex\_unlock(queue\_info->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex});
120         \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
121             \textcolor{keywordflow}{return} rv;
122         \}
123     \}
124 
125     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
126 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__APACHE__MPM__WORKER_ga7673a5c9eda89916d6df264fdfdba2b5_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__APACHE__MPM__WORKER_ga7673a5c9eda89916d6df264fdfdba2b5_icgraph}
\end{center}
\end{figure}


\index{Worker M\+PM@{Worker M\+PM}!ap\+\_\+queue\+\_\+info\+\_\+term@{ap\+\_\+queue\+\_\+info\+\_\+term}}
\index{ap\+\_\+queue\+\_\+info\+\_\+term@{ap\+\_\+queue\+\_\+info\+\_\+term}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{ap\+\_\+queue\+\_\+info\+\_\+term(fd\+\_\+queue\+\_\+info\+\_\+t $\ast$queue\+\_\+info)}{ap_queue_info_term(fd_queue_info_t *queue_info)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} ap\+\_\+queue\+\_\+info\+\_\+term (
\begin{DoxyParamCaption}
\item[{{\bf fd\+\_\+queue\+\_\+info\+\_\+t} $\ast$}]{queue\+\_\+info}
\end{DoxyParamCaption}
)}\hypertarget{group__APACHE__MPM__WORKER_gaae8ca4deac4b25a12d826ba68569f608}{}\label{group__APACHE__MPM__WORKER_gaae8ca4deac4b25a12d826ba68569f608}

\begin{DoxyCode}
297 \{
298     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv;
299     rv = apr\_thread\_mutex\_lock(queue\_info->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex});
300     \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
301         \textcolor{keywordflow}{return} rv;
302     \}
303     queue\_info->\hyperlink{structfd__queue__info__t_ab3c2c38658e83a417f7d6d98ed021d87}{terminated} = 1;
304     apr\_thread\_cond\_broadcast(queue\_info->\hyperlink{structfd__queue__info__t_ab55cf55999e66ef49df240ec7ac1b750}{wait\_for\_idler});
305     \textcolor{keywordflow}{return} apr\_thread\_mutex\_unlock(queue\_info->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex});
306 \}
\end{DoxyCode}
\index{Worker M\+PM@{Worker M\+PM}!ap\+\_\+queue\+\_\+info\+\_\+wait\+\_\+for\+\_\+idler@{ap\+\_\+queue\+\_\+info\+\_\+wait\+\_\+for\+\_\+idler}}
\index{ap\+\_\+queue\+\_\+info\+\_\+wait\+\_\+for\+\_\+idler@{ap\+\_\+queue\+\_\+info\+\_\+wait\+\_\+for\+\_\+idler}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{ap\+\_\+queue\+\_\+info\+\_\+wait\+\_\+for\+\_\+idler(fd\+\_\+queue\+\_\+info\+\_\+t $\ast$queue\+\_\+info, apr\+\_\+pool\+\_\+t $\ast$$\ast$recycled\+\_\+pool)}{ap_queue_info_wait_for_idler(fd_queue_info_t *queue_info, apr_pool_t **recycled_pool)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} ap\+\_\+queue\+\_\+info\+\_\+wait\+\_\+for\+\_\+idler (
\begin{DoxyParamCaption}
\item[{{\bf fd\+\_\+queue\+\_\+info\+\_\+t} $\ast$}]{queue\+\_\+info, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$$\ast$}]{recycled\+\_\+pool}
\end{DoxyParamCaption}
)}\hypertarget{group__APACHE__MPM__WORKER_ga7e0fa1c1b5681b774ad15366f909e55b}{}\label{group__APACHE__MPM__WORKER_ga7e0fa1c1b5681b774ad15366f909e55b}

\begin{DoxyCode}
142 \{
143     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv;
144 
145     *recycled\_pool = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
146 
147     \textcolor{comment}{/* Block if the count of idle workers is zero */}
148     \textcolor{keywordflow}{if} (queue\_info->\hyperlink{structfd__queue__info__t_a34f88b2125fb629dd4200cf75568bb1d}{idlers} == 0) \{
149         rv = apr\_thread\_mutex\_lock(queue\_info->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex});
150         \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
151             \textcolor{keywordflow}{return} rv;
152         \}
153         \textcolor{comment}{/* Re-check the idle worker count to guard against a}
154 \textcolor{comment}{         * race condition.  Now that we're in the mutex-protected}
155 \textcolor{comment}{         * region, one of two things may have happened:}
156 \textcolor{comment}{         *   - If the idle worker count is still zero, the}
157 \textcolor{comment}{         *     workers are all still busy, so it's safe to}
158 \textcolor{comment}{         *     block on a condition variable, BUT}
159 \textcolor{comment}{         *     we need to check for idle worker count again}
160 \textcolor{comment}{         *     when we are signaled since it can happen that}
161 \textcolor{comment}{         *     we are signaled by a worker thread that went idle}
162 \textcolor{comment}{         *     but received a context switch before it could}
163 \textcolor{comment}{         *     tell us. If it does signal us later once it is on}
164 \textcolor{comment}{         *     CPU again there might be no idle worker left.}
165 \textcolor{comment}{         *     See}
166 \textcolor{comment}{         *     https://issues.apache.org/bugzilla/show\_bug.cgi?id=45605#c4}
167 \textcolor{comment}{         *   - If the idle worker count is nonzero, then a}
168 \textcolor{comment}{         *     worker has become idle since the first check}
169 \textcolor{comment}{         *     of queue\_info->idlers above.  It's possible}
170 \textcolor{comment}{         *     that the worker has also signaled the condition}
171 \textcolor{comment}{         *     variable--and if so, the listener missed it}
172 \textcolor{comment}{         *     because it wasn't yet blocked on the condition}
173 \textcolor{comment}{         *     variable.  But if the idle worker count is}
174 \textcolor{comment}{         *     now nonzero, it's safe for this function to}
175 \textcolor{comment}{         *     return immediately.}
176 \textcolor{comment}{         */}
177         \textcolor{keywordflow}{while} (queue\_info->\hyperlink{structfd__queue__info__t_a34f88b2125fb629dd4200cf75568bb1d}{idlers} == 0) \{
178             rv = apr\_thread\_cond\_wait(queue\_info->\hyperlink{structfd__queue__info__t_ab55cf55999e66ef49df240ec7ac1b750}{wait\_for\_idler},
179                                   queue\_info->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex});
180             \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
181                 \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv2;
182                 rv2 = apr\_thread\_mutex\_unlock(queue\_info->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex});
183                 \textcolor{keywordflow}{if} (rv2 != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
184                     \textcolor{keywordflow}{return} rv2;
185                 \}
186                 \textcolor{keywordflow}{return} rv;
187             \}
188         \}
189         rv = apr\_thread\_mutex\_unlock(queue\_info->\hyperlink{structfd__queue__info__t_a18d58b9d46ec7629daee1c309161b8d0}{idlers\_mutex});
190         \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
191             \textcolor{keywordflow}{return} rv;
192         \}
193     \}
194 
195     \textcolor{comment}{/* Atomically decrement the idle worker count */}
196     \hyperlink{atomic_8c_a7a8d16335fdcd27f2baca90df35ad300}{apr\_atomic\_dec32}(&(queue\_info->\hyperlink{structfd__queue__info__t_a34f88b2125fb629dd4200cf75568bb1d}{idlers}));
197 
198     \textcolor{comment}{/* Atomically pop a pool from the recycled list */}
199 
200     \textcolor{comment}{/* This function is safe only as long as it is single threaded because}
201 \textcolor{comment}{     * it reaches into the queue and accesses "next" which can change.}
202 \textcolor{comment}{     * We are OK today because it is only called from the listener thread.}
203 \textcolor{comment}{     * cas-based pushes do not have the same limitation - any number can}
204 \textcolor{comment}{     * happen concurrently with a single cas-based pop.}
205 \textcolor{comment}{     */}
206 
207     \textcolor{keywordflow}{for} (;;) \{
208         \textcolor{keyword}{struct }recycled\_pool *first\_pool = queue\_info->\hyperlink{structfd__queue__info__t_ac4e7511417ba04c774bf0576cba54dc2}{recycled\_pools};
209         \textcolor{keywordflow}{if} (first\_pool == \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
210             \textcolor{keywordflow}{break};
211         \}
212         \textcolor{keywordflow}{if} (apr\_atomic\_casptr((\textcolor{keywordtype}{void}*)&(queue\_info->\hyperlink{structfd__queue__info__t_ac4e7511417ba04c774bf0576cba54dc2}{recycled\_pools}), first\_pool->
      \hyperlink{structrecycled__pool_a6c607a84f541b580419d94ec5313c25a}{next},
213                               first\_pool) == first\_pool) \{
214             *recycled\_pool = first\_pool->\hyperlink{structrecycled__pool_a7a9db88b8ae2ec367708d457b29e7d22}{pool};
215             \textcolor{keywordflow}{break};
216         \}
217     \}
218 
219     \textcolor{keywordflow}{if} (queue\_info->\hyperlink{structfd__queue__info__t_ab3c2c38658e83a417f7d6d98ed021d87}{terminated}) \{
220         \textcolor{keywordflow}{return} \hyperlink{group__APR__Error_ga35d9dca2514c522a2840aca0f3e2ebd3}{APR\_EOF};
221     \}
222     \textcolor{keywordflow}{else} \{
223         \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
224     \}
225 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{group__APACHE__MPM__WORKER_ga7e0fa1c1b5681b774ad15366f909e55b_cgraph}
\end{center}
\end{figure}


\index{Worker M\+PM@{Worker M\+PM}!ap\+\_\+queue\+\_\+init@{ap\+\_\+queue\+\_\+init}}
\index{ap\+\_\+queue\+\_\+init@{ap\+\_\+queue\+\_\+init}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{ap\+\_\+queue\+\_\+init(fd\+\_\+queue\+\_\+t $\ast$queue, int queue\+\_\+capacity, apr\+\_\+pool\+\_\+t $\ast$a)}{ap_queue_init(fd_queue_t *queue, int queue_capacity, apr_pool_t *a)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} ap\+\_\+queue\+\_\+init (
\begin{DoxyParamCaption}
\item[{{\bf fd\+\_\+queue\+\_\+t} $\ast$}]{queue, }
\item[{{\bf int}}]{queue\+\_\+capacity, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{a}
\end{DoxyParamCaption}
)}\hypertarget{group__APACHE__MPM__WORKER_ga3c7e0f17e79985d68cf97adbe01966a4}{}\label{group__APACHE__MPM__WORKER_ga3c7e0f17e79985d68cf97adbe01966a4}
Initialize the \hyperlink{structfd__queue__t}{fd\+\_\+queue\+\_\+t}. 
\begin{DoxyCode}
342 \{
343     \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i};
344     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv;
345 
346     \textcolor{keywordflow}{if} ((rv = apr\_thread\_mutex\_create(&queue->\hyperlink{structfd__queue__t_af029904f6cc5ddc0afec5df2fadeaef6}{one\_big\_mutex},
347                                       \hyperlink{group__apr__thread__mutex_ga579050872f9aff06e773b084264f7d06}{APR\_THREAD\_MUTEX\_DEFAULT},
348                                       a)) != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
349         \textcolor{keywordflow}{return} rv;
350     \}
351     \textcolor{keywordflow}{if} ((rv = apr\_thread\_cond\_create(&queue->\hyperlink{structfd__queue__t_a18ddd6a916b50d00310ee4ed096a562a}{not\_empty}, a)) != 
      \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
352         \textcolor{keywordflow}{return} rv;
353     \}
354 
355     \hyperlink{group__apr__ring_ga245e1a73b162a4a68ebd54c84683729d}{APR\_RING\_INIT}(&queue->timers, \hyperlink{structtimer__event__t}{timer\_event\_t}, link);
356 
357     queue->\hyperlink{structfd__queue__t_af838c3af6ffee37b30bbe8c45e05292b}{data} = apr\_palloc(a, queue\_capacity * \textcolor{keyword}{sizeof}(\hyperlink{structfd__queue__elem__t}{fd\_queue\_elem\_t}));
358     queue->\hyperlink{structfd__queue__t_a4f4edbb981e4bbbc7304ba485b519c09}{bounds} = queue\_capacity;
359     queue->\hyperlink{structfd__queue__t_a064707a5e5c88ee4715ebc0f4ea4abb1}{nelts} = 0;
360     queue->\hyperlink{structfd__queue__t_a17cde346fb215a61f7b2df26970c72bd}{in} = 0;
361     queue->\hyperlink{structfd__queue__t_a85b9339d9c70a03d3ff95ae92061cf70}{out} = 0;
362 
363     \textcolor{comment}{/* Set all the sockets in the queue to NULL */}
364     \textcolor{keywordflow}{for} (i = 0; i < queue\_capacity; ++\hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i})
365         queue->\hyperlink{structfd__queue__t_af838c3af6ffee37b30bbe8c45e05292b}{data}[i].\hyperlink{structfd__queue__elem__t_a04934612aa0f85b323659d652bc061a5}{sd} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
366 
367     apr\_pool\_cleanup\_register(a, queue, ap\_queue\_destroy,
368                               apr\_pool\_cleanup\_null);
369 
370     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
371 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__APACHE__MPM__WORKER_ga3c7e0f17e79985d68cf97adbe01966a4_icgraph}
\end{center}
\end{figure}


\index{Worker M\+PM@{Worker M\+PM}!ap\+\_\+queue\+\_\+interrupt\+\_\+all@{ap\+\_\+queue\+\_\+interrupt\+\_\+all}}
\index{ap\+\_\+queue\+\_\+interrupt\+\_\+all@{ap\+\_\+queue\+\_\+interrupt\+\_\+all}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{ap\+\_\+queue\+\_\+interrupt\+\_\+all(fd\+\_\+queue\+\_\+t $\ast$queue)}{ap_queue_interrupt_all(fd_queue_t *queue)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} ap\+\_\+queue\+\_\+interrupt\+\_\+all (
\begin{DoxyParamCaption}
\item[{{\bf fd\+\_\+queue\+\_\+t} $\ast$}]{queue}
\end{DoxyParamCaption}
)}\hypertarget{group__APACHE__MPM__WORKER_ga6a9df0d76a287d52f8ea78b6ebce9c27}{}\label{group__APACHE__MPM__WORKER_ga6a9df0d76a287d52f8ea78b6ebce9c27}

\begin{DoxyCode}
508 \{
509     \textcolor{keywordflow}{return} queue\_interrupt(queue, 1);
510 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__APACHE__MPM__WORKER_ga6a9df0d76a287d52f8ea78b6ebce9c27_icgraph}
\end{center}
\end{figure}


\index{Worker M\+PM@{Worker M\+PM}!ap\+\_\+queue\+\_\+pop@{ap\+\_\+queue\+\_\+pop}}
\index{ap\+\_\+queue\+\_\+pop@{ap\+\_\+queue\+\_\+pop}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{ap\+\_\+queue\+\_\+pop(fd\+\_\+queue\+\_\+t $\ast$queue, apr\+\_\+socket\+\_\+t $\ast$$\ast$sd, apr\+\_\+pool\+\_\+t $\ast$$\ast$p)}{ap_queue_pop(fd_queue_t *queue, apr_socket_t **sd, apr_pool_t **p)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} ap\+\_\+queue\+\_\+pop (
\begin{DoxyParamCaption}
\item[{{\bf fd\+\_\+queue\+\_\+t} $\ast$}]{queue, }
\item[{{\bf apr\+\_\+socket\+\_\+t} $\ast$$\ast$}]{sd, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$$\ast$}]{p}
\end{DoxyParamCaption}
)}\hypertarget{group__APACHE__MPM__WORKER_gaa0a7d0fbf57c588d863174ae5dbb1899}{}\label{group__APACHE__MPM__WORKER_gaa0a7d0fbf57c588d863174ae5dbb1899}
Retrieves the next available socket from the queue. If there are no sockets available, it will block until one becomes available. Once retrieved, the socket is placed into the address specified by \textquotesingle{}sd\textquotesingle{}. 
\begin{DoxyCode}
341 \{
342     \hyperlink{structfd__queue__elem__t}{fd\_queue\_elem\_t} *\hyperlink{group__APR__Util__XML_gaf6c0c31c62555e73fa50b02e1393afc2}{elem};
343     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv;
344 
345     \textcolor{keywordflow}{if} ((rv = apr\_thread\_mutex\_lock(queue->\hyperlink{structfd__queue__t_af029904f6cc5ddc0afec5df2fadeaef6}{one\_big\_mutex})) != 
      \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
346         \textcolor{keywordflow}{return} rv;
347     \}
348 
349     \textcolor{comment}{/* Keep waiting until we wake up and find that the queue is not empty. */}
350     \textcolor{keywordflow}{if} (\hyperlink{worker_2fdqueue_8c_af337af05355304aefe574a0ec1739675}{ap\_queue\_empty}(queue)) \{
351         \textcolor{keywordflow}{if} (!queue->\hyperlink{structfd__queue__t_aace4fa4b984ffe25980fed75c97779d2}{terminated}) \{
352             apr\_thread\_cond\_wait(queue->\hyperlink{structfd__queue__t_a18ddd6a916b50d00310ee4ed096a562a}{not\_empty}, queue->\hyperlink{structfd__queue__t_af029904f6cc5ddc0afec5df2fadeaef6}{one\_big\_mutex});
353         \}
354         \textcolor{comment}{/* If we wake up and it's still empty, then we were interrupted */}
355         \textcolor{keywordflow}{if} (\hyperlink{worker_2fdqueue_8c_af337af05355304aefe574a0ec1739675}{ap\_queue\_empty}(queue)) \{
356             rv = apr\_thread\_mutex\_unlock(queue->\hyperlink{structfd__queue__t_af029904f6cc5ddc0afec5df2fadeaef6}{one\_big\_mutex});
357             \textcolor{keywordflow}{if} (rv != \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
358                 \textcolor{keywordflow}{return} rv;
359             \}
360             \textcolor{keywordflow}{if} (queue->\hyperlink{structfd__queue__t_aace4fa4b984ffe25980fed75c97779d2}{terminated}) \{
361                 \textcolor{keywordflow}{return} \hyperlink{group__APR__Error_ga35d9dca2514c522a2840aca0f3e2ebd3}{APR\_EOF}; \textcolor{comment}{/* no more elements ever again */}
362             \}
363             \textcolor{keywordflow}{else} \{
364                 \textcolor{keywordflow}{return} \hyperlink{group__APR__Error_gaee1ce306c0ebf1701b34172310aa1bd5}{APR\_EINTR};
365             \}
366         \}
367     \}
368 
369     elem = &queue->\hyperlink{structfd__queue__t_af838c3af6ffee37b30bbe8c45e05292b}{data}[queue->\hyperlink{structfd__queue__t_a85b9339d9c70a03d3ff95ae92061cf70}{out}];
370     queue->\hyperlink{structfd__queue__t_a85b9339d9c70a03d3ff95ae92061cf70}{out}++;
371     \textcolor{keywordflow}{if} (queue->\hyperlink{structfd__queue__t_a85b9339d9c70a03d3ff95ae92061cf70}{out} >= queue->\hyperlink{structfd__queue__t_a4f4edbb981e4bbbc7304ba485b519c09}{bounds})
372         queue->\hyperlink{structfd__queue__t_a85b9339d9c70a03d3ff95ae92061cf70}{out} -= queue->\hyperlink{structfd__queue__t_a4f4edbb981e4bbbc7304ba485b519c09}{bounds};
373     queue->\hyperlink{structfd__queue__t_a064707a5e5c88ee4715ebc0f4ea4abb1}{nelts}--;
374     *sd = elem->\hyperlink{structfd__queue__elem__t_a04934612aa0f85b323659d652bc061a5}{sd};
375     *p = elem->\hyperlink{structfd__queue__elem__t_a6b6e73a58c344f80a3fab25eb35f9fd3}{p};
376 \textcolor{preprocessor}{#ifdef AP\_DEBUG}
377     elem->\hyperlink{structfd__queue__elem__t_a04934612aa0f85b323659d652bc061a5}{sd} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
378     elem->\hyperlink{structfd__queue__elem__t_a6b6e73a58c344f80a3fab25eb35f9fd3}{p} = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
379 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* AP\_DEBUG */}\textcolor{preprocessor}{}
380 
381     rv = apr\_thread\_mutex\_unlock(queue->\hyperlink{structfd__queue__t_af029904f6cc5ddc0afec5df2fadeaef6}{one\_big\_mutex});
382     \textcolor{keywordflow}{return} rv;
383 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__APACHE__MPM__WORKER_gaa0a7d0fbf57c588d863174ae5dbb1899_icgraph}
\end{center}
\end{figure}


\index{Worker M\+PM@{Worker M\+PM}!ap\+\_\+queue\+\_\+push@{ap\+\_\+queue\+\_\+push}}
\index{ap\+\_\+queue\+\_\+push@{ap\+\_\+queue\+\_\+push}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{ap\+\_\+queue\+\_\+push(fd\+\_\+queue\+\_\+t $\ast$queue, apr\+\_\+socket\+\_\+t $\ast$sd, apr\+\_\+pool\+\_\+t $\ast$p)}{ap_queue_push(fd_queue_t *queue, apr_socket_t *sd, apr_pool_t *p)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} ap\+\_\+queue\+\_\+push (
\begin{DoxyParamCaption}
\item[{{\bf fd\+\_\+queue\+\_\+t} $\ast$}]{queue, }
\item[{{\bf apr\+\_\+socket\+\_\+t} $\ast$}]{sd, }
\item[{{\bf apr\+\_\+pool\+\_\+t} $\ast$}]{p}
\end{DoxyParamCaption}
)}\hypertarget{group__APACHE__MPM__WORKER_gacd3fbdf78efce43a6fa7ca4e8e254707}{}\label{group__APACHE__MPM__WORKER_gacd3fbdf78efce43a6fa7ca4e8e254707}
Push a new socket onto the queue.

precondition\+: ap\+\_\+queue\+\_\+info\+\_\+wait\+\_\+for\+\_\+idler has already been called to reserve an idle worker thread 
\begin{DoxyCode}
306 \{
307     \hyperlink{structfd__queue__elem__t}{fd\_queue\_elem\_t} *\hyperlink{group__APR__Util__XML_gaf6c0c31c62555e73fa50b02e1393afc2}{elem};
308     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv;
309 
310     \textcolor{keywordflow}{if} ((rv = apr\_thread\_mutex\_lock(queue->\hyperlink{structfd__queue__t_af029904f6cc5ddc0afec5df2fadeaef6}{one\_big\_mutex})) != 
      \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
311         \textcolor{keywordflow}{return} rv;
312     \}
313 
314     \hyperlink{group__APACHE__CORE__DAEMON_ga85dbc1e4d9600422461f815193f8ace8}{AP\_DEBUG\_ASSERT}(!queue->\hyperlink{structfd__queue__t_aace4fa4b984ffe25980fed75c97779d2}{terminated});
315     \hyperlink{group__APACHE__CORE__DAEMON_ga85dbc1e4d9600422461f815193f8ace8}{AP\_DEBUG\_ASSERT}(!\hyperlink{worker_2fdqueue_8c_aee6adf45a7812d4fdc4211b1b90acbc7}{ap\_queue\_full}(queue));
316 
317     elem = &queue->\hyperlink{structfd__queue__t_af838c3af6ffee37b30bbe8c45e05292b}{data}[queue->\hyperlink{structfd__queue__t_a17cde346fb215a61f7b2df26970c72bd}{in}];
318     queue->\hyperlink{structfd__queue__t_a17cde346fb215a61f7b2df26970c72bd}{in}++;
319     \textcolor{keywordflow}{if} (queue->\hyperlink{structfd__queue__t_a17cde346fb215a61f7b2df26970c72bd}{in} >= queue->\hyperlink{structfd__queue__t_a4f4edbb981e4bbbc7304ba485b519c09}{bounds})
320         queue->\hyperlink{structfd__queue__t_a17cde346fb215a61f7b2df26970c72bd}{in} -= queue->\hyperlink{structfd__queue__t_a4f4edbb981e4bbbc7304ba485b519c09}{bounds};
321     elem->\hyperlink{structfd__queue__elem__t_a04934612aa0f85b323659d652bc061a5}{sd} = sd;
322     elem->\hyperlink{structfd__queue__elem__t_a6b6e73a58c344f80a3fab25eb35f9fd3}{p} = \hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p};
323     queue->\hyperlink{structfd__queue__t_a064707a5e5c88ee4715ebc0f4ea4abb1}{nelts}++;
324 
325     apr\_thread\_cond\_signal(queue->\hyperlink{structfd__queue__t_a18ddd6a916b50d00310ee4ed096a562a}{not\_empty});
326 
327     \textcolor{keywordflow}{if} ((rv = apr\_thread\_mutex\_unlock(queue->\hyperlink{structfd__queue__t_af029904f6cc5ddc0afec5df2fadeaef6}{one\_big\_mutex})) != 
      \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
328         \textcolor{keywordflow}{return} rv;
329     \}
330 
331     \textcolor{keywordflow}{return} \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS};
332 \}
\end{DoxyCode}
\index{Worker M\+PM@{Worker M\+PM}!ap\+\_\+queue\+\_\+term@{ap\+\_\+queue\+\_\+term}}
\index{ap\+\_\+queue\+\_\+term@{ap\+\_\+queue\+\_\+term}!Worker M\+PM@{Worker M\+PM}}
\subsubsection[{\texorpdfstring{ap\+\_\+queue\+\_\+term(fd\+\_\+queue\+\_\+t $\ast$queue)}{ap_queue_term(fd_queue_t *queue)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf apr\+\_\+status\+\_\+t} ap\+\_\+queue\+\_\+term (
\begin{DoxyParamCaption}
\item[{{\bf fd\+\_\+queue\+\_\+t} $\ast$}]{queue}
\end{DoxyParamCaption}
)}\hypertarget{group__APACHE__MPM__WORKER_gabd40aa9d9c5f2cd9a23d912200158c5f}{}\label{group__APACHE__MPM__WORKER_gabd40aa9d9c5f2cd9a23d912200158c5f}

\begin{DoxyCode}
518 \{
519     \hyperlink{group__apr__errno_gaa5105fa83cc322f09382292db8b47593}{apr\_status\_t} rv;
520 
521     \textcolor{keywordflow}{if} ((rv = apr\_thread\_mutex\_lock(queue->\hyperlink{structfd__queue__t_af029904f6cc5ddc0afec5df2fadeaef6}{one\_big\_mutex})) != 
      \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
522         \textcolor{keywordflow}{return} rv;
523     \}
524     \textcolor{comment}{/* we must hold one\_big\_mutex when setting this... otherwise,}
525 \textcolor{comment}{     * we could end up setting it and waking everybody up just after a}
526 \textcolor{comment}{     * would-be popper checks it but right before they block}
527 \textcolor{comment}{     */}
528     queue->\hyperlink{structfd__queue__t_aace4fa4b984ffe25980fed75c97779d2}{terminated} = 1;
529     \textcolor{keywordflow}{if} ((rv = apr\_thread\_mutex\_unlock(queue->\hyperlink{structfd__queue__t_af029904f6cc5ddc0afec5df2fadeaef6}{one\_big\_mutex})) != 
      \hyperlink{group__apr__errno_ga9ee311b7bf1c691dc521d721339ee2a6}{APR\_SUCCESS}) \{
530         \textcolor{keywordflow}{return} rv;
531     \}
532     \textcolor{keywordflow}{return} \hyperlink{group__APACHE__MPM__EVENT_ga6a9df0d76a287d52f8ea78b6ebce9c27}{ap\_queue\_interrupt\_all}(queue);
533 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{group__APACHE__MPM__WORKER_gabd40aa9d9c5f2cd9a23d912200158c5f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__APACHE__MPM__WORKER_gabd40aa9d9c5f2cd9a23d912200158c5f_icgraph}
\end{center}
\end{figure}


