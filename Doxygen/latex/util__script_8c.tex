\hypertarget{util__script_8c}{}\section{/usr/local/src/github/\+Codebase/httpd-\/2.4.29/server/util\+\_\+script.c File Reference}
\label{util__script_8c}\index{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/server/util\+\_\+script.\+c@{/usr/local/src/github/\+Codebase/httpd-\/2.\+4.\+29/server/util\+\_\+script.\+c}}
{\ttfamily \#include \char`\"{}apr.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+lib.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+strings.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+want.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ap\+\_\+config.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}httpd.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+config.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+main.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+log.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+core.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+protocol.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\+\_\+request.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}util\+\_\+script.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}apr\+\_\+date.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}util\+\_\+ebcdic.\+h\char`\"{}}\\*
Include dependency graph for util\+\_\+script.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{util__script_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structvastrs}{vastrs}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{util__script_8c_a88a4bf7f483aad3f3945773f3383e713}{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}
\item 
\#define \hyperlink{util__script_8c_ae75325996d1b2cf6120dded4cb153a22}{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}~\hyperlink{group__APACHE__CORE__HTTPD_gaf1cdaac5f4562d9d20bae417471ad422}{A\+P\+\_\+\+C\+O\+R\+E\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}
\item 
\#define \hyperlink{util__script_8c_afcd84495e0635d9ab191ad96e908df93}{H\+T\+T\+P\+\_\+\+U\+N\+S\+ET}~(-\/\hyperlink{group__HTTP__Status_ga02e6d59009dee759528ec81fc9a8eeff}{H\+T\+T\+P\+\_\+\+OK})
\item 
\#define \hyperlink{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{S\+C\+R\+I\+P\+T\+\_\+\+L\+O\+G\+\_\+\+M\+A\+RK}~\+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+,\+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+,\hyperlink{group__APACHE__CORE__SCRIPT_gafe3efe4874f4178a9d30f4a0889957c3}{module\+\_\+index}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{util__script_8c_a5414c3ed69a8a76b1c5f012b0b1200db}{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE} (char $\ast$$\ast$)
\item 
\hyperlink{group__hooks_ga2991c49e63464ffbc0a6d82f1878f0cd}{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{group__MOD__ISAPI_gacd6cdbf73df3d9eed42fa493d9b621a6}{void})
\item 
\hyperlink{util__script_8c_ace56382e8c8bdfffe9ffc8dbab06d36c}{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE} (\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int})
\item 
\hyperlink{util__script_8c_a098a6cc1cb07395cf2472ed109eaa3e8}{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE} (ap\+\_\+scan\+\_\+script\+\_\+header\+\_\+err\+\_\+core\+\_\+ex(\hyperlink{structrequest__rec}{request\+\_\+rec} \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int})
\item 
\hyperlink{util__script_8c_a3a211adcc4b131409999f5100de7ffc5}{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE} (ap\+\_\+scan\+\_\+script\+\_\+header\+\_\+err\+\_\+core(\hyperlink{structrequest__rec}{request\+\_\+rec} \hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int})
\item 
\hyperlink{group__AP__EXPR_ga1ac0588c7c2ca64ea23710360d5f6f85}{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E\+\_\+\+N\+O\+N\+S\+TD} (\hyperlink{pcre_8txt_a42dfa4ff673c82d8efe7144098fbc198}{int})
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{util\+\_\+script.\+c@{util\+\_\+script.\+c}!A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX@{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}}
\index{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX@{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}!util\+\_\+script.\+c@{util\+\_\+script.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}{APLOG_MODULE_INDEX}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+P\+L\+O\+G\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX~{\bf A\+P\+\_\+\+C\+O\+R\+E\+\_\+\+M\+O\+D\+U\+L\+E\+\_\+\+I\+N\+D\+EX}}\hypertarget{util__script_8c_ae75325996d1b2cf6120dded4cb153a22}{}\label{util__script_8c_ae75325996d1b2cf6120dded4cb153a22}
\index{util\+\_\+script.\+c@{util\+\_\+script.\+c}!A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC@{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}}
\index{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC@{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}!util\+\_\+script.\+c@{util\+\_\+script.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}{APR_WANT_STRFUNC}}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+P\+R\+\_\+\+W\+A\+N\+T\+\_\+\+S\+T\+R\+F\+U\+NC}\hypertarget{util__script_8c_a88a4bf7f483aad3f3945773f3383e713}{}\label{util__script_8c_a88a4bf7f483aad3f3945773f3383e713}
\index{util\+\_\+script.\+c@{util\+\_\+script.\+c}!H\+T\+T\+P\+\_\+\+U\+N\+S\+ET@{H\+T\+T\+P\+\_\+\+U\+N\+S\+ET}}
\index{H\+T\+T\+P\+\_\+\+U\+N\+S\+ET@{H\+T\+T\+P\+\_\+\+U\+N\+S\+ET}!util\+\_\+script.\+c@{util\+\_\+script.\+c}}
\subsubsection[{\texorpdfstring{H\+T\+T\+P\+\_\+\+U\+N\+S\+ET}{HTTP_UNSET}}]{\setlength{\rightskip}{0pt plus 5cm}\#define H\+T\+T\+P\+\_\+\+U\+N\+S\+ET~(-\/{\bf H\+T\+T\+P\+\_\+\+OK})}\hypertarget{util__script_8c_afcd84495e0635d9ab191ad96e908df93}{}\label{util__script_8c_afcd84495e0635d9ab191ad96e908df93}
\index{util\+\_\+script.\+c@{util\+\_\+script.\+c}!S\+C\+R\+I\+P\+T\+\_\+\+L\+O\+G\+\_\+\+M\+A\+RK@{S\+C\+R\+I\+P\+T\+\_\+\+L\+O\+G\+\_\+\+M\+A\+RK}}
\index{S\+C\+R\+I\+P\+T\+\_\+\+L\+O\+G\+\_\+\+M\+A\+RK@{S\+C\+R\+I\+P\+T\+\_\+\+L\+O\+G\+\_\+\+M\+A\+RK}!util\+\_\+script.\+c@{util\+\_\+script.\+c}}
\subsubsection[{\texorpdfstring{S\+C\+R\+I\+P\+T\+\_\+\+L\+O\+G\+\_\+\+M\+A\+RK}{SCRIPT_LOG_MARK}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+C\+R\+I\+P\+T\+\_\+\+L\+O\+G\+\_\+\+M\+A\+RK~\+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+,\+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+,{\bf module\+\_\+index}}\hypertarget{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{}\label{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}


\subsection{Function Documentation}
\index{util\+\_\+script.\+c@{util\+\_\+script.\+c}!A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}!util\+\_\+script.\+c@{util\+\_\+script.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E(char $\ast$$\ast$)}{AP_DECLARE(char **)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{char $\ast$$\ast$}]{}
\end{DoxyParamCaption}
)}\hypertarget{util__script_8c_a5414c3ed69a8a76b1c5f012b0b1200db}{}\label{util__script_8c_a5414c3ed69a8a76b1c5f012b0b1200db}

\begin{DoxyCode}
101 \{
102     \textcolor{keyword}{const} \hyperlink{structapr__array__header__t}{apr\_array\_header\_t} *env\_arr = apr\_table\_elts(\hyperlink{group__APACHE__CORE__DAEMON_gabfa74bb4f05f3b2de1a89160025e5400}{t});
103     \textcolor{keyword}{const} \hyperlink{structapr__table__entry__t}{apr\_table\_entry\_t} *elts = (\textcolor{keyword}{const} \hyperlink{structapr__table__entry__t}{apr\_table\_entry\_t} *) env\_arr->
      \hyperlink{structapr__array__header__t_af8462fa2a1ddf6406c66cd3dd441a269}{elts};
104     \textcolor{keywordtype}{char} **\hyperlink{group__APACHE__CORE__MPM_ga050c00b1a538603bac07d58e6e1c4ec7}{env} = (\textcolor{keywordtype}{char} **) apr\_palloc(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, (env\_arr->\hyperlink{structapr__array__header__t_ab11b88220885c5a0920a06ac85680055}{nelts} + 2) * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char} *));
105     \textcolor{keywordtype}{int} \hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}, j;
106     \textcolor{keywordtype}{char} *tz;
107     \textcolor{keywordtype}{char} *whack;
108 
109     j = 0;
110     \textcolor{keywordflow}{if} (!apr\_table\_get(\hyperlink{group__APACHE__CORE__DAEMON_gabfa74bb4f05f3b2de1a89160025e5400}{t}, \textcolor{stringliteral}{"TZ"})) \{
111         tz = getenv(\textcolor{stringliteral}{"TZ"});
112         \textcolor{keywordflow}{if} (tz != \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL}) \{
113             \hyperlink{group__APACHE__CORE__MPM_ga050c00b1a538603bac07d58e6e1c4ec7}{env}[j++] = apr\_pstrcat(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, \textcolor{stringliteral}{"TZ="}, tz, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
114         \}
115     \}
116     \textcolor{keywordflow}{for} (i = 0; i < env\_arr->\hyperlink{structapr__array__header__t_ab11b88220885c5a0920a06ac85680055}{nelts}; ++\hyperlink{group__MOD__PROXY_ga38403a0592eb8018a3ad61aef0f7ca2c}{i}) \{
117         \textcolor{keywordflow}{if} (!elts[i].\hyperlink{group__MOD__CACHE_ga11d8023381192746eb96be162398fe1c}{key}) \{
118             \textcolor{keywordflow}{continue};
119         \}
120         \hyperlink{group__APACHE__CORE__MPM_ga050c00b1a538603bac07d58e6e1c4ec7}{env}[j] = apr\_pstrcat(\hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p}, elts[i].key, \textcolor{stringliteral}{"="}, elts[i].\hyperlink{group__APACHE__CORE__CONFIG_gae553dcb033cb5c1e269683855e4f676a}{val}, \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
121         whack = \hyperlink{group__APACHE__CORE__MPM_ga050c00b1a538603bac07d58e6e1c4ec7}{env}[j];
122         \textcolor{keywordflow}{if} (\hyperlink{group__apr__ctype_ga8c453b1d66015b357c3d3a3ddb7d97d7}{apr\_isdigit}(*whack)) \{
123             *whack++ = \textcolor{charliteral}{'\_'};
124         \}
125         \textcolor{keywordflow}{while} (*whack != \textcolor{charliteral}{'='}) \{
126 \textcolor{preprocessor}{#ifdef WIN32}
127             \textcolor{keywordflow}{if} (!\hyperlink{group__apr__ctype_ga4fa78e6e7272dae64731768a17a2e003}{apr\_isalnum}(*whack) && *whack != \textcolor{charliteral}{'('} && *whack != \textcolor{charliteral}{')'}) \{
128 \textcolor{preprocessor}{#else}
129             \textcolor{keywordflow}{if} (!\hyperlink{group__apr__ctype_ga4fa78e6e7272dae64731768a17a2e003}{apr\_isalnum}(*whack)) \{
130 \textcolor{preprocessor}{#endif}
131                 *whack = \textcolor{charliteral}{'\_'};
132             \}
133             ++whack;
134         \}
135         ++j;
136     \}
137 
138     \hyperlink{group__APACHE__CORE__MPM_ga050c00b1a538603bac07d58e6e1c4ec7}{env}[j] = \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL};
139     \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__MPM_ga050c00b1a538603bac07d58e6e1c4ec7}{env};
140 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{util__script_8c_a5414c3ed69a8a76b1c5f012b0b1200db_icgraph}
\end{center}
\end{figure}


\index{util\+\_\+script.\+c@{util\+\_\+script.\+c}!A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}!util\+\_\+script.\+c@{util\+\_\+script.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E(int)}{AP_DECLARE(int)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{}
\end{DoxyParamCaption}
)}\hypertarget{util__script_8c_ace56382e8c8bdfffe9ffc8dbab06d36c}{}\label{util__script_8c_ace56382e8c8bdfffe9ffc8dbab06d36c}

\begin{DoxyCode}
330 \{
331     \textcolor{keywordtype}{int} lu = strlen(\hyperlink{group__APACHE__CORE__HTTPD_gaaf802cf1817bf45bcf1a5f266ef18bbd}{uri});
332     \textcolor{keywordtype}{int} lp = strlen(\hyperlink{group__APACHE__CORE__SCRIPT_ga8fe018b9749972d64c22742029459c5b}{path\_info});
333 
334     \textcolor{keywordflow}{while} (lu-- && lp-- && \hyperlink{group__APACHE__CORE__HTTPD_gaaf802cf1817bf45bcf1a5f266ef18bbd}{uri}[lu] == \hyperlink{group__APACHE__CORE__SCRIPT_ga8fe018b9749972d64c22742029459c5b}{path\_info}[lp]) \{
335         \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__SCRIPT_ga8fe018b9749972d64c22742029459c5b}{path\_info}[lp] == \textcolor{charliteral}{'/'}) \{
336             \textcolor{keywordflow}{while} (lu && \hyperlink{group__APACHE__CORE__HTTPD_gaaf802cf1817bf45bcf1a5f266ef18bbd}{uri}[lu-1] == \textcolor{charliteral}{'/'}) lu--;
337         \}
338     \}
339 
340     \textcolor{keywordflow}{if} (lu == -1) \{
341         lu = 0;
342     \}
343 
344     \textcolor{keywordflow}{while} (\hyperlink{group__APACHE__CORE__HTTPD_gaaf802cf1817bf45bcf1a5f266ef18bbd}{uri}[lu] != \textcolor{charliteral}{'\(\backslash\)0'} && \hyperlink{group__APACHE__CORE__HTTPD_gaaf802cf1817bf45bcf1a5f266ef18bbd}{uri}[lu] != \textcolor{charliteral}{'/'}) \{
345         lu++;
346     \}
347     \textcolor{keywordflow}{return} lu;
348 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{util__script_8c_ace56382e8c8bdfffe9ffc8dbab06d36c_cgraph}
\end{center}
\end{figure}


\index{util\+\_\+script.\+c@{util\+\_\+script.\+c}!A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}!util\+\_\+script.\+c@{util\+\_\+script.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E(ap\+\_\+scan\+\_\+script\+\_\+header\+\_\+err\+\_\+core\+\_\+ex(request\+\_\+rec int)}{AP_DECLARE(ap_scan_script_header_err_core_ex(request_rec int)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{ap\+\_\+scan\+\_\+script\+\_\+header\+\_\+err\+\_\+core\+\_\+ex({\bf request\+\_\+rec}}]{int}
\end{DoxyParamCaption}
)}\hypertarget{util__script_8c_a098a6cc1cb07395cf2472ed109eaa3e8}{}\label{util__script_8c_a098a6cc1cb07395cf2472ed109eaa3e8}

\begin{DoxyCode}
463 \{
464     \textcolor{keywordtype}{char} \hyperlink{group__MOD__PROXY_gaa51afdb6d96b938b938dc9439be201be}{x}[\hyperlink{group__APACHE__CORE__DAEMON_ga4fa9aad0e9c7cc2e344b679cdbb2b67d}{MAX\_STRING\_LEN}];
465     \textcolor{keywordtype}{char} *\hyperlink{group__MOD__PROXY_gab9a0c51666082a4ca5dd995ee972f77e}{w}, *\hyperlink{group__APACHE__CORE__CONFIG_ga325499caccf210ef36b605bae60930b7}{l};
466     \textcolor{keywordtype}{int} \hyperlink{group__APACHE__CORE__MPM_ga5cd91701e5c167f2b1a38e70ab57817e}{p};
467     \textcolor{keywordtype}{int} cgi\_status = \hyperlink{util__script_8c_afcd84495e0635d9ab191ad96e908df93}{HTTP\_UNSET};
468     \hyperlink{structapr__table__t}{apr\_table\_t} *merge;
469     \hyperlink{structapr__table__t}{apr\_table\_t} *cookie\_table;
470     \textcolor{keywordtype}{int} trace\_log = \hyperlink{group__APACHE__CORE__LOG_ga4e4ee8a00151db017209c55718f24d64}{APLOG\_R\_MODULE\_IS\_LEVEL}(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}, 
      \hyperlink{group__AP__EXPR_gaebe144cbe4474da9d8a21f71bee43251}{module\_index}, \hyperlink{group__APACHE__CORE__LOG_gab08ab6d0e9ab24707ce7baeaecf1f551}{APLOG\_TRACE1});
471     \textcolor{keywordtype}{int} first\_header = 1;
472 
473     \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer}) \{
474         *\hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer} = \textcolor{charliteral}{'\(\backslash\)0'};
475     \}
476     w = \hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer} ? \hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer} : \hyperlink{group__MOD__PROXY_gaa51afdb6d96b938b938dc9439be201be}{x};
477 
478     \textcolor{comment}{/* temporary place to hold headers to merge in later */}
479     merge = apr\_table\_make(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0}{pool}, 10);
480 
481     \textcolor{comment}{/* The HTTP specification says that it is legal to merge duplicate}
482 \textcolor{comment}{     * headers into one.  Some browsers that support Cookies don't like}
483 \textcolor{comment}{     * merged headers and prefer that each Set-Cookie header is sent}
484 \textcolor{comment}{     * separately.  Lets humour those browsers by not merging.}
485 \textcolor{comment}{     * Oh what a pain it is.}
486 \textcolor{comment}{     */}
487     cookie\_table = apr\_table\_make(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0}{pool}, 2);
488     apr\_table\_do(set\_cookie\_doo\_doo, cookie\_table, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a691d46e2e4fcf604394aeda5cc6e21e2}{err\_headers\_out}, \textcolor{stringliteral}{"Set-Cookie"}, 
      \hyperlink{pcre_8txt_ad7f989d16aa8ca809a36bc392c07fba1}{NULL});
489 
490     \textcolor{keywordflow}{while} (1) \{
491 
492         \textcolor{keywordtype}{int} rv = (*getsfunc) (\hyperlink{group__MOD__PROXY_gab9a0c51666082a4ca5dd995ee972f77e}{w}, \hyperlink{group__APACHE__CORE__DAEMON_ga4fa9aad0e9c7cc2e344b679cdbb2b67d}{MAX\_STRING\_LEN} - 1, 
      \hyperlink{group__APACHE__CORE__SCRIPT_gac02d658f319b3d5b305d32c19f20bf4b}{getsfunc\_data});
493         \textcolor{keywordflow}{if} (rv == 0) \{
494             \textcolor{keyword}{const} \textcolor{keywordtype}{char} *msg = \textcolor{stringliteral}{"Premature end of script headers"};
495             \textcolor{keywordflow}{if} (first\_header)
496                 msg = \textcolor{stringliteral}{"End of script output before headers"};
497             \textcolor{comment}{/* Intentional no APLOGNO */}
498             \hyperlink{group__APACHE__CORE__LOG_ga4c112558ccffd6b363da102b2052d2a6}{ap\_log\_rerror}(\hyperlink{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{SCRIPT\_LOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga57ad94ed8c92c4306de90479251a5d58}{APLOG\_ERR}|
      \hyperlink{group__APACHE__CORE__LOG_ga5d58a2410e5f8be30429161385acd8dc}{APLOG\_TOCLIENT}, 0, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r},
499                           \textcolor{stringliteral}{"%s: %s"}, msg,
500                           apr\_filepath\_name\_get(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a655cb2b33cbb40bd95c8da4d0da55eab}{filename}));
501             \textcolor{keywordflow}{return} \hyperlink{group__HTTP__Status_ga5d9777e02c26063c2985e39ef71091d2}{HTTP\_INTERNAL\_SERVER\_ERROR};
502         \}
503         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rv == -1) \{
504             \textcolor{comment}{/* Intentional no APLOGNO */}
505             \hyperlink{group__APACHE__CORE__LOG_ga4c112558ccffd6b363da102b2052d2a6}{ap\_log\_rerror}(\hyperlink{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{SCRIPT\_LOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga57ad94ed8c92c4306de90479251a5d58}{APLOG\_ERR}|
      \hyperlink{group__APACHE__CORE__LOG_ga5d58a2410e5f8be30429161385acd8dc}{APLOG\_TOCLIENT}, 0, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r},
506                           \textcolor{stringliteral}{"Script timed out before returning headers: %s"},
507                           apr\_filepath\_name\_get(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a655cb2b33cbb40bd95c8da4d0da55eab}{filename}));
508             \textcolor{keywordflow}{return} \hyperlink{group__HTTP__Status_gaaf973dd6df946c88224a4b761bb079fc}{HTTP\_GATEWAY\_TIME\_OUT};
509         \}
510 
511         \textcolor{comment}{/* Delete terminal (CR?)LF */}
512 
513         p = strlen(w);
514              \textcolor{comment}{/* Indeed, the host's '\(\backslash\)n':}
515 \textcolor{comment}{                '\(\backslash\)012' for UNIX; '\(\backslash\)015' for MacOS; '\(\backslash\)025' for OS/390}
516 \textcolor{comment}{                 -- whatever the script generates.}
517 \textcolor{comment}{             */}
518         \textcolor{keywordflow}{if} (p > 0 && w[p - 1] == \textcolor{charliteral}{'\(\backslash\)n'}) \{
519             \textcolor{keywordflow}{if} (p > 1 && w[p - 2] == \hyperlink{group__APACHE__CORE__DAEMON_gac7dc463c440edc9cf8f6a1e316e0b55b}{CR}) \{
520                 w[p - 2] = \textcolor{charliteral}{'\(\backslash\)0'};
521             \}
522             \textcolor{keywordflow}{else} \{
523                 w[p - 1] = \textcolor{charliteral}{'\(\backslash\)0'};
524             \}
525         \}
526 
527         \textcolor{comment}{/*}
528 \textcolor{comment}{         * If we've finished reading the headers, check to make sure any}
529 \textcolor{comment}{         * HTTP/1.1 conditions are met.  If so, we're done; normal processing}
530 \textcolor{comment}{         * will handle the script's output.  If not, just return the error.}
531 \textcolor{comment}{         * The appropriate thing to do would be to send the script process a}
532 \textcolor{comment}{         * SIGPIPE to let it know we're ignoring it, close the channel to the}
533 \textcolor{comment}{         * script process, and *then* return the failed-to-meet-condition}
534 \textcolor{comment}{         * error.  Otherwise we'd be waiting for the script to finish}
535 \textcolor{comment}{         * blithering before telling the client the output was no good.}
536 \textcolor{comment}{         * However, we don't have the information to do that, so we have to}
537 \textcolor{comment}{         * leave it to an upper layer.}
538 \textcolor{comment}{         */}
539         \textcolor{keywordflow}{if} (w[0] == \textcolor{charliteral}{'\(\backslash\)0'}) \{
540             \textcolor{keywordtype}{int} cond\_status = \hyperlink{group__APACHE__CORE__DAEMON_gaba51915c87d64af47fb1cc59348961c9}{OK};
541 
542             \textcolor{comment}{/* PR#38070: This fails because it gets confused when a}
543 \textcolor{comment}{             * CGI Status header overrides ap\_meets\_conditions.}
544 \textcolor{comment}{             *}
545 \textcolor{comment}{             * We can fix that by dropping ap\_meets\_conditions when}
546 \textcolor{comment}{             * Status has been set.  Since this is the only place}
547 \textcolor{comment}{             * cgi\_status gets used, let's test it explicitly.}
548 \textcolor{comment}{             *}
549 \textcolor{comment}{             * The alternative would be to ignore CGI Status when}
550 \textcolor{comment}{             * ap\_meets\_conditions returns anything interesting.}
551 \textcolor{comment}{             * That would be safer wrt HTTP, but would break CGI.}
552 \textcolor{comment}{             */}
553             \textcolor{keywordflow}{if} ((cgi\_status == \hyperlink{util__script_8c_afcd84495e0635d9ab191ad96e908df93}{HTTP\_UNSET}) && (\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a5d11eb89be0765988fde175e0d5ccfb7}{method\_number} == 
      \hyperlink{group__Methods_ga8793a8633545688a32ef097e9b0ac591}{M\_GET})) \{
554                 cond\_status = ap\_meets\_conditions(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r});
555             \}
556             apr\_table\_overlap(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a691d46e2e4fcf604394aeda5cc6e21e2}{err\_headers\_out}, merge,
557                 \hyperlink{group__apr__tables_ga553eea6eb6fea4bafaf4cbd7acafdf5f}{APR\_OVERLAP\_TABLES\_MERGE});
558             \textcolor{keywordflow}{if} (!apr\_is\_empty\_table(cookie\_table)) \{
559                 \textcolor{comment}{/* the cookies have already been copied to the cookie\_table */}
560                 apr\_table\_unset(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a691d46e2e4fcf604394aeda5cc6e21e2}{err\_headers\_out}, \textcolor{stringliteral}{"Set-Cookie"});
561                 \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a691d46e2e4fcf604394aeda5cc6e21e2}{err\_headers\_out} = apr\_table\_overlay(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0}{pool},
562                     \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a691d46e2e4fcf604394aeda5cc6e21e2}{err\_headers\_out}, cookie\_table);
563             \}
564             \textcolor{keywordflow}{return} cond\_status;
565         \}
566 
567         \textcolor{keywordflow}{if} (trace\_log) \{
568             \textcolor{keywordflow}{if} (first\_header)
569                 \hyperlink{group__APACHE__CORE__LOG_ga4c112558ccffd6b363da102b2052d2a6}{ap\_log\_rerror}(\hyperlink{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{SCRIPT\_LOG\_MARK}, 
      \hyperlink{group__APACHE__CORE__LOG_ga479289550d998526187ff78880378f9c}{APLOG\_TRACE4}, 0, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r},
570                               \textcolor{stringliteral}{"Headers from script '%s':"},
571                               apr\_filepath\_name\_get(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a655cb2b33cbb40bd95c8da4d0da55eab}{filename}));
572             \hyperlink{group__APACHE__CORE__LOG_ga4c112558ccffd6b363da102b2052d2a6}{ap\_log\_rerror}(\hyperlink{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{SCRIPT\_LOG\_MARK}, 
      \hyperlink{group__APACHE__CORE__LOG_ga479289550d998526187ff78880378f9c}{APLOG\_TRACE4}, 0, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}, \textcolor{stringliteral}{"  %s"}, w);
573         \}
574 
575         \textcolor{comment}{/* if we see a bogus header don't ignore it. Shout and scream */}
576 
577 \textcolor{preprocessor}{#if APR\_CHARSET\_EBCDIC}
578             \textcolor{comment}{/* Chances are that we received an ASCII header text instead of}
579 \textcolor{comment}{             * the expected EBCDIC header lines. Try to auto-detect:}
580 \textcolor{comment}{             */}
581         \textcolor{keywordflow}{if} (!(l = strchr(w, \textcolor{charliteral}{':'}))) \{
582             \textcolor{keywordtype}{int} maybeASCII = 0, maybeEBCDIC = 0;
583             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *cp, native;
584             \hyperlink{group__apr__platform_gaaa72b2253f6f3032cefea5712a27540e}{apr\_size\_t} \hyperlink{group__APR__XLATE_ga2f86284c0e279b847a1319f2074262bf}{inbytes\_left}, \hyperlink{group__APR__XLATE_ga52d059f5a291f7a81d4403229554cf57}{outbytes\_left};
585 
586             \textcolor{keywordflow}{for} (cp = w; *cp != \textcolor{charliteral}{'\(\backslash\)0'}; ++cp) \{
587                 native = apr\_xlate\_conv\_byte(ap\_hdrs\_from\_ascii, *cp);
588                 \textcolor{keywordflow}{if} (\hyperlink{group__apr__ctype_ga20da56fc8bbedc9f8a40d20c1cc58bac}{apr\_isprint}(*cp) && !\hyperlink{group__apr__ctype_ga20da56fc8bbedc9f8a40d20c1cc58bac}{apr\_isprint}(native))
589                     ++maybeEBCDIC;
590                 \textcolor{keywordflow}{if} (!\hyperlink{group__apr__ctype_ga20da56fc8bbedc9f8a40d20c1cc58bac}{apr\_isprint}(*cp) && \hyperlink{group__apr__ctype_ga20da56fc8bbedc9f8a40d20c1cc58bac}{apr\_isprint}(native))
591                     ++maybeASCII;
592             \}
593             \textcolor{keywordflow}{if} (maybeASCII > maybeEBCDIC) \{
594                 \hyperlink{group__APACHE__CORE__LOG_ga5e6676c87418af7a1d323a116c78ecb4}{ap\_log\_error}(\hyperlink{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{SCRIPT\_LOG\_MARK}, 
      \hyperlink{group__APACHE__CORE__LOG_ga57ad94ed8c92c4306de90479251a5d58}{APLOG\_ERR}, 0, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a4a8059930ce9409cb885fdeef6921b7b}{server},
595                              \hyperlink{group__APACHE__CORE__LOG_ga1dee8a07e06bc5b3de8b89662c2cd666}{APLOGNO}(02660) \textcolor{stringliteral}{"CGI Interface Error: "}
596                              \textcolor{stringliteral}{"Script headers apparently ASCII: (CGI = %s)"},
597                              \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a655cb2b33cbb40bd95c8da4d0da55eab}{filename});
598                 inbytes\_left = outbytes\_left = cp - \hyperlink{group__MOD__PROXY_gab9a0c51666082a4ca5dd995ee972f77e}{w};
599                 apr\_xlate\_conv\_buffer(ap\_hdrs\_from\_ascii,
600                                       w, &inbytes\_left, w, &outbytes\_left);
601             \}
602         \}
603 \textcolor{preprocessor}{#endif }\textcolor{comment}{/*APR\_CHARSET\_EBCDIC*/}\textcolor{preprocessor}{}
604         \textcolor{keywordflow}{if} (!(l = strchr(w, \textcolor{charliteral}{':'}))) \{
605             \textcolor{keywordflow}{if} (!\hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer}) \{
606                 \textcolor{comment}{/* Soak up all the script output - may save an outright kill */}
607                 \textcolor{keywordflow}{while} ((*\hyperlink{group__APACHE__CORE__SCRIPT_gaec1898c3826a871b62aa827595dce20a}{getsfunc})(w, MAX\_STRING\_LEN - 1, \hyperlink{group__APACHE__CORE__SCRIPT_gac02d658f319b3d5b305d32c19f20bf4b}{getsfunc\_data}) > 0) \{
608                     \textcolor{keywordflow}{continue};
609                 \}
610             \}
611 
612             \textcolor{comment}{/* Intentional no APLOGNO */}
613             \hyperlink{group__APACHE__CORE__LOG_ga4c112558ccffd6b363da102b2052d2a6}{ap\_log\_rerror}(\hyperlink{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{SCRIPT\_LOG\_MARK}, \hyperlink{group__APACHE__CORE__LOG_ga57ad94ed8c92c4306de90479251a5d58}{APLOG\_ERR}|
      \hyperlink{group__APACHE__CORE__LOG_ga5d58a2410e5f8be30429161385acd8dc}{APLOG\_TOCLIENT}, 0, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r},
614                           \textcolor{stringliteral}{"malformed header from script '%s': Bad header: %.30s"},
615                           apr\_filepath\_name\_get(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a655cb2b33cbb40bd95c8da4d0da55eab}{filename}), w);
616             \textcolor{keywordflow}{return} \hyperlink{group__HTTP__Status_ga5d9777e02c26063c2985e39ef71091d2}{HTTP\_INTERNAL\_SERVER\_ERROR};
617         \}
618 
619         *l++ = \textcolor{charliteral}{'\(\backslash\)0'};
620         \textcolor{keywordflow}{while} (\hyperlink{group__apr__ctype_ga23f4c7721923a0f0f444fd7fb196047a}{apr\_isspace}(*l)) \{
621             ++\hyperlink{group__APACHE__CORE__CONFIG_ga325499caccf210ef36b605bae60930b7}{l};
622         \}
623 
624         \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(w, \textcolor{stringliteral}{"Content-type"})) \{
625             \textcolor{keywordtype}{char} *tmp;
626 
627             \textcolor{comment}{/* Nuke trailing whitespace */}
628 
629             \textcolor{keywordtype}{char} *endp = l + strlen(l) - 1;
630             \textcolor{keywordflow}{while} (endp > l && \hyperlink{group__apr__ctype_ga23f4c7721923a0f0f444fd7fb196047a}{apr\_isspace}(*endp)) \{
631                 *endp-- = \textcolor{charliteral}{'\(\backslash\)0'};
632             \}
633 
634             tmp = apr\_pstrdup(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0}{pool}, l);
635             ap\_content\_type\_tolower(tmp);
636             ap\_set\_content\_type(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}, tmp);
637         \}
638         \textcolor{comment}{/*}
639 \textcolor{comment}{         * If the script returned a specific status, that's what}
640 \textcolor{comment}{         * we'll use - otherwise we assume 200 OK.}
641 \textcolor{comment}{         */}
642         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(w, \textcolor{stringliteral}{"Status"})) \{
643             \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a09b59ad2fa51be73efea7369b5484eb0}{status} = cgi\_status = atoi(l);
644             \textcolor{keywordflow}{if} (!\hyperlink{group__HTTP__Status_ga0cdd763b32bf9c0f42e7da2eccf539ac}{ap\_is\_HTTP\_VALID\_RESPONSE}(cgi\_status))
645                 \textcolor{comment}{/* Intentional no APLOGNO */}
646                 \hyperlink{group__APACHE__CORE__LOG_ga4c112558ccffd6b363da102b2052d2a6}{ap\_log\_rerror}(\hyperlink{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{SCRIPT\_LOG\_MARK}, 
      \hyperlink{group__APACHE__CORE__LOG_ga57ad94ed8c92c4306de90479251a5d58}{APLOG\_ERR}|\hyperlink{group__APACHE__CORE__LOG_ga5d58a2410e5f8be30429161385acd8dc}{APLOG\_TOCLIENT}, 0, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r},
647                               \textcolor{stringliteral}{"Invalid status line from script '%s': %.30s"},
648                               apr\_filepath\_name\_get(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a655cb2b33cbb40bd95c8da4d0da55eab}{filename}), l);
649             \textcolor{keywordflow}{else}
650                 \textcolor{keywordflow}{if} (\hyperlink{group__APACHE__CORE__LOG_ga6d561a49029da4b63d47725305961c1f}{APLOGrtrace1}(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}))
651                    \hyperlink{group__APACHE__CORE__LOG_ga4c112558ccffd6b363da102b2052d2a6}{ap\_log\_rerror}(\hyperlink{util__script_8c_aa8f4139a154e290b7310c3ab859abfc0}{SCRIPT\_LOG\_MARK}, 
      \hyperlink{group__APACHE__CORE__LOG_gab08ab6d0e9ab24707ce7baeaecf1f551}{APLOG\_TRACE1}, 0, \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r},
652                                  \textcolor{stringliteral}{"Status line from script '%s': %.30s"},
653                                  apr\_filepath\_name\_get(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a655cb2b33cbb40bd95c8da4d0da55eab}{filename}), l);
654             \hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_ab232130efe6c7ae07b0e0cafd49b4d31}{status\_line} = apr\_pstrdup(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0}{pool}, l);
655         \}
656         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(w, \textcolor{stringliteral}{"Location"})) \{
657             apr\_table\_set(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a0fd560d8d1118304dc33df8ee99efc04}{headers\_out}, w, l);
658         \}
659         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(w, \textcolor{stringliteral}{"Content-Length"})) \{
660             apr\_table\_set(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a0fd560d8d1118304dc33df8ee99efc04}{headers\_out}, w, l);
661         \}
662         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(w, \textcolor{stringliteral}{"Content-Range"})) \{
663             apr\_table\_set(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a0fd560d8d1118304dc33df8ee99efc04}{headers\_out}, w, l);
664         \}
665         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(w, \textcolor{stringliteral}{"Transfer-Encoding"})) \{
666             apr\_table\_set(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a0fd560d8d1118304dc33df8ee99efc04}{headers\_out}, w, l);
667         \}
668         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(w, \textcolor{stringliteral}{"ETag"})) \{
669             apr\_table\_set(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}->\hyperlink{structrequest__rec_a0fd560d8d1118304dc33df8ee99efc04}{headers\_out}, w, l);
670         \}
671         \textcolor{comment}{/*}
672 \textcolor{comment}{         * If the script gave us a Last-Modified header, we can't just}
673 \textcolor{comment}{         * pass it on blindly because of restrictions on future values.}
674 \textcolor{comment}{         */}
675         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(w, \textcolor{stringliteral}{"Last-Modified"})) \{
676             ap\_update\_mtime(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}, apr\_date\_parse\_http(l));
677             ap\_set\_last\_modified(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r});
678         \}
679         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\hyperlink{apr__cpystrn_8c_a4a00fc29b96a953fed9e0107a9c4548a}{strcasecmp}(w, \textcolor{stringliteral}{"Set-Cookie"})) \{
680             apr\_table\_add(cookie\_table, w, l);
681         \}
682         \textcolor{keywordflow}{else} \{
683             apr\_table\_add(merge, w, l);
684         \}
685         first\_header = 0;
686     \}
687     \textcolor{comment}{/* never reached - we leave this function within the while loop above */}
688     \textcolor{keywordflow}{return} \hyperlink{group__APACHE__CORE__DAEMON_gaba51915c87d64af47fb1cc59348961c9}{OK};
689 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=267pt]{util__script_8c_a098a6cc1cb07395cf2472ed109eaa3e8_cgraph}
\end{center}
\end{figure}


\index{util\+\_\+script.\+c@{util\+\_\+script.\+c}!A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}}
\index{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE@{A\+P\+\_\+\+D\+E\+C\+L\+A\+RE}!util\+\_\+script.\+c@{util\+\_\+script.\+c}}
\subsubsection[{\texorpdfstring{A\+P\+\_\+\+D\+E\+C\+L\+A\+R\+E(ap\+\_\+scan\+\_\+script\+\_\+header\+\_\+err\+\_\+core(request\+\_\+rec int)}{AP_DECLARE(ap_scan_script_header_err_core(request_rec int)}}]{\setlength{\rightskip}{0pt plus 5cm}A\+P\+\_\+\+D\+E\+C\+L\+A\+RE (
\begin{DoxyParamCaption}
\item[{ap\+\_\+scan\+\_\+script\+\_\+header\+\_\+err\+\_\+core({\bf request\+\_\+rec}}]{int}
\end{DoxyParamCaption}
)}\hypertarget{util__script_8c_a3a211adcc4b131409999f5100de7ffc5}{}\label{util__script_8c_a3a211adcc4b131409999f5100de7ffc5}

\begin{DoxyCode}
694 \{
695     \textcolor{keywordflow}{return} ap\_scan\_script\_header\_err\_core\_ex(\hyperlink{group__APACHE__CORE__CONFIG_ga091cdd45984e865a888a4f8bb8fe107a}{r}, \hyperlink{group__APACHE__CORE__PROTO_gabd91b1aab0a10c5027ca2eb5577f759f}{buffer}, \hyperlink{group__APACHE__CORE__SCRIPT_gaec1898c3826a871b62aa827595dce20a}{getsfunc},
696                                              \hyperlink{group__APACHE__CORE__SCRIPT_gac02d658f319b3d5b305d32c19f20bf4b}{getsfunc\_data},
697                                              \hyperlink{util__script_8c_ae75325996d1b2cf6120dded4cb153a22}{APLOG\_MODULE\_INDEX});
698 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{util__script_8c_a3a211adcc4b131409999f5100de7ffc5_cgraph}
\end{center}
\end{figure}


