<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>My Project: Cache Storage Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Cache Storage Functions<div class="ingroups"><a class="el" href="group__APACHE.html">Apache HTTP Server</a> &raquo; <a class="el" href="group__APACHE__MODS.html">Loadable modules</a> &raquo; <a class="el" href="group__MOD__CACHE.html">mod_cache</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Cache Storage Functions:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__Cache__storage.png" border="0" alt="" usemap="#group____Cache____storage"/>
<map name="group____Cache____storage" id="group____Cache____storage">
<area shape="rect" id="node1" href="group__MOD__CACHE.html" title="mod_cache" alt="" coords="5,5,95,32"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga099a01e4f8a6d68cc94a47adde527489"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__storage.html#ga099a01e4f8a6d68cc94a47adde527489">cache_remove_url</a> (<a class="el" href="structcache__request__rec.html">cache_request_rec</a> *<a class="el" href="structcache.html">cache</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>)</td></tr>
<tr class="separator:ga099a01e4f8a6d68cc94a47adde527489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa8317a8938235881e7f1368031b33bb9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__storage.html#gaa8317a8938235881e7f1368031b33bb9">cache_create_entity</a> (<a class="el" href="structcache__request__rec.html">cache_request_rec</a> *<a class="el" href="structcache.html">cache</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>, <a class="el" href="group__apr__platform.html#ga6938af9075cec15c88299109381aa984">apr_off_t</a> <a class="el" href="README_8txt.html#a870076999eb1486aa63d2e2cf5cdfa55">size</a>, <a class="el" href="structapr__bucket__brigade.html">apr_bucket_brigade</a> *<a class="el" href="group__apr__thread__proc.html#ga2e46fea00cc2238744ebca5061c62bcc">in</a>)</td></tr>
<tr class="separator:gaa8317a8938235881e7f1368031b33bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaffb29f2e1276bc7d81bac540a1cf3e06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__storage.html#gaffb29f2e1276bc7d81bac540a1cf3e06">cache_select</a> (<a class="el" href="structcache__request__rec.html">cache_request_rec</a> *<a class="el" href="structcache.html">cache</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>)</td></tr>
<tr class="separator:gaffb29f2e1276bc7d81bac540a1cf3e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8579a258895a1e158ebe9e61deb15d9a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__storage.html#ga8579a258895a1e158ebe9e61deb15d9a">cache_invalidate</a> (<a class="el" href="structcache__request__rec.html">cache_request_rec</a> *<a class="el" href="structcache.html">cache</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>)</td></tr>
<tr class="separator:ga8579a258895a1e158ebe9e61deb15d9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9b9cd90883d10b4e8f021c0cc371a823"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__storage.html#ga9b9cd90883d10b4e8f021c0cc371a823">cache_generate_key_default</a> (<a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>, <a class="el" href="structapr__pool__t.html">apr_pool_t</a> *<a class="el" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>, const char **<a class="el" href="apr__siphash_8h.html#adac0b6a30345ea1d0daa8a692b0b7ad9">key</a>)</td></tr>
<tr class="separator:ga9b9cd90883d10b4e8f021c0cc371a823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b273ea1fdda33adc7ecf2e47e4a57a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__storage.html#ga0b273ea1fdda33adc7ecf2e47e4a57a7">cache_accept_headers</a> (<a class="el" href="group__MOD__CACHE.html#ga6b7854a2592838a565bdee8f94343aab">cache_handle_t</a> *<a class="el" href="pcregrep_8txt.html#a373589baca2cb79ec87f46d6599640b9">h</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>, <a class="el" href="structapr__table__t.html">apr_table_t</a> *top, <a class="el" href="structapr__table__t.html">apr_table_t</a> *bottom, <a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> revalidation)</td></tr>
<tr class="separator:ga0b273ea1fdda33adc7ecf2e47e4a57a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga0b273ea1fdda33adc7ecf2e47e4a57a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a> cache_accept_headers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MOD__CACHE.html#ga6b7854a2592838a565bdee8f94343aab">cache_handle_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapr__table__t.html">apr_table_t</a> *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapr__table__t.html">apr_table_t</a> *&#160;</td>
          <td class="paramname"><em>bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td>
          <td class="paramname"><em>revalidation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Merge in cached headers into the response </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>cache_handle_t </td></tr>
    <tr><td class="paramname">r</td><td><a class="el" href="structrequest__rec.html" title="A structure that represents the current request. ">request_rec</a> </td></tr>
    <tr><td class="paramname">top</td><td>headers to be applied </td></tr>
    <tr><td class="paramname">bottom</td><td>headers to be overwritten </td></tr>
    <tr><td class="paramname">revalidation</td><td>true if revalidation is taking place</td></tr>
  </table>
  </dd>
</dl>
<p>Take two sets of headers, sandwich them together, and apply the result to r-&gt;headers_out.</p>
<p>To complicate this, a header may be duplicated in either table. Should a header exist in the top table, all matching headers will be removed from the bottom table before the headers are combined. The Warning headers are handled specially. Warnings are added rather than being replaced, while in the case of revalidation 1xx Warnings are stripped.</p>
<p>The Content-Type and Last-Modified headers are then re-parsed and inserted into the request. </p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="pcregrep_8txt.html#ac2002bf2124e804678bf3ccba93693c5">v</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (revalidation) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a> = apr_table_make(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, 10);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        apr_table_do(filter_header_do, r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>, bottom, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a> != bottom) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a> = apr_table_copy(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, bottom);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    apr_table_do(remove_header_do, r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>, top, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    apr_table_do(add_header_do, r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>, top, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    v = apr_table_get(r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>, <span class="stringliteral">&quot;Content-Type&quot;</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (v) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        ap_set_content_type(r, v);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">         * Also unset possible Content-Type headers in r-&gt;headers_out and</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">         * r-&gt;err_headers_out as they may be different to what we have received</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">         * from the cache.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">         * Actually they are not needed as r-&gt;content_type set by</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">         * ap_set_content_type above will be used in the store_headers functions</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">         * of the storage providers as a fallback and the HTTP_HEADER filter</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">         * does overwrite the Content-Type header with r-&gt;content_type anyway.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        apr_table_unset(r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>, <span class="stringliteral">&quot;Content-Type&quot;</span>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        apr_table_unset(r-&gt;<a class="code" href="structrequest__rec.html#a691d46e2e4fcf604394aeda5cc6e21e2">err_headers_out</a>, <span class="stringliteral">&quot;Content-Type&quot;</span>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">/* If the cache gave us a Last-Modified header, we can&#39;t just</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">     * pass it on blindly because of restrictions on future values.</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    v = apr_table_get(r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>, <span class="stringliteral">&quot;Last-Modified&quot;</span>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (v) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        ap_update_mtime(r, apr_date_parse_http(v));</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        ap_set_last_modified(r);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div><div class="ttc" id="structrequest__rec_html_a691d46e2e4fcf604394aeda5cc6e21e2"><div class="ttname"><a href="structrequest__rec.html#a691d46e2e4fcf604394aeda5cc6e21e2">request_rec::err_headers_out</a></div><div class="ttdeci">uintptr_t err_headers_out</div><div class="ttdef"><b>Definition:</b> ap.d:37</div></div>
<div class="ttc" id="pcregrep_8txt_html_ac2002bf2124e804678bf3ccba93693c5"><div class="ttname"><a href="pcregrep_8txt.html#ac2002bf2124e804678bf3ccba93693c5">v</a></div><div class="ttdeci">in some operating systems this gives an immediate end of file This option is a shorthand for setting the d option to recurse recursion no messages Suppress error messages about non existent or unreadable files Such files are quietly skipped the return code is even if matches were found in other files utf Operate in UTF mode This option is available only if PCRE has been compiled with UTF support All version Write the version numbers of pcregrep and the PCRE library to the standard output and then exit Anything else on the com mand line is ignored v</div><div class="ttdef"><b>Definition:</b> pcregrep.txt:605</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="structrequest__rec_html_a0fd560d8d1118304dc33df8ee99efc04"><div class="ttname"><a href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">request_rec::headers_out</a></div><div class="ttdeci">uintptr_t headers_out</div><div class="ttdef"><b>Definition:</b> ap.d:36</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__storage_ga0b273ea1fdda33adc7ecf2e47e4a57a7_icgraph.png" border="0" usemap="#group__Cache__storage_ga0b273ea1fdda33adc7ecf2e47e4a57a7_icgraph" alt=""/></div>
<map name="group__Cache__storage_ga0b273ea1fdda33adc7ecf2e47e4a57a7_icgraph" id="group__Cache__storage_ga0b273ea1fdda33adc7ecf2e47e4a57a7_icgraph">
<area shape="rect" id="node2" href="group__Cache__storage.html#gaffb29f2e1276bc7d81bac540a1cf3e06" title="cache_select" alt="" coords="209,5,308,32"/>
<area shape="rect" id="node3" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="356,31,547,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaa8317a8938235881e7f1368031b33bb9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> cache_create_entity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__request__rec.html">cache_request_rec</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__apr__platform.html#ga6938af9075cec15c88299109381aa984">apr_off_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapr__bucket__brigade.html">apr_bucket_brigade</a> *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="structcache__provider__list.html">cache_provider_list</a> *<a class="code" href="group__APACHE__CORE__PROTO.html#gaeb6b944e4524f915483b5696b7f2f424">list</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="structcache__handle.html">cache_handle_t</a> *<a class="code" href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a> = <a class="code" href="group__apr__pools.html#gad214fc0160de3c22b6435e29ea20fce8">apr_pcalloc</a>(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, <span class="keyword">sizeof</span>(<a class="code" href="structcache__handle.html">cache_handle_t</a>));</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a> rv;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> (!cache) {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">/* This should never happen */</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga57ad94ed8c92c4306de90479251a5d58">APLOG_ERR</a>, <a class="code" href="group__APR__Error.html#ga18f5678bea0c2c704a2b6a186c9e158b">APR_EGENERAL</a>, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00692)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <span class="stringliteral">&quot;cache: No cache request information available for key&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                <span class="stringliteral">&quot; generation&quot;</span>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__APR__Error.html#ga18f5678bea0c2c704a2b6a186c9e158b">APR_EGENERAL</a>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        rv = cache_generate_key(r, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, &amp;cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">if</span> (rv != <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">return</span> rv;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    list = cache-&gt;<a class="code" href="structcache__request__rec.html#afeb71f387482c679d90de359869b8e10">providers</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">/* for each specified cache type, delete the URL */</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">while</span> (list) {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">switch</span> (rv = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>-&gt;<a class="code" href="structcache__provider.html#a274d91e1289fb324e33ee86c8077c3d0">create_entity</a>(h, r, cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>, <a class="code" href="group__APACHE__CORE__CONFIG.html#ga2bd3edb50f631a96f1b729fde236ff43">size</a>, in)) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a>: {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            cache-&gt;<a class="code" href="structcache__request__rec.html#ade71ff36fe9a713fd081fa45524151f1">handle</a> = <a class="code" href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            cache-&gt;<a class="code" href="structcache__request__rec.html#aa97c7f2b0167adee182cce9f2c66b0eb">provider</a> = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            cache-&gt;<a class="code" href="structcache__request__rec.html#ad15b24a12858815a315f37152111b41d">provider_name</a> = list-&gt;<a class="code" href="structcache__provider__list.html#a0bd2adbaa02f1aa6af1971fd24b09b6a">provider_name</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>: {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            list = list-&gt;<a class="code" href="structcache__provider__list.html#a87c07afc8bb63fe7fd2e9274e60341a9">next</a>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">default</span>: {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">return</span> rv;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__LOG_html_ga655e126996849bcb82e4e5a14c616f4a"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a></div><div class="ttdeci">#define APLOG_MARK</div><div class="ttdef"><b>Definition:</b> http_log.h:283</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga57ad94ed8c92c4306de90479251a5d58"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga57ad94ed8c92c4306de90479251a5d58">APLOG_ERR</a></div><div class="ttdeci">#define APLOG_ERR</div><div class="ttdef"><b>Definition:</b> http_log.h:46</div></div>
<div class="ttc" id="structcache__request__rec_html_afeb71f387482c679d90de359869b8e10"><div class="ttname"><a href="structcache__request__rec.html#afeb71f387482c679d90de359869b8e10">cache_request_rec::providers</a></div><div class="ttdeci">cache_provider_list * providers</div><div class="ttdef"><b>Definition:</b> cache_util.h:211</div></div>
<div class="ttc" id="group__APR__Error_html_ga18f5678bea0c2c704a2b6a186c9e158b"><div class="ttname"><a href="group__APR__Error.html#ga18f5678bea0c2c704a2b6a186c9e158b">APR_EGENERAL</a></div><div class="ttdeci">#define APR_EGENERAL</div><div class="ttdef"><b>Definition:</b> apr_errno.h:313</div></div>
<div class="ttc" id="structcache__request__rec_html_ade71ff36fe9a713fd081fa45524151f1"><div class="ttname"><a href="structcache__request__rec.html#ade71ff36fe9a713fd081fa45524151f1">cache_request_rec::handle</a></div><div class="ttdeci">cache_handle_t * handle</div><div class="ttdef"><b>Definition:</b> cache_util.h:215</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga2bd3edb50f631a96f1b729fde236ff43"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga2bd3edb50f631a96f1b729fde236ff43">size</a></div><div class="ttdeci">apr_size_t size</div><div class="ttdef"><b>Definition:</b> http_config.h:1193</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="group__apr__errno_html_gaa5105fa83cc322f09382292db8b47593"><div class="ttname"><a href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a></div><div class="ttdeci">int apr_status_t</div><div class="ttdef"><b>Definition:</b> apr_errno.h:44</div></div>
<div class="ttc" id="structcache__provider_html_a274d91e1289fb324e33ee86c8077c3d0"><div class="ttname"><a href="structcache__provider.html#a274d91e1289fb324e33ee86c8077c3d0">cache_provider::create_entity</a></div><div class="ttdeci">int(* create_entity)(cache_handle_t *h, request_rec *r, const char *urlkey, apr_off_t len, apr_bucket_brigade *bb)</div><div class="ttdef"><b>Definition:</b> mod_cache.h:106</div></div>
<div class="ttc" id="structcache__provider__list_html"><div class="ttname"><a href="structcache__provider__list.html">cache_provider_list</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:203</div></div>
<div class="ttc" id="group__APACHE__CORE__PROTO_html_gaeb6b944e4524f915483b5696b7f2f424"><div class="ttname"><a href="group__APACHE__CORE__PROTO.html#gaeb6b944e4524f915483b5696b7f2f424">list</a></div><div class="ttdeci">const char apr_pool_t apr_bucket_alloc_t * list</div><div class="ttdef"><b>Definition:</b> http_protocol.h:985</div></div>
<div class="ttc" id="structcache__provider__list_html_a0bd2adbaa02f1aa6af1971fd24b09b6a"><div class="ttname"><a href="structcache__provider__list.html#a0bd2adbaa02f1aa6af1971fd24b09b6a">cache_provider_list::provider_name</a></div><div class="ttdeci">const char * provider_name</div><div class="ttdef"><b>Definition:</b> cache_util.h:204</div></div>
<div class="ttc" id="structcache__request__rec_html_ad15b24a12858815a315f37152111b41d"><div class="ttname"><a href="structcache__request__rec.html#ad15b24a12858815a315f37152111b41d">cache_request_rec::provider_name</a></div><div class="ttdeci">const char * provider_name</div><div class="ttdef"><b>Definition:</b> cache_util.h:213</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga9eba11ca86461a3ae319311d64682dda"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a></div><div class="ttdeci">#define DECLINED</div><div class="ttdef"><b>Definition:</b> httpd.h:456</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_gaba51915c87d64af47fb1cc59348961c9"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a></div><div class="ttdeci">#define OK</div><div class="ttdef"><b>Definition:</b> httpd.h:455</div></div>
<div class="ttc" id="structcache__provider__list_html_a1e1caa5b70698f255962728326dc1be3"><div class="ttname"><a href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">cache_provider_list::provider</a></div><div class="ttdeci">const cache_provider * provider</div><div class="ttdef"><b>Definition:</b> cache_util.h:205</div></div>
<div class="ttc" id="structcache__provider__list_html_a87c07afc8bb63fe7fd2e9274e60341a9"><div class="ttname"><a href="structcache__provider__list.html#a87c07afc8bb63fe7fd2e9274e60341a9">cache_provider_list::next</a></div><div class="ttdeci">cache_provider_list * next</div><div class="ttdef"><b>Definition:</b> cache_util.h:206</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga4c112558ccffd6b363da102b2052d2a6"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a></div><div class="ttdeci">#define ap_log_rerror</div><div class="ttdef"><b>Definition:</b> http_log.h:454</div></div>
<div class="ttc" id="structcache__request__rec_html_a564726b5f7e5dc4fee2fb01d178677b4"><div class="ttname"><a href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">cache_request_rec::key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> cache_util.h:227</div></div>
<div class="ttc" id="structcache__handle_html"><div class="ttname"><a href="structcache__handle.html">cache_handle</a></div><div class="ttdef"><b>Definition:</b> mod_cache.h:91</div></div>
<div class="ttc" id="group__apr__pools_html_gad214fc0160de3c22b6435e29ea20fce8"><div class="ttname"><a href="group__apr__pools.html#gad214fc0160de3c22b6435e29ea20fce8">apr_pcalloc</a></div><div class="ttdeci">#define apr_pcalloc(p, size)</div><div class="ttdef"><b>Definition:</b> apr_pools.h:465</div></div>
<div class="ttc" id="group__apr__hash_html_ga0d6dcb41ca5e794b318df5f6fd273ee2"><div class="ttname"><a href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a></div><div class="ttdeci">const apr_hash_t * h</div><div class="ttdef"><b>Definition:</b> apr_hash.h:97</div></div>
<div class="ttc" id="group__apr__errno_html_ga9ee311b7bf1c691dc521d721339ee2a6"><div class="ttname"><a href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a></div><div class="ttdeci">#define APR_SUCCESS</div><div class="ttdef"><b>Definition:</b> apr_errno.h:225</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga1dee8a07e06bc5b3de8b89662c2cd666"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a></div><div class="ttdeci">#define APLOGNO(n)</div><div class="ttdef"><b>Definition:</b> http_log.h:117</div></div>
<div class="ttc" id="structcache__request__rec_html_aa97c7f2b0167adee182cce9f2c66b0eb"><div class="ttname"><a href="structcache__request__rec.html#aa97c7f2b0167adee182cce9f2c66b0eb">cache_request_rec::provider</a></div><div class="ttdeci">const cache_provider * provider</div><div class="ttdef"><b>Definition:</b> cache_util.h:212</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__storage_gaa8317a8938235881e7f1368031b33bb9_icgraph.png" border="0" usemap="#group__Cache__storage_gaa8317a8938235881e7f1368031b33bb9_icgraph" alt=""/></div>
<map name="group__Cache__storage_gaa8317a8938235881e7f1368031b33bb9_icgraph" id="group__Cache__storage_gaa8317a8938235881e7f1368031b33bb9_icgraph">
<area shape="rect" id="node2" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="192,5,383,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga9b9cd90883d10b4e8f021c0cc371a823"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a> cache_generate_key_default </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapr__pool__t.html">apr_pool_t</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;{</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">/* In early processing (quick-handler, forward proxy), we want the initial</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">     * query-string from r-&gt;parsed_uri, since any change before CACHE_SAVE</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">     * shouldn&#39;t modify the key. Otherwise we want the actual query-string.</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__APACHE__CORE__CONFIG.html#gab559cff0ba49c0f92a0dc777d5730496">path</a> = r-&gt;<a class="code" href="structrequest__rec.html#aee240e90eac55c732891e9408543990b">uri</a>;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__APR__Util__DBD.html#ga1086b66aba6ed16e6853a4cef784f8f6">query</a> = r-&gt;<a class="code" href="structrequest__rec.html#ad05e275008cdfe1865e02e8774541611">args</a>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Cache__util.html#gaea2f7fee82fd07fce89934bee0939987">cache_use_early_url</a>(r)) {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        path = r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>.<a class="code" href="structapr__uri__t.html#a61cff1baadb3c1b52a34b502c25bba7f">path</a>;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        query = r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>.<a class="code" href="structapr__uri__t.html#a88d889bcda9e95696022f04ffb470678">query</a>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">return</span> cache_canonicalise_key(r, p, path, query, &amp;r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>, <a class="code" href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a>);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;}</div><div class="ttc" id="structrequest__rec_html_a778f7883e201095a1d914ab7422635eb"><div class="ttname"><a href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">request_rec::parsed_uri</a></div><div class="ttdeci">apr_uri_t parsed_uri</div><div class="ttdef"><b>Definition:</b> httpd.h:1038</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_gab559cff0ba49c0f92a0dc777d5730496"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#gab559cff0ba49c0f92a0dc777d5730496">path</a></div><div class="ttdeci">request_rec int int apr_table_t const char * path</div><div class="ttdef"><b>Definition:</b> http_config.h:1123</div></div>
<div class="ttc" id="structapr__uri__t_html_a88d889bcda9e95696022f04ffb470678"><div class="ttname"><a href="structapr__uri__t.html#a88d889bcda9e95696022f04ffb470678">apr_uri_t::query</a></div><div class="ttdeci">char * query</div><div class="ttdef"><b>Definition:</b> apr_uri.h:101</div></div>
<div class="ttc" id="structrequest__rec_html_ad05e275008cdfe1865e02e8774541611"><div class="ttname"><a href="structrequest__rec.html#ad05e275008cdfe1865e02e8774541611">request_rec::args</a></div><div class="ttdeci">char * args</div><div class="ttdef"><b>Definition:</b> ap.d:54</div></div>
<div class="ttc" id="group__APR__Util__DBD_html_ga1086b66aba6ed16e6853a4cef784f8f6"><div class="ttname"><a href="group__APR__Util__DBD.html#ga1086b66aba6ed16e6853a4cef784f8f6">query</a></div><div class="ttdeci">apr_pool_t apr_dbd_t const char * query</div><div class="ttdef"><b>Definition:</b> apr_dbd.h:395</div></div>
<div class="ttc" id="structapr__uri__t_html_a61cff1baadb3c1b52a34b502c25bba7f"><div class="ttname"><a href="structapr__uri__t.html#a61cff1baadb3c1b52a34b502c25bba7f">apr_uri_t::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> apr_uri.h:99</div></div>
<div class="ttc" id="group__MOD__CACHE_html_ga11d8023381192746eb96be162398fe1c"><div class="ttname"><a href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a></div><div class="ttdeci">request_rec apr_pool_t const char ** key</div><div class="ttdef"><b>Definition:</b> mod_cache.h:187</div></div>
<div class="ttc" id="structrequest__rec_html_aee240e90eac55c732891e9408543990b"><div class="ttname"><a href="structrequest__rec.html#aee240e90eac55c732891e9408543990b">request_rec::uri</a></div><div class="ttdeci">char * uri</div><div class="ttdef"><b>Definition:</b> ap.d:50</div></div>
<div class="ttc" id="group__Cache__util_html_gaea2f7fee82fd07fce89934bee0939987"><div class="ttname"><a href="group__Cache__util.html#gaea2f7fee82fd07fce89934bee0939987">cache_use_early_url</a></div><div class="ttdeci">int cache_use_early_url(request_rec *r)</div><div class="ttdef"><b>Definition:</b> cache_util.c:130</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__storage_ga9b9cd90883d10b4e8f021c0cc371a823_cgraph.png" border="0" usemap="#group__Cache__storage_ga9b9cd90883d10b4e8f021c0cc371a823_cgraph" alt=""/></div>
<map name="group__Cache__storage_ga9b9cd90883d10b4e8f021c0cc371a823_cgraph" id="group__Cache__storage_ga9b9cd90883d10b4e8f021c0cc371a823_cgraph">
<area shape="rect" id="node2" href="group__Cache__util.html#gaea2f7fee82fd07fce89934bee0939987" title="cache_use_early_url" alt="" coords="196,13,337,39"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__storage_ga9b9cd90883d10b4e8f021c0cc371a823_icgraph.png" border="0" usemap="#group__Cache__storage_ga9b9cd90883d10b4e8f021c0cc371a823_icgraph" alt=""/></div>
<map name="group__Cache__storage_ga9b9cd90883d10b4e8f021c0cc371a823_icgraph" id="group__Cache__storage_ga9b9cd90883d10b4e8f021c0cc371a823_icgraph">
<area shape="rect" id="node2" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="196,13,387,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga8579a258895a1e158ebe9e61deb15d9a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> cache_invalidate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__request__rec.html">cache_request_rec</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>invalidate a specific URL entity in all caches</p>
<p>All cached entities for this URL are removed, usually in response to a POST/PUT or DELETE.</p>
<p>This function returns OK if at least one entity was found and removed, and DECLINED if no cached entities were removed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td><a class="el" href="structcache__request__rec.html">cache_request_rec</a> </td></tr>
    <tr><td class="paramname">r</td><td><a class="el" href="structrequest__rec.html" title="A structure that represents the current request. ">request_rec</a> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;{</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="structcache__provider__list.html">cache_provider_list</a> *<a class="code" href="group__APACHE__CORE__PROTO.html#gaeb6b944e4524f915483b5696b7f2f424">list</a>;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a> rv, <a class="code" href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a> = <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="structcache__handle.html">cache_handle_t</a> *<a class="code" href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="structapr__uri__t.html">apr_uri_t</a> location_uri;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <a class="code" href="structapr__uri__t.html">apr_uri_t</a> content_location_uri;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="pcre_8txt.html#ab5ae715589dddf66b4d1eeb056186268">location</a>, *location_key = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *content_location, *content_location_key = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">if</span> (!cache) {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="comment">/* This should never happen */</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga57ad94ed8c92c4306de90479251a5d58">APLOG_ERR</a>, <a class="code" href="group__APR__Error.html#ga18f5678bea0c2c704a2b6a186c9e158b">APR_EGENERAL</a>, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00697) <span class="stringliteral">&quot;cache: No cache request information available for key&quot;</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="stringliteral">&quot; generation&quot;</span>);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>) {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        rv = cache_generate_key(r, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, &amp;cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">if</span> (rv != <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>) {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    location = apr_table_get(r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>, <span class="stringliteral">&quot;Location&quot;</span>);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">if</span> (location) {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">if</span> (apr_uri_parse(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, location, &amp;location_uri)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                || cache_canonicalise_key(r, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>,</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                          location_uri.<a class="code" href="structapr__uri__t.html#a61cff1baadb3c1b52a34b502c25bba7f">path</a>,</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                          location_uri.<a class="code" href="structapr__uri__t.html#a88d889bcda9e95696022f04ffb470678">query</a>,</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                          &amp;location_uri, &amp;location_key)</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                || !(r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>.<a class="code" href="structapr__uri__t.html#a8c6bf3dfca3d159f091377d9f7228aec">hostname</a></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                     &amp;&amp; location_uri.<a class="code" href="structapr__uri__t.html#a8c6bf3dfca3d159f091377d9f7228aec">hostname</a></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                     &amp;&amp; !strcmp(r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>.<a class="code" href="structapr__uri__t.html#a8c6bf3dfca3d159f091377d9f7228aec">hostname</a>,</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                                location_uri.<a class="code" href="structapr__uri__t.html#a8c6bf3dfca3d159f091377d9f7228aec">hostname</a>))) {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            location_key = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        }</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    content_location = apr_table_get(r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>, <span class="stringliteral">&quot;Content-Location&quot;</span>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">if</span> (content_location) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">if</span> (apr_uri_parse(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, content_location,</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                          &amp;content_location_uri)</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                || cache_canonicalise_key(r, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>,</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                                          content_location_uri.<a class="code" href="structapr__uri__t.html#a61cff1baadb3c1b52a34b502c25bba7f">path</a>,</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                                          content_location_uri.<a class="code" href="structapr__uri__t.html#a88d889bcda9e95696022f04ffb470678">query</a>,</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                                          &amp;content_location_uri,</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                                          &amp;content_location_key)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                || !(r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>.<a class="code" href="structapr__uri__t.html#a8c6bf3dfca3d159f091377d9f7228aec">hostname</a></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                     &amp;&amp; content_location_uri.<a class="code" href="structapr__uri__t.html#a8c6bf3dfca3d159f091377d9f7228aec">hostname</a></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                     &amp;&amp; !strcmp(r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>.<a class="code" href="structapr__uri__t.html#a8c6bf3dfca3d159f091377d9f7228aec">hostname</a>,</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                                content_location_uri.<a class="code" href="structapr__uri__t.html#a8c6bf3dfca3d159f091377d9f7228aec">hostname</a>))) {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            content_location_key = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">/* go through the cache types */</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    h = apr_palloc(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, <span class="keyword">sizeof</span>(<a class="code" href="structcache__handle.html">cache_handle_t</a>));</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    list = cache-&gt;<a class="code" href="structcache__request__rec.html#afeb71f387482c679d90de359869b8e10">providers</a>;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    </div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keyword">struct </span>timespec <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>, finish;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">double</span> elapsed = 0;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="group__APR__MD5.html#ga16ff2d8e15ade4948398b0aeb80124a8">count</a> = 0;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">while</span> (list) {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="comment">/* invalidate the request uri */</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    clock_gettime(CLOCK_MONOTONIC, &amp;<a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        rv = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>-&gt;<a class="code" href="structcache__provider.html#ac99f3fba4c7e207f7a121443f16afe18">open_entity</a>(h, r, cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    clock_gettime(CLOCK_MONOTONIC, &amp;finish);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    elapsed += (finish.tv_nsec - <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>.tv_nsec) / 500000000.0;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    count++;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        </div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a> == rv) {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            rv = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>-&gt;<a class="code" href="structcache__provider.html#a77d0de369d305c7bf1886a95518a7b39">invalidate_entity</a>(h, r);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            status = <a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                <a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, rv, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(02468) <span class="stringliteral">&quot;cache: Attempted to invalidate cached entity with key: %s&quot;</span>, cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="comment">/* invalidate the Location */</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">if</span> (location_key) {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        clock_gettime(CLOCK_MONOTONIC, &amp;<a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            rv = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>-&gt;<a class="code" href="structcache__provider.html#ac99f3fba4c7e207f7a121443f16afe18">open_entity</a>(h, r, location_key);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        clock_gettime(CLOCK_MONOTONIC, &amp;finish);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        elapsed += (finish.tv_nsec - <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>.tv_nsec) / 500000000.0;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        count++;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a> == rv) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                rv = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>-&gt;<a class="code" href="structcache__provider.html#a77d0de369d305c7bf1886a95518a7b39">invalidate_entity</a>(h, r);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                status = <a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a>;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    <a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, rv, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(02469) <span class="stringliteral">&quot;cache: Attempted to invalidate cached entity with key: %s&quot;</span>, location_key);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="comment">/* invalidate the Content-Location */</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordflow">if</span> (content_location_key) {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        clock_gettime(CLOCK_MONOTONIC, &amp;<a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            rv = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>-&gt;<a class="code" href="structcache__provider.html#ac99f3fba4c7e207f7a121443f16afe18">open_entity</a>(h, r, content_location_key);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        clock_gettime(CLOCK_MONOTONIC, &amp;finish);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        elapsed += (finish.tv_nsec - <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>.tv_nsec) / 500000000.0;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        count++;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a> == rv) {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                rv = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>-&gt;<a class="code" href="structcache__provider.html#a77d0de369d305c7bf1886a95518a7b39">invalidate_entity</a>(h, r);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                status = <a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a>;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            }</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                    <a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, rv, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(02470) <span class="stringliteral">&quot;cache: Attempted to invalidate cached entity with key: %s&quot;</span>, content_location_key);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        list = list-&gt;<a class="code" href="structcache__provider__list.html#a87c07afc8bb63fe7fd2e9274e60341a9">next</a>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">if</span> (count != 0) {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    elapsed /= <a class="code" href="group__APR__MD5.html#ga16ff2d8e15ade4948398b0aeb80124a8">count</a>;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="group__APACHE__CORE__LOG.html#ga5e6676c87418af7a1d323a116c78ecb4">ap_log_error</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga9f0686ea770c44e205d1c12be74fc21f">APLOG_CRIT</a>, 0, r -&gt; <a class="code" href="group__APACHE__CORE__MUTEX.html#ga32727ee32089d3426d1d6a7280d28228">server</a>, <span class="stringliteral">&quot;%lf OPEN_ENTITY_2&quot;</span>, elapsed); </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a>;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;}</div><div class="ttc" id="structrequest__rec_html_a778f7883e201095a1d914ab7422635eb"><div class="ttname"><a href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">request_rec::parsed_uri</a></div><div class="ttdeci">apr_uri_t parsed_uri</div><div class="ttdef"><b>Definition:</b> httpd.h:1038</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga655e126996849bcb82e4e5a14c616f4a"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a></div><div class="ttdeci">#define APLOG_MARK</div><div class="ttdef"><b>Definition:</b> http_log.h:283</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga57ad94ed8c92c4306de90479251a5d58"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga57ad94ed8c92c4306de90479251a5d58">APLOG_ERR</a></div><div class="ttdeci">#define APLOG_ERR</div><div class="ttdef"><b>Definition:</b> http_log.h:46</div></div>
<div class="ttc" id="structcache__request__rec_html_afeb71f387482c679d90de359869b8e10"><div class="ttname"><a href="structcache__request__rec.html#afeb71f387482c679d90de359869b8e10">cache_request_rec::providers</a></div><div class="ttdeci">cache_provider_list * providers</div><div class="ttdef"><b>Definition:</b> cache_util.h:211</div></div>
<div class="ttc" id="group__APACHE__CORE__HTTPD_html_ga6e27f49150e9a14580fb313cc2777e00"><div class="ttname"><a href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> http_core.h:277</div></div>
<div class="ttc" id="group__APR__Error_html_ga18f5678bea0c2c704a2b6a186c9e158b"><div class="ttname"><a href="group__APR__Error.html#ga18f5678bea0c2c704a2b6a186c9e158b">APR_EGENERAL</a></div><div class="ttdeci">#define APR_EGENERAL</div><div class="ttdef"><b>Definition:</b> apr_errno.h:313</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_gadfcef90537539cf2b7d35cfbbbafeb93"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a></div><div class="ttdeci">#define APLOG_DEBUG</div><div class="ttdef"><b>Definition:</b> http_log.h:50</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="group__apr__errno_html_gaa5105fa83cc322f09382292db8b47593"><div class="ttname"><a href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a></div><div class="ttdeci">int apr_status_t</div><div class="ttdef"><b>Definition:</b> apr_errno.h:44</div></div>
<div class="ttc" id="structrequest__rec_html_a0fd560d8d1118304dc33df8ee99efc04"><div class="ttname"><a href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">request_rec::headers_out</a></div><div class="ttdeci">uintptr_t headers_out</div><div class="ttdef"><b>Definition:</b> ap.d:36</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga5e6676c87418af7a1d323a116c78ecb4"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga5e6676c87418af7a1d323a116c78ecb4">ap_log_error</a></div><div class="ttdeci">#define ap_log_error</div><div class="ttdef"><b>Definition:</b> http_log.h:370</div></div>
<div class="ttc" id="structcache__provider__list_html"><div class="ttname"><a href="structcache__provider__list.html">cache_provider_list</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:203</div></div>
<div class="ttc" id="structapr__uri__t_html_a88d889bcda9e95696022f04ffb470678"><div class="ttname"><a href="structapr__uri__t.html#a88d889bcda9e95696022f04ffb470678">apr_uri_t::query</a></div><div class="ttdeci">char * query</div><div class="ttdef"><b>Definition:</b> apr_uri.h:101</div></div>
<div class="ttc" id="group__APACHE__CORE__PROTO_html_gaeb6b944e4524f915483b5696b7f2f424"><div class="ttname"><a href="group__APACHE__CORE__PROTO.html#gaeb6b944e4524f915483b5696b7f2f424">list</a></div><div class="ttdeci">const char apr_pool_t apr_bucket_alloc_t * list</div><div class="ttdef"><b>Definition:</b> http_protocol.h:985</div></div>
<div class="ttc" id="structcache__provider_html_a77d0de369d305c7bf1886a95518a7b39"><div class="ttname"><a href="structcache__provider.html#a77d0de369d305c7bf1886a95518a7b39">cache_provider::invalidate_entity</a></div><div class="ttdeci">apr_status_t(* invalidate_entity)(cache_handle_t *h, request_rec *r)</div><div class="ttdef"><b>Definition:</b> mod_cache.h:112</div></div>
<div class="ttc" id="pcre_8txt_html_ab5ae715589dddf66b4d1eeb056186268"><div class="ttname"><a href="pcre_8txt.html#ab5ae715589dddf66b4d1eeb056186268">location</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory location</div><div class="ttdef"><b>Definition:</b> pcre.txt:2052</div></div>
<div class="ttc" id="structcache__provider_html_ac99f3fba4c7e207f7a121443f16afe18"><div class="ttname"><a href="structcache__provider.html#ac99f3fba4c7e207f7a121443f16afe18">cache_provider::open_entity</a></div><div class="ttdeci">int(* open_entity)(cache_handle_t *h, request_rec *r, const char *urlkey)</div><div class="ttdef"><b>Definition:</b> mod_cache.h:108</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga9eba11ca86461a3ae319311d64682dda"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a></div><div class="ttdeci">#define DECLINED</div><div class="ttdef"><b>Definition:</b> httpd.h:456</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_gaba51915c87d64af47fb1cc59348961c9"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a></div><div class="ttdeci">#define OK</div><div class="ttdef"><b>Definition:</b> httpd.h:455</div></div>
<div class="ttc" id="structcache__provider__list_html_a1e1caa5b70698f255962728326dc1be3"><div class="ttname"><a href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">cache_provider_list::provider</a></div><div class="ttdeci">const cache_provider * provider</div><div class="ttdef"><b>Definition:</b> cache_util.h:205</div></div>
<div class="ttc" id="structcache__provider__list_html_a87c07afc8bb63fe7fd2e9274e60341a9"><div class="ttname"><a href="structcache__provider__list.html#a87c07afc8bb63fe7fd2e9274e60341a9">cache_provider_list::next</a></div><div class="ttdeci">cache_provider_list * next</div><div class="ttdef"><b>Definition:</b> cache_util.h:206</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga4c112558ccffd6b363da102b2052d2a6"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a></div><div class="ttdeci">#define ap_log_rerror</div><div class="ttdef"><b>Definition:</b> http_log.h:454</div></div>
<div class="ttc" id="structcache__request__rec_html_a564726b5f7e5dc4fee2fb01d178677b4"><div class="ttname"><a href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">cache_request_rec::key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> cache_util.h:227</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga9f0686ea770c44e205d1c12be74fc21f"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga9f0686ea770c44e205d1c12be74fc21f">APLOG_CRIT</a></div><div class="ttdeci">#define APLOG_CRIT</div><div class="ttdef"><b>Definition:</b> http_log.h:45</div></div>
<div class="ttc" id="structcache__handle_html"><div class="ttname"><a href="structcache__handle.html">cache_handle</a></div><div class="ttdef"><b>Definition:</b> mod_cache.h:91</div></div>
<div class="ttc" id="structapr__uri__t_html"><div class="ttname"><a href="structapr__uri__t.html">apr_uri_t</a></div><div class="ttdef"><b>Definition:</b> apr_uri.h:85</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga6d3a995932cd00f6b3473898aa90d596"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a></div><div class="ttdeci">const char int start</div><div class="ttdef"><b>Definition:</b> httpd.h:2357</div></div>
<div class="ttc" id="structapr__uri__t_html_a61cff1baadb3c1b52a34b502c25bba7f"><div class="ttname"><a href="structapr__uri__t.html#a61cff1baadb3c1b52a34b502c25bba7f">apr_uri_t::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> apr_uri.h:99</div></div>
<div class="ttc" id="structapr__uri__t_html_a8c6bf3dfca3d159f091377d9f7228aec"><div class="ttname"><a href="structapr__uri__t.html#a8c6bf3dfca3d159f091377d9f7228aec">apr_uri_t::hostname</a></div><div class="ttdeci">char * hostname</div><div class="ttdef"><b>Definition:</b> apr_uri.h:95</div></div>
<div class="ttc" id="group__apr__hash_html_ga0d6dcb41ca5e794b318df5f6fd273ee2"><div class="ttname"><a href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a></div><div class="ttdeci">const apr_hash_t * h</div><div class="ttdef"><b>Definition:</b> apr_hash.h:97</div></div>
<div class="ttc" id="group__APR__MD5_html_ga16ff2d8e15ade4948398b0aeb80124a8"><div class="ttname"><a href="group__APR__MD5.html#ga16ff2d8e15ade4948398b0aeb80124a8">count</a></div><div class="ttdeci">unsigned int count</div><div class="ttdef"><b>Definition:</b> apr_md5.h:152</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
<div class="ttc" id="group__apr__errno_html_ga9ee311b7bf1c691dc521d721339ee2a6"><div class="ttname"><a href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a></div><div class="ttdeci">#define APR_SUCCESS</div><div class="ttdef"><b>Definition:</b> apr_errno.h:225</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga1dee8a07e06bc5b3de8b89662c2cd666"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a></div><div class="ttdeci">#define APLOGNO(n)</div><div class="ttdef"><b>Definition:</b> http_log.h:117</div></div>
<div class="ttc" id="group__APACHE__CORE__MUTEX_html_ga32727ee32089d3426d1d6a7280d28228"><div class="ttname"><a href="group__APACHE__CORE__MUTEX.html#ga32727ee32089d3426d1d6a7280d28228">server</a></div><div class="ttdeci">const char const char const char server_rec * server</div><div class="ttdef"><b>Definition:</b> util_mutex.h:182</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__storage_ga8579a258895a1e158ebe9e61deb15d9a_icgraph.png" border="0" usemap="#group__Cache__storage_ga8579a258895a1e158ebe9e61deb15d9a_icgraph" alt=""/></div>
<map name="group__Cache__storage_ga8579a258895a1e158ebe9e61deb15d9a_icgraph" id="group__Cache__storage_ga8579a258895a1e158ebe9e61deb15d9a_icgraph">
<area shape="rect" id="node2" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="172,5,363,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga099a01e4f8a6d68cc94a47adde527489"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> cache_remove_url </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__request__rec.html">cache_request_rec</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>cache_storage.c </p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__storage_ga099a01e4f8a6d68cc94a47adde527489_icgraph.png" border="0" usemap="#group__Cache__storage_ga099a01e4f8a6d68cc94a47adde527489_icgraph" alt=""/></div>
<map name="group__Cache__storage_ga099a01e4f8a6d68cc94a47adde527489_icgraph" id="group__Cache__storage_ga099a01e4f8a6d68cc94a47adde527489_icgraph">
<area shape="rect" id="node2" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="181,5,372,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaffb29f2e1276bc7d81bac540a1cf3e06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> cache_select </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__request__rec.html">cache_request_rec</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;{</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="structcache__provider__list.html">cache_provider_list</a> *<a class="code" href="group__APACHE__CORE__PROTO.html#gaeb6b944e4524f915483b5696b7f2f424">list</a>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a> rv;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="structcache__handle.html">cache_handle_t</a> *<a class="code" href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (!cache) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="comment">/* This should never happen */</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga57ad94ed8c92c4306de90479251a5d58">APLOG_ERR</a>, <a class="code" href="group__APR__Error.html#ga18f5678bea0c2c704a2b6a186c9e158b">APR_EGENERAL</a>, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00693)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="stringliteral">&quot;cache: No cache request information available for key&quot;</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="stringliteral">&quot; generation&quot;</span>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">/* if no-cache, we can&#39;t serve from the cache, but we may store to the</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">     * cache.</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__Cache__util.html#ga565962a760117aaaed7e13445f79e831">ap_cache_check_no_cache</a>(cache, r)) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        rv = cache_generate_key(r, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, &amp;cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">if</span> (rv != <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">/* go through the cache types till we get a match */</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    h = apr_palloc(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, <span class="keyword">sizeof</span>(<a class="code" href="structcache__handle.html">cache_handle_t</a>));</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    list = cache-&gt;<a class="code" href="structcache__request__rec.html#afeb71f387482c679d90de359869b8e10">providers</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keyword">struct </span>timespec <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>, finish;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">double</span> elapsed = 0;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="group__APR__MD5.html#ga16ff2d8e15ade4948398b0aeb80124a8">count</a> = 0;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">while</span> (list) {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    </div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    clock_gettime(CLOCK_MONOTONIC, &amp;<a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">switch</span> ((rv = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>-&gt;<a class="code" href="structcache__provider.html#ac99f3fba4c7e207f7a121443f16afe18">open_entity</a>(h, r, cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>))) {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a>: {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        clock_gettime(CLOCK_MONOTONIC, &amp;finish);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        elapsed += (finish.tv_nsec - <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a>.tv_nsec) / 500000000.0;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        count++;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordtype">char</span> *vary = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordtype">int</span> mismatch = 0;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordtype">char</span> *<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a> = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">if</span> (list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>-&gt;<a class="code" href="structcache__provider.html#a1ebbc419cb9f93c27620e0fe993dbd18">recall_headers</a>(h, r) != <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="comment">/* try again with next cache type */</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                list = list-&gt;<a class="code" href="structcache__provider__list.html#a87c07afc8bb63fe7fd2e9274e60341a9">next</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">             * Check Content-Negotiation - Vary</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">             *</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">             * At this point we need to make sure that the object we found in</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">             * the cache is the same object that would be delivered to the</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">             * client, when the effects of content negotiation are taken into</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">             * effect.</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">             *</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">             * In plain english, we want to make sure that a language-negotiated</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">             * document in one language is not given to a client asking for a</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">             * language negotiated document in a different language by mistake.</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">             *</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">             * This code makes the assumption that the storage manager will</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">             * cache the req_hdrs if the response contains a Vary</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">             * header.</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">             *</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">             * RFC2616 13.6 and 14.44 describe the Vary mechanism.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            vary = <a class="code" href="group__Cache__util.html#gada03570414af2b2d9349449858036d90">cache_strqtok</a>(</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    apr_pstrdup(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                            <a class="code" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a>(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Vary&quot;</span>)),</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                    <a class="code" href="group__Cache__util.html#ga2916636af38fdf277cb80c1c698c291a">CACHE_SEPARATOR</a>, &amp;last);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">while</span> (vary) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__apr__hash.html#ga7424aa17231f37fcf2350b861ca9b549">h1</a>, *<a class="code" href="group__apr__hash.html#gaebeb34ebcc8806faa82df3123f4423cf">h2</a>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">                 * is this header in the request and the header in the cached</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">                 * request identical? If not, we give up and do a straight get</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                h1 = <a class="code" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a>(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, vary);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                h2 = <a class="code" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a>(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, h-&gt;<a class="code" href="structcache__handle.html#a3d302af4d74f9067d16e6398f0b709ae">req_hdrs</a>, vary);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="keywordflow">if</span> (h1 == h2) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <span class="comment">/* both headers NULL, so a match - do nothing */</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (h1 &amp;&amp; h2 &amp;&amp; !strcmp(h1, h2)) {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    <span class="comment">/* both headers exist and are equal - do nothing */</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    <span class="comment">/* headers do not match, so Vary failed */</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                            r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00694) <span class="stringliteral">&quot;cache_select(): Vary header mismatch.&quot;</span>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    mismatch = 1;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                vary = <a class="code" href="group__Cache__util.html#gada03570414af2b2d9349449858036d90">cache_strqtok</a>(<a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>, <a class="code" href="group__Cache__util.html#ga2916636af38fdf277cb80c1c698c291a">CACHE_SEPARATOR</a>, &amp;last);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="comment">/* no vary match, try next provider */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">if</span> (mismatch) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="comment">/* try again with next cache type */</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                list = list-&gt;<a class="code" href="structcache__provider__list.html#a87c07afc8bb63fe7fd2e9274e60341a9">next</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            cache-&gt;<a class="code" href="structcache__request__rec.html#aa97c7f2b0167adee182cce9f2c66b0eb">provider</a> = list-&gt;<a class="code" href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">provider</a>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            cache-&gt;<a class="code" href="structcache__request__rec.html#ad15b24a12858815a315f37152111b41d">provider_name</a> = list-&gt;<a class="code" href="structcache__provider__list.html#a0bd2adbaa02f1aa6af1971fd24b09b6a">provider_name</a>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">             * RFC2616 13.3.4 Rules for When to Use Entity Tags and Last-Modified</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">             * Dates: An HTTP/1.1 caching proxy, upon receiving a conditional request</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">             * that includes both a Last-Modified date and one or more entity tags as</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">             * cache validators, MUST NOT return a locally cached response to the</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">             * client unless that cached response is consistent with all of the</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">             * conditional header fields in the request.</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">if</span> (ap_condition_if_match(r, h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>) == <a class="code" href="group__APACHE__CORE__PROTO.html#gga0c22f044612f116fb81886e73bbce80baa8fec426bc27e2c7c079f92975cc24f9">AP_CONDITION_NOMATCH</a></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    || ap_condition_if_unmodified_since(r, h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                            == <a class="code" href="group__APACHE__CORE__PROTO.html#gga0c22f044612f116fb81886e73bbce80baa8fec426bc27e2c7c079f92975cc24f9">AP_CONDITION_NOMATCH</a></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    || ap_condition_if_none_match(r, h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                            == <a class="code" href="group__APACHE__CORE__PROTO.html#gga0c22f044612f116fb81886e73bbce80baa8fec426bc27e2c7c079f92975cc24f9">AP_CONDITION_NOMATCH</a></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    || ap_condition_if_modified_since(r, h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                            == <a class="code" href="group__APACHE__CORE__PROTO.html#gga0c22f044612f116fb81886e73bbce80baa8fec426bc27e2c7c079f92975cc24f9">AP_CONDITION_NOMATCH</a></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    || ap_condition_if_range(r, h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>) == <a class="code" href="group__APACHE__CORE__PROTO.html#gga0c22f044612f116fb81886e73bbce80baa8fec426bc27e2c7c079f92975cc24f9">AP_CONDITION_NOMATCH</a>) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                mismatch = 1;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="comment">/* Is our cached response fresh enough? */</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">if</span> (mismatch || !<a class="code" href="group__Cache__util.html#ga8719ff14e3ad87c32614da9fc10cb119">cache_check_freshness</a>(h, cache, r)) {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *etag, *lastmod;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="comment">/* Cache-Control: only-if-cached and revalidation required, try</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">                 * the next provider</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.<a class="code" href="structcache__control.html#aeca404f2dd16548ae4fbde3592602764">only_if_cached</a>) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    <span class="comment">/* try again with next cache type */</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    list = list-&gt;<a class="code" href="structcache__provider__list.html#a87c07afc8bb63fe7fd2e9274e60341a9">next</a>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="comment">/* set aside the stale entry for accessing later */</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                cache-&gt;<a class="code" href="structcache__request__rec.html#a7bdf3605a965ddd6b566babb830bde8b">stale_headers</a> = apr_table_copy(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                        r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                cache-&gt;<a class="code" href="structcache__request__rec.html#a17c5946aa60de5806a2af38ef7b91507">stale_handle</a> = <a class="code" href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="comment">/* if no existing conditionals, use conditionals of our own */</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <span class="keywordflow">if</span> (!mismatch) {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                            <a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00695) <span class="stringliteral">&quot;Cached response for %s isn&#39;t fresh. Adding &quot;</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                            <span class="stringliteral">&quot;conditional request headers.&quot;</span>, r-&gt;<a class="code" href="structrequest__rec.html#aee240e90eac55c732891e9408543990b">uri</a>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="comment">/* Remove existing conditionals that might conflict with ours */</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    apr_table_unset(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;If-Match&quot;</span>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    apr_table_unset(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;If-Modified-Since&quot;</span>);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    apr_table_unset(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;If-None-Match&quot;</span>);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    apr_table_unset(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;If-Range&quot;</span>);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    apr_table_unset(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;If-Unmodified-Since&quot;</span>);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    etag = apr_table_get(h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;ETag&quot;</span>);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    lastmod = apr_table_get(h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Last-Modified&quot;</span>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    <span class="keywordflow">if</span> (etag || lastmod) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        <span class="comment">/* If we have a cached etag and/or Last-Modified add in</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">                         * our own conditionals.</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">                         */</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        <span class="keywordflow">if</span> (etag) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                            apr_table_set(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;If-None-Match&quot;</span>, etag);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                        <span class="keywordflow">if</span> (lastmod) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                            apr_table_set(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;If-Modified-Since&quot;</span>,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                    lastmod);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        <span class="comment">/*</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">                         * Do not do Range requests with our own conditionals: If</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">                         * we get 304 the Range does not matter and otherwise the</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">                         * entity changed and we want to have the complete entity</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">                         */</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        apr_table_unset(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;Range&quot;</span>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        </div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordflow">if</span> (count != 0) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            elapsed /= <a class="code" href="group__APR__MD5.html#ga16ff2d8e15ade4948398b0aeb80124a8">count</a>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <a class="code" href="group__APACHE__CORE__LOG.html#ga5e6676c87418af7a1d323a116c78ecb4">ap_log_error</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga9f0686ea770c44e205d1c12be74fc21f">APLOG_CRIT</a>, 0, r -&gt; <a class="code" href="group__APACHE__CORE__MUTEX.html#ga32727ee32089d3426d1d6a7280d28228">server</a>, <span class="stringliteral">&quot;%lf OPEN_ENTITY&quot;</span>, elapsed);   </div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;         }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="comment">/* ready to revalidate, pretend we were never here */</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="comment">/* Okay, this response looks okay.  Merge in our stuff and go. */</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <a class="code" href="group__Cache__storage.html#ga0b273ea1fdda33adc7ecf2e47e4a57a7">cache_accept_headers</a>(h, r, h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>, 0);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            cache-&gt;<a class="code" href="structcache__request__rec.html#ade71ff36fe9a713fd081fa45524151f1">handle</a> = <a class="code" href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        </div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordflow">if</span> (count != 0) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            elapsed /= <a class="code" href="group__APR__MD5.html#ga16ff2d8e15ade4948398b0aeb80124a8">count</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <a class="code" href="group__APACHE__CORE__LOG.html#ga5e6676c87418af7a1d323a116c78ecb4">ap_log_error</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga9f0686ea770c44e205d1c12be74fc21f">APLOG_CRIT</a>, 0, r -&gt; <a class="code" href="group__APACHE__CORE__MUTEX.html#ga32727ee32089d3426d1d6a7280d28228">server</a>, <span class="stringliteral">&quot;%lf OPEN_ENTITY&quot;</span>, elapsed);   </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>: {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="comment">/* try again with next cache type */</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            list = list-&gt;<a class="code" href="structcache__provider__list.html#a87c07afc8bb63fe7fd2e9274e60341a9">next</a>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">default</span>: {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="comment">/* oo-er! an error */</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">return</span> rv;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (count != 0) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    elapsed /= <a class="code" href="group__APR__MD5.html#ga16ff2d8e15ade4948398b0aeb80124a8">count</a>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="group__APACHE__CORE__LOG.html#ga5e6676c87418af7a1d323a116c78ecb4">ap_log_error</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga9f0686ea770c44e205d1c12be74fc21f">APLOG_CRIT</a>, 0, r -&gt; <a class="code" href="group__APACHE__CORE__MUTEX.html#ga32727ee32089d3426d1d6a7280d28228">server</a>, <span class="stringliteral">&quot;%lf OPEN_ENTITY&quot;</span>, elapsed);   </div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">/* if Cache-Control: only-if-cached, and not cached, return 504 */</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.<a class="code" href="structcache__control.html#aeca404f2dd16548ae4fbde3592602764">only_if_cached</a>) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00696)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="stringliteral">&quot;cache: &#39;only-if-cached&#39; requested and no cached entity, &quot;</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="stringliteral">&quot;returning 504 Gateway Timeout for: %s&quot;</span>, r-&gt;<a class="code" href="structrequest__rec.html#aee240e90eac55c732891e9408543990b">uri</a>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__HTTP__Status.html#gaaf973dd6df946c88224a4b761bb079fc">HTTP_GATEWAY_TIME_OUT</a>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div><div class="ttc" id="group__Cache__util_html_ga2916636af38fdf277cb80c1c698c291a"><div class="ttname"><a href="group__Cache__util.html#ga2916636af38fdf277cb80c1c698c291a">CACHE_SEPARATOR</a></div><div class="ttdeci">#define CACHE_SEPARATOR</div><div class="ttdef"><b>Definition:</b> cache_util.h:102</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga655e126996849bcb82e4e5a14c616f4a"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a></div><div class="ttdeci">#define APLOG_MARK</div><div class="ttdef"><b>Definition:</b> http_log.h:283</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga57ad94ed8c92c4306de90479251a5d58"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga57ad94ed8c92c4306de90479251a5d58">APLOG_ERR</a></div><div class="ttdeci">#define APLOG_ERR</div><div class="ttdef"><b>Definition:</b> http_log.h:46</div></div>
<div class="ttc" id="structcache__request__rec_html_afeb71f387482c679d90de359869b8e10"><div class="ttname"><a href="structcache__request__rec.html#afeb71f387482c679d90de359869b8e10">cache_request_rec::providers</a></div><div class="ttdeci">cache_provider_list * providers</div><div class="ttdef"><b>Definition:</b> cache_util.h:211</div></div>
<div class="ttc" id="structcache__request__rec_html_aaea78b272eb05f1ba67a75bd6264b4df"><div class="ttname"><a href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">cache_request_rec::control_in</a></div><div class="ttdeci">cache_control_t control_in</div><div class="ttdef"><b>Definition:</b> cache_util.h:232</div></div>
<div class="ttc" id="group__Cache__util_html_ga565962a760117aaaed7e13445f79e831"><div class="ttname"><a href="group__Cache__util.html#ga565962a760117aaaed7e13445f79e831">ap_cache_check_no_cache</a></div><div class="ttdeci">int ap_cache_check_no_cache(cache_request_rec *cache, request_rec *r)</div><div class="ttdef"><b>Definition:</b> cache_util.c:450</div></div>
<div class="ttc" id="group__apr__hash_html_ga7424aa17231f37fcf2350b861ca9b549"><div class="ttname"><a href="group__apr__hash.html#ga7424aa17231f37fcf2350b861ca9b549">h1</a></div><div class="ttdeci">const apr_hash_t * h1</div><div class="ttdef"><b>Definition:</b> apr_hash.h:232</div></div>
<div class="ttc" id="group__APR__Error_html_ga18f5678bea0c2c704a2b6a186c9e158b"><div class="ttname"><a href="group__APR__Error.html#ga18f5678bea0c2c704a2b6a186c9e158b">APR_EGENERAL</a></div><div class="ttdeci">#define APR_EGENERAL</div><div class="ttdef"><b>Definition:</b> apr_errno.h:313</div></div>
<div class="ttc" id="structcache__request__rec_html_ade71ff36fe9a713fd081fa45524151f1"><div class="ttname"><a href="structcache__request__rec.html#ade71ff36fe9a713fd081fa45524151f1">cache_request_rec::handle</a></div><div class="ttdeci">cache_handle_t * handle</div><div class="ttdef"><b>Definition:</b> cache_util.h:215</div></div>
<div class="ttc" id="group__Cache__util_html_ga46b2ea303b9ec2767a61d0f121835b43"><div class="ttname"><a href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a></div><div class="ttdeci">const char * cache_table_getm(apr_pool_t *p, const apr_table_t *t, const char *key)</div><div class="ttdef"><b>Definition:</b> cache_util.c:1324</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_gadfcef90537539cf2b7d35cfbbbafeb93"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a></div><div class="ttdeci">#define APLOG_DEBUG</div><div class="ttdef"><b>Definition:</b> http_log.h:50</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="group__APACHE__CORE__PROTO_html_gga0c22f044612f116fb81886e73bbce80baa8fec426bc27e2c7c079f92975cc24f9"><div class="ttname"><a href="group__APACHE__CORE__PROTO.html#gga0c22f044612f116fb81886e73bbce80baa8fec426bc27e2c7c079f92975cc24f9">AP_CONDITION_NOMATCH</a></div><div class="ttdef"><b>Definition:</b> http_protocol.h:172</div></div>
<div class="ttc" id="structcache__request__rec_html_a17c5946aa60de5806a2af38ef7b91507"><div class="ttname"><a href="structcache__request__rec.html#a17c5946aa60de5806a2af38ef7b91507">cache_request_rec::stale_handle</a></div><div class="ttdeci">cache_handle_t * stale_handle</div><div class="ttdef"><b>Definition:</b> cache_util.h:216</div></div>
<div class="ttc" id="group__apr__errno_html_gaa5105fa83cc322f09382292db8b47593"><div class="ttname"><a href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a></div><div class="ttdeci">int apr_status_t</div><div class="ttdef"><b>Definition:</b> apr_errno.h:44</div></div>
<div class="ttc" id="structrequest__rec_html_a0fd560d8d1118304dc33df8ee99efc04"><div class="ttname"><a href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">request_rec::headers_out</a></div><div class="ttdeci">uintptr_t headers_out</div><div class="ttdef"><b>Definition:</b> ap.d:36</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga5e6676c87418af7a1d323a116c78ecb4"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga5e6676c87418af7a1d323a116c78ecb4">ap_log_error</a></div><div class="ttdeci">#define ap_log_error</div><div class="ttdef"><b>Definition:</b> http_log.h:370</div></div>
<div class="ttc" id="structcache__provider__list_html"><div class="ttname"><a href="structcache__provider__list.html">cache_provider_list</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:203</div></div>
<div class="ttc" id="group__Cache__storage_html_ga0b273ea1fdda33adc7ecf2e47e4a57a7"><div class="ttname"><a href="group__Cache__storage.html#ga0b273ea1fdda33adc7ecf2e47e4a57a7">cache_accept_headers</a></div><div class="ttdeci">void cache_accept_headers(cache_handle_t *h, request_rec *r, apr_table_t *top, apr_table_t *bottom, int revalidation)</div><div class="ttdef"><b>Definition:</b> cache_storage.c:172</div></div>
<div class="ttc" id="structcache__control_html_aeca404f2dd16548ae4fbde3592602764"><div class="ttname"><a href="structcache__control.html#aeca404f2dd16548ae4fbde3592602764">cache_control::only_if_cached</a></div><div class="ttdeci">unsigned int only_if_cached</div><div class="ttdef"><b>Definition:</b> cache_common.h:41</div></div>
<div class="ttc" id="group__APACHE__CORE__PROTO_html_gaeb6b944e4524f915483b5696b7f2f424"><div class="ttname"><a href="group__APACHE__CORE__PROTO.html#gaeb6b944e4524f915483b5696b7f2f424">list</a></div><div class="ttdeci">const char apr_pool_t apr_bucket_alloc_t * list</div><div class="ttdef"><b>Definition:</b> http_protocol.h:985</div></div>
<div class="ttc" id="structcache__handle_html_a3d302af4d74f9067d16e6398f0b709ae"><div class="ttname"><a href="structcache__handle.html#a3d302af4d74f9067d16e6398f0b709ae">cache_handle::req_hdrs</a></div><div class="ttdeci">apr_table_t * req_hdrs</div><div class="ttdef"><b>Definition:</b> mod_cache.h:93</div></div>
<div class="ttc" id="structcache__provider__list_html_a0bd2adbaa02f1aa6af1971fd24b09b6a"><div class="ttname"><a href="structcache__provider__list.html#a0bd2adbaa02f1aa6af1971fd24b09b6a">cache_provider_list::provider_name</a></div><div class="ttdeci">const char * provider_name</div><div class="ttdef"><b>Definition:</b> cache_util.h:204</div></div>
<div class="ttc" id="structcache__request__rec_html_ad15b24a12858815a315f37152111b41d"><div class="ttname"><a href="structcache__request__rec.html#ad15b24a12858815a315f37152111b41d">cache_request_rec::provider_name</a></div><div class="ttdeci">const char * provider_name</div><div class="ttdef"><b>Definition:</b> cache_util.h:213</div></div>
<div class="ttc" id="structcache__provider_html_ac99f3fba4c7e207f7a121443f16afe18"><div class="ttname"><a href="structcache__provider.html#ac99f3fba4c7e207f7a121443f16afe18">cache_provider::open_entity</a></div><div class="ttdeci">int(* open_entity)(cache_handle_t *h, request_rec *r, const char *urlkey)</div><div class="ttdef"><b>Definition:</b> mod_cache.h:108</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga9eba11ca86461a3ae319311d64682dda"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga9eba11ca86461a3ae319311d64682dda">DECLINED</a></div><div class="ttdeci">#define DECLINED</div><div class="ttdef"><b>Definition:</b> httpd.h:456</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_gaba51915c87d64af47fb1cc59348961c9"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#gaba51915c87d64af47fb1cc59348961c9">OK</a></div><div class="ttdeci">#define OK</div><div class="ttdef"><b>Definition:</b> httpd.h:455</div></div>
<div class="ttc" id="structcache__provider__list_html_a1e1caa5b70698f255962728326dc1be3"><div class="ttname"><a href="structcache__provider__list.html#a1e1caa5b70698f255962728326dc1be3">cache_provider_list::provider</a></div><div class="ttdeci">const cache_provider * provider</div><div class="ttdef"><b>Definition:</b> cache_util.h:205</div></div>
<div class="ttc" id="structcache__provider__list_html_a87c07afc8bb63fe7fd2e9274e60341a9"><div class="ttname"><a href="structcache__provider__list.html#a87c07afc8bb63fe7fd2e9274e60341a9">cache_provider_list::next</a></div><div class="ttdeci">cache_provider_list * next</div><div class="ttdef"><b>Definition:</b> cache_util.h:206</div></div>
<div class="ttc" id="structcache__handle_html_a66c4c1875bb9740d34ddda4d3e71065e"><div class="ttname"><a href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">cache_handle::resp_hdrs</a></div><div class="ttdeci">apr_table_t * resp_hdrs</div><div class="ttdef"><b>Definition:</b> mod_cache.h:94</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga4c112558ccffd6b363da102b2052d2a6"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a></div><div class="ttdeci">#define ap_log_rerror</div><div class="ttdef"><b>Definition:</b> http_log.h:454</div></div>
<div class="ttc" id="structcache__request__rec_html_a564726b5f7e5dc4fee2fb01d178677b4"><div class="ttname"><a href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">cache_request_rec::key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> cache_util.h:227</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga9f0686ea770c44e205d1c12be74fc21f"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga9f0686ea770c44e205d1c12be74fc21f">APLOG_CRIT</a></div><div class="ttdeci">#define APLOG_CRIT</div><div class="ttdef"><b>Definition:</b> http_log.h:45</div></div>
<div class="ttc" id="group__Cache__util_html_gada03570414af2b2d9349449858036d90"><div class="ttname"><a href="group__Cache__util.html#gada03570414af2b2d9349449858036d90">cache_strqtok</a></div><div class="ttdeci">char * cache_strqtok(char *str, const char *sep, char **last)</div><div class="ttdef"><b>Definition:</b> cache_util.c:929</div></div>
<div class="ttc" id="structcache__handle_html"><div class="ttname"><a href="structcache__handle.html">cache_handle</a></div><div class="ttdef"><b>Definition:</b> mod_cache.h:91</div></div>
<div class="ttc" id="group__apr__hash_html_gaebeb34ebcc8806faa82df3123f4423cf"><div class="ttname"><a href="group__apr__hash.html#gaebeb34ebcc8806faa82df3123f4423cf">h2</a></div><div class="ttdeci">const apr_hash_t const apr_hash_t * h2</div><div class="ttdef"><b>Definition:</b> apr_hash.h:232</div></div>
<div class="ttc" id="structcache__provider_html_a1ebbc419cb9f93c27620e0fe993dbd18"><div class="ttname"><a href="structcache__provider.html#a1ebbc419cb9f93c27620e0fe993dbd18">cache_provider::recall_headers</a></div><div class="ttdeci">apr_status_t(* recall_headers)(cache_handle_t *h, request_rec *r)</div><div class="ttdef"><b>Definition:</b> mod_cache.h:104</div></div>
<div class="ttc" id="group__HTTP__Status_html_gaaf973dd6df946c88224a4b761bb079fc"><div class="ttname"><a href="group__HTTP__Status.html#gaaf973dd6df946c88224a4b761bb079fc">HTTP_GATEWAY_TIME_OUT</a></div><div class="ttdeci">#define HTTP_GATEWAY_TIME_OUT</div><div class="ttdef"><b>Definition:</b> httpd.h:541</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga6d3a995932cd00f6b3473898aa90d596"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga6d3a995932cd00f6b3473898aa90d596">start</a></div><div class="ttdeci">const char int start</div><div class="ttdef"><b>Definition:</b> httpd.h:2357</div></div>
<div class="ttc" id="structcache__request__rec_html_a7bdf3605a965ddd6b566babb830bde8b"><div class="ttname"><a href="structcache__request__rec.html#a7bdf3605a965ddd6b566babb830bde8b">cache_request_rec::stale_headers</a></div><div class="ttdeci">apr_table_t * stale_headers</div><div class="ttdef"><b>Definition:</b> cache_util.h:217</div></div>
<div class="ttc" id="group__apr__strings_html_ga882d08c2e3ad3004cdfc219601ebaac8"><div class="ttname"><a href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a></div><div class="ttdeci">const char char ** last</div><div class="ttdef"><b>Definition:</b> apr_strings.h:247</div></div>
<div class="ttc" id="group__Cache__util_html_ga8719ff14e3ad87c32614da9fc10cb119"><div class="ttname"><a href="group__Cache__util.html#ga8719ff14e3ad87c32614da9fc10cb119">cache_check_freshness</a></div><div class="ttdeci">int cache_check_freshness(cache_handle_t *h, cache_request_rec *cache, request_rec *r)</div><div class="ttdef"><b>Definition:</b> cache_util.c:533</div></div>
<div class="ttc" id="group__apr__hash_html_ga0d6dcb41ca5e794b318df5f6fd273ee2"><div class="ttname"><a href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a></div><div class="ttdeci">const apr_hash_t * h</div><div class="ttdef"><b>Definition:</b> apr_hash.h:97</div></div>
<div class="ttc" id="group__APR__MD5_html_ga16ff2d8e15ade4948398b0aeb80124a8"><div class="ttname"><a href="group__APR__MD5.html#ga16ff2d8e15ade4948398b0aeb80124a8">count</a></div><div class="ttdeci">unsigned int count</div><div class="ttdef"><b>Definition:</b> apr_md5.h:152</div></div>
<div class="ttc" id="structrequest__rec_html_aee240e90eac55c732891e9408543990b"><div class="ttname"><a href="structrequest__rec.html#aee240e90eac55c732891e9408543990b">request_rec::uri</a></div><div class="ttdeci">char * uri</div><div class="ttdef"><b>Definition:</b> ap.d:50</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
<div class="ttc" id="structrequest__rec_html_a5497da6c01af49acf70a4a9b975c1c83"><div class="ttname"><a href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">request_rec::headers_in</a></div><div class="ttdeci">uintptr_t headers_in</div><div class="ttdef"><b>Definition:</b> ap.d:35</div></div>
<div class="ttc" id="group__apr__errno_html_ga9ee311b7bf1c691dc521d721339ee2a6"><div class="ttname"><a href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a></div><div class="ttdeci">#define APR_SUCCESS</div><div class="ttdef"><b>Definition:</b> apr_errno.h:225</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga1dee8a07e06bc5b3de8b89662c2cd666"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a></div><div class="ttdeci">#define APLOGNO(n)</div><div class="ttdef"><b>Definition:</b> http_log.h:117</div></div>
<div class="ttc" id="group__APACHE__CORE__MUTEX_html_ga32727ee32089d3426d1d6a7280d28228"><div class="ttname"><a href="group__APACHE__CORE__MUTEX.html#ga32727ee32089d3426d1d6a7280d28228">server</a></div><div class="ttdeci">const char const char const char server_rec * server</div><div class="ttdef"><b>Definition:</b> util_mutex.h:182</div></div>
<div class="ttc" id="structcache__request__rec_html_aa97c7f2b0167adee182cce9f2c66b0eb"><div class="ttname"><a href="structcache__request__rec.html#aa97c7f2b0167adee182cce9f2c66b0eb">cache_request_rec::provider</a></div><div class="ttdeci">const cache_provider * provider</div><div class="ttdef"><b>Definition:</b> cache_util.h:212</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__storage_gaffb29f2e1276bc7d81bac540a1cf3e06_cgraph.png" border="0" usemap="#group__Cache__storage_gaffb29f2e1276bc7d81bac540a1cf3e06_cgraph" alt=""/></div>
<map name="group__Cache__storage_gaffb29f2e1276bc7d81bac540a1cf3e06_cgraph" id="group__Cache__storage_gaffb29f2e1276bc7d81bac540a1cf3e06_cgraph">
<area shape="rect" id="node2" href="group__Cache__util.html#ga565962a760117aaaed7e13445f79e831" title="ap_cache_check_no_cache" alt="" coords="152,56,335,83"/>
<area shape="rect" id="node3" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43" title="cache_table_getm" alt="" coords="383,5,511,32"/>
<area shape="rect" id="node6" href="group__Cache__util.html#gada03570414af2b2d9349449858036d90" title="cache_strqtok" alt="" coords="587,107,691,133"/>
<area shape="rect" id="node7" href="group__Cache__util.html#ga8719ff14e3ad87c32614da9fc10cb119" title="cache_check_freshness" alt="" coords="162,157,325,184"/>
<area shape="rect" id="node12" href="group__Cache__storage.html#ga0b273ea1fdda33adc7ecf2e47e4a57a7" title="cache_accept_headers" alt="" coords="165,208,321,235"/>
<area shape="rect" id="node4" href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b" title="ap_cache_control" alt="" coords="385,56,509,83"/>
<area shape="rect" id="node5" href="structcache__control.html#ab54624480acafa695556a98b70938413" title="cache_control::cache\l_control" alt="" coords="565,41,712,82"/>
<area shape="rect" id="node8" href="group__Cache__util.html#gaffa94dfea5098ffab89d1dc91e094415" title="cache_try_lock" alt="" coords="391,157,502,184"/>
<area shape="rect" id="node9" href="dir__make__recurse_8c.html#a6a3b2602f57ff148cd64096da02adbd2" title="apr_dir_make_recursive" alt="" coords="559,157,719,184"/>
<area shape="rect" id="node10" href="unix_2dir_8c.html#a51e0b4703c7561f72587982808985d29" title="apr_dir_make" alt="" coords="767,157,867,184"/>
<area shape="rect" id="node11" href="unix_2fileacc_8c.html#a6ff1e968d4350cb1184ec6ed57ac3902" title="apr_unix_perms2mode" alt="" coords="915,157,1068,184"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__storage_gaffb29f2e1276bc7d81bac540a1cf3e06_icgraph.png" border="0" usemap="#group__Cache__storage_gaffb29f2e1276bc7d81bac540a1cf3e06_icgraph" alt=""/></div>
<map name="group__Cache__storage_gaffb29f2e1276bc7d81bac540a1cf3e06_icgraph" id="group__Cache__storage_gaffb29f2e1276bc7d81bac540a1cf3e06_icgraph">
<area shape="rect" id="node2" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="152,5,343,32"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
