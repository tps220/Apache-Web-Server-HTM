<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>My Project: Cache Utility Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Cache Utility Functions<div class="ingroups"><a class="el" href="group__APACHE.html">Apache HTTP Server</a> &raquo; <a class="el" href="group__APACHE__MODS.html">Loadable modules</a> &raquo; <a class="el" href="group__MOD__CACHE.html">mod_cache</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Cache Utility Functions:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__Cache__util.png" border="0" alt="" usemap="#group____Cache____util"/>
<map name="group____Cache____util" id="group____Cache____util">
<area shape="rect" id="node2" href="group__MOD__CACHE.html" title="mod_cache" alt="" coords="5,5,95,32"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcache__enable.html">cache_enable</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcache__disable.html">cache_disable</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcache__server__conf.html">cache_server_conf</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcache__dir__conf.html">cache_dir_conf</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcache__provider__list.html">cache_provider_list</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcache__request__rec.html">cache_request_rec</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga88a4bf7f483aad3f3945773f3383e713"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga88a4bf7f483aad3f3945773f3383e713">APR_WANT_STRFUNC</a></td></tr>
<tr class="separator:ga88a4bf7f483aad3f3945773f3383e713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>,  <a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>)&#160;&#160;&#160;((<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>) &gt; (<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>) ? (<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>) : (<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>))</td></tr>
<tr class="separator:gafa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3acffbd305ee72dcd4593c0d8af64a4f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>,  <a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>)&#160;&#160;&#160;((<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>) &lt; (<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>) ? (<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>) : (<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>))</td></tr>
<tr class="separator:ga3acffbd305ee72dcd4593c0d8af64a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11c1c155b3b983d8a53ee6f62d054c5c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga11c1c155b3b983d8a53ee6f62d054c5c">MSEC_ONE_DAY</a>&#160;&#160;&#160;((<a class="el" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a>)(86400*<a class="el" href="group__apr__time.html#gab4dd3f3015d25a50f3be3e0e91043abf">APR_USEC_PER_SEC</a>)) /* one day, <a class="el" href="group__apr__thread__proc.html#ga2e46fea00cc2238744ebca5061c62bcc">in</a> microseconds */</td></tr>
<tr class="separator:ga11c1c155b3b983d8a53ee6f62d054c5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga99f59d6743883a270e59e4d49616b054"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga99f59d6743883a270e59e4d49616b054">MSEC_ONE_HR</a>&#160;&#160;&#160;((<a class="el" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a>)(3600*<a class="el" href="group__apr__time.html#gab4dd3f3015d25a50f3be3e0e91043abf">APR_USEC_PER_SEC</a>))  /* one hour, <a class="el" href="group__apr__thread__proc.html#ga2e46fea00cc2238744ebca5061c62bcc">in</a> microseconds */</td></tr>
<tr class="separator:ga99f59d6743883a270e59e4d49616b054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga06c93f90cd6b42720767c458a27ba49c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga06c93f90cd6b42720767c458a27ba49c">MSEC_ONE_MIN</a>&#160;&#160;&#160;((<a class="el" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a>)(60*<a class="el" href="group__apr__time.html#gab4dd3f3015d25a50f3be3e0e91043abf">APR_USEC_PER_SEC</a>))    /* one minute, <a class="el" href="group__apr__thread__proc.html#ga2e46fea00cc2238744ebca5061c62bcc">in</a> microseconds */</td></tr>
<tr class="separator:ga06c93f90cd6b42720767c458a27ba49c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga99bdcd9c38d9afadf961bf71103fb44e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga99bdcd9c38d9afadf961bf71103fb44e">MSEC_ONE_SEC</a>&#160;&#160;&#160;((<a class="el" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a>)(<a class="el" href="group__apr__time.html#gab4dd3f3015d25a50f3be3e0e91043abf">APR_USEC_PER_SEC</a>))       /* one <a class="el" href="group__apr__tables.html#gade8df35e4d83c24788cf409262f7fc51">second</a>, <a class="el" href="group__apr__thread__proc.html#ga2e46fea00cc2238744ebca5061c62bcc">in</a> microseconds */</td></tr>
<tr class="separator:ga99bdcd9c38d9afadf961bf71103fb44e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadfe1ae1ee42160d9c183cfac20c25ad1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gadfe1ae1ee42160d9c183cfac20c25ad1">DEFAULT_CACHE_MAXEXPIRE</a>&#160;&#160;&#160;<a class="el" href="group__Cache__util.html#ga11c1c155b3b983d8a53ee6f62d054c5c">MSEC_ONE_DAY</a></td></tr>
<tr class="separator:gadfe1ae1ee42160d9c183cfac20c25ad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1777581186d443f1a84aad75245f526e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga1777581186d443f1a84aad75245f526e">DEFAULT_CACHE_MINEXPIRE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ga1777581186d443f1a84aad75245f526e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a4dac2e0dccccc4f1e4485bfc529724"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga4a4dac2e0dccccc4f1e4485bfc529724">DEFAULT_CACHE_EXPIRE</a>&#160;&#160;&#160;<a class="el" href="group__Cache__util.html#ga99f59d6743883a270e59e4d49616b054">MSEC_ONE_HR</a></td></tr>
<tr class="separator:ga4a4dac2e0dccccc4f1e4485bfc529724"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a7f13c74ab54bb2ec8419463f95fa1d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga3a7f13c74ab54bb2ec8419463f95fa1d">DEFAULT_CACHE_LMFACTOR</a>&#160;&#160;&#160;(0.1)</td></tr>
<tr class="separator:ga3a7f13c74ab54bb2ec8419463f95fa1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab7892c35c420dde1a8050b5bd7c437c5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gab7892c35c420dde1a8050b5bd7c437c5">DEFAULT_CACHE_MAXAGE</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:gab7892c35c420dde1a8050b5bd7c437c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga201e22bbaa4aa67b58a109afaabf6959"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga201e22bbaa4aa67b58a109afaabf6959">DEFAULT_X_CACHE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ga201e22bbaa4aa67b58a109afaabf6959"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5774f5c44b82783922fe3c741cb4c093"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga5774f5c44b82783922fe3c741cb4c093">DEFAULT_X_CACHE_DETAIL</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ga5774f5c44b82783922fe3c741cb4c093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac909357ff2b12a32397146be2a3a8b74"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gac909357ff2b12a32397146be2a3a8b74">DEFAULT_CACHE_STALE_ON_ERROR</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:gac909357ff2b12a32397146be2a3a8b74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8529c15e3f5e3e6598f8313495f50598"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga8529c15e3f5e3e6598f8313495f50598">DEFAULT_CACHE_LOCKPATH</a>&#160;&#160;&#160;&quot;/mod_cache-<a class="el" href="group__APR__Util__RMM.html#ga0353fe7d0bd33c38d9a7a57a73b6407e">lock</a>&quot;</td></tr>
<tr class="separator:ga8529c15e3f5e3e6598f8313495f50598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa55455b9316bd74826d36a89914580b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gaa55455b9316bd74826d36a89914580b8">CACHE_LOCKNAME_KEY</a>&#160;&#160;&#160;&quot;mod_cache-lockname&quot;</td></tr>
<tr class="separator:gaa55455b9316bd74826d36a89914580b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga18f46c3a4173d016f51fce82d596fec7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga18f46c3a4173d016f51fce82d596fec7">CACHE_LOCKFILE_KEY</a>&#160;&#160;&#160;&quot;mod_cache-lockfile&quot;</td></tr>
<tr class="separator:ga18f46c3a4173d016f51fce82d596fec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac10632e313af1b7ac2c619b65290f5d7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gac10632e313af1b7ac2c619b65290f5d7">CACHE_CTX_KEY</a>&#160;&#160;&#160;&quot;mod_cache-<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga0525238c5b09cb4ac5067ddec654d09c">ctx</a>&quot;</td></tr>
<tr class="separator:gac10632e313af1b7ac2c619b65290f5d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2916636af38fdf277cb80c1c698c291a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga2916636af38fdf277cb80c1c698c291a">CACHE_SEPARATOR</a>&#160;&#160;&#160;&quot;, \t&quot;</td></tr>
<tr class="separator:ga2916636af38fdf277cb80c1c698c291a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaf1d145ae80afe048c683ac2da4e9c298"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcache__provider__list.html">cache_provider_list</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gaf1d145ae80afe048c683ac2da4e9c298">cache_provider_list</a></td></tr>
<tr class="separator:gaf1d145ae80afe048c683ac2da4e9c298"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga565962a760117aaaed7e13445f79e831"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga565962a760117aaaed7e13445f79e831">ap_cache_check_no_cache</a> (<a class="el" href="structcache__request__rec.html">cache_request_rec</a> *<a class="el" href="structcache.html">cache</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>)</td></tr>
<tr class="separator:ga565962a760117aaaed7e13445f79e831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabddbd6cc98e9791c643ea64a26e165b0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gabddbd6cc98e9791c643ea64a26e165b0">ap_cache_check_no_store</a> (<a class="el" href="structcache__request__rec.html">cache_request_rec</a> *<a class="el" href="structcache.html">cache</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>)</td></tr>
<tr class="separator:gabddbd6cc98e9791c643ea64a26e165b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8719ff14e3ad87c32614da9fc10cb119"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga8719ff14e3ad87c32614da9fc10cb119">cache_check_freshness</a> (<a class="el" href="group__MOD__CACHE.html#ga6b7854a2592838a565bdee8f94343aab">cache_handle_t</a> *<a class="el" href="pcregrep_8txt.html#a373589baca2cb79ec87f46d6599640b9">h</a>, <a class="el" href="structcache__request__rec.html">cache_request_rec</a> *<a class="el" href="structcache.html">cache</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>)</td></tr>
<tr class="separator:ga8719ff14e3ad87c32614da9fc10cb119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaffa94dfea5098ffab89d1dc91e094415"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gaffa94dfea5098ffab89d1dc91e094415">cache_try_lock</a> (<a class="el" href="structcache__server__conf.html">cache_server_conf</a> *<a class="el" href="group__MOD__PROXY.html#ga4d7edd451c4bb8ed9ce9012e5dea2b14">conf</a>, <a class="el" href="structcache__request__rec.html">cache_request_rec</a> *<a class="el" href="structcache.html">cache</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>)</td></tr>
<tr class="separator:gaffa94dfea5098ffab89d1dc91e094415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6936350ce1acc1f19e336eb95be153fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga6936350ce1acc1f19e336eb95be153fb">cache_remove_lock</a> (<a class="el" href="structcache__server__conf.html">cache_server_conf</a> *<a class="el" href="group__MOD__PROXY.html#ga4d7edd451c4bb8ed9ce9012e5dea2b14">conf</a>, <a class="el" href="structcache__request__rec.html">cache_request_rec</a> *<a class="el" href="structcache.html">cache</a>, <a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>, <a class="el" href="structapr__bucket__brigade.html">apr_bucket_brigade</a> *<a class="el" href="group__MOD__PROXY.html#ga9313a8a2814cff280d5d780c723def3c">bb</a>)</td></tr>
<tr class="separator:ga6936350ce1acc1f19e336eb95be153fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3bb0227007e96351ef9b155cd0720abb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcache__provider__list.html">cache_provider_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga3bb0227007e96351ef9b155cd0720abb">cache_get_providers</a> (<a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>, <a class="el" href="structcache__server__conf.html">cache_server_conf</a> *<a class="el" href="group__MOD__PROXY.html#ga4d7edd451c4bb8ed9ce9012e5dea2b14">conf</a>)</td></tr>
<tr class="separator:ga3bb0227007e96351ef9b155cd0720abb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga46b2ea303b9ec2767a61d0f121835b43"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a> (<a class="el" href="structapr__pool__t.html">apr_pool_t</a> *<a class="el" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>, const <a class="el" href="structapr__table__t.html">apr_table_t</a> *<a class="el" href="pcretest_8txt.html#a9ffb27fb8e1f90c17b13303fee2fb883">t</a>, const char *<a class="el" href="apr__siphash_8h.html#adac0b6a30345ea1d0daa8a692b0b7ad9">key</a>)</td></tr>
<tr class="separator:ga46b2ea303b9ec2767a61d0f121835b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada03570414af2b2d9349449858036d90"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gada03570414af2b2d9349449858036d90">cache_strqtok</a> (char *<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga6a62b60443be1d042194af15ce934193">str</a>, const char *<a class="el" href="group__apr__tables.html#ga37d96adf842aef6b03690e17874c9ed8">sep</a>, char **<a class="el" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>)</td></tr>
<tr class="separator:gada03570414af2b2d9349449858036d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81c4df4762c014811f81be66e236f62b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapr__table__t.html">apr_table_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#ga81c4df4762c014811f81be66e236f62b">cache_merge_headers_out</a> (<a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>)</td></tr>
<tr class="separator:ga81c4df4762c014811f81be66e236f62b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea2f7fee82fd07fce89934bee0939987"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Cache__util.html#gaea2f7fee82fd07fce89934bee0939987">cache_use_early_url</a> (<a class="el" href="structrequest__rec.html">request_rec</a> *<a class="el" href="pcregrep_8txt.html#a2e9e9438b26c0bb4425367a7e4f75eb3">r</a>)</td></tr>
<tr class="separator:gaea2f7fee82fd07fce89934bee0939987"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga88a4bf7f483aad3f3945773f3383e713"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APR_WANT_STRFUNC</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gac10632e313af1b7ac2c619b65290f5d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CACHE_CTX_KEY&#160;&#160;&#160;&quot;mod_cache-<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga0525238c5b09cb4ac5067ddec654d09c">ctx</a>&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga18f46c3a4173d016f51fce82d596fec7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CACHE_LOCKFILE_KEY&#160;&#160;&#160;&quot;mod_cache-lockfile&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gaa55455b9316bd74826d36a89914580b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CACHE_LOCKNAME_KEY&#160;&#160;&#160;&quot;mod_cache-lockname&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga2916636af38fdf277cb80c1c698c291a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CACHE_SEPARATOR&#160;&#160;&#160;&quot;, \t&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga4a4dac2e0dccccc4f1e4485bfc529724"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_CACHE_EXPIRE&#160;&#160;&#160;<a class="el" href="group__Cache__util.html#ga99f59d6743883a270e59e4d49616b054">MSEC_ONE_HR</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga3a7f13c74ab54bb2ec8419463f95fa1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_CACHE_LMFACTOR&#160;&#160;&#160;(0.1)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga8529c15e3f5e3e6598f8313495f50598"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_CACHE_LOCKPATH&#160;&#160;&#160;&quot;/mod_cache-<a class="el" href="group__APR__Util__RMM.html#ga0353fe7d0bd33c38d9a7a57a73b6407e">lock</a>&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gab7892c35c420dde1a8050b5bd7c437c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_CACHE_MAXAGE&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gadfe1ae1ee42160d9c183cfac20c25ad1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_CACHE_MAXEXPIRE&#160;&#160;&#160;<a class="el" href="group__Cache__util.html#ga11c1c155b3b983d8a53ee6f62d054c5c">MSEC_ONE_DAY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga1777581186d443f1a84aad75245f526e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_CACHE_MINEXPIRE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gac909357ff2b12a32397146be2a3a8b74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_CACHE_STALE_ON_ERROR&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga201e22bbaa4aa67b58a109afaabf6959"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_X_CACHE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga5774f5c44b82783922fe3c741cb4c093"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_X_CACHE_DETAIL&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gafa99ec4acc4ecb2dc3c2d05da15d0e3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>) &gt; (<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>) ? (<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>) : (<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga3acffbd305ee72dcd4593c0d8af64a4f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>) &lt; (<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>) ? (<a class="el" href="pcre_8txt.html#a841271aab70f5cda9412a19c7753f02c">a</a>) : (<a class="el" href="group__APR__Util__Bucket__Brigades.html#ga11dc1bdeac74315dbed17465c98879e9">b</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga11c1c155b3b983d8a53ee6f62d054c5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSEC_ONE_DAY&#160;&#160;&#160;((<a class="el" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a>)(86400*<a class="el" href="group__apr__time.html#gab4dd3f3015d25a50f3be3e0e91043abf">APR_USEC_PER_SEC</a>)) /* one day, <a class="el" href="group__apr__thread__proc.html#ga2e46fea00cc2238744ebca5061c62bcc">in</a> microseconds */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga99f59d6743883a270e59e4d49616b054"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSEC_ONE_HR&#160;&#160;&#160;((<a class="el" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a>)(3600*<a class="el" href="group__apr__time.html#gab4dd3f3015d25a50f3be3e0e91043abf">APR_USEC_PER_SEC</a>))  /* one hour, <a class="el" href="group__apr__thread__proc.html#ga2e46fea00cc2238744ebca5061c62bcc">in</a> microseconds */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga06c93f90cd6b42720767c458a27ba49c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSEC_ONE_MIN&#160;&#160;&#160;((<a class="el" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a>)(60*<a class="el" href="group__apr__time.html#gab4dd3f3015d25a50f3be3e0e91043abf">APR_USEC_PER_SEC</a>))    /* one minute, <a class="el" href="group__apr__thread__proc.html#ga2e46fea00cc2238744ebca5061c62bcc">in</a> microseconds */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga99bdcd9c38d9afadf961bf71103fb44e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSEC_ONE_SEC&#160;&#160;&#160;((<a class="el" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a>)(<a class="el" href="group__apr__time.html#gab4dd3f3015d25a50f3be3e0e91043abf">APR_USEC_PER_SEC</a>))       /* one <a class="el" href="group__apr__tables.html#gade8df35e4d83c24788cf409262f7fc51">second</a>, <a class="el" href="group__apr__thread__proc.html#ga2e46fea00cc2238744ebca5061c62bcc">in</a> microseconds */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gaf1d145ae80afe048c683ac2da4e9c298"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcache__provider__list.html">cache_provider_list</a> <a class="el" href="structcache__provider__list.html">cache_provider_list</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga565962a760117aaaed7e13445f79e831"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> ap_cache_check_no_cache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__request__rec.html">cache_request_rec</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the whether the request allows a cached object to be served as per RFC2616 section 14.9.4 (Cache Revalidation and Reload Controls) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td><a class="el" href="structcache__request__rec.html">cache_request_rec</a> </td></tr>
    <tr><td class="paramname">r</td><td><a class="el" href="structrequest__rec.html" title="A structure that represents the current request. ">request_rec</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 ==&gt; cache object may not be served, 1 ==&gt; cache object may be served </dd></dl>
<div class="fragment"><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;{</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="structcache__server__conf.html">cache_server_conf</a> *<a class="code" href="group__APACHE__CORE__HTTPD.html#ga7be6dfd9155648f64d6e9abcd78c38cd">conf</a> =</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      (<a class="code" href="structcache__server__conf.html">cache_server_conf</a> *)<a class="code" href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a>(r-&gt;<a class="code" href="structrequest__rec.html#a4a8059930ce9409cb885fdeef6921b7b">server</a>-&gt;module_config,</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                                &amp;<a class="code" href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">     * At this point, we may have data cached, but the request may have</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">     * specified that cached data may not be used in a response.</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">     * This is covered under RFC2616 section 14.9.4 (Cache Revalidation and</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">     * Reload Controls).</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">     * - RFC2616 14.9.4 End to end reload, Cache-Control: no-cache, or Pragma:</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">     * no-cache. The server MUST NOT use a cached copy when responding to such</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">     * a request.</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">/* This value comes from the client&#39;s initial request. */</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.<a class="code" href="structcache__control.html#a386401082305485525836ed568c6b46a">parsed</a>) {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *cc_req = <a class="code" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a>(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>,</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="stringliteral">&quot;Cache-Control&quot;</span>);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *pragma = <a class="code" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a>(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;Pragma&quot;</span>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b">ap_cache_control</a>(r, &amp;cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>, cc_req, pragma, r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.<a class="code" href="structcache__control.html#a76e5095344c47d185ef638ba1b66f267">no_cache</a>) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span> (!conf-&gt;<a class="code" href="structcache__server__conf.html#a2372aa3f5b681975bd629bb1c865735d">ignorecachecontrol</a>) {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga47fafbef7e478babdd92e90407f95b19">APLOG_INFO</a>, 0, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(02657)</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                    <span class="stringliteral">&quot;Incoming request is asking for an uncached version of &quot;</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <span class="stringliteral">&quot;%s, but we have been configured to ignore it and serve &quot;</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    <span class="stringliteral">&quot;cached content anyway&quot;</span>, r-&gt;<a class="code" href="structrequest__rec.html#a2c0077c30ea4446551ecee4e24ced868">unparsed_uri</a>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__LOG_html_ga47fafbef7e478babdd92e90407f95b19"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga47fafbef7e478babdd92e90407f95b19">APLOG_INFO</a></div><div class="ttdeci">#define APLOG_INFO</div><div class="ttdef"><b>Definition:</b> http_log.h:49</div></div>
<div class="ttc" id="structcache__control_html_a76e5095344c47d185ef638ba1b66f267"><div class="ttname"><a href="structcache__control.html#a76e5095344c47d185ef638ba1b66f267">cache_control::no_cache</a></div><div class="ttdeci">unsigned int no_cache</div><div class="ttdef"><b>Definition:</b> cache_common.h:34</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga655e126996849bcb82e4e5a14c616f4a"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a></div><div class="ttdeci">#define APLOG_MARK</div><div class="ttdef"><b>Definition:</b> http_log.h:283</div></div>
<div class="ttc" id="structrequest__rec_html_a4a8059930ce9409cb885fdeef6921b7b"><div class="ttname"><a href="structrequest__rec.html#a4a8059930ce9409cb885fdeef6921b7b">request_rec::server</a></div><div class="ttdeci">uintptr_t server</div><div class="ttdef"><b>Definition:</b> ap.d:5</div></div>
<div class="ttc" id="structcache__request__rec_html_aaea78b272eb05f1ba67a75bd6264b4df"><div class="ttname"><a href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">cache_request_rec::control_in</a></div><div class="ttdeci">cache_control_t control_in</div><div class="ttdef"><b>Definition:</b> cache_util.h:232</div></div>
<div class="ttc" id="structcache__server__conf_html_a2372aa3f5b681975bd629bb1c865735d"><div class="ttname"><a href="structcache__server__conf.html#a2372aa3f5b681975bd629bb1c865735d">cache_server_conf::ignorecachecontrol</a></div><div class="ttdeci">unsigned int ignorecachecontrol</div><div class="ttdef"><b>Definition:</b> cache_util.h:131</div></div>
<div class="ttc" id="group__Cache__util_html_ga46b2ea303b9ec2767a61d0f121835b43"><div class="ttname"><a href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a></div><div class="ttdeci">const char * cache_table_getm(apr_pool_t *p, const apr_table_t *t, const char *key)</div><div class="ttdef"><b>Definition:</b> cache_util.c:1324</div></div>
<div class="ttc" id="mod__cache_8c_html_a315b551bc967794e90417b5538a128f1"><div class="ttname"><a href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a></div><div class="ttdeci">module AP_MODULE_DECLARE_DATA cache_module</div><div class="ttdef"><b>Definition:</b> mod_cache.c:22</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="structrequest__rec_html_a2c0077c30ea4446551ecee4e24ced868"><div class="ttname"><a href="structrequest__rec.html#a2c0077c30ea4446551ecee4e24ced868">request_rec::unparsed_uri</a></div><div class="ttdeci">char * unparsed_uri</div><div class="ttdef"><b>Definition:</b> ap.d:49</div></div>
<div class="ttc" id="group__MOD__CACHE_html_ga22e3955e21c6e60450101eb1e3c6919b"><div class="ttname"><a href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b">ap_cache_control</a></div><div class="ttdeci">int ap_cache_control(request_rec *r, cache_control_t *cc, const char *cc_header, const char *pragma_header, apr_table_t *headers)</div><div class="ttdef"><b>Definition:</b> cache_util.c:1002</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga1093a5908a384eacc929b028c79f2a02"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a></div><div class="ttdeci">#define ap_get_module_config(v, m)</div><div class="ttdef"><b>Definition:</b> http_config.h:531</div></div>
<div class="ttc" id="group__APACHE__CORE__HTTPD_html_ga7be6dfd9155648f64d6e9abcd78c38cd"><div class="ttname"><a href="group__APACHE__CORE__HTTPD.html#ga7be6dfd9155648f64d6e9abcd78c38cd">conf</a></div><div class="ttdeci">core_dir_config * conf</div><div class="ttdef"><b>Definition:</b> http_core.h:755</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga4c112558ccffd6b363da102b2052d2a6"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a></div><div class="ttdeci">#define ap_log_rerror</div><div class="ttdef"><b>Definition:</b> http_log.h:454</div></div>
<div class="ttc" id="structcache__control_html_a386401082305485525836ed568c6b46a"><div class="ttname"><a href="structcache__control.html#a386401082305485525836ed568c6b46a">cache_control::parsed</a></div><div class="ttdeci">unsigned int parsed</div><div class="ttdef"><b>Definition:</b> cache_common.h:31</div></div>
<div class="ttc" id="structcache__server__conf_html"><div class="ttname"><a href="structcache__server__conf.html">cache_server_conf</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:120</div></div>
<div class="ttc" id="structrequest__rec_html_a5497da6c01af49acf70a4a9b975c1c83"><div class="ttname"><a href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">request_rec::headers_in</a></div><div class="ttdeci">uintptr_t headers_in</div><div class="ttdef"><b>Definition:</b> ap.d:35</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga1dee8a07e06bc5b3de8b89662c2cd666"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a></div><div class="ttdeci">#define APLOGNO(n)</div><div class="ttdef"><b>Definition:</b> http_log.h:117</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_ga565962a760117aaaed7e13445f79e831_cgraph.png" border="0" usemap="#group__Cache__util_ga565962a760117aaaed7e13445f79e831_cgraph" alt=""/></div>
<map name="group__Cache__util_ga565962a760117aaaed7e13445f79e831_cgraph" id="group__Cache__util_ga565962a760117aaaed7e13445f79e831_cgraph">
<area shape="rect" id="node2" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43" title="cache_table_getm" alt="" coords="236,5,364,32"/>
<area shape="rect" id="node3" href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b" title="ap_cache_control" alt="" coords="238,56,362,83"/>
<area shape="rect" id="node4" href="structcache__control.html#ab54624480acafa695556a98b70938413" title="cache_control::cache\l_control" alt="" coords="412,19,559,61"/>
<area shape="rect" id="node5" href="group__Cache__util.html#gada03570414af2b2d9349449858036d90" title="cache_strqtok" alt="" coords="433,85,537,112"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_ga565962a760117aaaed7e13445f79e831_icgraph.png" border="0" usemap="#group__Cache__util_ga565962a760117aaaed7e13445f79e831_icgraph" alt=""/></div>
<map name="group__Cache__util_ga565962a760117aaaed7e13445f79e831_icgraph" id="group__Cache__util_ga565962a760117aaaed7e13445f79e831_icgraph">
<area shape="rect" id="node2" href="group__Cache__storage.html#gaffb29f2e1276bc7d81bac540a1cf3e06" title="cache_select" alt="" coords="236,5,335,32"/>
<area shape="rect" id="node3" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="383,5,573,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gabddbd6cc98e9791c643ea64a26e165b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> ap_cache_check_no_store </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__request__rec.html">cache_request_rec</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the whether the request allows a cached object to be stored as per RFC2616 section 14.9.2 (What May be Stored by Caches) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td><a class="el" href="structcache__request__rec.html">cache_request_rec</a> </td></tr>
    <tr><td class="paramname">r</td><td><a class="el" href="structrequest__rec.html" title="A structure that represents the current request. ">request_rec</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 ==&gt; cache object may not be served, 1 ==&gt; cache object may be served </dd></dl>
<div class="fragment"><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;{</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="structcache__server__conf.html">cache_server_conf</a> *<a class="code" href="group__APACHE__CORE__HTTPD.html#ga7be6dfd9155648f64d6e9abcd78c38cd">conf</a> =</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      (<a class="code" href="structcache__server__conf.html">cache_server_conf</a> *)<a class="code" href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a>(r-&gt;<a class="code" href="structrequest__rec.html#a4a8059930ce9409cb885fdeef6921b7b">server</a>-&gt;module_config,</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                                &amp;<a class="code" href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">     * At this point, we may have data cached, but the request may have</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">     * specified that cached data may not be used in a response.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">     * - RFC2616 14.9.2 What May be Stored by Caches. If Cache-Control:</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">     * no-store arrives, do not serve from or store to the cache.</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">/* This value comes from the client&#39;s initial request. */</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.<a class="code" href="structcache__control.html#a386401082305485525836ed568c6b46a">parsed</a>) {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *cc_req = <a class="code" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a>(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="stringliteral">&quot;Cache-Control&quot;</span>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *pragma = <a class="code" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a>(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;Pragma&quot;</span>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b">ap_cache_control</a>(r, &amp;cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>, cc_req, pragma, r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.<a class="code" href="structcache__control.html#a954d604960ef369d164db15b4574f5e2">no_store</a>) {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">if</span> (!conf-&gt;<a class="code" href="structcache__server__conf.html#a2372aa3f5b681975bd629bb1c865735d">ignorecachecontrol</a>) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="comment">/* We&#39;re not allowed to serve a cached copy */</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga47fafbef7e478babdd92e90407f95b19">APLOG_INFO</a>, 0, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(02658)</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                    <span class="stringliteral">&quot;Incoming request is asking for a no-store version of &quot;</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                    <span class="stringliteral">&quot;%s, but we have been configured to ignore it and serve &quot;</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                    <span class="stringliteral">&quot;cached content anyway&quot;</span>, r-&gt;<a class="code" href="structrequest__rec.html#a2c0077c30ea4446551ecee4e24ced868">unparsed_uri</a>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__LOG_html_ga47fafbef7e478babdd92e90407f95b19"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga47fafbef7e478babdd92e90407f95b19">APLOG_INFO</a></div><div class="ttdeci">#define APLOG_INFO</div><div class="ttdef"><b>Definition:</b> http_log.h:49</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga655e126996849bcb82e4e5a14c616f4a"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a></div><div class="ttdeci">#define APLOG_MARK</div><div class="ttdef"><b>Definition:</b> http_log.h:283</div></div>
<div class="ttc" id="structrequest__rec_html_a4a8059930ce9409cb885fdeef6921b7b"><div class="ttname"><a href="structrequest__rec.html#a4a8059930ce9409cb885fdeef6921b7b">request_rec::server</a></div><div class="ttdeci">uintptr_t server</div><div class="ttdef"><b>Definition:</b> ap.d:5</div></div>
<div class="ttc" id="structcache__request__rec_html_aaea78b272eb05f1ba67a75bd6264b4df"><div class="ttname"><a href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">cache_request_rec::control_in</a></div><div class="ttdeci">cache_control_t control_in</div><div class="ttdef"><b>Definition:</b> cache_util.h:232</div></div>
<div class="ttc" id="structcache__server__conf_html_a2372aa3f5b681975bd629bb1c865735d"><div class="ttname"><a href="structcache__server__conf.html#a2372aa3f5b681975bd629bb1c865735d">cache_server_conf::ignorecachecontrol</a></div><div class="ttdeci">unsigned int ignorecachecontrol</div><div class="ttdef"><b>Definition:</b> cache_util.h:131</div></div>
<div class="ttc" id="group__Cache__util_html_ga46b2ea303b9ec2767a61d0f121835b43"><div class="ttname"><a href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43">cache_table_getm</a></div><div class="ttdeci">const char * cache_table_getm(apr_pool_t *p, const apr_table_t *t, const char *key)</div><div class="ttdef"><b>Definition:</b> cache_util.c:1324</div></div>
<div class="ttc" id="mod__cache_8c_html_a315b551bc967794e90417b5538a128f1"><div class="ttname"><a href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a></div><div class="ttdeci">module AP_MODULE_DECLARE_DATA cache_module</div><div class="ttdef"><b>Definition:</b> mod_cache.c:22</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="structrequest__rec_html_a2c0077c30ea4446551ecee4e24ced868"><div class="ttname"><a href="structrequest__rec.html#a2c0077c30ea4446551ecee4e24ced868">request_rec::unparsed_uri</a></div><div class="ttdeci">char * unparsed_uri</div><div class="ttdef"><b>Definition:</b> ap.d:49</div></div>
<div class="ttc" id="group__MOD__CACHE_html_ga22e3955e21c6e60450101eb1e3c6919b"><div class="ttname"><a href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b">ap_cache_control</a></div><div class="ttdeci">int ap_cache_control(request_rec *r, cache_control_t *cc, const char *cc_header, const char *pragma_header, apr_table_t *headers)</div><div class="ttdef"><b>Definition:</b> cache_util.c:1002</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga1093a5908a384eacc929b028c79f2a02"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a></div><div class="ttdeci">#define ap_get_module_config(v, m)</div><div class="ttdef"><b>Definition:</b> http_config.h:531</div></div>
<div class="ttc" id="group__APACHE__CORE__HTTPD_html_ga7be6dfd9155648f64d6e9abcd78c38cd"><div class="ttname"><a href="group__APACHE__CORE__HTTPD.html#ga7be6dfd9155648f64d6e9abcd78c38cd">conf</a></div><div class="ttdeci">core_dir_config * conf</div><div class="ttdef"><b>Definition:</b> http_core.h:755</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga4c112558ccffd6b363da102b2052d2a6"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a></div><div class="ttdeci">#define ap_log_rerror</div><div class="ttdef"><b>Definition:</b> http_log.h:454</div></div>
<div class="ttc" id="structcache__control_html_a386401082305485525836ed568c6b46a"><div class="ttname"><a href="structcache__control.html#a386401082305485525836ed568c6b46a">cache_control::parsed</a></div><div class="ttdeci">unsigned int parsed</div><div class="ttdef"><b>Definition:</b> cache_common.h:31</div></div>
<div class="ttc" id="structcache__server__conf_html"><div class="ttname"><a href="structcache__server__conf.html">cache_server_conf</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:120</div></div>
<div class="ttc" id="structcache__control_html_a954d604960ef369d164db15b4574f5e2"><div class="ttname"><a href="structcache__control.html#a954d604960ef369d164db15b4574f5e2">cache_control::no_store</a></div><div class="ttdeci">unsigned int no_store</div><div class="ttdef"><b>Definition:</b> cache_common.h:36</div></div>
<div class="ttc" id="structrequest__rec_html_a5497da6c01af49acf70a4a9b975c1c83"><div class="ttname"><a href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">request_rec::headers_in</a></div><div class="ttdeci">uintptr_t headers_in</div><div class="ttdef"><b>Definition:</b> ap.d:35</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga1dee8a07e06bc5b3de8b89662c2cd666"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a></div><div class="ttdeci">#define APLOGNO(n)</div><div class="ttdef"><b>Definition:</b> http_log.h:117</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_gabddbd6cc98e9791c643ea64a26e165b0_cgraph.png" border="0" usemap="#group__Cache__util_gabddbd6cc98e9791c643ea64a26e165b0_cgraph" alt=""/></div>
<map name="group__Cache__util_gabddbd6cc98e9791c643ea64a26e165b0_cgraph" id="group__Cache__util_gabddbd6cc98e9791c643ea64a26e165b0_cgraph">
<area shape="rect" id="node2" href="group__Cache__util.html#ga46b2ea303b9ec2767a61d0f121835b43" title="cache_table_getm" alt="" coords="231,5,359,32"/>
<area shape="rect" id="node3" href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b" title="ap_cache_control" alt="" coords="233,56,357,83"/>
<area shape="rect" id="node4" href="structcache__control.html#ab54624480acafa695556a98b70938413" title="cache_control::cache\l_control" alt="" coords="407,19,553,61"/>
<area shape="rect" id="node5" href="group__Cache__util.html#gada03570414af2b2d9349449858036d90" title="cache_strqtok" alt="" coords="428,85,532,112"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_gabddbd6cc98e9791c643ea64a26e165b0_icgraph.png" border="0" usemap="#group__Cache__util_gabddbd6cc98e9791c643ea64a26e165b0_icgraph" alt=""/></div>
<map name="group__Cache__util_gabddbd6cc98e9791c643ea64a26e165b0_icgraph" id="group__Cache__util_gabddbd6cc98e9791c643ea64a26e165b0_icgraph">
<area shape="rect" id="node2" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="231,5,421,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga8719ff14e3ad87c32614da9fc10cb119"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> cache_check_freshness </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MOD__CACHE.html#ga6b7854a2592838a565bdee8f94343aab">cache_handle_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__request__rec.html">cache_request_rec</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the freshness of the cache object per RFC2616 section 13.2 (Expiration Model) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>cache_handle_t </td></tr>
    <tr><td class="paramname">cache</td><td><a class="el" href="structcache__request__rec.html">cache_request_rec</a> </td></tr>
    <tr><td class="paramname">r</td><td><a class="el" href="structrequest__rec.html" title="A structure that represents the current request. ">request_rec</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 ==&gt; cache object is stale, 1 ==&gt; cache object is fresh </dd></dl>
<div class="fragment"><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;{</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a> <a class="code" href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="group__apr__platform.html#ga4b75afbf973dc6c8aea4ae75b044aa08">apr_int64_t</a> age, maxage_req, maxage_cresp, <a class="code" href="group__APACHE__CORE__COOKIE.html#ga846f24530366d967942121cbfdca1ea7">maxage</a>, smaxage, maxstale;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="group__apr__platform.html#ga4b75afbf973dc6c8aea4ae75b044aa08">apr_int64_t</a> minfresh;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *cc_req;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *pragma;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *agestr = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a> age_c = 0;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="structcache__info.html">cache_info</a> *<a class="code" href="group__AP__EXPR.html#gae5e165b68fbb12afc88707b8e6eb2f08">info</a> = &amp;(h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a>-&gt;<a class="code" href="structcache__object.html#ab4b2aae3e314dfa7abe8304c33cedb83">info</a>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *warn_head;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="structcache__server__conf.html">cache_server_conf</a> *<a class="code" href="group__APACHE__CORE__HTTPD.html#ga7be6dfd9155648f64d6e9abcd78c38cd">conf</a> =</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      (<a class="code" href="structcache__server__conf.html">cache_server_conf</a> *)<a class="code" href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a>(r-&gt;<a class="code" href="structrequest__rec.html#a4a8059930ce9409cb885fdeef6921b7b">server</a>-&gt;module_config,</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                                &amp;<a class="code" href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a>);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">     * We now want to check if our cached data is still fresh. This depends</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">     * on a few things, in this order:</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">     * - RFC2616 14.9.4 End to end reload, Cache-Control: no-cache. no-cache</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">     * in either the request or the cached response means that we must</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">     * perform the request unconditionally, and ignore cached content. We</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">     * should never reach here, but if we do, mark the content as stale,</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">     * as this is the best we can do.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">     * - RFC2616 14.32 Pragma: no-cache This is treated the same as</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">     * Cache-Control: no-cache.</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">     * - RFC2616 14.9.3 Cache-Control: max-stale, must-revalidate,</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">     * proxy-revalidate if the max-stale request header exists, modify the</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">     * stale calculations below so that an object can be at most &lt;max-stale&gt;</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">     * seconds stale before we request a revalidation, _UNLESS_ a</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">     * must-revalidate or proxy-revalidate cached response header exists to</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">     * stop us doing this.</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">     * - RFC2616 14.9.3 Cache-Control: s-maxage the origin server specifies the</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">     * maximum age an object can be before it is considered stale. This</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">     * directive has the effect of proxy|must revalidate, which in turn means</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">     * simple ignore any max-stale setting.</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">     * - RFC2616 14.9.4 Cache-Control: max-age this header can appear in both</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">     * requests and responses. If both are specified, the smaller of the two</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">     * takes priority.</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">     * - RFC2616 14.21 Expires: if this request header exists in the cached</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">     * entity, and it&#39;s value is in the past, it has expired.</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">/* This value comes from the client&#39;s initial request. */</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    cc_req = apr_table_get(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;Cache-Control&quot;</span>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    pragma = apr_table_get(r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>, <span class="stringliteral">&quot;Pragma&quot;</span>);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b">ap_cache_control</a>(r, &amp;cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>, cc_req, pragma, r-&gt;<a class="code" href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">headers_in</a>);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.<a class="code" href="structcache__control.html#a76e5095344c47d185ef638ba1b66f267">no_cache</a>) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordflow">if</span> (!conf-&gt;<a class="code" href="structcache__server__conf.html#a2372aa3f5b681975bd629bb1c865735d">ignorecachecontrol</a>) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="comment">/* Treat as stale, causing revalidation */</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga47fafbef7e478babdd92e90407f95b19">APLOG_INFO</a>, 0, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00781)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                <span class="stringliteral">&quot;Incoming request is asking for a uncached version of &quot;</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <span class="stringliteral">&quot;%s, but we have been configured to ignore it and &quot;</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                <span class="stringliteral">&quot;serve a cached response anyway&quot;</span>,</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                r-&gt;<a class="code" href="structrequest__rec.html#a2c0077c30ea4446551ecee4e24ced868">unparsed_uri</a>);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">/* These come from the cached entity. */</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">if</span> (h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a>-&gt;<a class="code" href="structcache__object.html#ab4b2aae3e314dfa7abe8304c33cedb83">info</a>.<a class="code" href="structcache__info.html#ad13eba54e179bd5b57b7e97b219b3c67">control</a>.<a class="code" href="structcache__control.html#a76e5095344c47d185ef638ba1b66f267">no_cache</a></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            || h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a>-&gt;<a class="code" href="structcache__object.html#ab4b2aae3e314dfa7abe8304c33cedb83">info</a>.<a class="code" href="structcache__info.html#ad13eba54e179bd5b57b7e97b219b3c67">control</a>.invalidated) {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">         * The cached entity contained Cache-Control: no-cache, or a</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">         * no-cache with a header present, or a private with a header</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">         * present, or the cached entity has been invalidated in the</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">         * past, so treat as stale causing revalidation.</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> ((agestr = apr_table_get(h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Age&quot;</span>))) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordtype">char</span> *endp;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <a class="code" href="group__apr__platform.html#ga6938af9075cec15c88299109381aa984">apr_off_t</a> offt;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">if</span> (!apr_strtoff(&amp;offt, agestr, &amp;endp, 10)</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                &amp;&amp; endp &gt; agestr &amp;&amp; !*endp) {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            age_c = offt;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">/* calculate age of object */</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    age = ap_cache_current_age(info, age_c, r-&gt;<a class="code" href="structrequest__rec.html#a2dadff0630a13ea1ccc2037356ffbb81">request_time</a>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">/* extract s-maxage */</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    smaxage = h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a>-&gt;<a class="code" href="structcache__object.html#ab4b2aae3e314dfa7abe8304c33cedb83">info</a>.<a class="code" href="structcache__info.html#ad13eba54e179bd5b57b7e97b219b3c67">control</a>.s_maxage_value;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">/* extract max-age from request */</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    maxage_req = -1;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">if</span> (!conf-&gt;<a class="code" href="structcache__server__conf.html#a2372aa3f5b681975bd629bb1c865735d">ignorecachecontrol</a>) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        maxage_req = cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.max_age_value;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">     * extract max-age from response, if both s-maxage and max-age, s-maxage</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">     * takes priority</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">if</span> (smaxage != -1) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        maxage_cresp = smaxage;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        maxage_cresp = h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a>-&gt;<a class="code" href="structcache__object.html#ab4b2aae3e314dfa7abe8304c33cedb83">info</a>.<a class="code" href="structcache__info.html#ad13eba54e179bd5b57b7e97b219b3c67">control</a>.max_age_value;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">     * if both maxage request and response, the smaller one takes priority</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> (maxage_req == -1) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        maxage = maxage_cresp;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (maxage_cresp == -1) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        maxage = maxage_req;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        maxage = <a class="code" href="group__Cache__util.html#ga3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(maxage_req, maxage_cresp);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">/* extract max-stale */</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.<a class="code" href="structcache__control.html#a86c0c3648dd91f6793e6150fc2fd2391">max_stale</a>) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.max_stale_value != -1) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            maxstale = cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.max_stale_value;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">             * If no value is assigned to max-stale, then the client is willing</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">             * to accept a stale response of any age (RFC2616 14.9.3). We will</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">             * set it to one year in this case as this situation is somewhat</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">             * similar to a &quot;never expires&quot; Expires header (RFC2616 14.21)</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">             * which is set to a date one year from the time the response is</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">             * sent in this case.</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            maxstale = <a class="code" href="group__apr__platform.html#gaae749817bb595cd5dcb9c17c119ddb13">APR_INT64_C</a>(86400*365);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        maxstale = 0;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">/* extract min-fresh */</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span> (!conf-&gt;<a class="code" href="structcache__server__conf.html#a2372aa3f5b681975bd629bb1c865735d">ignorecachecontrol</a> &amp;&amp; cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.<a class="code" href="structcache__control.html#aa2e69b28766eef731031b7b2d728273d">min_fresh</a>) {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        minfresh = cache-&gt;<a class="code" href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">control_in</a>.min_fresh_value;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        minfresh = 0;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">/* override maxstale if must-revalidate, proxy-revalidate or s-maxage */</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">if</span> (maxstale &amp;&amp; (h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a>-&gt;<a class="code" href="structcache__object.html#ab4b2aae3e314dfa7abe8304c33cedb83">info</a>.<a class="code" href="structcache__info.html#ad13eba54e179bd5b57b7e97b219b3c67">control</a>.must_revalidate</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            || h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a>-&gt;<a class="code" href="structcache__object.html#ab4b2aae3e314dfa7abe8304c33cedb83">info</a>.<a class="code" href="structcache__info.html#ad13eba54e179bd5b57b7e97b219b3c67">control</a>.proxy_revalidate || smaxage != -1)) {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        maxstale = 0;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">/* handle expiration */</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span> (((maxage != -1) &amp;&amp; (age &lt; (maxage + maxstale - minfresh))) ||</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        ((smaxage == -1) &amp;&amp; (maxage == -1) &amp;&amp;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;         (info-&gt;<a class="code" href="structcache__info.html#acad1125058221e40207cc515f294d474">expire</a> != <a class="code" href="group__APR__Util__Date.html#ga8be88b25f4b477ad13c4067c959411b0">APR_DATE_BAD</a>) &amp;&amp;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;         (age &lt; (<a class="code" href="group__apr__time.html#gae0237f70a9a3206b5263c0a474219476">apr_time_sec</a>(info-&gt;<a class="code" href="structcache__info.html#acad1125058221e40207cc515f294d474">expire</a> - info-&gt;<a class="code" href="structcache__info.html#a25cd61e421d08b30595f6373d230f95f">date</a>) + maxstale - minfresh)))) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        warn_head = apr_table_get(h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Warning&quot;</span>);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="comment">/* it&#39;s fresh darlings... */</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="comment">/* set age header on response */</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        apr_table_set(h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Age&quot;</span>,</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                      apr_psprintf(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, <span class="stringliteral">&quot;%lu&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)age));</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="comment">/* add warning if maxstale overrode freshness calculation */</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordflow">if</span> (!(((maxage != -1) &amp;&amp; age &lt; maxage) ||</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;              (info-&gt;<a class="code" href="structcache__info.html#acad1125058221e40207cc515f294d474">expire</a> != <a class="code" href="group__APR__Util__Date.html#ga8be88b25f4b477ad13c4067c959411b0">APR_DATE_BAD</a> &amp;&amp;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;               (<a class="code" href="group__apr__time.html#gae0237f70a9a3206b5263c0a474219476">apr_time_sec</a>(info-&gt;<a class="code" href="structcache__info.html#acad1125058221e40207cc515f294d474">expire</a> - info-&gt;<a class="code" href="structcache__info.html#a25cd61e421d08b30595f6373d230f95f">date</a>)) &gt; age))) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <span class="comment">/* make sure we don&#39;t stomp on a previous warning */</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="keywordflow">if</span> ((warn_head == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) ||</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                ((warn_head != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) &amp;&amp; (<a class="code" href="group__APACHE__CORE__DAEMON.html#ga48f6ba4ea178ad3a334403ec7206d7a3">ap_strstr_c</a>(warn_head, <span class="stringliteral">&quot;110&quot;</span>) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>))) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                apr_table_mergen(h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Warning&quot;</span>,</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                 <span class="stringliteral">&quot;110 Response is stale&quot;</span>);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">         * If none of Expires, Cache-Control: max-age, or Cache-Control:</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">         * s-maxage appears in the response, and the response header age</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">         * calculated is more than 24 hours add the warning 113</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">if</span> ((maxage_cresp == -1) &amp;&amp; (smaxage == -1) &amp;&amp; (apr_table_get(</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Expires&quot;</span>) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) &amp;&amp; (age &gt; 86400)) {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="comment">/* Make sure we don&#39;t stomp on a previous warning, and don&#39;t dup</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">             * a 113 marning that is already present. Also, make sure to add</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">             * the new warning to the correct *headers_out location.</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">if</span> ((warn_head == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) ||</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                ((warn_head != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) &amp;&amp; (<a class="code" href="group__APACHE__CORE__DAEMON.html#ga48f6ba4ea178ad3a334403ec7206d7a3">ap_strstr_c</a>(warn_head, <span class="stringliteral">&quot;113&quot;</span>) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>))) {</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                apr_table_mergen(h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Warning&quot;</span>,</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                 <span class="stringliteral">&quot;113 Heuristic expiration&quot;</span>);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">return</span> 1;    <span class="comment">/* Cache object is fresh (enough) */</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">     * At this point we are stale, but: if we are under load, we may let</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">     * a significant number of stale requests through before the first</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">     * stale request successfully revalidates itself, causing a sudden</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">     * unexpected thundering herd which in turn brings angst and drama.</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">     * So.</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">     * We want the first stale request to go through as normal. But the</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">     * second and subsequent request, we must pretend to be fresh until</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">     * the first request comes back with either new content or confirmation</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">     * that the stale content is still fresh.</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">     * To achieve this, we create a very simple file based lock based on</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">     * the key of the cached object. We attempt to open the lock file with</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">     * exclusive write access. If we succeed, woohoo! we&#39;re first, and we</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">     * follow the stale path to the backend server. If we fail, oh well,</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">     * we follow the fresh path, and avoid being a thundering herd.</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">     * The lock lives only as long as the stale request that went on ahead.</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">     * If the request succeeds, the lock is deleted. If the request fails,</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">     * the lock is deleted, and another request gets to make a new lock</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">     * and try again.</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">     * At any time, a request marked &quot;no-cache&quot; will force a refresh,</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">     * ignoring the lock, ensuring an extended lockout is impossible.</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">     * A lock that exceeds a maximum age will be deleted, and another</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">     * request gets to make a new lock and try again.</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    status = <a class="code" href="group__Cache__util.html#gaffa94dfea5098ffab89d1dc91e094415">cache_try_lock</a>(conf, cache, r);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a> == status) {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="comment">/* we obtained a lock, follow the stale path */</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, 0, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00782)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <span class="stringliteral">&quot;Cache lock obtained for stale cached URL, &quot;</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="stringliteral">&quot;revalidating entry: %s&quot;</span>,</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                r-&gt;<a class="code" href="structrequest__rec.html#a2c0077c30ea4446551ecee4e24ced868">unparsed_uri</a>);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__APR__STATUS__IS.html#ga37707a0f41b084f1ce1a13575f4f21db">APR_STATUS_IS_EEXIST</a>(status)) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="comment">/* lock already exists, return stale data anyway, with a warning */</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, status, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00783)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <span class="stringliteral">&quot;Cache already locked for stale cached URL, &quot;</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="stringliteral">&quot;pretend it is fresh: %s&quot;</span>,</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                r-&gt;<a class="code" href="structrequest__rec.html#a2c0077c30ea4446551ecee4e24ced868">unparsed_uri</a>);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="comment">/* make sure we don&#39;t stomp on a previous warning */</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        warn_head = apr_table_get(h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Warning&quot;</span>);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">if</span> ((warn_head == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) ||</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            ((warn_head != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) &amp;&amp; (<a class="code" href="group__APACHE__CORE__DAEMON.html#ga48f6ba4ea178ad3a334403ec7206d7a3">ap_strstr_c</a>(warn_head, <span class="stringliteral">&quot;110&quot;</span>) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>))) {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            apr_table_mergen(h-&gt;<a class="code" href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">resp_hdrs</a>, <span class="stringliteral">&quot;Warning&quot;</span>,</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                             <span class="stringliteral">&quot;110 Response is stale&quot;</span>);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        }</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="comment">/* some other error occurred, just treat the object as stale */</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, status, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00784)</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="stringliteral">&quot;Attempt to obtain a cache lock for stale &quot;</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="stringliteral">&quot;cached URL failed, revalidating entry anyway: %s&quot;</span>,</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                r-&gt;<a class="code" href="structrequest__rec.html#a2c0077c30ea4446551ecee4e24ced868">unparsed_uri</a>);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;}</div><div class="ttc" id="structcache__control_html_aa2e69b28766eef731031b7b2d728273d"><div class="ttname"><a href="structcache__control.html#aa2e69b28766eef731031b7b2d728273d">cache_control::min_fresh</a></div><div class="ttdeci">unsigned int min_fresh</div><div class="ttdef"><b>Definition:</b> cache_common.h:39</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga47fafbef7e478babdd92e90407f95b19"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga47fafbef7e478babdd92e90407f95b19">APLOG_INFO</a></div><div class="ttdeci">#define APLOG_INFO</div><div class="ttdef"><b>Definition:</b> http_log.h:49</div></div>
<div class="ttc" id="structcache__info_html_ad13eba54e179bd5b57b7e97b219b3c67"><div class="ttname"><a href="structcache__info.html#ad13eba54e179bd5b57b7e97b219b3c67">cache_info::control</a></div><div class="ttdeci">cache_control_t control</div><div class="ttdef"><b>Definition:</b> mod_cache.h:77</div></div>
<div class="ttc" id="structcache__control_html_a76e5095344c47d185ef638ba1b66f267"><div class="ttname"><a href="structcache__control.html#a76e5095344c47d185ef638ba1b66f267">cache_control::no_cache</a></div><div class="ttdeci">unsigned int no_cache</div><div class="ttdef"><b>Definition:</b> cache_common.h:34</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga655e126996849bcb82e4e5a14c616f4a"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a></div><div class="ttdeci">#define APLOG_MARK</div><div class="ttdef"><b>Definition:</b> http_log.h:283</div></div>
<div class="ttc" id="structrequest__rec_html_a4a8059930ce9409cb885fdeef6921b7b"><div class="ttname"><a href="structrequest__rec.html#a4a8059930ce9409cb885fdeef6921b7b">request_rec::server</a></div><div class="ttdeci">uintptr_t server</div><div class="ttdef"><b>Definition:</b> ap.d:5</div></div>
<div class="ttc" id="group__APACHE__CORE__HTTPD_html_ga6e27f49150e9a14580fb313cc2777e00"><div class="ttname"><a href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> http_core.h:277</div></div>
<div class="ttc" id="structcache__request__rec_html_aaea78b272eb05f1ba67a75bd6264b4df"><div class="ttname"><a href="structcache__request__rec.html#aaea78b272eb05f1ba67a75bd6264b4df">cache_request_rec::control_in</a></div><div class="ttdeci">cache_control_t control_in</div><div class="ttdef"><b>Definition:</b> cache_util.h:232</div></div>
<div class="ttc" id="structcache__server__conf_html_a2372aa3f5b681975bd629bb1c865735d"><div class="ttname"><a href="structcache__server__conf.html#a2372aa3f5b681975bd629bb1c865735d">cache_server_conf::ignorecachecontrol</a></div><div class="ttdeci">unsigned int ignorecachecontrol</div><div class="ttdef"><b>Definition:</b> cache_util.h:131</div></div>
<div class="ttc" id="group__APR__STATUS__IS_html_ga37707a0f41b084f1ce1a13575f4f21db"><div class="ttname"><a href="group__APR__STATUS__IS.html#ga37707a0f41b084f1ce1a13575f4f21db">APR_STATUS_IS_EEXIST</a></div><div class="ttdeci">#define APR_STATUS_IS_EEXIST(s)</div><div class="ttdef"><b>Definition:</b> apr_errno.h:1233</div></div>
<div class="ttc" id="group__apr__time_html_gae0237f70a9a3206b5263c0a474219476"><div class="ttname"><a href="group__apr__time.html#gae0237f70a9a3206b5263c0a474219476">apr_time_sec</a></div><div class="ttdeci">#define apr_time_sec(time)</div><div class="ttdef"><b>Definition:</b> apr_time.h:64</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga48f6ba4ea178ad3a334403ec7206d7a3"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga48f6ba4ea178ad3a334403ec7206d7a3">ap_strstr_c</a></div><div class="ttdeci">#define ap_strstr_c(s, c)</div><div class="ttdef"><b>Definition:</b> httpd.h:2252</div></div>
<div class="ttc" id="structcache__control_html_a86c0c3648dd91f6793e6150fc2fd2391"><div class="ttname"><a href="structcache__control.html#a86c0c3648dd91f6793e6150fc2fd2391">cache_control::max_stale</a></div><div class="ttdeci">unsigned int max_stale</div><div class="ttdef"><b>Definition:</b> cache_common.h:38</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_gadfcef90537539cf2b7d35cfbbbafeb93"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a></div><div class="ttdeci">#define APLOG_DEBUG</div><div class="ttdef"><b>Definition:</b> http_log.h:50</div></div>
<div class="ttc" id="mod__cache_8c_html_a315b551bc967794e90417b5538a128f1"><div class="ttname"><a href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a></div><div class="ttdeci">module AP_MODULE_DECLARE_DATA cache_module</div><div class="ttdef"><b>Definition:</b> mod_cache.c:22</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="structrequest__rec_html_a2c0077c30ea4446551ecee4e24ced868"><div class="ttname"><a href="structrequest__rec.html#a2c0077c30ea4446551ecee4e24ced868">request_rec::unparsed_uri</a></div><div class="ttdeci">char * unparsed_uri</div><div class="ttdef"><b>Definition:</b> ap.d:49</div></div>
<div class="ttc" id="group__apr__platform_html_gaae749817bb595cd5dcb9c17c119ddb13"><div class="ttname"><a href="group__apr__platform.html#gaae749817bb595cd5dcb9c17c119ddb13">APR_INT64_C</a></div><div class="ttdeci">#define APR_INT64_C(val)</div><div class="ttdef"><b>Definition:</b> apr.h:373</div></div>
<div class="ttc" id="group__apr__errno_html_gaa5105fa83cc322f09382292db8b47593"><div class="ttname"><a href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a></div><div class="ttdeci">int apr_status_t</div><div class="ttdef"><b>Definition:</b> apr_errno.h:44</div></div>
<div class="ttc" id="group__MOD__CACHE_html_ga22e3955e21c6e60450101eb1e3c6919b"><div class="ttname"><a href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b">ap_cache_control</a></div><div class="ttdeci">int ap_cache_control(request_rec *r, cache_control_t *cc, const char *cc_header, const char *pragma_header, apr_table_t *headers)</div><div class="ttdef"><b>Definition:</b> cache_util.c:1002</div></div>
<div class="ttc" id="group__AP__EXPR_html_gae5e165b68fbb12afc88707b8e6eb2f08"><div class="ttname"><a href="group__AP__EXPR.html#gae5e165b68fbb12afc88707b8e6eb2f08">info</a></div><div class="ttdeci">apr_pool_t ap_expr_info_t * info</div><div class="ttdef"><b>Definition:</b> ap_expr.h:312</div></div>
<div class="ttc" id="group__Cache__util_html_ga3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="group__Cache__util.html#ga3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition:</b> cache_util.h:82</div></div>
<div class="ttc" id="group__apr__time_html_gadb4bde16055748190eae190c55aa02bb"><div class="ttname"><a href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a></div><div class="ttdeci">apr_int64_t apr_time_t</div><div class="ttdef"><b>Definition:</b> apr_time.h:46</div></div>
<div class="ttc" id="structcache__handle_html_aea71e9fd166a32e0fe46a12668a1f3bd"><div class="ttname"><a href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_handle::cache_obj</a></div><div class="ttdeci">cache_object_t * cache_obj</div><div class="ttdef"><b>Definition:</b> mod_cache.h:92</div></div>
<div class="ttc" id="group__Cache__util_html_gaffa94dfea5098ffab89d1dc91e094415"><div class="ttname"><a href="group__Cache__util.html#gaffa94dfea5098ffab89d1dc91e094415">cache_try_lock</a></div><div class="ttdeci">apr_status_t cache_try_lock(cache_server_conf *conf, cache_request_rec *cache, request_rec *r)</div><div class="ttdef"><b>Definition:</b> cache_util.c:279</div></div>
<div class="ttc" id="structrequest__rec_html_a2dadff0630a13ea1ccc2037356ffbb81"><div class="ttname"><a href="structrequest__rec.html#a2dadff0630a13ea1ccc2037356ffbb81">request_rec::request_time</a></div><div class="ttdeci">int64_t request_time</div><div class="ttdef"><b>Definition:</b> ap.d:16</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga1093a5908a384eacc929b028c79f2a02"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a></div><div class="ttdeci">#define ap_get_module_config(v, m)</div><div class="ttdef"><b>Definition:</b> http_config.h:531</div></div>
<div class="ttc" id="structcache__info_html"><div class="ttname"><a href="structcache__info.html">cache_info</a></div><div class="ttdef"><b>Definition:</b> mod_cache.h:59</div></div>
<div class="ttc" id="structcache__info_html_a25cd61e421d08b30595f6373d230f95f"><div class="ttname"><a href="structcache__info.html#a25cd61e421d08b30595f6373d230f95f">cache_info::date</a></div><div class="ttdeci">apr_time_t date</div><div class="ttdef"><b>Definition:</b> mod_cache.h:64</div></div>
<div class="ttc" id="structcache__object_html_ab4b2aae3e314dfa7abe8304c33cedb83"><div class="ttname"><a href="structcache__object.html#ab4b2aae3e314dfa7abe8304c33cedb83">cache_object::info</a></div><div class="ttdeci">cache_info info</div><div class="ttdef"><b>Definition:</b> mod_cache.h:85</div></div>
<div class="ttc" id="group__APACHE__CORE__HTTPD_html_ga7be6dfd9155648f64d6e9abcd78c38cd"><div class="ttname"><a href="group__APACHE__CORE__HTTPD.html#ga7be6dfd9155648f64d6e9abcd78c38cd">conf</a></div><div class="ttdeci">core_dir_config * conf</div><div class="ttdef"><b>Definition:</b> http_core.h:755</div></div>
<div class="ttc" id="structcache__handle_html_a66c4c1875bb9740d34ddda4d3e71065e"><div class="ttname"><a href="structcache__handle.html#a66c4c1875bb9740d34ddda4d3e71065e">cache_handle::resp_hdrs</a></div><div class="ttdeci">apr_table_t * resp_hdrs</div><div class="ttdef"><b>Definition:</b> mod_cache.h:94</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga4c112558ccffd6b363da102b2052d2a6"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a></div><div class="ttdeci">#define ap_log_rerror</div><div class="ttdef"><b>Definition:</b> http_log.h:454</div></div>
<div class="ttc" id="group__APR__Util__Date_html_ga8be88b25f4b477ad13c4067c959411b0"><div class="ttname"><a href="group__APR__Util__Date.html#ga8be88b25f4b477ad13c4067c959411b0">APR_DATE_BAD</a></div><div class="ttdeci">#define APR_DATE_BAD</div><div class="ttdef"><b>Definition:</b> apr_date.h:43</div></div>
<div class="ttc" id="group__APACHE__CORE__COOKIE_html_ga846f24530366d967942121cbfdca1ea7"><div class="ttname"><a href="group__APACHE__CORE__COOKIE.html#ga846f24530366d967942121cbfdca1ea7">maxage</a></div><div class="ttdeci">const char const char const char long maxage</div><div class="ttdef"><b>Definition:</b> util_cookies.h:68</div></div>
<div class="ttc" id="group__apr__platform_html_ga4b75afbf973dc6c8aea4ae75b044aa08"><div class="ttname"><a href="group__apr__platform.html#ga4b75afbf973dc6c8aea4ae75b044aa08">apr_int64_t</a></div><div class="ttdeci">long apr_int64_t</div><div class="ttdef"><b>Definition:</b> apr.h:353</div></div>
<div class="ttc" id="structcache__server__conf_html"><div class="ttname"><a href="structcache__server__conf.html">cache_server_conf</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:120</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
<div class="ttc" id="structrequest__rec_html_a5497da6c01af49acf70a4a9b975c1c83"><div class="ttname"><a href="structrequest__rec.html#a5497da6c01af49acf70a4a9b975c1c83">request_rec::headers_in</a></div><div class="ttdeci">uintptr_t headers_in</div><div class="ttdef"><b>Definition:</b> ap.d:35</div></div>
<div class="ttc" id="group__apr__errno_html_ga9ee311b7bf1c691dc521d721339ee2a6"><div class="ttname"><a href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a></div><div class="ttdeci">#define APR_SUCCESS</div><div class="ttdef"><b>Definition:</b> apr_errno.h:225</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga1dee8a07e06bc5b3de8b89662c2cd666"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a></div><div class="ttdeci">#define APLOGNO(n)</div><div class="ttdef"><b>Definition:</b> http_log.h:117</div></div>
<div class="ttc" id="group__apr__platform_html_ga6938af9075cec15c88299109381aa984"><div class="ttname"><a href="group__apr__platform.html#ga6938af9075cec15c88299109381aa984">apr_off_t</a></div><div class="ttdeci">off_t apr_off_t</div><div class="ttdef"><b>Definition:</b> apr.h:359</div></div>
<div class="ttc" id="structcache__info_html_acad1125058221e40207cc515f294d474"><div class="ttname"><a href="structcache__info.html#acad1125058221e40207cc515f294d474">cache_info::expire</a></div><div class="ttdeci">apr_time_t expire</div><div class="ttdef"><b>Definition:</b> mod_cache.h:66</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_ga8719ff14e3ad87c32614da9fc10cb119_cgraph.png" border="0" usemap="#group__Cache__util_ga8719ff14e3ad87c32614da9fc10cb119_cgraph" alt=""/></div>
<map name="group__Cache__util_ga8719ff14e3ad87c32614da9fc10cb119_cgraph" id="group__Cache__util_ga8719ff14e3ad87c32614da9fc10cb119_cgraph">
<area shape="rect" id="node2" href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b" title="ap_cache_control" alt="" coords="216,71,340,98"/>
<area shape="rect" id="node5" href="group__Cache__util.html#gaffa94dfea5098ffab89d1dc91e094415" title="cache_try_lock" alt="" coords="223,122,333,149"/>
<area shape="rect" id="node3" href="structcache__control.html#ab54624480acafa695556a98b70938413" title="cache_control::cache\l_control" alt="" coords="395,5,541,47"/>
<area shape="rect" id="node4" href="group__Cache__util.html#gada03570414af2b2d9349449858036d90" title="cache_strqtok" alt="" coords="416,71,520,98"/>
<area shape="rect" id="node6" href="dir__make__recurse_8c.html#a6a3b2602f57ff148cd64096da02adbd2" title="apr_dir_make_recursive" alt="" coords="388,122,548,149"/>
<area shape="rect" id="node7" href="unix_2dir_8c.html#a51e0b4703c7561f72587982808985d29" title="apr_dir_make" alt="" coords="596,122,696,149"/>
<area shape="rect" id="node8" href="unix_2fileacc_8c.html#a6ff1e968d4350cb1184ec6ed57ac3902" title="apr_unix_perms2mode" alt="" coords="744,122,897,149"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_ga8719ff14e3ad87c32614da9fc10cb119_icgraph.png" border="0" usemap="#group__Cache__util_ga8719ff14e3ad87c32614da9fc10cb119_icgraph" alt=""/></div>
<map name="group__Cache__util_ga8719ff14e3ad87c32614da9fc10cb119_icgraph" id="group__Cache__util_ga8719ff14e3ad87c32614da9fc10cb119_icgraph">
<area shape="rect" id="node2" href="group__Cache__storage.html#gaffb29f2e1276bc7d81bac540a1cf3e06" title="cache_select" alt="" coords="216,5,315,32"/>
<area shape="rect" id="node3" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="363,5,553,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga3bb0227007e96351ef9b155cd0720abb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcache__provider__list.html">cache_provider_list</a>* cache_get_providers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__server__conf.html">cache_server_conf</a> *&#160;</td>
          <td class="paramname"><em>conf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="structcache__dir__conf.html">cache_dir_conf</a> *<a class="code" href="group__MOD__PROXY.html#ga01226e8c588429d47a24e72bda63a5e3">dconf</a> = <a class="code" href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a>(r-&gt;<a class="code" href="structrequest__rec.html#a0935ac19a61c462c8986898b4c30547d">per_dir_config</a>, &amp;<a class="code" href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="structcache__provider__list.html">cache_provider_list</a> *providers = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__APACHE__CORE__CONFIG.html#gab559cff0ba49c0f92a0dc777d5730496">path</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">/* per directory cache disable */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> (dconf-&gt;<a class="code" href="structcache__dir__conf.html#aff0b731349364c6d71d77508f1d2f3f1">disable</a>) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    path = <a class="code" href="group__Cache__util.html#gaea2f7fee82fd07fce89934bee0939987">cache_use_early_url</a>(r) ? r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>.<a class="code" href="structapr__uri__t.html#a61cff1baadb3c1b52a34b502c25bba7f">path</a> : r-&gt;<a class="code" href="structrequest__rec.html#aee240e90eac55c732891e9408543990b">uri</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">/* global cache disable */</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; conf-&gt;<a class="code" href="structcache__server__conf.html#a5cb017668213d1850a5b145f111ae4d1">cachedisable</a>-&gt;<a class="code" href="structapr__array__header__t.html#ab11b88220885c5a0920a06ac85680055">nelts</a>; i++) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keyword">struct </span><a class="code" href="structcache__disable.html">cache_disable</a> *<a class="code" href="structent.html">ent</a> =</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                               (<span class="keyword">struct </span><a class="code" href="structcache__disable.html">cache_disable</a> *)conf-&gt;<a class="code" href="structcache__server__conf.html#a5cb017668213d1850a5b145f111ae4d1">cachedisable</a>-&gt;<a class="code" href="structapr__array__header__t.html#af8462fa2a1ddf6406c66cd3dd441a269">elts</a>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="util__expr__scan_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a> (uri_meets_conditions(&amp;ent[i].<a class="code" href="group__MOD__PROXY.html#ga05d2db9f2dd75d18170f192bd1cc9b4e">url</a>, ent[i].<a class="code" href="structcache__disable.html#ad7ba683fd82f0243459781622258323c">pathlen</a>,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                 &amp;r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>, path)) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="comment">/* Stop searching now. */</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">/* loop through all the per directory cacheenable entries */</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; dconf-&gt;<a class="code" href="structcache__dir__conf.html#a12a954532411f0c7534f8b1d77e433f4">cacheenable</a>-&gt;<a class="code" href="structapr__array__header__t.html#ab11b88220885c5a0920a06ac85680055">nelts</a>; i++) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keyword">struct </span><a class="code" href="structcache__enable.html">cache_enable</a> *ent =</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                (<span class="keyword">struct </span><a class="code" href="structcache__enable.html">cache_enable</a> *)dconf-&gt;<a class="code" href="structcache__dir__conf.html#a12a954532411f0c7534f8b1d77e433f4">cacheenable</a>-&gt;<a class="code" href="structapr__array__header__t.html#af8462fa2a1ddf6406c66cd3dd441a269">elts</a>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        providers = get_provider(r, &amp;ent[i], providers);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">/* loop through all the global cacheenable entries */</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; conf-&gt;<a class="code" href="structcache__server__conf.html#aaa7a7b0ab522f181bde5376c2673a9b4">cacheenable</a>-&gt;<a class="code" href="structapr__array__header__t.html#ab11b88220885c5a0920a06ac85680055">nelts</a>; i++) {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keyword">struct </span><a class="code" href="structcache__enable.html">cache_enable</a> *ent =</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                (<span class="keyword">struct </span><a class="code" href="structcache__enable.html">cache_enable</a> *)conf-&gt;<a class="code" href="structcache__server__conf.html#aaa7a7b0ab522f181bde5376c2673a9b4">cacheenable</a>-&gt;<a class="code" href="structapr__array__header__t.html#af8462fa2a1ddf6406c66cd3dd441a269">elts</a>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="util__expr__scan_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a> (uri_meets_conditions(&amp;ent[i].<a class="code" href="group__MOD__PROXY.html#ga05d2db9f2dd75d18170f192bd1cc9b4e">url</a>, ent[i].<a class="code" href="structcache__enable.html#adce5084f188b489662db5aebcc678803">pathlen</a>,</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                 &amp;r-&gt;<a class="code" href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">parsed_uri</a>, path)) {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            providers = get_provider(r, &amp;ent[i], providers);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">return</span> providers;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div><div class="ttc" id="structrequest__rec_html_a778f7883e201095a1d914ab7422635eb"><div class="ttname"><a href="structrequest__rec.html#a778f7883e201095a1d914ab7422635eb">request_rec::parsed_uri</a></div><div class="ttdeci">apr_uri_t parsed_uri</div><div class="ttdef"><b>Definition:</b> httpd.h:1038</div></div>
<div class="ttc" id="structcache__disable_html_ad7ba683fd82f0243459781622258323c"><div class="ttname"><a href="structcache__disable.html#ad7ba683fd82f0243459781622258323c">cache_disable::pathlen</a></div><div class="ttdeci">apr_size_t pathlen</div><div class="ttdef"><b>Definition:</b> cache_util.h:116</div></div>
<div class="ttc" id="mod__cache_8c_html_a315b551bc967794e90417b5538a128f1"><div class="ttname"><a href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a></div><div class="ttdeci">module AP_MODULE_DECLARE_DATA cache_module</div><div class="ttdef"><b>Definition:</b> mod_cache.c:22</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_gab559cff0ba49c0f92a0dc777d5730496"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#gab559cff0ba49c0f92a0dc777d5730496">path</a></div><div class="ttdeci">request_rec int int apr_table_t const char * path</div><div class="ttdef"><b>Definition:</b> http_config.h:1123</div></div>
<div class="ttc" id="structcache__enable_html_adce5084f188b489662db5aebcc678803"><div class="ttname"><a href="structcache__enable.html#adce5084f188b489662db5aebcc678803">cache_enable::pathlen</a></div><div class="ttdeci">apr_size_t pathlen</div><div class="ttdef"><b>Definition:</b> cache_util.h:111</div></div>
<div class="ttc" id="group__MOD__PROXY_html_ga38403a0592eb8018a3ad61aef0f7ca2c"><div class="ttname"><a href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a></div><div class="ttdeci">proxy_worker_shared int i</div><div class="ttdef"><b>Definition:</b> mod_proxy.h:718</div></div>
<div class="ttc" id="structcache__provider__list_html"><div class="ttname"><a href="structcache__provider__list.html">cache_provider_list</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:203</div></div>
<div class="ttc" id="structapr__array__header__t_html_ab11b88220885c5a0920a06ac85680055"><div class="ttname"><a href="structapr__array__header__t.html#ab11b88220885c5a0920a06ac85680055">apr_array_header_t::nelts</a></div><div class="ttdeci">int nelts</div><div class="ttdef"><b>Definition:</b> apr_tables.h:68</div></div>
<div class="ttc" id="util__expr__scan_8c_html_a33e91cd0cef6786e9e3a27ac67707207"><div class="ttname"><a href="util__expr__scan_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a></div><div class="ttdeci">if(!yyg-&gt;yy_init)</div><div class="ttdef"><b>Definition:</b> util_expr_scan.c:873</div></div>
<div class="ttc" id="structent_html"><div class="ttname"><a href="structent.html">ent</a></div><div class="ttdef"><b>Definition:</b> mod_autoindex.c:748</div></div>
<div class="ttc" id="structcache__enable_html"><div class="ttname"><a href="structcache__enable.html">cache_enable</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:108</div></div>
<div class="ttc" id="structcache__disable_html"><div class="ttname"><a href="structcache__disable.html">cache_disable</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:114</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga1093a5908a384eacc929b028c79f2a02"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a></div><div class="ttdeci">#define ap_get_module_config(v, m)</div><div class="ttdef"><b>Definition:</b> http_config.h:531</div></div>
<div class="ttc" id="group__MOD__PROXY_html_ga01226e8c588429d47a24e72bda63a5e3"><div class="ttname"><a href="group__MOD__PROXY.html#ga01226e8c588429d47a24e72bda63a5e3">dconf</a></div><div class="ttdeci">struct proxy_alias proxy_dir_conf * dconf</div><div class="ttdef"><b>Definition:</b> mod_proxy.h:1058</div></div>
<div class="ttc" id="structcache__dir__conf_html_a12a954532411f0c7534f8b1d77e433f4"><div class="ttname"><a href="structcache__dir__conf.html#a12a954532411f0c7534f8b1d77e433f4">cache_dir_conf::cacheenable</a></div><div class="ttdeci">apr_array_header_t * cacheenable</div><div class="ttdef"><b>Definition:</b> cache_util.h:169</div></div>
<div class="ttc" id="structcache__dir__conf_html_aff0b731349364c6d71d77508f1d2f3f1"><div class="ttname"><a href="structcache__dir__conf.html#aff0b731349364c6d71d77508f1d2f3f1">cache_dir_conf::disable</a></div><div class="ttdeci">unsigned int disable</div><div class="ttdef"><b>Definition:</b> cache_util.h:171</div></div>
<div class="ttc" id="structcache__server__conf_html_aaa7a7b0ab522f181bde5376c2673a9b4"><div class="ttname"><a href="structcache__server__conf.html#aaa7a7b0ab522f181bde5376c2673a9b4">cache_server_conf::cacheenable</a></div><div class="ttdeci">apr_array_header_t * cacheenable</div><div class="ttdef"><b>Definition:</b> cache_util.h:121</div></div>
<div class="ttc" id="structcache__dir__conf_html"><div class="ttname"><a href="structcache__dir__conf.html">cache_dir_conf</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:159</div></div>
<div class="ttc" id="group__MOD__PROXY_html_ga05d2db9f2dd75d18170f192bd1cc9b4e"><div class="ttname"><a href="group__MOD__PROXY.html#ga05d2db9f2dd75d18170f192bd1cc9b4e">url</a></div><div class="ttdeci">proxy_dir_conf const char * url</div><div class="ttdef"><b>Definition:</b> mod_proxy.h:650</div></div>
<div class="ttc" id="structapr__uri__t_html_a61cff1baadb3c1b52a34b502c25bba7f"><div class="ttname"><a href="structapr__uri__t.html#a61cff1baadb3c1b52a34b502c25bba7f">apr_uri_t::path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> apr_uri.h:99</div></div>
<div class="ttc" id="structapr__array__header__t_html_af8462fa2a1ddf6406c66cd3dd441a269"><div class="ttname"><a href="structapr__array__header__t.html#af8462fa2a1ddf6406c66cd3dd441a269">apr_array_header_t::elts</a></div><div class="ttdeci">char * elts</div><div class="ttdef"><b>Definition:</b> apr_tables.h:72</div></div>
<div class="ttc" id="structrequest__rec_html_aee240e90eac55c732891e9408543990b"><div class="ttname"><a href="structrequest__rec.html#aee240e90eac55c732891e9408543990b">request_rec::uri</a></div><div class="ttdeci">char * uri</div><div class="ttdef"><b>Definition:</b> ap.d:50</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
<div class="ttc" id="structrequest__rec_html_a0935ac19a61c462c8986898b4c30547d"><div class="ttname"><a href="structrequest__rec.html#a0935ac19a61c462c8986898b4c30547d">request_rec::per_dir_config</a></div><div class="ttdeci">uintptr_t per_dir_config</div><div class="ttdef"><b>Definition:</b> ap.d:91</div></div>
<div class="ttc" id="group__Cache__util_html_gaea2f7fee82fd07fce89934bee0939987"><div class="ttname"><a href="group__Cache__util.html#gaea2f7fee82fd07fce89934bee0939987">cache_use_early_url</a></div><div class="ttdeci">int cache_use_early_url(request_rec *r)</div><div class="ttdef"><b>Definition:</b> cache_util.c:130</div></div>
<div class="ttc" id="structcache__server__conf_html_a5cb017668213d1850a5b145f111ae4d1"><div class="ttname"><a href="structcache__server__conf.html#a5cb017668213d1850a5b145f111ae4d1">cache_server_conf::cachedisable</a></div><div class="ttdeci">apr_array_header_t * cachedisable</div><div class="ttdef"><b>Definition:</b> cache_util.h:122</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_ga3bb0227007e96351ef9b155cd0720abb_cgraph.png" border="0" usemap="#group__Cache__util_ga3bb0227007e96351ef9b155cd0720abb_cgraph" alt=""/></div>
<map name="group__Cache__util_ga3bb0227007e96351ef9b155cd0720abb_cgraph" id="group__Cache__util_ga3bb0227007e96351ef9b155cd0720abb_cgraph">
<area shape="rect" id="node2" href="group__Cache__util.html#gaea2f7fee82fd07fce89934bee0939987" title="cache_use_early_url" alt="" coords="196,5,337,32"/>
<area shape="rect" id="node3" href="util__expr__scan_8c.html#a33e91cd0cef6786e9e3a27ac67707207" title="if" alt="" coords="247,56,286,83"/>
<area shape="rect" id="node4" href="util__expr__scan_8c.html#a073e30a44c0e142fe3d3a1f87bbf6c5e" title="ap_expr_yy_create_buffer" alt="" coords="385,56,557,83"/>
<area shape="rect" id="node5" href="util__expr__scan_8c.html#a3dd61ae214da108171a1bc60b87291d0" title="ap_expr_yyalloc" alt="" coords="605,56,721,83"/>
<area shape="rect" id="node6" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6" title="void" alt="" coords="776,31,823,57"/>
<area shape="rect" id="node7" href="util__expr__parse_8c.html#a5faf6a2d99f50a4655dd390199a8db7b" title="malloc" alt="" coords="769,81,829,108"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_ga3bb0227007e96351ef9b155cd0720abb_icgraph.png" border="0" usemap="#group__Cache__util_ga3bb0227007e96351ef9b155cd0720abb_icgraph" alt=""/></div>
<map name="group__Cache__util_ga3bb0227007e96351ef9b155cd0720abb_icgraph" id="group__Cache__util_ga3bb0227007e96351ef9b155cd0720abb_icgraph">
<area shape="rect" id="node2" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="196,5,387,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga81c4df4762c014811f81be66e236f62b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structapr__table__t.html">apr_table_t</a>* cache_merge_headers_out </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Merge err_headers_out into headers_out and add request's Content-Type and Content-Encoding if available. </p>
<div class="fragment"><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;{</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <a class="code" href="structapr__table__t.html">apr_table_t</a> *headers_out;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    headers_out = apr_table_overlay(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, r-&gt;<a class="code" href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">headers_out</a>,</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                    r-&gt;<a class="code" href="structrequest__rec.html#a691d46e2e4fcf604394aeda5cc6e21e2">err_headers_out</a>);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structrequest__rec.html#a539f8aba497328ed3e9c4628b0b7b4b0">content_type</a></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            &amp;&amp; !apr_table_get(headers_out, <span class="stringliteral">&quot;Content-Type&quot;</span>)) {</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *ctype = ap_make_content_type(r, r-&gt;<a class="code" href="structrequest__rec.html#a539f8aba497328ed3e9c4628b0b7b4b0">content_type</a>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">if</span> (ctype) {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            apr_table_setn(headers_out, <span class="stringliteral">&quot;Content-Type&quot;</span>, ctype);</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        }</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    }</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structrequest__rec.html#aa90257968ba3fbed2c21de67fdb3cf02">content_encoding</a></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            &amp;&amp; !apr_table_get(headers_out, <span class="stringliteral">&quot;Content-Encoding&quot;</span>)) {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        apr_table_setn(headers_out, <span class="stringliteral">&quot;Content-Encoding&quot;</span>,</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                       r-&gt;<a class="code" href="structrequest__rec.html#aa90257968ba3fbed2c21de67fdb3cf02">content_encoding</a>);</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    }</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordflow">return</span> headers_out;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;}</div><div class="ttc" id="structrequest__rec_html_a691d46e2e4fcf604394aeda5cc6e21e2"><div class="ttname"><a href="structrequest__rec.html#a691d46e2e4fcf604394aeda5cc6e21e2">request_rec::err_headers_out</a></div><div class="ttdeci">uintptr_t err_headers_out</div><div class="ttdef"><b>Definition:</b> ap.d:37</div></div>
<div class="ttc" id="structrequest__rec_html_aa90257968ba3fbed2c21de67fdb3cf02"><div class="ttname"><a href="structrequest__rec.html#aa90257968ba3fbed2c21de67fdb3cf02">request_rec::content_encoding</a></div><div class="ttdeci">char * content_encoding</div><div class="ttdef"><b>Definition:</b> ap.d:42</div></div>
<div class="ttc" id="structrequest__rec_html_a539f8aba497328ed3e9c4628b0b7b4b0"><div class="ttname"><a href="structrequest__rec.html#a539f8aba497328ed3e9c4628b0b7b4b0">request_rec::content_type</a></div><div class="ttdeci">char * content_type</div><div class="ttdef"><b>Definition:</b> ap.d:40</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="structrequest__rec_html_a0fd560d8d1118304dc33df8ee99efc04"><div class="ttname"><a href="structrequest__rec.html#a0fd560d8d1118304dc33df8ee99efc04">request_rec::headers_out</a></div><div class="ttdeci">uintptr_t headers_out</div><div class="ttdef"><b>Definition:</b> ap.d:36</div></div>
<div class="ttc" id="structapr__table__t_html"><div class="ttname"><a href="structapr__table__t.html">apr_table_t</a></div><div class="ttdef"><b>Definition:</b> apr_tables.c:332</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_ga81c4df4762c014811f81be66e236f62b_icgraph.png" border="0" usemap="#group__Cache__util_ga81c4df4762c014811f81be66e236f62b_icgraph" alt=""/></div>
<map name="group__Cache__util_ga81c4df4762c014811f81be66e236f62b_icgraph" id="group__Cache__util_ga81c4df4762c014811f81be66e236f62b_icgraph">
<area shape="rect" id="node2" href="cache__util_8c.html#gafeaa7620641e0072e420fec575619f85" title="CACHE_DECLARE" alt="" coords="257,5,398,32"/>
<area shape="rect" id="node3" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="232,56,423,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga6936350ce1acc1f19e336eb95be153fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a> cache_remove_lock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__server__conf.html">cache_server_conf</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__request__rec.html">cache_request_rec</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapr__bucket__brigade.html">apr_bucket_brigade</a> *&#160;</td>
          <td class="paramname"><em>bb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove the cache lock, if present.</p>
<p>First, try to close the file handle, whose delete-on-close should kill the file. Otherwise, just delete the file by name.</p>
<p>If no lock name has yet been calculated, do the calculation of the lock name first before trying to delete the file.</p>
<p>If an optional bucket brigade is passed, the lock will only be removed if the bucket brigade contains an EOS bucket. </p>
<div class="fragment"><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="group__APACHE__CORE__LISTEN.html#gafd856f29d11272d954fe05b9c1ca84dd">dummy</a>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *lockname;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">if</span> (!conf || !conf-&gt;<a class="code" href="structcache__server__conf.html#ab459a77dbc1bbba26a954336d34d136e">lock</a> || !conf-&gt;<a class="code" href="structcache__server__conf.html#ab8f9316567111d3366fcc1edfaf0bc8c">lockpath</a>) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment">/* no locks configured, leave */</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (bb) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <a class="code" href="structapr__bucket.html">apr_bucket</a> *<a class="code" href="group__APR__Util__Bucket__Brigades.html#gacd90314acb2c2e5cd19681136c08efac">e</a>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordtype">int</span> eos_found = 0;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">for</span> (e = <a class="code" href="group__APR__Util__Bucket__Brigades.html#gab5826a11eb6ba90786a94282f806c230">APR_BRIGADE_FIRST</a>(bb);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;             e != <a class="code" href="group__APR__Util__Bucket__Brigades.html#ga858da66dccab1e063415678bb115788a">APR_BRIGADE_SENTINEL</a>(bb);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;             e = <a class="code" href="group__APR__Util__Bucket__Brigades.html#ga7171f690b203d548a5b6ae0b079068d8">APR_BUCKET_NEXT</a>(e))</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__APR__Util__Bucket__Brigades.html#ga89b225e1c08473766eec719b985ca0d6">APR_BUCKET_IS_EOS</a>(e)) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                eos_found = 1;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">if</span> (!eos_found) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment">/* no eos found in brigade, don&#39;t delete anything just yet,</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">             * we are not done.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    apr_pool_userdata_get(&amp;dummy, <a class="code" href="group__Cache__util.html#ga18f46c3a4173d016f51fce82d596fec7">CACHE_LOCKFILE_KEY</a>, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (dummy) {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">return</span> apr_file_close((<a class="code" href="structapr__file__t.html">apr_file_t</a> *)dummy);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    apr_pool_userdata_get(&amp;dummy, <a class="code" href="group__Cache__util.html#gaa55455b9316bd74826d36a89914580b8">CACHE_LOCKNAME_KEY</a>, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    lockname = (<span class="keyword">const</span> <span class="keywordtype">char</span> *)dummy;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> (!lockname) {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordtype">char</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d902c83b02c43071b972ed0416729bc">dir</a>[5];</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">/* create the key if it doesn&#39;t exist */</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            cache_generate_key(r, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, &amp;cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">/* create a hashed filename from the key, and save it for later */</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        lockname = ap_cache_generate_name(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, 0, 0, cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">/* lock files represent discrete just-went-stale URLs &quot;in flight&quot;, so</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">         * we support a simple two level directory structure, more is overkill.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        dir[0] = <span class="charliteral">&#39;/&#39;</span>;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        dir[1] = lockname[0];</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        dir[2] = <span class="charliteral">&#39;/&#39;</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        dir[3] = lockname[1];</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        dir[4] = 0;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        lockname = apr_pstrcat(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, conf-&gt;<a class="code" href="structcache__server__conf.html#ab8f9316567111d3366fcc1edfaf0bc8c">lockpath</a>, dir, <span class="stringliteral">&quot;/&quot;</span>, lockname, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">return</span> apr_file_remove(lockname, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__LISTEN_html_gafd856f29d11272d954fe05b9c1ca84dd"><div class="ttname"><a href="group__APACHE__CORE__LISTEN.html#gafd856f29d11272d954fe05b9c1ca84dd">dummy</a></div><div class="ttdeci">void * dummy</div><div class="ttdef"><b>Definition:</b> ap_listen.h:136</div></div>
<div class="ttc" id="structcache__server__conf_html_ab8f9316567111d3366fcc1edfaf0bc8c"><div class="ttname"><a href="structcache__server__conf.html#ab8f9316567111d3366fcc1edfaf0bc8c">cache_server_conf::lockpath</a></div><div class="ttdeci">const char * lockpath</div><div class="ttdef"><b>Definition:</b> cache_util.h:127</div></div>
<div class="ttc" id="structapr__file__t_html"><div class="ttname"><a href="structapr__file__t.html">apr_file_t</a></div><div class="ttdef"><b>Definition:</b> apr_arch_file_io.h:97</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="group__Cache__util_html_ga18f46c3a4173d016f51fce82d596fec7"><div class="ttname"><a href="group__Cache__util.html#ga18f46c3a4173d016f51fce82d596fec7">CACHE_LOCKFILE_KEY</a></div><div class="ttdeci">#define CACHE_LOCKFILE_KEY</div><div class="ttdef"><b>Definition:</b> cache_util.h:100</div></div>
<div class="ttc" id="group__Cache__util_html_gaa55455b9316bd74826d36a89914580b8"><div class="ttname"><a href="group__Cache__util.html#gaa55455b9316bd74826d36a89914580b8">CACHE_LOCKNAME_KEY</a></div><div class="ttdeci">#define CACHE_LOCKNAME_KEY</div><div class="ttdef"><b>Definition:</b> cache_util.h:99</div></div>
<div class="ttc" id="structapr__bucket_html"><div class="ttname"><a href="structapr__bucket.html">apr_bucket</a></div><div class="ttdef"><b>Definition:</b> apr_buckets.h:224</div></div>
<div class="ttc" id="structcache__server__conf_html_ab459a77dbc1bbba26a954336d34d136e"><div class="ttname"><a href="structcache__server__conf.html#ab459a77dbc1bbba26a954336d34d136e">cache_server_conf::lock</a></div><div class="ttdeci">unsigned int lock</div><div class="ttdef"><b>Definition:</b> cache_util.h:137</div></div>
<div class="ttc" id="structcache__request__rec_html_a564726b5f7e5dc4fee2fb01d178677b4"><div class="ttname"><a href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">cache_request_rec::key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> cache_util.h:227</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga6d902c83b02c43071b972ed0416729bc"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga6d902c83b02c43071b972ed0416729bc">dir</a></div><div class="ttdeci">const char * dir</div><div class="ttdef"><b>Definition:</b> httpd.h:1848</div></div>
<div class="ttc" id="group__APR__Util__Bucket__Brigades_html_ga89b225e1c08473766eec719b985ca0d6"><div class="ttname"><a href="group__APR__Util__Bucket__Brigades.html#ga89b225e1c08473766eec719b985ca0d6">APR_BUCKET_IS_EOS</a></div><div class="ttdeci">#define APR_BUCKET_IS_EOS(e)</div><div class="ttdef"><b>Definition:</b> apr_buckets.h:461</div></div>
<div class="ttc" id="group__APR__Util__Bucket__Brigades_html_ga7171f690b203d548a5b6ae0b079068d8"><div class="ttname"><a href="group__APR__Util__Bucket__Brigades.html#ga7171f690b203d548a5b6ae0b079068d8">APR_BUCKET_NEXT</a></div><div class="ttdeci">#define APR_BUCKET_NEXT(e)</div><div class="ttdef"><b>Definition:</b> apr_buckets.h:422</div></div>
<div class="ttc" id="group__APR__Util__Bucket__Brigades_html_gab5826a11eb6ba90786a94282f806c230"><div class="ttname"><a href="group__APR__Util__Bucket__Brigades.html#gab5826a11eb6ba90786a94282f806c230">APR_BRIGADE_FIRST</a></div><div class="ttdeci">#define APR_BRIGADE_FIRST(b)</div><div class="ttdef"><b>Definition:</b> apr_buckets.h:345</div></div>
<div class="ttc" id="group__APR__Util__Bucket__Brigades_html_gacd90314acb2c2e5cd19681136c08efac"><div class="ttname"><a href="group__APR__Util__Bucket__Brigades.html#gacd90314acb2c2e5cd19681136c08efac">e</a></div><div class="ttdeci">apr_bucket * e</div><div class="ttdef"><b>Definition:</b> apr_buckets.h:699</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
<div class="ttc" id="group__apr__errno_html_ga9ee311b7bf1c691dc521d721339ee2a6"><div class="ttname"><a href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a></div><div class="ttdeci">#define APR_SUCCESS</div><div class="ttdef"><b>Definition:</b> apr_errno.h:225</div></div>
<div class="ttc" id="group__APR__Util__Bucket__Brigades_html_ga858da66dccab1e063415678bb115788a"><div class="ttname"><a href="group__APR__Util__Bucket__Brigades.html#ga858da66dccab1e063415678bb115788a">APR_BRIGADE_SENTINEL</a></div><div class="ttdeci">#define APR_BRIGADE_SENTINEL(b)</div><div class="ttdef"><b>Definition:</b> apr_buckets.h:331</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_ga6936350ce1acc1f19e336eb95be153fb_icgraph.png" border="0" usemap="#group__Cache__util_ga6936350ce1acc1f19e336eb95be153fb_icgraph" alt=""/></div>
<map name="group__Cache__util_ga6936350ce1acc1f19e336eb95be153fb_icgraph" id="group__Cache__util_ga6936350ce1acc1f19e336eb95be153fb_icgraph">
<area shape="rect" id="node2" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="192,5,383,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gada03570414af2b2d9349449858036d90"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* cache_strqtok </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>last</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>String tokenizer that ignores separator characters within quoted strings and escaped characters, as per RFC2616 section 2.2. </p>
<div class="fragment"><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;{</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordtype">char</span> *token;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordtype">int</span> quoted = 0;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a>) {         <span class="comment">/* subsequent call */</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a> = *<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>;    <span class="comment">/* start where we left off */</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    }</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a>) {         <span class="comment">/* no more tokens */</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    }</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="comment">/* skip characters in sep (will terminate at &#39;\0&#39;) */</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">while</span> (*<a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a> &amp;&amp; <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6016b58857e4c0b11e39913bdf4ff910">ap_strchr_c</a>(<a class="code" href="group__apr__strings.html#ga0234c8660bac5d4b5e016b1e715aed77">sep</a>, *<a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a>)) {</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        ++<a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a>;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span> (!*<a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a>) {        <span class="comment">/* no more tokens */</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    token = <a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a>;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">/* skip valid token characters to terminate token and</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">     * prepare for the next call (will terminate at &#39;\0)</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">     * on the way, ignore all quoted strings, and within</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">     * quoted strings, escaped characters.</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    *<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a> = token;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">while</span> (**<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>) {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="keywordflow">if</span> (!quoted) {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <span class="keywordflow">if</span> (**<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a> == <span class="charliteral">&#39;\&quot;&#39;</span> &amp;&amp; !<a class="code" href="group__APACHE__CORE__DAEMON.html#ga6016b58857e4c0b11e39913bdf4ff910">ap_strchr_c</a>(<a class="code" href="group__apr__strings.html#ga0234c8660bac5d4b5e016b1e715aed77">sep</a>, <span class="charliteral">&#39;\&quot;&#39;</span>)) {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                quoted = 1;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                ++*<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="group__APACHE__CORE__DAEMON.html#ga6016b58857e4c0b11e39913bdf4ff910">ap_strchr_c</a>(<a class="code" href="group__apr__strings.html#ga0234c8660bac5d4b5e016b1e715aed77">sep</a>, **<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>)) {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                ++*<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        }</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <span class="keywordflow">if</span> (**<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a> == <span class="charliteral">&#39;\&quot;&#39;</span>) {</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                quoted = 0;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                ++*<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (**<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a> == <span class="charliteral">&#39;\\&#39;</span>) {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                ++*<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                <span class="keywordflow">if</span> (**<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                    ++*<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            }</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                ++*<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        }</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">if</span> (**<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>) {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        **<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a> = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        ++*<a class="code" href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">return</span> token;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga6016b58857e4c0b11e39913bdf4ff910"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga6016b58857e4c0b11e39913bdf4ff910">ap_strchr_c</a></div><div class="ttdeci">#define ap_strchr_c(s, c)</div><div class="ttdef"><b>Definition:</b> httpd.h:2244</div></div>
<div class="ttc" id="group__MOD__DAV_html_gaab9226fe8f632e1f998e24276d478f30"><div class="ttname"><a href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a></div><div class="ttdeci">#define str</div><div class="ttdef"><b>Definition:</b> util_expr_scan.c:621</div></div>
<div class="ttc" id="group__apr__strings_html_ga0234c8660bac5d4b5e016b1e715aed77"><div class="ttname"><a href="group__apr__strings.html#ga0234c8660bac5d4b5e016b1e715aed77">sep</a></div><div class="ttdeci">const char * sep</div><div class="ttdef"><b>Definition:</b> apr_strings.h:247</div></div>
<div class="ttc" id="group__apr__strings_html_ga882d08c2e3ad3004cdfc219601ebaac8"><div class="ttname"><a href="group__apr__strings.html#ga882d08c2e3ad3004cdfc219601ebaac8">last</a></div><div class="ttdeci">const char char ** last</div><div class="ttdef"><b>Definition:</b> apr_strings.h:247</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_gada03570414af2b2d9349449858036d90_icgraph.png" border="0" usemap="#group__Cache__util_gada03570414af2b2d9349449858036d90_icgraph" alt=""/></div>
<map name="group__Cache__util_gada03570414af2b2d9349449858036d90_icgraph" id="group__Cache__util_gada03570414af2b2d9349449858036d90_icgraph">
<area shape="rect" id="node2" href="group__Cache__storage.html#gaffb29f2e1276bc7d81bac540a1cf3e06" title="cache_select" alt="" coords="599,55,698,81"/>
<area shape="rect" id="node4" href="group__MOD__CACHE.html#ga22e3955e21c6e60450101eb1e3c6919b" title="ap_cache_control" alt="" coords="157,80,281,107"/>
<area shape="rect" id="node3" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="785,131,976,157"/>
<area shape="rect" id="node5" href="group__Cache__util.html#ga565962a760117aaaed7e13445f79e831" title="ap_cache_check_no_cache" alt="" coords="329,29,512,56"/>
<area shape="rect" id="node6" href="group__Cache__util.html#gabddbd6cc98e9791c643ea64a26e165b0" title="ap_cache_check_no_store" alt="" coords="560,181,737,208"/>
<area shape="rect" id="node7" href="group__Cache__util.html#ga8719ff14e3ad87c32614da9fc10cb119" title="cache_check_freshness" alt="" coords="339,80,502,107"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga46b2ea303b9ec2767a61d0f121835b43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* cache_table_getm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapr__pool__t.html">apr_pool_t</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structapr__table__t.html">apr_table_t</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a value from a table, where the table may contain multiple values for a given key.</p>
<p>When the table contains a single value, that value is returned unchanged.</p>
<p>When the table contains two or more values for a key, all values for the key are returned, separated by commas. </p>
<div class="fragment"><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;{</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <a class="code" href="structcache__table__getm__t.html">cache_table_getm_t</a> state;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    state.<a class="code" href="structcache__table__getm__t.html#aef53ee2fbdd18ae818995ca2d0367c8f">p</a> = <a class="code" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    state.<a class="code" href="structcache__table__getm__t.html#a32828dd02e32454edba8b5b0c82cefed">first</a> = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    state.<a class="code" href="structcache__table__getm__t.html#a87987bba6b631eccdcb7dfa3dbf556b5">merged</a> = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    apr_table_do(cache_table_getm_do, &amp;state, t, <a class="code" href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a>, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">if</span> (!state.<a class="code" href="structcache__table__getm__t.html#a32828dd02e32454edba8b5b0c82cefed">first</a>) {</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    }</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!state.<a class="code" href="structcache__table__getm__t.html#a87987bba6b631eccdcb7dfa3dbf556b5">merged</a>) {</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <span class="keywordflow">return</span> state.<a class="code" href="structcache__table__getm__t.html#a32828dd02e32454edba8b5b0c82cefed">first</a>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    }</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="keywordflow">return</span> apr_array_pstrcat(p, state.<a class="code" href="structcache__table__getm__t.html#a87987bba6b631eccdcb7dfa3dbf556b5">merged</a>, <span class="charliteral">&#39;,&#39;</span>);</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    }</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__MPM_html_ga5cd91701e5c167f2b1a38e70ab57817e"><div class="ttname"><a href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a></div><div class="ttdeci">apr_proc_t const char const char *const const char *const apr_procattr_t apr_pool_t * p</div><div class="ttdef"><b>Definition:</b> ap_mpm.h:109</div></div>
<div class="ttc" id="structcache__table__getm__t_html"><div class="ttname"><a href="structcache__table__getm__t.html">cache_table_getm_t</a></div><div class="ttdef"><b>Definition:</b> cache_util.c:1291</div></div>
<div class="ttc" id="structcache__table__getm__t_html_a32828dd02e32454edba8b5b0c82cefed"><div class="ttname"><a href="structcache__table__getm__t.html#a32828dd02e32454edba8b5b0c82cefed">cache_table_getm_t::first</a></div><div class="ttdeci">const char * first</div><div class="ttdef"><b>Definition:</b> cache_util.c:1294</div></div>
<div class="ttc" id="structcache__table__getm__t_html_aef53ee2fbdd18ae818995ca2d0367c8f"><div class="ttname"><a href="structcache__table__getm__t.html#aef53ee2fbdd18ae818995ca2d0367c8f">cache_table_getm_t::p</a></div><div class="ttdeci">apr_pool_t * p</div><div class="ttdef"><b>Definition:</b> cache_util.c:1293</div></div>
<div class="ttc" id="structcache__table__getm__t_html_a87987bba6b631eccdcb7dfa3dbf556b5"><div class="ttname"><a href="structcache__table__getm__t.html#a87987bba6b631eccdcb7dfa3dbf556b5">cache_table_getm_t::merged</a></div><div class="ttdeci">apr_array_header_t * merged</div><div class="ttdef"><b>Definition:</b> cache_util.c:1295</div></div>
<div class="ttc" id="group__MOD__CACHE_html_ga11d8023381192746eb96be162398fe1c"><div class="ttname"><a href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a></div><div class="ttdeci">request_rec apr_pool_t const char ** key</div><div class="ttdef"><b>Definition:</b> mod_cache.h:187</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_ga46b2ea303b9ec2767a61d0f121835b43_icgraph.png" border="0" usemap="#group__Cache__util_ga46b2ea303b9ec2767a61d0f121835b43_icgraph" alt=""/></div>
<map name="group__Cache__util_ga46b2ea303b9ec2767a61d0f121835b43_icgraph" id="group__Cache__util_ga46b2ea303b9ec2767a61d0f121835b43_icgraph">
<area shape="rect" id="node2" href="group__Cache__storage.html#gaffb29f2e1276bc7d81bac540a1cf3e06" title="cache_select" alt="" coords="451,32,550,59"/>
<area shape="rect" id="node3" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="637,83,828,109"/>
<area shape="rect" id="node4" href="group__Cache__util.html#ga565962a760117aaaed7e13445f79e831" title="ap_cache_check_no_cache" alt="" coords="181,32,364,59"/>
<area shape="rect" id="node5" href="group__Cache__util.html#gabddbd6cc98e9791c643ea64a26e165b0" title="ap_cache_check_no_store" alt="" coords="412,133,589,160"/>
<area shape="rect" id="node6" href="cache__util_8c.html#gafeaa7620641e0072e420fec575619f85" title="CACHE_DECLARE" alt="" coords="202,184,343,211"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaffa94dfea5098ffab89d1dc91e094415"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a> cache_try_lock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__server__conf.html">cache_server_conf</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__request__rec.html">cache_request_rec</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Try obtain a cache wide lock on the given cache key.</p>
<p>If we return APR_SUCCESS, we obtained the lock, and we are clear to proceed to the backend. If we return APR_EEXISTS, then the lock is already locked, someone else has gone to refresh the backend data already, so we must return stale data with a warning in the mean time. If we return anything else, then something has gone pear shaped, and we allow the request through to the backend regardless.</p>
<p>This lock is created from the request pool, meaning that should something go wrong and the lock isn't deleted on return of the request headers from the backend for whatever reason, at worst the lock will be cleaned up when the request is dies or finishes.</p>
<p>If something goes truly bananas and the lock isn't deleted when the request dies, the lock will be trashed when its max-age is reached, or when a request arrives containing a Cache-Control: no-cache. At no point is it possible for this lock to permanently deny access to the backend.</p>
<p>Try obtain a cache wide lock on the given cache key.</p>
<p>If we return APR_SUCCESS, we obtained the lock, and we are clear to proceed to the backend. If we return APR_EEXIST, then the lock is already locked, someone else has gone to refresh the backend data already, so we must return stale data with a warning in the mean time. If we return anything else, then something has gone pear shaped, and we allow the request through to the backend regardless.</p>
<p>This lock is created from the request pool, meaning that should something go wrong and the lock isn't deleted on return of the request headers from the backend for whatever reason, at worst the lock will be cleaned up when the request dies or finishes.</p>
<p>If something goes truly bananas and the lock isn't deleted when the request dies, the lock will be trashed when its max-age is reached, or when a request arrives containing a Cache-Control: no-cache. At no point is it possible for this lock to permanently deny access to the backend. </p>
<div class="fragment"><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a> <a class="code" href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *lockname;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__APACHE__CORE__CONFIG.html#gab559cff0ba49c0f92a0dc777d5730496">path</a>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6d902c83b02c43071b972ed0416729bc">dir</a>[5];</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a> <a class="code" href="group__MOD__CACHE.html#ga33504014e188d5d7506173cc14fb5801">now</a> = apr_time_now();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="structapr__finfo__t.html">apr_finfo_t</a> finfo;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="structapr__file__t.html">apr_file_t</a> *lockfile;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="group__APACHE__CORE__LISTEN.html#gafd856f29d11272d954fe05b9c1ca84dd">dummy</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    finfo.<a class="code" href="structapr__finfo__t.html#afc3bec0f6b3b10160428ba5602a41c60">mtime</a> = 0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (!conf || !conf-&gt;<a class="code" href="structcache__server__conf.html#ab459a77dbc1bbba26a954336d34d136e">lock</a> || !conf-&gt;<a class="code" href="structcache__server__conf.html#ab8f9316567111d3366fcc1edfaf0bc8c">lockpath</a>) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">/* no locks configured, leave */</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">/* lock already obtained earlier? if so, success */</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    apr_pool_userdata_get(&amp;dummy, <a class="code" href="group__Cache__util.html#ga18f46c3a4173d016f51fce82d596fec7">CACHE_LOCKFILE_KEY</a>, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (dummy) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">/* create the key if it doesn&#39;t exist */</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="structcache__handle.html">cache_handle_t</a> *<a class="code" href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">         * Try to use the key of a possible open but stale cache</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">         * entry if we have one.</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="structcache__request__rec.html#ade71ff36fe9a713fd081fa45524151f1">handle</a> != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            h = cache-&gt;<a class="code" href="structcache__request__rec.html#ade71ff36fe9a713fd081fa45524151f1">handle</a>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            h = cache-&gt;<a class="code" href="structcache__request__rec.html#a17c5946aa60de5806a2af38ef7b91507">stale_handle</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">if</span> ((h != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) &amp;&amp;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            (h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a> != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) &amp;&amp;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            (h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a>-&gt;<a class="code" href="structcache__object.html#a6dfc38a2cd449d6ede42716a80e11f92">key</a> != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>)) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a> = apr_pstrdup(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, h-&gt;<a class="code" href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_obj</a>-&gt;<a class="code" href="structcache__object.html#a6dfc38a2cd449d6ede42716a80e11f92">key</a>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            cache_generate_key(r, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, &amp;cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">/* create a hashed filename from the key, and save it for later */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    lockname = ap_cache_generate_name(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, 0, 0, cache-&gt;<a class="code" href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">key</a>);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">/* lock files represent discrete just-went-stale URLs &quot;in flight&quot;, so</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">     * we support a simple two level directory structure, more is overkill.</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    dir[0] = <span class="charliteral">&#39;/&#39;</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    dir[1] = lockname[0];</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    dir[2] = <span class="charliteral">&#39;/&#39;</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    dir[3] = lockname[1];</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    dir[4] = 0;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">/* make the directories */</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    path = apr_pstrcat(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, conf-&gt;<a class="code" href="structcache__server__conf.html#ab8f9316567111d3366fcc1edfaf0bc8c">lockpath</a>, dir, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a> != (status = <a class="code" href="dir__make__recurse_8c.html#a6a3b2602f57ff148cd64096da02adbd2">apr_dir_make_recursive</a>(path,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <a class="code" href="group__apr__file__permissions.html#ga51dc87ecd94c98e97694e68d5d9620a0">APR_UREAD</a>|<a class="code" href="group__apr__file__permissions.html#ga4faa7fdfa3bcda569dd1e23ae002c5e5">APR_UWRITE</a>|<a class="code" href="group__apr__file__permissions.html#ga4c08d7e798ab4022e31ed70f06f202b5">APR_UEXECUTE</a>, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>))) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga57ad94ed8c92c4306de90479251a5d58">APLOG_ERR</a>, status, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00778)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="stringliteral">&quot;Could not create a cache lock directory: %s&quot;</span>,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                path);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    lockname = apr_pstrcat(r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>, path, <span class="stringliteral">&quot;/&quot;</span>, lockname, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    apr_pool_userdata_set(lockname, <a class="code" href="group__Cache__util.html#gaa55455b9316bd74826d36a89914580b8">CACHE_LOCKNAME_KEY</a>, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">/* is an existing lock file too old? */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    status = apr_stat(&amp;finfo, lockname,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <a class="code" href="group__apr__file__stat.html#ga992ce1f4f75d519fd2a9d241c5a12515">APR_FINFO_MTIME</a> | <a class="code" href="group__apr__file__stat.html#gabb2ba05b8ed45e59b1f06e1b7b4c91c2">APR_FINFO_NLINK</a>, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="group__APR__STATUS__IS.html#gad15c3b9bda78a88c02466a0d405c6047">APR_STATUS_IS_ENOENT</a>(status)) &amp;&amp; <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a> != status) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga57ad94ed8c92c4306de90479251a5d58">APLOG_ERR</a>, status, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00779)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="stringliteral">&quot;Could not stat a cache lock file: %s&quot;</span>,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                lockname);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> ((status == <a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a>) &amp;&amp; (((now - finfo.<a class="code" href="structapr__finfo__t.html#afc3bec0f6b3b10160428ba5602a41c60">mtime</a>) &gt; conf-&gt;<a class="code" href="structcache__server__conf.html#a4a1fb68d2fc7f123fc7bc5c3d19f1f7d">lockmaxage</a>)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                  || (now &lt; finfo.<a class="code" href="structapr__finfo__t.html#afc3bec0f6b3b10160428ba5602a41c60">mtime</a>))) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga47fafbef7e478babdd92e90407f95b19">APLOG_INFO</a>, status, r, <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(00780)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="stringliteral">&quot;Cache lock file for &#39;%s&#39; too old, removing: %s&quot;</span>,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                r-&gt;<a class="code" href="structrequest__rec.html#aee240e90eac55c732891e9408543990b">uri</a>, lockname);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        apr_file_remove(lockname, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">/* try obtain a lock on the file */</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a> == (status = apr_file_open(&amp;lockfile, lockname,</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="group__apr__file__open__flags.html#ga3e427e53aceb1ccdb078d9a03cd63d01">APR_WRITE</a> | <a class="code" href="group__apr__file__open__flags.html#gac210e96bc821dbaa83c326e775dad028">APR_CREATE</a> | <a class="code" href="group__apr__file__open__flags.html#ga209c26b2b903cc23417f6781d4edf891">APR_EXCL</a> | <a class="code" href="group__apr__file__open__flags.html#gaebc7f034a72dffe64858b1b9451994ff">APR_DELONCLOSE</a>,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <a class="code" href="group__apr__file__permissions.html#ga51dc87ecd94c98e97694e68d5d9620a0">APR_UREAD</a> | <a class="code" href="group__apr__file__permissions.html#ga4faa7fdfa3bcda569dd1e23ae002c5e5">APR_UWRITE</a>, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>))) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        apr_pool_userdata_set(lockfile, <a class="code" href="group__Cache__util.html#ga18f46c3a4173d016f51fce82d596fec7">CACHE_LOCKFILE_KEY</a>, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>, r-&gt;<a class="code" href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">pool</a>);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div><div class="ttc" id="group__apr__file__open__flags_html_ga3e427e53aceb1ccdb078d9a03cd63d01"><div class="ttname"><a href="group__apr__file__open__flags.html#ga3e427e53aceb1ccdb078d9a03cd63d01">APR_WRITE</a></div><div class="ttdeci">#define APR_WRITE</div><div class="ttdef"><b>Definition:</b> apr_file_io.h:114</div></div>
<div class="ttc" id="group__APACHE__CORE__LISTEN_html_gafd856f29d11272d954fe05b9c1ca84dd"><div class="ttname"><a href="group__APACHE__CORE__LISTEN.html#gafd856f29d11272d954fe05b9c1ca84dd">dummy</a></div><div class="ttdeci">void * dummy</div><div class="ttdef"><b>Definition:</b> ap_listen.h:136</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga47fafbef7e478babdd92e90407f95b19"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga47fafbef7e478babdd92e90407f95b19">APLOG_INFO</a></div><div class="ttdeci">#define APLOG_INFO</div><div class="ttdef"><b>Definition:</b> http_log.h:49</div></div>
<div class="ttc" id="structcache__server__conf_html_ab8f9316567111d3366fcc1edfaf0bc8c"><div class="ttname"><a href="structcache__server__conf.html#ab8f9316567111d3366fcc1edfaf0bc8c">cache_server_conf::lockpath</a></div><div class="ttdeci">const char * lockpath</div><div class="ttdef"><b>Definition:</b> cache_util.h:127</div></div>
<div class="ttc" id="group__apr__file__permissions_html_ga4faa7fdfa3bcda569dd1e23ae002c5e5"><div class="ttname"><a href="group__apr__file__permissions.html#ga4faa7fdfa3bcda569dd1e23ae002c5e5">APR_UWRITE</a></div><div class="ttdeci">#define APR_UWRITE</div><div class="ttdef"><b>Definition:</b> apr_file_info.h:102</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga655e126996849bcb82e4e5a14c616f4a"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a></div><div class="ttdeci">#define APLOG_MARK</div><div class="ttdef"><b>Definition:</b> http_log.h:283</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga57ad94ed8c92c4306de90479251a5d58"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga57ad94ed8c92c4306de90479251a5d58">APLOG_ERR</a></div><div class="ttdeci">#define APLOG_ERR</div><div class="ttdef"><b>Definition:</b> http_log.h:46</div></div>
<div class="ttc" id="group__apr__file__open__flags_html_gaebc7f034a72dffe64858b1b9451994ff"><div class="ttname"><a href="group__apr__file__open__flags.html#gaebc7f034a72dffe64858b1b9451994ff">APR_DELONCLOSE</a></div><div class="ttdeci">#define APR_DELONCLOSE</div><div class="ttdef"><b>Definition:</b> apr_file_io.h:121</div></div>
<div class="ttc" id="structapr__file__t_html"><div class="ttname"><a href="structapr__file__t.html">apr_file_t</a></div><div class="ttdef"><b>Definition:</b> apr_arch_file_io.h:97</div></div>
<div class="ttc" id="group__APACHE__CORE__HTTPD_html_ga6e27f49150e9a14580fb313cc2777e00"><div class="ttname"><a href="group__APACHE__CORE__HTTPD.html#ga6e27f49150e9a14580fb313cc2777e00">status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> http_core.h:277</div></div>
<div class="ttc" id="group__apr__file__permissions_html_ga51dc87ecd94c98e97694e68d5d9620a0"><div class="ttname"><a href="group__apr__file__permissions.html#ga51dc87ecd94c98e97694e68d5d9620a0">APR_UREAD</a></div><div class="ttdeci">#define APR_UREAD</div><div class="ttdef"><b>Definition:</b> apr_file_info.h:101</div></div>
<div class="ttc" id="structcache__request__rec_html_ade71ff36fe9a713fd081fa45524151f1"><div class="ttname"><a href="structcache__request__rec.html#ade71ff36fe9a713fd081fa45524151f1">cache_request_rec::handle</a></div><div class="ttdeci">cache_handle_t * handle</div><div class="ttdef"><b>Definition:</b> cache_util.h:215</div></div>
<div class="ttc" id="group__apr__file__stat_html_ga992ce1f4f75d519fd2a9d241c5a12515"><div class="ttname"><a href="group__apr__file__stat.html#ga992ce1f4f75d519fd2a9d241c5a12515">APR_FINFO_MTIME</a></div><div class="ttdeci">#define APR_FINFO_MTIME</div><div class="ttdef"><b>Definition:</b> apr_file_info.h:146</div></div>
<div class="ttc" id="structrequest__rec_html_aa0a0c16f9a9ab3901cdb3f3c9c9d83d0"><div class="ttname"><a href="structrequest__rec.html#aa0a0c16f9a9ab3901cdb3f3c9c9d83d0">request_rec::pool</a></div><div class="ttdeci">uintptr_t pool</div><div class="ttdef"><b>Definition:</b> ap.d:3</div></div>
<div class="ttc" id="group__apr__file__stat_html_gabb2ba05b8ed45e59b1f06e1b7b4c91c2"><div class="ttname"><a href="group__apr__file__stat.html#gabb2ba05b8ed45e59b1f06e1b7b4c91c2">APR_FINFO_NLINK</a></div><div class="ttdeci">#define APR_FINFO_NLINK</div><div class="ttdef"><b>Definition:</b> apr_file_info.h:153</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_gab559cff0ba49c0f92a0dc777d5730496"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#gab559cff0ba49c0f92a0dc777d5730496">path</a></div><div class="ttdeci">request_rec int int apr_table_t const char * path</div><div class="ttdef"><b>Definition:</b> http_config.h:1123</div></div>
<div class="ttc" id="structcache__request__rec_html_a17c5946aa60de5806a2af38ef7b91507"><div class="ttname"><a href="structcache__request__rec.html#a17c5946aa60de5806a2af38ef7b91507">cache_request_rec::stale_handle</a></div><div class="ttdeci">cache_handle_t * stale_handle</div><div class="ttdef"><b>Definition:</b> cache_util.h:216</div></div>
<div class="ttc" id="group__apr__file__open__flags_html_ga209c26b2b903cc23417f6781d4edf891"><div class="ttname"><a href="group__apr__file__open__flags.html#ga209c26b2b903cc23417f6781d4edf891">APR_EXCL</a></div><div class="ttdeci">#define APR_EXCL</div><div class="ttdef"><b>Definition:</b> apr_file_io.h:119</div></div>
<div class="ttc" id="group__apr__errno_html_gaa5105fa83cc322f09382292db8b47593"><div class="ttname"><a href="group__apr__errno.html#gaa5105fa83cc322f09382292db8b47593">apr_status_t</a></div><div class="ttdeci">int apr_status_t</div><div class="ttdef"><b>Definition:</b> apr_errno.h:44</div></div>
<div class="ttc" id="group__MOD__CACHE_html_ga33504014e188d5d7506173cc14fb5801"><div class="ttname"><a href="group__MOD__CACHE.html#ga33504014e188d5d7506173cc14fb5801">now</a></div><div class="ttdeci">const apr_time_t apr_time_t now</div><div class="ttdef"><b>Definition:</b> mod_cache.h:131</div></div>
<div class="ttc" id="group__Cache__util_html_ga18f46c3a4173d016f51fce82d596fec7"><div class="ttname"><a href="group__Cache__util.html#ga18f46c3a4173d016f51fce82d596fec7">CACHE_LOCKFILE_KEY</a></div><div class="ttdeci">#define CACHE_LOCKFILE_KEY</div><div class="ttdef"><b>Definition:</b> cache_util.h:100</div></div>
<div class="ttc" id="group__apr__time_html_gadb4bde16055748190eae190c55aa02bb"><div class="ttname"><a href="group__apr__time.html#gadb4bde16055748190eae190c55aa02bb">apr_time_t</a></div><div class="ttdeci">apr_int64_t apr_time_t</div><div class="ttdef"><b>Definition:</b> apr_time.h:46</div></div>
<div class="ttc" id="structcache__handle_html_aea71e9fd166a32e0fe46a12668a1f3bd"><div class="ttname"><a href="structcache__handle.html#aea71e9fd166a32e0fe46a12668a1f3bd">cache_handle::cache_obj</a></div><div class="ttdeci">cache_object_t * cache_obj</div><div class="ttdef"><b>Definition:</b> mod_cache.h:92</div></div>
<div class="ttc" id="structapr__finfo__t_html_afc3bec0f6b3b10160428ba5602a41c60"><div class="ttname"><a href="structapr__finfo__t.html#afc3bec0f6b3b10160428ba5602a41c60">apr_finfo_t::mtime</a></div><div class="ttdeci">apr_time_t mtime</div><div class="ttdef"><b>Definition:</b> apr_file_info.h:204</div></div>
<div class="ttc" id="group__Cache__util_html_gaa55455b9316bd74826d36a89914580b8"><div class="ttname"><a href="group__Cache__util.html#gaa55455b9316bd74826d36a89914580b8">CACHE_LOCKNAME_KEY</a></div><div class="ttdeci">#define CACHE_LOCKNAME_KEY</div><div class="ttdef"><b>Definition:</b> cache_util.h:99</div></div>
<div class="ttc" id="structcache__server__conf_html_ab459a77dbc1bbba26a954336d34d136e"><div class="ttname"><a href="structcache__server__conf.html#ab459a77dbc1bbba26a954336d34d136e">cache_server_conf::lock</a></div><div class="ttdeci">unsigned int lock</div><div class="ttdef"><b>Definition:</b> cache_util.h:137</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga4c112558ccffd6b363da102b2052d2a6"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga4c112558ccffd6b363da102b2052d2a6">ap_log_rerror</a></div><div class="ttdeci">#define ap_log_rerror</div><div class="ttdef"><b>Definition:</b> http_log.h:454</div></div>
<div class="ttc" id="structcache__request__rec_html_a564726b5f7e5dc4fee2fb01d178677b4"><div class="ttname"><a href="structcache__request__rec.html#a564726b5f7e5dc4fee2fb01d178677b4">cache_request_rec::key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> cache_util.h:227</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga6d902c83b02c43071b972ed0416729bc"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga6d902c83b02c43071b972ed0416729bc">dir</a></div><div class="ttdeci">const char * dir</div><div class="ttdef"><b>Definition:</b> httpd.h:1848</div></div>
<div class="ttc" id="group__APR__STATUS__IS_html_gad15c3b9bda78a88c02466a0d405c6047"><div class="ttname"><a href="group__APR__STATUS__IS.html#gad15c3b9bda78a88c02466a0d405c6047">APR_STATUS_IS_ENOENT</a></div><div class="ttdeci">#define APR_STATUS_IS_ENOENT(s)</div><div class="ttdef"><b>Definition:</b> apr_errno.h:1246</div></div>
<div class="ttc" id="structcache__handle_html"><div class="ttname"><a href="structcache__handle.html">cache_handle</a></div><div class="ttdef"><b>Definition:</b> mod_cache.h:91</div></div>
<div class="ttc" id="structcache__object_html_a6dfc38a2cd449d6ede42716a80e11f92"><div class="ttname"><a href="structcache__object.html#a6dfc38a2cd449d6ede42716a80e11f92">cache_object::key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> mod_cache.h:83</div></div>
<div class="ttc" id="structcache__server__conf_html_a4a1fb68d2fc7f123fc7bc5c3d19f1f7d"><div class="ttname"><a href="structcache__server__conf.html#a4a1fb68d2fc7f123fc7bc5c3d19f1f7d">cache_server_conf::lockmaxage</a></div><div class="ttdeci">apr_time_t lockmaxage</div><div class="ttdef"><b>Definition:</b> cache_util.h:128</div></div>
<div class="ttc" id="group__apr__hash_html_ga0d6dcb41ca5e794b318df5f6fd273ee2"><div class="ttname"><a href="group__apr__hash.html#ga0d6dcb41ca5e794b318df5f6fd273ee2">h</a></div><div class="ttdeci">const apr_hash_t * h</div><div class="ttdef"><b>Definition:</b> apr_hash.h:97</div></div>
<div class="ttc" id="dir__make__recurse_8c_html_a6a3b2602f57ff148cd64096da02adbd2"><div class="ttname"><a href="dir__make__recurse_8c.html#a6a3b2602f57ff148cd64096da02adbd2">apr_dir_make_recursive</a></div><div class="ttdeci">apr_status_t apr_dir_make_recursive(const char *path, apr_fileperms_t perm, apr_pool_t *pool)</div><div class="ttdef"><b>Definition:</b> dir_make_recurse.c:63</div></div>
<div class="ttc" id="structrequest__rec_html_aee240e90eac55c732891e9408543990b"><div class="ttname"><a href="structrequest__rec.html#aee240e90eac55c732891e9408543990b">request_rec::uri</a></div><div class="ttdeci">char * uri</div><div class="ttdef"><b>Definition:</b> ap.d:50</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
<div class="ttc" id="group__apr__errno_html_ga9ee311b7bf1c691dc521d721339ee2a6"><div class="ttname"><a href="group__apr__errno.html#ga9ee311b7bf1c691dc521d721339ee2a6">APR_SUCCESS</a></div><div class="ttdeci">#define APR_SUCCESS</div><div class="ttdef"><b>Definition:</b> apr_errno.h:225</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga1dee8a07e06bc5b3de8b89662c2cd666"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a></div><div class="ttdeci">#define APLOGNO(n)</div><div class="ttdef"><b>Definition:</b> http_log.h:117</div></div>
<div class="ttc" id="group__apr__file__permissions_html_ga4c08d7e798ab4022e31ed70f06f202b5"><div class="ttname"><a href="group__apr__file__permissions.html#ga4c08d7e798ab4022e31ed70f06f202b5">APR_UEXECUTE</a></div><div class="ttdeci">#define APR_UEXECUTE</div><div class="ttdef"><b>Definition:</b> apr_file_info.h:103</div></div>
<div class="ttc" id="structapr__finfo__t_html"><div class="ttname"><a href="structapr__finfo__t.html">apr_finfo_t</a></div><div class="ttdef"><b>Definition:</b> apr_file_info.h:174</div></div>
<div class="ttc" id="group__apr__file__open__flags_html_gac210e96bc821dbaa83c326e775dad028"><div class="ttname"><a href="group__apr__file__open__flags.html#gac210e96bc821dbaa83c326e775dad028">APR_CREATE</a></div><div class="ttdeci">#define APR_CREATE</div><div class="ttdef"><b>Definition:</b> apr_file_io.h:115</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_gaffa94dfea5098ffab89d1dc91e094415_cgraph.png" border="0" usemap="#group__Cache__util_gaffa94dfea5098ffab89d1dc91e094415_cgraph" alt=""/></div>
<map name="group__Cache__util_gaffa94dfea5098ffab89d1dc91e094415_cgraph" id="group__Cache__util_gaffa94dfea5098ffab89d1dc91e094415_cgraph">
<area shape="rect" id="node2" href="dir__make__recurse_8c.html#a6a3b2602f57ff148cd64096da02adbd2" title="apr_dir_make_recursive" alt="" coords="164,5,324,32"/>
<area shape="rect" id="node3" href="unix_2dir_8c.html#a51e0b4703c7561f72587982808985d29" title="apr_dir_make" alt="" coords="372,5,472,32"/>
<area shape="rect" id="node4" href="unix_2fileacc_8c.html#a6ff1e968d4350cb1184ec6ed57ac3902" title="apr_unix_perms2mode" alt="" coords="520,5,673,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_gaffa94dfea5098ffab89d1dc91e094415_icgraph.png" border="0" usemap="#group__Cache__util_gaffa94dfea5098ffab89d1dc91e094415_icgraph" alt=""/></div>
<map name="group__Cache__util_gaffa94dfea5098ffab89d1dc91e094415_icgraph" id="group__Cache__util_gaffa94dfea5098ffab89d1dc91e094415_icgraph">
<area shape="rect" id="node2" href="group__Cache__util.html#ga8719ff14e3ad87c32614da9fc10cb119" title="cache_check_freshness" alt="" coords="164,5,327,32"/>
<area shape="rect" id="node4" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="521,31,712,57"/>
<area shape="rect" id="node3" href="group__Cache__storage.html#gaffb29f2e1276bc7d81bac540a1cf3e06" title="cache_select" alt="" coords="375,5,473,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaea2f7fee82fd07fce89934bee0939987"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> cache_use_early_url </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrequest__rec.html">request_rec</a> *&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return whether to use request's path/query from early stage (r-&gt;parsed_uri) or the current/rewritable ones (r-&gt;uri/r-&gt;args). </p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;{</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="structcache__server__conf.html">cache_server_conf</a> *<a class="code" href="group__APACHE__CORE__HTTPD.html#ga7be6dfd9155648f64d6e9abcd78c38cd">conf</a>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structrequest__rec.html#a82ca03c6dcfcacbf7001ff85e462289d">proxyreq</a> == <a class="code" href="group__ProxyReq.html#gaa879e84f9b9d334007ef4c542bf6374e">PROXYREQ_PROXY</a>) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    conf = <a class="code" href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a>(r-&gt;<a class="code" href="structrequest__rec.html#a4a8059930ce9409cb885fdeef6921b7b">server</a>-&gt;module_config, &amp;<a class="code" href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span> (conf-&gt;<a class="code" href="structcache__server__conf.html#a9fcfca4177da5400a75f607f5d808b93">quick</a>) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div><div class="ttc" id="structrequest__rec_html_a4a8059930ce9409cb885fdeef6921b7b"><div class="ttname"><a href="structrequest__rec.html#a4a8059930ce9409cb885fdeef6921b7b">request_rec::server</a></div><div class="ttdeci">uintptr_t server</div><div class="ttdef"><b>Definition:</b> ap.d:5</div></div>
<div class="ttc" id="mod__cache_8c_html_a315b551bc967794e90417b5538a128f1"><div class="ttname"><a href="mod__cache_8c.html#a315b551bc967794e90417b5538a128f1">cache_module</a></div><div class="ttdeci">module AP_MODULE_DECLARE_DATA cache_module</div><div class="ttdef"><b>Definition:</b> mod_cache.c:22</div></div>
<div class="ttc" id="group__ProxyReq_html_gaa879e84f9b9d334007ef4c542bf6374e"><div class="ttname"><a href="group__ProxyReq.html#gaa879e84f9b9d334007ef4c542bf6374e">PROXYREQ_PROXY</a></div><div class="ttdeci">#define PROXYREQ_PROXY</div><div class="ttdef"><b>Definition:</b> httpd.h:1075</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga1093a5908a384eacc929b028c79f2a02"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga1093a5908a384eacc929b028c79f2a02">ap_get_module_config</a></div><div class="ttdeci">#define ap_get_module_config(v, m)</div><div class="ttdef"><b>Definition:</b> http_config.h:531</div></div>
<div class="ttc" id="group__APACHE__CORE__HTTPD_html_ga7be6dfd9155648f64d6e9abcd78c38cd"><div class="ttname"><a href="group__APACHE__CORE__HTTPD.html#ga7be6dfd9155648f64d6e9abcd78c38cd">conf</a></div><div class="ttdeci">core_dir_config * conf</div><div class="ttdef"><b>Definition:</b> http_core.h:755</div></div>
<div class="ttc" id="structcache__server__conf_html_a9fcfca4177da5400a75f607f5d808b93"><div class="ttname"><a href="structcache__server__conf.html#a9fcfca4177da5400a75f607f5d808b93">cache_server_conf::quick</a></div><div class="ttdeci">unsigned int quick</div><div class="ttdef"><b>Definition:</b> cache_util.h:135</div></div>
<div class="ttc" id="structrequest__rec_html_a82ca03c6dcfcacbf7001ff85e462289d"><div class="ttname"><a href="structrequest__rec.html#a82ca03c6dcfcacbf7001ff85e462289d">request_rec::proxyreq</a></div><div class="ttdeci">int proxyreq</div><div class="ttdef"><b>Definition:</b> ap.d:11</div></div>
<div class="ttc" id="structcache__server__conf_html"><div class="ttname"><a href="structcache__server__conf.html">cache_server_conf</a></div><div class="ttdef"><b>Definition:</b> cache_util.h:120</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__Cache__util_gaea2f7fee82fd07fce89934bee0939987_icgraph.png" border="0" usemap="#group__Cache__util_gaea2f7fee82fd07fce89934bee0939987_icgraph" alt=""/></div>
<map name="group__Cache__util_gaea2f7fee82fd07fce89934bee0939987_icgraph" id="group__Cache__util_gaea2f7fee82fd07fce89934bee0939987_icgraph">
<area shape="rect" id="node2" href="group__Cache__storage.html#ga9b9cd90883d10b4e8f021c0cc371a823" title="cache_generate_key\l_default" alt="" coords="195,5,337,47"/>
<area shape="rect" id="node3" href="mod__cache_8c.html#a0c188ed1fe0083803d64f9d4d958508b" title="APR_OPTIONAL_FN_TYPE" alt="" coords="385,71,576,98"/>
<area shape="rect" id="node4" href="group__Cache__util.html#ga3bb0227007e96351ef9b155cd0720abb" title="cache_get_providers" alt="" coords="195,122,337,149"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
