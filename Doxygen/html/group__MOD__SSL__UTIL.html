<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>My Project: Utilities</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Utilities<div class="ingroups"><a class="el" href="group__APACHE.html">Apache HTTP Server</a> &raquo; <a class="el" href="group__APACHE__MODS.html">Loadable modules</a> &raquo; <a class="el" href="group__MOD__SSL.html">mod_ssl</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Utilities:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__MOD__SSL__UTIL.png" border="0" alt="" usemap="#group____MOD____SSL____UTIL"/>
<map name="group____MOD____SSL____UTIL" id="group____MOD____SSL____UTIL">
<area shape="rect" id="node2" href="group__MOD__SSL.html" title="mod_ssl" alt="" coords="5,5,76,32"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga69e719c4e3cc5f9d8038c18a7240482f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga69e719c4e3cc5f9d8038c18a7240482f">MODSSL_LIBRARY_VERSION</a>&#160;&#160;&#160;OPENSSL_VERSION_NUMBER</td></tr>
<tr class="separator:ga69e719c4e3cc5f9d8038c18a7240482f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga745269f1532440b23c691b5febedb539"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga745269f1532440b23c691b5febedb539">MODSSL_LIBRARY_NAME</a>&#160;&#160;&#160;&quot;OpenSSL&quot;</td></tr>
<tr class="separator:ga745269f1532440b23c691b5febedb539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8483b8fd1bc5ff050b4c0154b3f1cd0f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga8483b8fd1bc5ff050b4c0154b3f1cd0f">MODSSL_LIBRARY_TEXT</a>&#160;&#160;&#160;OPENSSL_VERSION_TEXT</td></tr>
<tr class="separator:ga8483b8fd1bc5ff050b4c0154b3f1cd0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7199e41b3460675e9b97e9582471c8e9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga7199e41b3460675e9b97e9582471c8e9">MODSSL_LIBRARY_DYNTEXT</a>&#160;&#160;&#160;OpenSSL_version(OPENSSL_VERSION)</td></tr>
<tr class="separator:ga7199e41b3460675e9b97e9582471c8e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga33ff82b5abee9e2a133dbc1108e40688"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga33ff82b5abee9e2a133dbc1108e40688">MODSSL_SESSION_MAX_DER</a>&#160;&#160;&#160;1024*10</td></tr>
<tr class="separator:ga33ff82b5abee9e2a133dbc1108e40688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga536fe93cdb182005c2482441ea973f16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga536fe93cdb182005c2482441ea973f16">MODSSL_SESSION_ID_STRING_LEN</a>&#160;&#160;&#160;((SSL_MAX_SSL_SESSION_ID_LENGTH + 1) * 2)</td></tr>
<tr class="separator:ga536fe93cdb182005c2482441ea973f16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1e6f698e376d307e5826cf96eae59708"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga1e6f698e376d307e5826cf96eae59708">modssl_init_app_data2_idx</a> (<a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a>)</td></tr>
<tr class="separator:ga1e6f698e376d307e5826cf96eae59708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1bcee252b873bbf1f10920827802303c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga1bcee252b873bbf1f10920827802303c">modssl_get_app_data2</a> (<a class="el" href="group__MOD__SSL.html#gac05889312301718b3fc106564942ad68">SSL</a> *)</td></tr>
<tr class="separator:ga1bcee252b873bbf1f10920827802303c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9474414be52ebb8768e3023968097bc5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga9474414be52ebb8768e3023968097bc5">modssl_set_app_data2</a> (<a class="el" href="group__MOD__SSL.html#gac05889312301718b3fc106564942ad68">SSL</a> *, <a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a> *)</td></tr>
<tr class="separator:ga9474414be52ebb8768e3023968097bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82752d8eb9f5dab0b40d7b18d741e3bc"><td class="memItemLeft" align="right" valign="top">EVP_PKEY *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga82752d8eb9f5dab0b40d7b18d741e3bc">modssl_read_privatekey</a> (const char *, EVP_PKEY **, pem_password_cb *, <a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a> *)</td></tr>
<tr class="separator:ga82752d8eb9f5dab0b40d7b18d741e3bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9f72fcff0b63162c3be9840dd308315"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#gac9f72fcff0b63162c3be9840dd308315">modssl_smart_shutdown</a> (<a class="el" href="group__MOD__SSL.html#gac05889312301718b3fc106564942ad68">SSL</a> *<a class="el" href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a>)</td></tr>
<tr class="separator:gac9f72fcff0b63162c3be9840dd308315"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga864fc6f3f3d496b62b5f0ba5b61f9eb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga864fc6f3f3d496b62b5f0ba5b61f9eb3">modssl_X509_getBC</a> (X509 *, <a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> *, <a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> *)</td></tr>
<tr class="separator:ga864fc6f3f3d496b62b5f0ba5b61f9eb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2892cbff75bedf65cf0731d337684894"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga2892cbff75bedf65cf0731d337684894">modssl_X509_NAME_ENTRY_to_string</a> (<a class="el" href="structapr__pool__t.html">apr_pool_t</a> *<a class="el" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>, X509_NAME_ENTRY *xsne)</td></tr>
<tr class="separator:ga2892cbff75bedf65cf0731d337684894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga51008e236441926c31150e12283c87aa"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga51008e236441926c31150e12283c87aa">modssl_X509_NAME_to_string</a> (<a class="el" href="structapr__pool__t.html">apr_pool_t</a> *, X509_NAME *, <a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>)</td></tr>
<tr class="separator:ga51008e236441926c31150e12283c87aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc03fd52fbd4883723b4caa24915e595"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#gadc03fd52fbd4883723b4caa24915e595">modssl_X509_getSAN</a> (<a class="el" href="structapr__pool__t.html">apr_pool_t</a> *, X509 *, <a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>, const char *, <a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>, <a class="el" href="structapr__array__header__t.html">apr_array_header_t</a> **)</td></tr>
<tr class="separator:gadc03fd52fbd4883723b4caa24915e595"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga617b046265fec156bdbb4e897034c113"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga617b046265fec156bdbb4e897034c113">modssl_X509_match_name</a> (<a class="el" href="structapr__pool__t.html">apr_pool_t</a> *, X509 *, const char *, <a class="el" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>, <a class="el" href="structserver__rec.html">server_rec</a> *)</td></tr>
<tr class="separator:ga617b046265fec156bdbb4e897034c113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2363acfbf9ae3431c6ae3e7c3c346c17"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MOD__SSL__UTIL.html#ga2363acfbf9ae3431c6ae3e7c3c346c17">modssl_SSL_SESSION_id2sz</a> (<a class="el" href="group__MOD__SSL__PRIVATE.html#ga7b2aaacd57801ee8b4692b1699a1b1bd">IDCONST</a> unsigned char *, <a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>, char *, <a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>)</td></tr>
<tr class="separator:ga2363acfbf9ae3431c6ae3e7c3c346c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga7199e41b3460675e9b97e9582471c8e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MODSSL_LIBRARY_DYNTEXT&#160;&#160;&#160;OpenSSL_version(OPENSSL_VERSION)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga745269f1532440b23c691b5febedb539"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MODSSL_LIBRARY_NAME&#160;&#160;&#160;&quot;OpenSSL&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga8483b8fd1bc5ff050b4c0154b3f1cd0f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MODSSL_LIBRARY_TEXT&#160;&#160;&#160;OPENSSL_VERSION_TEXT</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga69e719c4e3cc5f9d8038c18a7240482f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MODSSL_LIBRARY_VERSION&#160;&#160;&#160;OPENSSL_VERSION_NUMBER</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SSL library version number </p>

</div>
</div>
<a class="anchor" id="ga536fe93cdb182005c2482441ea973f16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MODSSL_SESSION_ID_STRING_LEN&#160;&#160;&#160;((SSL_MAX_SSL_SESSION_ID_LENGTH + 1) * 2)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>max length for modssl_SSL_SESSION_id2sz </p>

</div>
</div>
<a class="anchor" id="ga33ff82b5abee9e2a133dbc1108e40688"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MODSSL_SESSION_MAX_DER&#160;&#160;&#160;1024*10</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum length of a DER encoded session. FIXME: There is no define in OpenSSL, but OpenSSL uses 1024*10, so this value should be ok. Although we have no warm feeling. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga1bcee252b873bbf1f10920827802303c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a>* modssl_get_app_data2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MOD__SSL.html#gac05889312301718b3fc106564942ad68">SSL</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)SSL_get_ex_data(<a class="code" href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a>, app_data2_idx);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div><div class="ttc" id="group__MOD__SSL_html_ga91d808d6c1c01029f9c9260b9b69a437"><div class="ttname"><a href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a></div><div class="ttdeci">conn_rec SSL * ssl</div><div class="ttdef"><b>Definition:</b> mod_ssl_openssl.h:60</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga1bcee252b873bbf1f10920827802303c_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga1bcee252b873bbf1f10920827802303c_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga1bcee252b873bbf1f10920827802303c_icgraph" id="group__MOD__SSL__UTIL_ga1bcee252b873bbf1f10920827802303c_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__PRIVATE.html#gaffe1983e42db597bf43dedd27419e255" title="ssl_callback_SSLVerify" alt="" coords="209,22,369,48"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#ga4aa47e22efe0b853cf31c3e8e9a7c70c" title="ssl_init_Module" alt="" coords="595,22,707,48"/>
<area shape="rect" id="node5" href="group__MOD__SSL__PRIVATE.html#gad536620d986d5e4c72891abcdf205036" title="ssl_hook_Access" alt="" coords="588,72,713,99"/>
<area shape="rect" id="node6" href="group__MOD__SSL__PRIVATE.html#gaad15af9d93ac03e2acdbe6a8d1d76adb" title="ssl_callback_Info" alt="" coords="417,22,540,48"/>
<area shape="rect" id="node4" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="761,47,919,74"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga1e6f698e376d307e5826cf96eae59708"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a> modssl_init_app_data2_idx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Additional Functions </p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (app_data2_idx &gt; -1) {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">/* we _do_ need to call this twice */</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt;= 1; i++) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        app_data2_idx =</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            SSL_get_ex_new_index(0,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                 <span class="stringliteral">&quot;Second Application Data for SSL&quot;</span>,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                 <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div><div class="ttc" id="group__MOD__PROXY_html_ga38403a0592eb8018a3ad61aef0f7ca2c"><div class="ttname"><a href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a></div><div class="ttdeci">proxy_worker_shared int i</div><div class="ttdef"><b>Definition:</b> mod_proxy.h:718</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga1e6f698e376d307e5826cf96eae59708_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga1e6f698e376d307e5826cf96eae59708_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga1e6f698e376d307e5826cf96eae59708_icgraph" id="group__MOD__SSL__UTIL_ga1e6f698e376d307e5826cf96eae59708_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__PRIVATE.html#ga4aa47e22efe0b853cf31c3e8e9a7c70c" title="ssl_init_Module" alt="" coords="232,29,344,56"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="392,29,549,56"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga82752d8eb9f5dab0b40d7b18d741e3bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EVP_PKEY* modssl_read_privatekey </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">EVP_PKEY **&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pem_password_cb *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    EVP_PKEY *<a class="code" href="group__APACHE__CORE__CONFIG.html#ga2e051c0ce9ee165170cd7973f2464512">rc</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    BIO *bioS;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    BIO *bioF;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">/* 1. try PEM (= DER+Base64+headers) */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span> ((bioS=BIO_new_file(<a class="code" href="group__APACHE__CORE__LOG.html#ga28849770c8bfeb04039d7dd29d4dfa35">filename</a>, <span class="stringliteral">&quot;r&quot;</span>)) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    rc = PEM_read_bio_PrivateKey(bioS, <a class="code" href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a>, cb, <a class="code" href="group__APACHE__CORE__LISTEN.html#ga9359ed159c8b295541e3770172d34550">s</a>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    BIO_free(bioS);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span> (rc == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">/* 2. try DER+Base64 */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">if</span> ((bioS = BIO_new_file(<a class="code" href="group__APACHE__CORE__LOG.html#ga28849770c8bfeb04039d7dd29d4dfa35">filename</a>, <span class="stringliteral">&quot;r&quot;</span>)) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">if</span> ((bioF = BIO_new(BIO_f_base64())) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            BIO_free(bioS);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        bioS = BIO_push(bioF, bioS);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        rc = d2i_PrivateKey_bio(bioS, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        BIO_free_all(bioS);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">if</span> (rc == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="comment">/* 3. try plain DER */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordflow">if</span> ((bioS = BIO_new_file(<a class="code" href="group__APACHE__CORE__LOG.html#ga28849770c8bfeb04039d7dd29d4dfa35">filename</a>, <span class="stringliteral">&quot;r&quot;</span>)) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            rc = d2i_PrivateKey_bio(bioS, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            BIO_free(bioS);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (rc != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a> &amp;&amp; <a class="code" href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a> != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> (*<a class="code" href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a> != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            EVP_PKEY_free(*<a class="code" href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        *<a class="code" href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a> = <a class="code" href="group__APACHE__CORE__CONFIG.html#ga2e051c0ce9ee165170cd7973f2464512">rc</a>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__CONFIG.html#ga2e051c0ce9ee165170cd7973f2464512">rc</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__LOG_html_ga28849770c8bfeb04039d7dd29d4dfa35"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga28849770c8bfeb04039d7dd29d4dfa35">filename</a></div><div class="ttdeci">const char * filename</div><div class="ttdef"><b>Definition:</b> http_log.h:773</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga2e051c0ce9ee165170cd7973f2464512"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga2e051c0ce9ee165170cd7973f2464512">rc</a></div><div class="ttdeci">ap_configfile_t apr_status_t rc</div><div class="ttdef"><b>Definition:</b> http_config.h:851</div></div>
<div class="ttc" id="group__APACHE__CORE__LISTEN_html_ga9359ed159c8b295541e3770172d34550"><div class="ttname"><a href="group__APACHE__CORE__LISTEN.html#ga9359ed159c8b295541e3770172d34550">s</a></div><div class="ttdeci">server_rec * s</div><div class="ttdef"><b>Definition:</b> ap_listen.h:109</div></div>
<div class="ttc" id="group__MOD__CACHE_html_ga11d8023381192746eb96be162398fe1c"><div class="ttname"><a href="group__MOD__CACHE.html#ga11d8023381192746eb96be162398fe1c">key</a></div><div class="ttdeci">request_rec apr_pool_t const char ** key</div><div class="ttdef"><b>Definition:</b> mod_cache.h:187</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga82752d8eb9f5dab0b40d7b18d741e3bc_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga82752d8eb9f5dab0b40d7b18d741e3bc_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga82752d8eb9f5dab0b40d7b18d741e3bc_icgraph" id="group__MOD__SSL__UTIL_ga82752d8eb9f5dab0b40d7b18d741e3bc_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__PRIVATE.html#ga594145a68cd4bcdddfcee86210599d73" title="ssl_load_encrypted_pkey" alt="" coords="216,29,385,56"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#ga4aa47e22efe0b853cf31c3e8e9a7c70c" title="ssl_init_Module" alt="" coords="433,29,545,56"/>
<area shape="rect" id="node4" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="593,29,751,56"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga9474414be52ebb8768e3023968097bc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a> modssl_set_app_data2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MOD__SSL.html#gac05889312301718b3fc106564942ad68">SSL</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6">void</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    SSL_set_ex_data(<a class="code" href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a>, app_data2_idx, (<span class="keywordtype">char</span> *)<a class="code" href="group__APACHE__CORE__LISTEN.html#ga71f9d4c76ff7cd8f3db5697a5cfa7b08">arg</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div><div class="ttc" id="group__MOD__SSL_html_ga91d808d6c1c01029f9c9260b9b69a437"><div class="ttname"><a href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a></div><div class="ttdeci">conn_rec SSL * ssl</div><div class="ttdef"><b>Definition:</b> mod_ssl_openssl.h:60</div></div>
<div class="ttc" id="group__APACHE__CORE__LISTEN_html_ga71f9d4c76ff7cd8f3db5697a5cfa7b08"><div class="ttname"><a href="group__APACHE__CORE__LISTEN.html#ga71f9d4c76ff7cd8f3db5697a5cfa7b08">arg</a></div><div class="ttdeci">void const char * arg</div><div class="ttdef"><b>Definition:</b> ap_listen.h:136</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga9474414be52ebb8768e3023968097bc5_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga9474414be52ebb8768e3023968097bc5_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga9474414be52ebb8768e3023968097bc5_icgraph" id="group__MOD__SSL__UTIL_ga9474414be52ebb8768e3023968097bc5_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="393,29,551,56"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#gab9e4b8c8cb8d3cbbdc226c4de311de51" title="ssl_hook_ReadReq" alt="" coords="209,55,345,81"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gac9f72fcff0b63162c3be9840dd308315"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> modssl_smart_shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MOD__SSL.html#gac05889312301718b3fc106564942ad68">SSL</a> *&#160;</td>
          <td class="paramname"><em>ssl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="group__APACHE__CORE__CONFIG.html#ga2e051c0ce9ee165170cd7973f2464512">rc</a>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="group__APACHE__CORE__CONNECTION.html#ga0e45940edc0a96a29eea9b91650341ae">flush</a>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">     * Repeat the calls, because SSL_shutdown internally dispatches through a</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">     * little state machine. Usually only one or two interation should be</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">     * needed, so we restrict the total number of restrictions in order to</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">     * avoid process hangs in case the client played bad with the socket</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">     * connection and OpenSSL cannot recognize it.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    rc = 0;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    flush = !(SSL_get_shutdown(<a class="code" href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a>) &amp; SSL_SENT_SHUTDOWN);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; 4 <span class="comment">/* max 2x pending + 2x data = 4 */</span>; i++) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        rc = SSL_shutdown(<a class="code" href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">if</span> (rc &gt;= 0 &amp;&amp; flush &amp;&amp; (SSL_get_shutdown(<a class="code" href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a>) &amp; SSL_SENT_SHUTDOWN)) {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="comment">/* Once the close notity is sent through the output filters,</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">             * ensure it is flushed through the socket.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span> (BIO_flush(SSL_get_wbio(<a class="code" href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a>)) &lt;= 0) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                rc = -1;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            flush = 0;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> (rc != 0)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__CONFIG.html#ga2e051c0ce9ee165170cd7973f2464512">rc</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div><div class="ttc" id="group__MOD__SSL_html_ga91d808d6c1c01029f9c9260b9b69a437"><div class="ttname"><a href="group__MOD__SSL.html#ga91d808d6c1c01029f9c9260b9b69a437">ssl</a></div><div class="ttdeci">conn_rec SSL * ssl</div><div class="ttdef"><b>Definition:</b> mod_ssl_openssl.h:60</div></div>
<div class="ttc" id="group__MOD__PROXY_html_ga38403a0592eb8018a3ad61aef0f7ca2c"><div class="ttname"><a href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a></div><div class="ttdeci">proxy_worker_shared int i</div><div class="ttdef"><b>Definition:</b> mod_proxy.h:718</div></div>
<div class="ttc" id="group__APACHE__CORE__CONNECTION_html_ga0e45940edc0a96a29eea9b91650341ae"><div class="ttname"><a href="group__APACHE__CORE__CONNECTION.html#ga0e45940edc0a96a29eea9b91650341ae">flush</a></div><div class="ttdeci">int flush</div><div class="ttdef"><b>Definition:</b> http_connection.h:52</div></div>
<div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga2e051c0ce9ee165170cd7973f2464512"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga2e051c0ce9ee165170cd7973f2464512">rc</a></div><div class="ttdeci">ap_configfile_t apr_status_t rc</div><div class="ttdef"><b>Definition:</b> http_config.h:851</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga2363acfbf9ae3431c6ae3e7c3c346c17"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* modssl_SSL_SESSION_id2sz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__MOD__SSL__PRIVATE.html#ga7b2aaacd57801ee8b4692b1699a1b1bd">IDCONST</a> unsigned char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;{</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (idlen &gt; SSL_MAX_SSL_SESSION_ID_LENGTH)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        idlen = SSL_MAX_SSL_SESSION_ID_LENGTH;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        </div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">/* We must ensure not to process more than what would fit in the</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">     * destination buffer, including terminating NULL */</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> (idlen &gt; (strsize-1) / 2)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        idlen = (strsize-1) / 2;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    ap_bin2hex(<span class="keywordtype">id</span>, idlen, <a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a>);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div><div class="ttc" id="group__MOD__DAV_html_gaab9226fe8f632e1f998e24276d478f30"><div class="ttname"><a href="group__MOD__DAV.html#gaab9226fe8f632e1f998e24276d478f30">str</a></div><div class="ttdeci">#define str</div><div class="ttdef"><b>Definition:</b> util_expr_scan.c:621</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga2363acfbf9ae3431c6ae3e7c3c346c17_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga2363acfbf9ae3431c6ae3e7c3c346c17_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga2363acfbf9ae3431c6ae3e7c3c346c17_icgraph" id="group__MOD__SSL__UTIL_ga2363acfbf9ae3431c6ae3e7c3c346c17_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__PRIVATE.html#gaf5cd2a533da5f24cb355f5745e397727" title="ssl_callback_proxy_cert" alt="" coords="216,5,379,32"/>
<area shape="rect" id="node5" href="group__MOD__SSL__PRIVATE.html#ga42e6f981345c92e377fc830d91667fa5" title="ssl_var_lookup" alt="" coords="243,56,352,83"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#ga4aa47e22efe0b853cf31c3e8e9a7c70c" title="ssl_init_Module" alt="" coords="436,5,548,32"/>
<area shape="rect" id="node4" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="605,31,763,57"/>
<area shape="rect" id="node6" href="group__MOD__SSL__PRIVATE.html#gafbb3810aae5f5ad5d5d1e78977ff3888" title="ssl_var_register" alt="" coords="435,56,549,83"/>
<area shape="rect" id="node7" href="group__MOD__SSL__PRIVATE.html#ga6f47bd17d9737a2c803a58bea27d5407" title="ssl_var_log_config\l_register" alt="" coords="427,107,557,149"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga864fc6f3f3d496b62b5f0ba5b61f9eb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> modssl_X509_getBC </td>
          <td>(</td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    BASIC_CONSTRAINTS *bc;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    BIGNUM *bn = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">char</span> *cp;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    bc = X509_get_ext_d2i(cert, NID_basic_constraints, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">if</span> (bc == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    *ca = bc-&gt;ca;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    *pathlen = -1 <span class="comment">/* unlimited */</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (bc-&gt;pathlen != <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> ((bn = ASN1_INTEGER_to_BN(bc-&gt;pathlen, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>)) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            BASIC_CONSTRAINTS_free(bc);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span> ((cp = BN_bn2dec(bn)) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            BN_free(bn);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            BASIC_CONSTRAINTS_free(bc);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        *pathlen = atoi(cp);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        OPENSSL_free(cp);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        BN_free(bn);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    BASIC_CONSTRAINTS_free(bc);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="ttc" id="group__MOD__SSL__PRIVATE_html_gaa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> ssl_private.h:71</div></div>
<div class="ttc" id="group__MOD__SSL__PRIVATE_html_gaa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> ssl_private.h:75</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga864fc6f3f3d496b62b5f0ba5b61f9eb3_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga864fc6f3f3d496b62b5f0ba5b61f9eb3_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga864fc6f3f3d496b62b5f0ba5b61f9eb3_icgraph" id="group__MOD__SSL__UTIL_ga864fc6f3f3d496b62b5f0ba5b61f9eb3_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__PRIVATE.html#ga4aa47e22efe0b853cf31c3e8e9a7c70c" title="ssl_init_Module" alt="" coords="199,29,311,56"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="359,29,516,56"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gadc03fd52fbd4883723b4caa24915e595"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> modssl_X509_getSAN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapr__pool__t.html">apr_pool_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapr__array__header__t.html">apr_array_header_t</a> **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="ssl__engine__init_8c.html#a8d3ef5dbf93a046b44c0a610b5325b45">STACK_OF</a>(GENERAL_NAME) *<a class="code" href="ap__regex_8h.html#aba891871049c2a2e93d20a094a56662a">names</a>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="ssl__engine__vars_8c.html#a7235ef62e89328f5155846dc59c6fc37">nid</a> = onf ? OBJ_txt2nid(onf) : NID_undef;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (!x509 || (<a class="code" href="group__APACHE__CORE__HTTPD.html#gaafc7089562892428c4fcae486f171f5a">type</a> &lt; GEN_OTHERNAME) ||</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        ((<a class="code" href="group__APACHE__CORE__HTTPD.html#gaafc7089562892428c4fcae486f171f5a">type</a> == GEN_OTHERNAME) &amp;&amp; (nid == NID_undef)) ||</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        (<a class="code" href="group__APACHE__CORE__HTTPD.html#gaafc7089562892428c4fcae486f171f5a">type</a> &gt; GEN_RID) || (idx &lt; -1) ||</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        !(*entries = apr_array_make(<a class="code" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>, 0, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *)))) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        *entries = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="ap__regex_8h.html#aba891871049c2a2e93d20a094a56662a">names</a> = X509_get_ext_d2i(x509, NID_subject_alt_name, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>, <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>))) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a>, <a class="code" href="group__APACHE__CORE__PROTO.html#gad484edfd58b9127caa8f0f59b4004d09">n</a> = 0;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        GENERAL_NAME *<a class="code" href="group__APACHE__CORE__CONFIG.html#ga06e97fb366205b8f170da3c7562a8677">name</a>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *utf8str;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; sk_GENERAL_NAME_num(<a class="code" href="ap__regex_8h.html#aba891871049c2a2e93d20a094a56662a">names</a>); i++) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            name = sk_GENERAL_NAME_value(<a class="code" href="ap__regex_8h.html#aba891871049c2a2e93d20a094a56662a">names</a>, i);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">if</span> (name-&gt;type != <a class="code" href="group__APACHE__CORE__HTTPD.html#gaafc7089562892428c4fcae486f171f5a">type</a>)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="group__APACHE__CORE__HTTPD.html#gaafc7089562892428c4fcae486f171f5a">type</a>) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">case</span> GEN_EMAIL:</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">case</span> GEN_DNS:</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="keywordflow">if</span> (((idx == -1) || (n == idx)) &amp;&amp;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    (utf8str = asn1_string_to_utf8(<a class="code" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>, name-&gt;d.ia5))) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    <a class="code" href="group__apr__tables.html#ga1833b0f940ec03d0b95926812152e1ca">APR_ARRAY_PUSH</a>(*entries, <span class="keyword">const</span> <span class="keywordtype">char</span> *) = utf8str;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                n++;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordflow">case</span> GEN_OTHERNAME:</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="keywordflow">if</span> (OBJ_obj2nid(name-&gt;d.otherName-&gt;type_id) == nid) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    <span class="keywordflow">if</span> (((idx == -1) || (n == idx))) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        parse_otherName_value(<a class="code" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>, name-&gt;d.otherName-&gt;value,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                              onf, entries);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    n++;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="comment">/*</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">                 * Not implemented right now:</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">                 * GEN_X400 (x400Address)</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">                 * GEN_DIRNAME (directoryName)</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">                 * GEN_EDIPARTY (ediPartyName)</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">                 * GEN_URI (uniformResourceIdentifier)</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">                 * GEN_IPADD (iPAddress)</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">                 * GEN_RID (registeredID)</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">                 */</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">if</span> ((idx != -1) &amp;&amp; (n &gt; idx))</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        sk_GENERAL_NAME_pop_free(<a class="code" href="ap__regex_8h.html#aba891871049c2a2e93d20a094a56662a">names</a>, GENERAL_NAME_free);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> apr_is_empty_array(*entries) ? <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a> : <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga06e97fb366205b8f170da3c7562a8677"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga06e97fb366205b8f170da3c7562a8677">name</a></div><div class="ttdeci">apr_pool_t const char * name</div><div class="ttdef"><b>Definition:</b> http_config.h:800</div></div>
<div class="ttc" id="group__MOD__SSL__PRIVATE_html_gaa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> ssl_private.h:71</div></div>
<div class="ttc" id="group__APACHE__CORE__MPM_html_ga5cd91701e5c167f2b1a38e70ab57817e"><div class="ttname"><a href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a></div><div class="ttdeci">apr_proc_t const char const char *const const char *const apr_procattr_t apr_pool_t * p</div><div class="ttdef"><b>Definition:</b> ap_mpm.h:109</div></div>
<div class="ttc" id="ssl__engine__vars_8c_html_a7235ef62e89328f5155846dc59c6fc37"><div class="ttname"><a href="ssl__engine__vars_8c.html#a7235ef62e89328f5155846dc59c6fc37">nid</a></div><div class="ttdeci">int nid</div><div class="ttdef"><b>Definition:</b> ssl_engine_vars.c:569</div></div>
<div class="ttc" id="group__MOD__PROXY_html_ga38403a0592eb8018a3ad61aef0f7ca2c"><div class="ttname"><a href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a></div><div class="ttdeci">proxy_worker_shared int i</div><div class="ttdef"><b>Definition:</b> mod_proxy.h:718</div></div>
<div class="ttc" id="group__APACHE__CORE__PROTO_html_gad484edfd58b9127caa8f0f59b4004d09"><div class="ttname"><a href="group__APACHE__CORE__PROTO.html#gad484edfd58b9127caa8f0f59b4004d09">n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> ap_regex.h:230</div></div>
<div class="ttc" id="ap__regex_8h_html_aba891871049c2a2e93d20a094a56662a"><div class="ttname"><a href="ap__regex_8h.html#aba891871049c2a2e93d20a094a56662a">names</a></div><div class="ttdeci">apr_array_header_t * names</div><div class="ttdef"><b>Definition:</b> ap_regex.h:161</div></div>
<div class="ttc" id="group__APACHE__CORE__HTTPD_html_gaafc7089562892428c4fcae486f171f5a"><div class="ttname"><a href="group__APACHE__CORE__HTTPD.html#gaafc7089562892428c4fcae486f171f5a">type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> http_core.h:184</div></div>
<div class="ttc" id="group__MOD__SSL__PRIVATE_html_gaa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> ssl_private.h:75</div></div>
<div class="ttc" id="group__apr__tables_html_ga1833b0f940ec03d0b95926812152e1ca"><div class="ttname"><a href="group__apr__tables.html#ga1833b0f940ec03d0b95926812152e1ca">APR_ARRAY_PUSH</a></div><div class="ttdeci">#define APR_ARRAY_PUSH(ary, type)</div><div class="ttdef"><b>Definition:</b> apr_tables.h:150</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
<div class="ttc" id="ssl__engine__init_8c_html_a8d3ef5dbf93a046b44c0a610b5325b45"><div class="ttname"><a href="ssl__engine__init_8c.html#a8d3ef5dbf93a046b44c0a610b5325b45">STACK_OF</a></div><div class="ttdeci">STACK_OF(X509_NAME)</div><div class="ttdef"><b>Definition:</b> ssl_engine_init.c:1865</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_cgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_cgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_cgraph" id="group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_cgraph">
<area shape="rect" id="node2" href="ssl__engine__init_8c.html#a8d3ef5dbf93a046b44c0a610b5325b45" title="STACK_OF" alt="" coords="262,114,354,141"/>
<area shape="rect" id="node9" href="group__MOD__SSL__UTIL.html#ga2892cbff75bedf65cf0731d337684894" title="modssl_X509_NAME_ENTRY\l_to_string" alt="" coords="208,165,408,207"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#ga9a4071d17f72df0574d3c8840886d3bb" title="ssl_log_ssl_error" alt="" coords="456,13,576,39"/>
<area shape="rect" id="node5" href="unix_2dir_8c.html#a6116289feec09ec86c564e926a5f4cd2" title="apr_dir_open" alt="" coords="468,63,564,90"/>
<area shape="rect" id="node6" href="unix_2dir_8c.html#a3e4ee253e0c712160bee10bfb9c8e4a8" title="apr_dir_read" alt="" coords="469,114,563,141"/>
<area shape="rect" id="node7" href="unix_2dir_8c.html#a57fef00ccea03e9244f6fa21da4d3359" title="apr_dir_close" alt="" coords="467,165,565,191"/>
<area shape="rect" id="node8" href="group__MOD__ISAPI.html#gacd6cdbf73df3d9eed42fa493d9b621a6" title="void" alt="" coords="493,215,539,242"/>
<area shape="rect" id="node4" href="group__MOD__SSL__UTIL.html#ga51008e236441926c31150e12283c87aa" title="modssl_X509_NAME_to\l_string" alt="" coords="624,5,789,47"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_icgraph" id="group__MOD__SSL__UTIL_gadc03fd52fbd4883723b4caa24915e595_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__PRIVATE.html#gafdb8841b626c0bc44c0583a748c36cec" title="modssl_var_extract\l_san_entries" alt="" coords="208,22,344,63"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#ga2574b28e07747ea87febd970f9a76eb3" title="ssl_hook_Fixup" alt="" coords="392,29,505,56"/>
<area shape="rect" id="node4" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="553,29,711,56"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga617b046265fec156bdbb4e897034c113"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> modssl_X509_match_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapr__pool__t.html">apr_pool_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structserver__rec.html">server_rec</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;{</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="code" href="pcregrep_8txt.html#adbf62cf6c8d0bfcea6906e5ffb865b90">matched</a> = <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="structapr__array__header__t.html">apr_array_header_t</a> *ids;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">     * At some day in the future, this might be replaced with X509_check_host()</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">     * (available in OpenSSL 1.0.2 and later), but two points should be noted:</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">     * 1) wildcard matching in X509_check_host() might yield different</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">     *    results (by default, it supports a broader set of patterns, e.g.</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">     *    wildcards in non-initial positions);</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">     * 2) we lose the option of logging each DNS- and CN-ID (until a match</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">     *    is found).</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span> (getIDs(<a class="code" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>, x509, &amp;ids)) {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *cp;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a>;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordtype">char</span> **<span class="keywordtype">id</span> = (<span class="keywordtype">char</span> **)ids-&gt;<a class="code" href="structapr__array__header__t.html#af8462fa2a1ddf6406c66cd3dd441a269">elts</a>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> is_wildcard;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        for (i = 0; i &lt; ids-&gt;<a class="code" href="structapr__array__header__t.html#ab11b88220885c5a0920a06ac85680055">nelts</a>; i++) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">if</span> (!<span class="keywordtype">id</span>[i])</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">             * Determine if it is a wildcard ID - we&#39;re restrictive</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">             * in the sense that we require the wildcard character to be</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">             * THE left-most label (i.e., the ID must start with &quot;*.&quot;)</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            is_wildcard = (*<span class="keywordtype">id</span>[<a class="code" href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a>] == <span class="charliteral">&#39;*&#39;</span> &amp;&amp; *(<span class="keywordtype">id</span>[<a class="code" href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a>]+1) == <span class="charliteral">&#39;.&#39;</span>) ? <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> : <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">             * If the ID includes a wildcard character (and the caller is</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">             * allowing wildcards), check if it matches for the left-most</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">             * DNS label - i.e., the wildcard character is not allowed</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">             * to match a dot. Otherwise, try a simple string compare.</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordflow">if</span> ((allow_wildcard == <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> &amp;&amp; is_wildcard == <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> &amp;&amp;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                 (cp = <a class="code" href="group__APACHE__CORE__DAEMON.html#ga6016b58857e4c0b11e39913bdf4ff910">ap_strchr_c</a>(<a class="code" href="group__APACHE__CORE__CONFIG.html#ga06e97fb366205b8f170da3c7562a8677">name</a>, <span class="charliteral">&#39;.&#39;</span>)) &amp;&amp; !<a class="code" href="apr__cpystrn_8c.html#a4a00fc29b96a953fed9e0107a9c4548a">strcasecmp</a>(<span class="keywordtype">id</span>[i]+1, cp)) ||</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                !<a class="code" href="apr__cpystrn_8c.html#a4a00fc29b96a953fed9e0107a9c4548a">strcasecmp</a>(<span class="keywordtype">id</span>[i], <a class="code" href="group__APACHE__CORE__CONFIG.html#ga06e97fb366205b8f170da3c7562a8677">name</a>)) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                matched = <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__APACHE__CORE__LISTEN.html#ga9359ed159c8b295541e3770172d34550">s</a>) {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <a class="code" href="group__APACHE__CORE__LOG.html#ga5e6676c87418af7a1d323a116c78ecb4">ap_log_error</a>(<a class="code" href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#ga5e4f134ae2203dd339774d9549d814db">APLOG_TRACE3</a>, 0, <a class="code" href="group__APACHE__CORE__LISTEN.html#ga9359ed159c8b295541e3770172d34550">s</a>,</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                             <span class="stringliteral">&quot;[%s] modssl_X509_match_name: expecting name &#39;%s&#39;, &quot;</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                             <span class="stringliteral">&quot;%smatched by ID &#39;%s&#39;&quot;</span>,</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                             (<a class="code" href="group__MOD__SSL__PRIVATE.html#ga3ea8e2c288a4f4af189ae0fc4f1fd996">mySrvConfig</a>(<a class="code" href="group__APACHE__CORE__LISTEN.html#ga9359ed159c8b295541e3770172d34550">s</a>))-&gt;vhost_id, <a class="code" href="group__APACHE__CORE__CONFIG.html#ga06e97fb366205b8f170da3c7562a8677">name</a>,</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                             matched == <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;NOT &quot;</span>, <span class="keywordtype">id</span>[i]);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">if</span> (matched == <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__APACHE__CORE__LISTEN.html#ga9359ed159c8b295541e3770172d34550">s</a>) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <a class="code" href="ssl__engine__log_8c.html#a5de86875132e7d957f6ff54cf3e3c002">ssl_log_xerror</a>(<a class="code" href="group__MOD__SSL__PRIVATE.html#ga0e50481cba5952ce59ad2c103f8128a4">SSLLOG_MARK</a>, <a class="code" href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a>, 0, <a class="code" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>, <a class="code" href="group__APACHE__CORE__LISTEN.html#ga9359ed159c8b295541e3770172d34550">s</a>, x509,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                       <a class="code" href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a>(02412) <span class="stringliteral">&quot;[%s] Cert %s for name &#39;%s&#39;&quot;</span>,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                       (<a class="code" href="group__MOD__SSL__PRIVATE.html#ga3ea8e2c288a4f4af189ae0fc4f1fd996">mySrvConfig</a>(<a class="code" href="group__APACHE__CORE__LISTEN.html#ga9359ed159c8b295541e3770172d34550">s</a>))-&gt;vhost_id,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                       matched == <a class="code" href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> ? <span class="stringliteral">&quot;matches&quot;</span> : <span class="stringliteral">&quot;does not match&quot;</span>,</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                       <a class="code" href="group__APACHE__CORE__CONFIG.html#ga06e97fb366205b8f170da3c7562a8677">name</a>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pcregrep_8txt.html#adbf62cf6c8d0bfcea6906e5ffb865b90">matched</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__CONFIG_html_ga06e97fb366205b8f170da3c7562a8677"><div class="ttname"><a href="group__APACHE__CORE__CONFIG.html#ga06e97fb366205b8f170da3c7562a8677">name</a></div><div class="ttdeci">apr_pool_t const char * name</div><div class="ttdef"><b>Definition:</b> http_config.h:800</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga655e126996849bcb82e4e5a14c616f4a"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga655e126996849bcb82e4e5a14c616f4a">APLOG_MARK</a></div><div class="ttdeci">#define APLOG_MARK</div><div class="ttdef"><b>Definition:</b> http_log.h:283</div></div>
<div class="ttc" id="structapr__array__header__t_html"><div class="ttname"><a href="structapr__array__header__t.html">apr_array_header_t</a></div><div class="ttdef"><b>Definition:</b> apr_tables.h:62</div></div>
<div class="ttc" id="group__MOD__SSL__PRIVATE_html_gaa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="group__MOD__SSL__PRIVATE.html#gaa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> ssl_private.h:71</div></div>
<div class="ttc" id="group__APACHE__CORE__MPM_html_ga5cd91701e5c167f2b1a38e70ab57817e"><div class="ttname"><a href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a></div><div class="ttdeci">apr_proc_t const char const char *const const char *const apr_procattr_t apr_pool_t * p</div><div class="ttdef"><b>Definition:</b> ap_mpm.h:109</div></div>
<div class="ttc" id="pcregrep_8txt_html_adbf62cf6c8d0bfcea6906e5ffb865b90"><div class="ttname"><a href="pcregrep_8txt.html#adbf62cf6c8d0bfcea6906e5ffb865b90">matched</a></div><div class="ttdeci">all the files are read include the only direc tories that are processed are those that match one of the whether listed on the command obtained from file or by scanning a parent directory The pattern is a PCRE regular and is matched against the final component of the directory not the entire path The and x options do not apply to this pattern The option may be given any number of times If a directory matches both include dir and exclude it is excluded There is no short form for this option files without match Instead of outputting lines from the just output the names of the files that do not contain any lines that would have been output Each file name is output on a sepa rate line files with matches Instead of outputting lines from the just output the names of the files containing lines that would have been out put Each file name is output on a separate line Searching normally stops as soon as a matching line is found in a file if the matching continues in order to obtain the correct and those files that have at least one match are listed along with their counts Using this option with c is a way of sup pressing the listing of files with no matches standard input is used There is no short form for this option line buffered When this option is input is read and processed line by and the output is flushed after each write By input is read in large unless pcregrep can determine that it is reading from a its use will affect perfor and the show each match as a line the offset from the start of the and a length The line number is terminated by a and the offset and length are separated by a comma In this no context is shown That the and C options are ignored If there is more than one match in a each of them is shown sepa rately This option is mutually exclusive with file offsets and only matching the PCRE library s leading in some cases to a pro gram crash if not enough is available Other patterns may take a very long time to search for all possible matching strings The but which have a very large number of possibilities in their search trees The classic example is a pattern that uses nested unlimited repeats PCRE uses a func tion called which has the effect of limiting the amount of backtracking that can take place The recursion limit option is similar to match but instead of limiting the total number of times that it limits the depth of recursive which in turn limits the amount of memory that can be used The recursion depth is a smaller number than the total number of because not all calls to with the default default being million multiline Allow patterns to match more than one line When this option is patterns may usefully contain literal newline char acters and internal occurrences of and characters The output for a successful match may consist of more than one the last of which is the one in which the match ended If the matched string ends with a newline sequence the output ends at the end of that line When this option is the PCRE library is called in mul tiline mode There is a limit to the number of lines that can be matched</div><div class="ttdef"><b>Definition:</b> pcregrep.txt:476</div></div>
<div class="ttc" id="pcre__internal_8h_html_a050c65e107f0c828f856a231f4b4e788"><div class="ttname"><a href="pcre__internal_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a></div><div class="ttdeci">int BOOL</div><div class="ttdef"><b>Definition:</b> pcre_internal.h:1159</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_gadfcef90537539cf2b7d35cfbbbafeb93"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#gadfcef90537539cf2b7d35cfbbbafeb93">APLOG_DEBUG</a></div><div class="ttdeci">#define APLOG_DEBUG</div><div class="ttdef"><b>Definition:</b> http_log.h:50</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga6016b58857e4c0b11e39913bdf4ff910"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga6016b58857e4c0b11e39913bdf4ff910">ap_strchr_c</a></div><div class="ttdeci">#define ap_strchr_c(s, c)</div><div class="ttdef"><b>Definition:</b> httpd.h:2244</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga5e6676c87418af7a1d323a116c78ecb4"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga5e6676c87418af7a1d323a116c78ecb4">ap_log_error</a></div><div class="ttdeci">#define ap_log_error</div><div class="ttdef"><b>Definition:</b> http_log.h:370</div></div>
<div class="ttc" id="group__MOD__PROXY_html_ga38403a0592eb8018a3ad61aef0f7ca2c"><div class="ttname"><a href="group__MOD__PROXY.html#ga38403a0592eb8018a3ad61aef0f7ca2c">i</a></div><div class="ttdeci">proxy_worker_shared int i</div><div class="ttdef"><b>Definition:</b> mod_proxy.h:718</div></div>
<div class="ttc" id="structapr__array__header__t_html_ab11b88220885c5a0920a06ac85680055"><div class="ttname"><a href="structapr__array__header__t.html#ab11b88220885c5a0920a06ac85680055">apr_array_header_t::nelts</a></div><div class="ttdeci">int nelts</div><div class="ttdef"><b>Definition:</b> apr_tables.h:68</div></div>
<div class="ttc" id="group__MOD__SSL__PRIVATE_html_ga3ea8e2c288a4f4af189ae0fc4f1fd996"><div class="ttname"><a href="group__MOD__SSL__PRIVATE.html#ga3ea8e2c288a4f4af189ae0fc4f1fd996">mySrvConfig</a></div><div class="ttdeci">#define mySrvConfig(srv)</div><div class="ttdef"><b>Definition:</b> ssl_private.h:303</div></div>
<div class="ttc" id="group__MOD__SSL__PRIVATE_html_gaa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="group__MOD__SSL__PRIVATE.html#gaa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> ssl_private.h:75</div></div>
<div class="ttc" id="group__MOD__SSL__PRIVATE_html_ga0e50481cba5952ce59ad2c103f8128a4"><div class="ttname"><a href="group__MOD__SSL__PRIVATE.html#ga0e50481cba5952ce59ad2c103f8128a4">SSLLOG_MARK</a></div><div class="ttdeci">#define SSLLOG_MARK</div><div class="ttdef"><b>Definition:</b> ssl_private.h:1021</div></div>
<div class="ttc" id="group__APACHE__CORE__LISTEN_html_ga9359ed159c8b295541e3770172d34550"><div class="ttname"><a href="group__APACHE__CORE__LISTEN.html#ga9359ed159c8b295541e3770172d34550">s</a></div><div class="ttdeci">server_rec * s</div><div class="ttdef"><b>Definition:</b> ap_listen.h:109</div></div>
<div class="ttc" id="apr__cpystrn_8c_html_a4a00fc29b96a953fed9e0107a9c4548a"><div class="ttname"><a href="apr__cpystrn_8c.html#a4a00fc29b96a953fed9e0107a9c4548a">strcasecmp</a></div><div class="ttdeci">int strcasecmp(const char *a, const char *b)</div><div class="ttdef"><b>Definition:</b> apr_cpystrn.c:248</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga5e4f134ae2203dd339774d9549d814db"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga5e4f134ae2203dd339774d9549d814db">APLOG_TRACE3</a></div><div class="ttdeci">#define APLOG_TRACE3</div><div class="ttdef"><b>Definition:</b> http_log.h:53</div></div>
<div class="ttc" id="structapr__array__header__t_html_af8462fa2a1ddf6406c66cd3dd441a269"><div class="ttname"><a href="structapr__array__header__t.html#af8462fa2a1ddf6406c66cd3dd441a269">apr_array_header_t::elts</a></div><div class="ttdeci">char * elts</div><div class="ttdef"><b>Definition:</b> apr_tables.h:72</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_ga1dee8a07e06bc5b3de8b89662c2cd666"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#ga1dee8a07e06bc5b3de8b89662c2cd666">APLOGNO</a></div><div class="ttdeci">#define APLOGNO(n)</div><div class="ttdef"><b>Definition:</b> http_log.h:117</div></div>
<div class="ttc" id="ssl__engine__log_8c_html_a5de86875132e7d957f6ff54cf3e3c002"><div class="ttname"><a href="ssl__engine__log_8c.html#a5de86875132e7d957f6ff54cf3e3c002">ssl_log_xerror</a></div><div class="ttdeci">void ssl_log_xerror(const char *file, int line, int level, apr_status_t rv, apr_pool_t *ptemp, server_rec *s, X509 *cert, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> ssl_engine_log.c:203</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_cgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_cgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_cgraph" id="group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_cgraph">
<area shape="rect" id="node2" href="apr__cpystrn_8c.html#a4a00fc29b96a953fed9e0107a9c4548a" title="strcasecmp" alt="" coords="242,5,333,32"/>
<area shape="rect" id="node3" href="ssl__engine__log_8c.html#a5de86875132e7d957f6ff54cf3e3c002" title="ssl_log_xerror" alt="" coords="236,56,339,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_icgraph" id="group__MOD__SSL__UTIL_ga617b046265fec156bdbb4e897034c113_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__PRIVATE.html#ga4aa47e22efe0b853cf31c3e8e9a7c70c" title="ssl_init_Module" alt="" coords="236,29,348,56"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="396,29,553,56"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga2892cbff75bedf65cf0731d337684894"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* modssl_X509_NAME_ENTRY_to_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapr__pool__t.html">apr_pool_t</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509_NAME_ENTRY *&#160;</td>
          <td class="paramname"><em>xsne</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="group__APACHE__CORE__MPM.html#ga9f5959dd76d5c83e775dcf44de684686">result</a> = asn1_string_to_utf8(p, X509_NAME_ENTRY_get_data(xsne));</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="group__APACHE__CORE__EBCDIC.html#gad8d6e268d45b4380e6b00371795b12c7">ap_xlate_proto_from_ascii</a>(result, <a class="code" href="group__APACHE__CORE__LOG.html#gab5a43233d60ef05c5b5bf5cba3d74468">len</a>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__MPM.html#ga9f5959dd76d5c83e775dcf44de684686">result</a>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__LOG_html_gab5a43233d60ef05c5b5bf5cba3d74468"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#gab5a43233d60ef05c5b5bf5cba3d74468">len</a></div><div class="ttdeci">const char apr_size_t len</div><div class="ttdef"><b>Definition:</b> ap_regex.h:140</div></div>
<div class="ttc" id="group__APACHE__CORE__EBCDIC_html_gad8d6e268d45b4380e6b00371795b12c7"><div class="ttname"><a href="group__APACHE__CORE__EBCDIC.html#gad8d6e268d45b4380e6b00371795b12c7">ap_xlate_proto_from_ascii</a></div><div class="ttdeci">#define ap_xlate_proto_from_ascii(x, y)</div><div class="ttdef"><b>Definition:</b> util_ebcdic.h:81</div></div>
<div class="ttc" id="group__APACHE__CORE__MPM_html_ga9f5959dd76d5c83e775dcf44de684686"><div class="ttname"><a href="group__APACHE__CORE__MPM.html#ga9f5959dd76d5c83e775dcf44de684686">result</a></div><div class="ttdeci">int * result</div><div class="ttdef"><b>Definition:</b> ap_mpm.h:160</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga2892cbff75bedf65cf0731d337684894_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga2892cbff75bedf65cf0731d337684894_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga2892cbff75bedf65cf0731d337684894_icgraph" id="group__MOD__SSL__UTIL_ga2892cbff75bedf65cf0731d337684894_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__UTIL.html#gadc03fd52fbd4883723b4caa24915e595" title="modssl_X509_getSAN" alt="" coords="253,29,408,56"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#gafdb8841b626c0bc44c0583a748c36cec" title="modssl_var_extract\l_san_entries" alt="" coords="456,22,592,63"/>
<area shape="rect" id="node4" href="group__MOD__SSL__PRIVATE.html#ga2574b28e07747ea87febd970f9a76eb3" title="ssl_hook_Fixup" alt="" coords="640,29,753,56"/>
<area shape="rect" id="node5" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="801,29,959,56"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga51008e236441926c31150e12283c87aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* modssl_X509_NAME_to_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapr__pool__t.html">apr_pool_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509_NAME *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcre_8txt.html#a42dfa4ff673c82d8efe7144098fbc198">int</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="group__APACHE__CORE__MPM.html#ga9f5959dd76d5c83e775dcf44de684686">result</a> = <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    BIO *bio;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="group__APACHE__CORE__LOG.html#gab5a43233d60ef05c5b5bf5cba3d74468">len</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> ((bio = BIO_new(BIO_s_mem())) == <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    X509_NAME_print_ex(bio, dn, 0, XN_FLAG_RFC2253);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    len = BIO_pending(bio);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span> (len &gt; 0) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        result = apr_palloc(<a class="code" href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a>, (<a class="code" href="group__APACHE__CORE__DAEMON.html#ga396b50964961e17784202ccbefcbf25d">maxlen</a> &gt; 0) ? <a class="code" href="group__APACHE__CORE__DAEMON.html#ga396b50964961e17784202ccbefcbf25d">maxlen</a>+1 : len+1);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__APACHE__CORE__DAEMON.html#ga396b50964961e17784202ccbefcbf25d">maxlen</a> &gt; 0 &amp;&amp; <a class="code" href="group__APACHE__CORE__DAEMON.html#ga396b50964961e17784202ccbefcbf25d">maxlen</a> &lt; len) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            len = BIO_read(bio, result, <a class="code" href="group__APACHE__CORE__DAEMON.html#ga396b50964961e17784202ccbefcbf25d">maxlen</a>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__APACHE__CORE__DAEMON.html#ga396b50964961e17784202ccbefcbf25d">maxlen</a> &gt; 2) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="comment">/* insert trailing ellipsis if there&#39;s enough space */</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                apr_snprintf(result + <a class="code" href="group__APACHE__CORE__DAEMON.html#ga396b50964961e17784202ccbefcbf25d">maxlen</a> - 3, 4, <span class="stringliteral">&quot;...&quot;</span>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            len = BIO_read(bio, result, len);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        result[<a class="code" href="group__APACHE__CORE__LOG.html#gab5a43233d60ef05c5b5bf5cba3d74468">len</a>] = <a class="code" href="group__MOD__SSL__PRIVATE.html#gaf19d48b9f61047a668649a2f9dc317ff">NUL</a>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    BIO_free(bio);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__APACHE__CORE__MPM.html#ga9f5959dd76d5c83e775dcf44de684686">result</a>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div><div class="ttc" id="group__APACHE__CORE__MPM_html_ga5cd91701e5c167f2b1a38e70ab57817e"><div class="ttname"><a href="group__APACHE__CORE__MPM.html#ga5cd91701e5c167f2b1a38e70ab57817e">p</a></div><div class="ttdeci">apr_proc_t const char const char *const const char *const apr_procattr_t apr_pool_t * p</div><div class="ttdef"><b>Definition:</b> ap_mpm.h:109</div></div>
<div class="ttc" id="group__APACHE__CORE__LOG_html_gab5a43233d60ef05c5b5bf5cba3d74468"><div class="ttname"><a href="group__APACHE__CORE__LOG.html#gab5a43233d60ef05c5b5bf5cba3d74468">len</a></div><div class="ttdeci">const char apr_size_t len</div><div class="ttdef"><b>Definition:</b> ap_regex.h:140</div></div>
<div class="ttc" id="group__MOD__SSL__PRIVATE_html_gaf19d48b9f61047a668649a2f9dc317ff"><div class="ttname"><a href="group__MOD__SSL__PRIVATE.html#gaf19d48b9f61047a668649a2f9dc317ff">NUL</a></div><div class="ttdeci">#define NUL</div><div class="ttdef"><b>Definition:</b> ssl_private.h:269</div></div>
<div class="ttc" id="group__APACHE__CORE__DAEMON_html_ga396b50964961e17784202ccbefcbf25d"><div class="ttname"><a href="group__APACHE__CORE__DAEMON.html#ga396b50964961e17784202ccbefcbf25d">maxlen</a></div><div class="ttdeci">char const char const char apr_size_t ap_regmatch_t apr_size_t maxlen</div><div class="ttdef"><b>Definition:</b> httpd.h:1976</div></div>
<div class="ttc" id="pcre_8txt_html_ad7f989d16aa8ca809a36bc392c07fba1"><div class="ttname"><a href="pcre_8txt.html#ad7f989d16aa8ca809a36bc392c07fba1">NULL</a></div><div class="ttdeci">this is a typedef for a structure whose contents are not externally defined It is up to the caller to free the that it does not depend on memory the complete pcre data block is not fully because it may contain a copy of the tableptr argu which is an those that are compatible with but some others as well can also be set and unset from within the the contents of the options argument specifies their settings at the start of compilation and execution The and PCRE_NO_START_OPTIMIZE options can be set at the time of matching as well as at compile time If errptr is NULL</div><div class="ttdef"><b>Definition:</b> pcre.txt:2065</div></div>
<div class="ttc" id="group__APACHE__CORE__MPM_html_ga9f5959dd76d5c83e775dcf44de684686"><div class="ttname"><a href="group__APACHE__CORE__MPM.html#ga9f5959dd76d5c83e775dcf44de684686">result</a></div><div class="ttdeci">int * result</div><div class="ttdef"><b>Definition:</b> ap_mpm.h:160</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__MOD__SSL__UTIL_ga51008e236441926c31150e12283c87aa_icgraph.png" border="0" usemap="#group__MOD__SSL__UTIL_ga51008e236441926c31150e12283c87aa_icgraph" alt=""/></div>
<map name="group__MOD__SSL__UTIL_ga51008e236441926c31150e12283c87aa_icgraph" id="group__MOD__SSL__UTIL_ga51008e236441926c31150e12283c87aa_icgraph">
<area shape="rect" id="node2" href="group__MOD__SSL__PRIVATE.html#ga14e99b39c5c1ebf015f8d3e8fdd0ca70" title="ssl_init_CheckServers" alt="" coords="609,5,763,32"/>
<area shape="rect" id="node5" href="group__MOD__SSL__PRIVATE.html#ga9a4071d17f72df0574d3c8840886d3bb" title="ssl_log_ssl_error" alt="" coords="219,187,339,213"/>
<area shape="rect" id="node3" href="group__MOD__SSL__PRIVATE.html#ga4aa47e22efe0b853cf31c3e8e9a7c70c" title="ssl_init_Module" alt="" coords="828,157,940,184"/>
<area shape="rect" id="node4" href="group__MOD__SSL__PRIVATE.html#ga41dd90c37aff54ebfb37071f8b6a3b46" title="ssl_init_ssl_connection" alt="" coords="1163,472,1320,499"/>
<area shape="rect" id="node6" href="ssl__engine__init_8c.html#a8d3ef5dbf93a046b44c0a610b5325b45" title="STACK_OF" alt="" coords="425,325,517,352"/>
<area shape="rect" id="node7" href="group__MOD__SSL__PRIVATE.html#gad536620d986d5e4c72891abcdf205036" title="ssl_hook_Access" alt="" coords="623,552,749,579"/>
<area shape="rect" id="node13" href="group__MOD__SSL__PRIVATE.html#gafebe2cea0454494fe6c90d112b982213" title="modssl_dispatch_ocsp\l_request" alt="" coords="609,209,763,250"/>
<area shape="rect" id="node16" href="group__MOD__SSL__PRIVATE.html#ga594145a68cd4bcdddfcee86210599d73" title="ssl_load_encrypted_pkey" alt="" coords="387,107,556,133"/>
<area shape="rect" id="node17" href="group__MOD__SSL__PRIVATE.html#gafd4f4e800eec373cf92da32610897efc" title="ssl_init_ocsp_certificates" alt="" coords="387,159,556,185"/>
<area shape="rect" id="node8" href="group__MOD__SSL__PRIVATE.html#ga2574b28e07747ea87febd970f9a76eb3" title="ssl_hook_Fixup" alt="" coords="1001,472,1114,499"/>
<area shape="rect" id="node9" href="group__MOD__SSL__PRIVATE.html#gaf5cd2a533da5f24cb355f5745e397727" title="ssl_callback_proxy_cert" alt="" coords="605,275,767,301"/>
<area shape="rect" id="node10" href="group__MOD__SSL__PRIVATE.html#ga42e6f981345c92e377fc830d91667fa5" title="ssl_var_lookup" alt="" coords="631,376,741,403"/>
<area shape="rect" id="node14" href="group__MOD__SSL__UTIL.html#gadc03fd52fbd4883723b4caa24915e595" title="modssl_X509_getSAN" alt="" coords="609,451,763,477"/>
<area shape="rect" id="node11" href="group__MOD__SSL__PRIVATE.html#gafbb3810aae5f5ad5d5d1e78977ff3888" title="ssl_var_register" alt="" coords="1000,403,1115,429"/>
<area shape="rect" id="node12" href="group__MOD__SSL__PRIVATE.html#ga6f47bd17d9737a2c803a58bea27d5407" title="ssl_var_log_config\l_register" alt="" coords="819,318,949,359"/>
<area shape="rect" id="node15" href="group__MOD__SSL__PRIVATE.html#gafdb8841b626c0bc44c0583a748c36cec" title="modssl_var_extract\l_san_entries" alt="" coords="816,435,952,477"/>
<area shape="rect" id="node18" href="group__MOD__SSL__PRIVATE.html#gad251ffd8ea9f31b8f2fd5333c9261b82" title="ssl_init_ConfigureServer" alt="" coords="604,157,768,184"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
